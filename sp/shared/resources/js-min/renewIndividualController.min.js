function renewIndividualController($scope,$element,$attrs,$http,ngDialog,$timeout,ajaxService){$scope.product={},$scope.promoApplied=!1,$scope.finalAmount=0,$scope.promo={},$scope.updatedPromoDetails={},$scope.updateCC={},$scope.dialogStatus={},$scope.promoError={},$scope.serverError=!1,$scope.getIndividualAccountInfo=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/individualAccountDetails"}).then(function(response){"true"===response.Success&&($scope.accountInfo=response)})},$scope.getProductInfo=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/getCurrentIndividualProductInfo"}).then(function(response){"true"===response.Success&&($scope.product=response.product,void 0!==response.promotion&&void 0!==response.promotion.unitPrice?($scope.product.updatedUnitPrice=parseFloat(response.promotion.unitPrice).toFixed(2),$scope.promoApplied=!0,$scope.finalAmount=parseFloat(12*$scope.product.updatedUnitPrice).toFixed(2)):($scope.product.updatedUnitPrice=parseFloat(response.product.unitPrice).toFixed(2),$scope.promoApplied=!1,$scope.finalAmount=parseFloat(12*$scope.product.updatedUnitPrice).toFixed(2)))})},$scope.activatePromo=function(promoCode){if($scope.promoDetails.$valid){var _params={code:promoCode,productId:$scope.product.id};ajaxService.getAjaxResponse({url:"/sp/signup/promotion",data:$.param(_params)}).then(function(response){"true"===response.Success?($scope.updatedPromoDetails=response.promotion,$scope.product.updatedUnitPrice=parseFloat(response.promotion.unitPrice).toFixed(2),$scope.promoApplied=!0,$scope.finalAmount=parseFloat(12*$scope.product.updatedUnitPrice).toFixed(2)):($scope.promoError.error=!0,$scope.promoError.msg=response.error,$scope.promo.code=null,$timeout(function(){$scope.promoError.error=!1},1500))})}else $scope.promoFormSubmitted=!0,$scope.promo.code=null},$scope.renewIndividualSubscription=function(fData){var _paramsUpdated,_params={},vCount=0;for(var k in fData)"default"!==fData[k]&&"default1"!==fData[k]||vCount++;_params=!1===$scope.promoApplied?{numAccounts:1,productId:$scope.product.id}:{numAccounts:1,productId:$scope.product.id,promotionId:$scope.updatedPromoDetails.id},$scope.updateCC.$valid&&0===vCount?(_paramsUpdated=$.extend({},_params,fData),ajaxService.getAjaxResponse({url:"/sp/admin/account/renewAccount",data:$.param(_paramsUpdated)}).then(function(response){if("true"===response.Success)$scope.dialogStatus.title="Subscription Renewal",$scope.dialogStatus.content="Subscription renewed successfully.",ngDialog.open({template:"/sp/resources/html/admin/account/success-dialog.html",scope:$scope});else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})):$scope.updateCC.submitted=!0},$scope.deactivatePromo=function(){$scope.product.updatedUnitPrice=parseFloat($scope.product.unitPrice).toFixed(2),$scope.finalAmount=parseFloat(12*$scope.product.updatedUnitPrice).toFixed(2),$scope.promoApplied=!1,$scope.promo.code=null},$scope.cancelRedirect=function(){window.location="/sp/admin/account/individual"},$scope.initRenewIndividual=function(){$scope.getIndividualAccountInfo(),$scope.getProductInfo()},$scope.initRenewIndividual()}angular.module("spApp").controller("Additional Member Accounts",renewIndividualController),renewIndividualController.$inject=["$scope","$element","$attrs","$http","ngDialog","$timeout","ajaxService"];