function competencyListingController($scope,ajaxService,ngDialog,$localStorage,sharedProperties,$filter,$rootScope){function getAllCompetencyProfiles(){ajaxService.getAjaxResponse({url:self.serviceApis.getAllCompetencyProfiles}).then(function(response){"true"===response.Success?(self.responseAvailable=!0,self.masterCompetenciesList=response.companyCompetencyList,self.returnMemberList(),self.competenciesList=angular.copy(self.masterCompetenciesList)):null!==response.error&&sharedProperties.ajaxError(response.error)})}function selectCompany(){self.competencyCompanies.length?openCompanyModal():getCompaniesWithCompetencyFeature()}function getCompaniesWithCompetencyFeature(){ajaxService.getAjaxResponse({url:self.serviceApis.getCompaniesWithCompetencyFeature,method:"POST"}).then(function(response){"true"===response.Success?(self.responseAvailableForModal=!0,self.competencyCompanies=response.companyList,self.competencyCompanies.length?openCompanyModal():sharedProperties.growlMessage("No Companies found with Competency Feature Enabled.","<strong> Alert </strong>","glyphicon glyphicon-ban-circle")):null!==response.error&&sharedProperties.ajaxError(response.error)})}function openCompanyModal(){ngDialog.open({template:self.serviceApis.selectCompanyModal,scope:$scope}).closePromise.then(function(data){self.pageVariables.companySearchText=""})}function returnMemberList(pageSize){if(!self.masterCompetenciesList.length)return!0;self.order(self.pageVariables.lastPredicate,self.pageVariables.lastReverse)}function order(predicate,reverse){self.pageVariables.lastPredicate=predicate,self.pageVariables.lastReverse=reverse,self.competenciesList=$filter("orderBy")(self.competenciesList,predicate,reverse)}function searchTextFilter(search){self.pageVariables.textSearching=search,self.returnMemberList()}function active(event,setting){self.pageVariables.lastPredicate=setting.predicate,self.pageVariables.lastReverse=setting.reverse,sharedProperties.toggleFilterClick(event,self.pageVariables.lastPredicate),self.order(self.pageVariables.lastPredicate,self.pageVariables.lastReverse)}function resetfilter(){self.pageVariables=angular.copy(self.originalpageVariables),self.returnMemberList();var curr=$(".memberHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")}function createCompetency(obj){$localStorage.set("competency",obj),window.location.href="/sp/sysAdmin/competency/create"}function updateCompetency(obj){$localStorage.set("competency",obj),window.location.href="/sp/sysAdmin/competency/update"}var self=this;self.masterCompetenciesList=[],self.competenciesList=[],self.competencyCompanies=[],self.serviceApis={getAllCompetencyProfiles:"/sp/sysAdmin/competency/getAll",getCompaniesWithCompetencyFeature:"/sp/sysAdmin/competency/getCompanies",selectCompanyModal:"/sp/sysAdmin/competency/selectCompany"},self.pageVariables={searchText:"",disabledInfinite:!1,lastPredicate:"name",lastReverse:!1,companySearchText:""},self.responseAvailable=!1,self.responseAvailableForModal=!1,self.originalpageVariables=angular.copy(self.pageVariables),self.getAllCompetencyProfiles=getAllCompetencyProfiles,self.getCompaniesWithCompetencyFeature=getCompaniesWithCompetencyFeature,self.searchTextFilter=searchTextFilter,self.returnMemberList=returnMemberList,self.active=active,self.order=order,self.selectCompany=selectCompany,self.createCompetency=createCompetency,self.updateCompetency=updateCompetency,self.resetfilter=resetfilter,function(){null!==$localStorage.get("competencyStatus")&&(sharedProperties.growlMessage($localStorage.get("competencyStatus")),$localStorage.remove("competencyStatus"))}()}function competencyAdminController($scope,ajaxService,$localStorage,ngDialog,spJsonFetchAdminComp,$rootScope,$timeout,sharedProperties,$state,$filter,filterFilter){function openRatingWarnModal(){ngDialog.open({template:"/sp/resources/html/sysAdmin/competency/rating-change-warn.html",scope:$scope,closeByDocument:!1,closeByEscape:!1})}function closeWarnDialog(){self.actionPlan.ratingConfiguration.size=self.currentRatingScale,ngDialog.close()}function updateRatingList(){ngDialog.close();var diff=calculateDiff(self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList.length,self.actionPlan.ratingConfiguration.size),currentListLength=self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList.length;if(self.backupRatingList=[],self.backupRatingList=angular.copy(self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList),self.actionPlan.ratingConfiguration.size>currentListLength)for(var j=1;j<=diff;j++){var ratingObj={title:null,description:null,score:currentListLength+j};self.backupRatingList.push(ratingObj)}else if(self.actionPlan.ratingConfiguration.size<currentListLength)for(var k=currentListLength-1;k>=self.actionPlan.ratingConfiguration.size;k--)self.backupRatingList.splice(k,1);null!==self.backupRatingList[self.backupRatingList.length-1].title&&""!==self.backupRatingList[self.backupRatingList.length-1].title||(self.backupRatingList[self.backupRatingList.length-1].title="Test Title"),null!==self.backupRatingList[self.backupRatingList.length-1].description&&""!==self.backupRatingList[self.backupRatingList.length-1].description||(self.backupRatingList[self.backupRatingList.length-1].description="Test Description");for(var i=0;i<self.actionPlan.competencyList.length;i++)self.actionPlan.competencyList[i].rating.ratingList=angular.copy(self.backupRatingList);window.setTimeout(function(){jQuery('input[type="range"]').rangeslider("update",!0)},1e3),$("html, body").animate({scrollTop:$("#rating-desc").offset().top},1e3),sharedProperties.growlMessage("Please update the default Rating title and description.")}function reloadSlider(){window.setTimeout(function(){jQuery('input[type="range"]').rangeslider("update",!0)},1e3)}function deleteCompetencyModal(){self.actionPlan.evaluationInProgress?sharedProperties.growlMessage("Competency Evaluation in Progress..","<strong> Alert </strong>","glyphicon glyphicon-ban-circle"):ngDialog.open({template:"/sp/resources/html/sysAdmin/competency/delete-competency.html",scope:$scope})}function deleteGenericModal(options){"update"===self.mode&&self.actionPlan.evaluationInProgress?sharedProperties.growlMessage("Competency Evaluation in Progress..","<strong> Alert </strong>","glyphicon glyphicon-ban-circle"):(self.competencyDeleteOptions=options,ngDialog.open({template:"/sp/resources/html/sysAdmin/competency/delete-generic-modal.html",scope:$scope}))}function deleteActionList(){"competency"===self.competencyDeleteOptions.type?(self.actionPlan.competencyList.splice(self.currentCompetencyListIndex,1),moveIndexToFirstItem(0),void 0!==self.competencyDeleteOptions.id&&self.actionPlan.deletedCompetencyList.push(self.competencyDeleteOptions.id)):self.competencyDeleteOptions.list.splice(self.competencyDeleteOptions.index,1),ngDialog.close()}function deleteCompetencyProfile(){ajaxService.getAjaxResponse({url:self.config.deleteCompetencyProfile,data:$.param({competencyProfileId:self.actionPlan.id})}).then(function(response){"true"===response.Success?(ngDialog.close(),sharedProperties.growlMessage("Competency Profile Deleted Successfully"),$timeout(function(){window.location.href="/sp/sysAdmin/competency/home"},500)):null!==response.error&&(ngDialog.close(),sharedProperties.ajaxError(response.error))})}function removeArticleFromCompetency(id){sharedProperties.spilceIndexWithBreak(self.addedArticles,"articleLinkUrl",id);var filteredArray=self.actionPlan.competencyList[self.currentActionPlan].mandatoryArticles.filter(function(e){return e!==id});self.actionPlan.competencyList[self.currentActionPlan].mandatoryArticles=angular.copy(filteredArray);for(var i=0;i<self.masterArticlesList.length;i++)if(self.masterArticlesList[i].articleLinkUrl===id){self.masterArticlesList[i].added=!1;break}}function addArticleToCompetency(obj){if(-1===self.actionPlan.competencyList[self.currentActionPlan].mandatoryArticles.indexOf(obj.articleLinkUrl)){self.addedArticles.push(obj),self.actionPlan.competencyList[self.currentActionPlan].mandatoryArticles.push(obj.articleLinkUrl);for(var i=0;i<self.masterArticlesList.length;i++)if(self.masterArticlesList[i].articleLinkUrl===obj.articleLinkUrl){self.masterArticlesList[i].added=!0;break}self.articlesList=filterFilter(self.masterArticlesList,self.articleSearchText)}else sharedProperties.growlMessage("Article already added.","<strong> Alert </strong>","glyphicon glyphicon-ban-circle")}function competencySort(length){if(!self.actionBool&&length>1){new Sortable121(document.getElementById("sort-competency"),{animation:150,ghostClass:"ghost",handle:".practiceHandle",yAxisOnly:!0,onEnd:function(evt){self.actionPlan.competencyList.move(evt.oldIndex,evt.newIndex),self.currentActionPlan=evt.newIndex}});self.actionBool=!0}}function articlesSortable(length){if(!self.initializeBool&&length>1){new Sortable121(document.getElementById("sort-me"),{animation:150,ghostClass:"ghost",handle:".dHandle",yAxisOnly:!0,onEnd:function(evt){self.addedArticles.move(evt.oldIndex,evt.newIndex),self.actionPlan.competencyList[self.currentActionPlan].mandatoryArticles.move(evt.oldIndex,evt.newIndex)}});self.initializeBool=!0}}function initializeCompetency(param){null===$localStorage.get("competency")?redirectToListing():self.company=$localStorage.get("competency"),"update"===param?(self.mode=param,getDetail("onLoad")):(self.mode=param,self.actionPlan=spJsonFetchAdminComp.spCompJson(),self.copYactionPlan=self.actionPlan.competencyList[self.currentActionPlan].devStrategyActionCategoryList),$state.go("competencyView"),"create"===param&&(self.currentCompetencyId=void 0,self.currentCompetencyListIndex=0,self.currentRatingScale=self.actionPlan.ratingConfiguration.size,window.setTimeout(function(){jQuery('input[type="range"]').rangeslider("update",!0)},1e3))}function getDetail(type){ajaxService.getAjaxResponse({url:self.config.getDetail,data:$.param({competencyProfileId:self.company.competencyProfileId})}).then(function(response){"true"===response.Success?(self.actionPlan=response.competencyProfile,self.actionPlan.deletedCompetencyList=[],"onSave"===type?(self.currentCompetencyId=self.actionPlan.competencyList[self.currentActionPlan].id,self.currentCompetencyListIndex=self.currentActionPlan,self.addedArticles=angular.copy(self.actionPlan.competencyList[self.currentActionPlan].articlesDTOList)):(self.currentCompetencyId=self.actionPlan.competencyList[0].id,self.currentCompetencyListIndex=0,self.addedArticles=angular.copy(self.actionPlan.competencyList[0].articlesDTOList)),self.copYactionPlan=self.actionPlan.competencyList[self.currentActionPlan].devStrategyActionCategoryList,self.backupRatingList=angular.copy(self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList),null!==self.actionPlan.ratingConfiguration?self.currentRatingScale=self.actionPlan.ratingConfiguration.size:(self.currentRatingScale=3,self.actionPlan.ratingConfiguration={},self.actionPlan.ratingConfiguration.type="Numeric",self.actionPlan.ratingConfiguration.size=self.backupRatingList.length),scrollPosition(),window.setTimeout(function(){jQuery('input[type="range"]').rangeslider("update",!0)},1e3)):null!==response.error&&sharedProperties.ajaxError(response.error)})}function clonePlan(){self.clonecompanies.length?openCompanyModal():getCompanies()}function getCompanies(){ajaxService.getAjaxResponse({url:self.config.getCompaniesWithCompetencyFeature,method:"POST"}).then(function(response){if("true"===response.Success){self.responseAvailableForCloning=!0,self.clonecompanies=[],openCompanyModal();var clonedCompany={};response.companyList.filter(function(obj){obj.id===self.company.id?clonedCompany=obj:self.clonecompanies.push(obj)});self.clonecompanies.sort(function(a,b){var nameA=a.name.toLowerCase(),nameB=b.name.toLowerCase();return nameA<nameB?-1:nameA>nameB?1:0}),self.clonecompanies.unshift(clonedCompany)}else null!==response.error&&sharedProperties.ajaxError(response.error)})}function openCompanyModal(){self.clonePlanName=self.actionPlan.name,ngDialog.open({template:"/sp/resources/html/sysAdmin/competency/clone.html",scope:$scope}).closePromise.then(function(data){self.pageSetting.companyText=""})}function selectArticleModal(){ngDialog.open({template:"/sp/resources/html/sysAdmin/competency/select-article.html",scope:$scope}).closePromise.then(function(data){self.articleSearchText="",self.articlesList=[]})}function loadAndFilterArticles(){!self.masterArticlesList.length&&self.articleSearchText.length>2?($rootScope.$broadcast("httpLoaderStart"),ajaxService.getAjaxResponse({url:self.config.getAllArticles,data:$.param({companyId:self.company.id}),method:"POST"}).then(function(response){if("true"===response.Success){self.responseAvailableForModal=!0,self.masterArticlesList=response.articles;for(var i=0;i<self.masterArticlesList.length;i++){self.masterArticlesList[i].added=!1;for(var j=0;j<self.addedArticles.length;j++)self.masterArticlesList[i].articleLinkUrl===self.addedArticles[j].articleLinkUrl&&(self.masterArticlesList[i].added=!0)}self.articlesList=filterFilter(self.masterArticlesList,self.articleSearchText)}else null!==response.error&&sharedProperties.ajaxError(response.error)}),$rootScope.$broadcast("httpLoaderEnd")):self.articleSearchText.length>2?self.articlesList=filterFilter(self.masterArticlesList,self.articleSearchText):self.articlesList=[]}function clearArticleSearch(){self.articlesList=[],self.articleSearchText=""}function openCloseSiblingContent(event,mode){var $this=$(event.target);if($this.hasClass("filterCheckBox-label"))return!0;var toggleClass=void 0===mode?"show":"noshow",$html=$this.closest(".category"),$upTarget=$html.find(".header-style-content:eq(0)"),$upTargetHeight=$upTarget.outerHeight();$html.find(".border-faq-content:eq(0)").outerHeight();$upTargetHeight>1?$upTarget.css("height",0):$upTarget.css("height","auto"),$html.toggleClass(toggleClass)}function addLink(){"update"===self.mode&&self.actionPlan.evaluationInProgress?sharedProperties.growlMessage("Competency Evaluation in Progress..","<strong> Alert </strong>","glyphicon glyphicon-ban-circle"):self.actionPlan.mediaList.push({type:null,linkText:null,url:null,imageLink:null,altText:null})}function singleAction(actionList){"update"===self.mode&&self.actionPlan.evaluationInProgress?sharedProperties.growlMessage("Competency Evaluation in Progress..","<strong> Alert </strong>","glyphicon glyphicon-ban-circle"):(actionList.push({title:"New Strategy",description:null,type:"Single",active:!0,actionData:[{type:null,linkText:null,url:null,imageLink:null,altText:null}]}),self.pageSetting.actions=!0)}function scrollPosition(){$(".parent-cat").each(function(){$(this).removeClass("show").find(".header-style-content:eq(0)").css("height",0)}),$("html,body").animate({scrollTop:$(".lnd-right-sec").offset().top-80},300)}function changeCompetency(index){if(self.currentActionPlan===index)return!0;self.actionPlanForm.submitted=!1,null!==self.actionPlan.description&&void 0!==self.actionPlan.description&&jQuery(".description-toggle").css("background-color","#666 !important"),self.actionPlanForm.$valid?(self.currentActionPlan=index,self.currentCompetencyId=self.actionPlan.competencyList[index].id,self.currentCompetencyListIndex=index,self.addedArticles=[],self.addedArticles=angular.copy(self.actionPlan.competencyList[self.currentCompetencyListIndex].articlesDTOList),scrollPosition()):errorHighlighter()}function startCloning(companyDetail){null!==self.clonePlanName&&(self.actionPlan.name=self.clonePlanName),self.actionPlan.id=null,self.actionPlan.active=!1,self.company.id=companyDetail.id,self.company.name=companyDetail.name,self.mode="clone",self.actionPlan.competencyList.filter(function(e){e.id=null,e.devStrategyActionCategoryList.filter(function(e1){e1.uid=null,e1.actionList.filter(function(e2){e2.uid=null,e2.actionData.filter(function(e3){e3.uid=null})})})}),self.actionPlan.evaluationInProgress=!1,sharedProperties.growlMessage("The Competency Profile has been cloned successfully.")}function createNewSection(index){if(self.actionPlan.evaluationInProgress)sharedProperties.growlMessage("Competency Evaluation in Progress..","<strong> Alert </strong>","glyphicon glyphicon-ban-circle");else if(self.actionPlanForm.submitted=!1,self.currentCompetencyId=void 0,null!==self.actionPlan.description&&void 0!==self.actionPlan.description&&jQuery(".description-toggle").css("background-color","#666 !important"),self.actionPlanForm.$valid){if(null!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[0].title&&void 0!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[0].title&&""!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[0].title&&null!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[0].description&&void 0!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[0].description&&""!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[0].description||(self.ratingValid=!1),null!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList.length-1].title&&void 0!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList.length-1].title&&""!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList.length-1].title&&null!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList.length-1].description&&void 0!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList.length-1].description&&""!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList.length-1].description||(self.ratingValid=!1),!self.ratingValid)return!1;self.ratingValid=!0,self.actionPlan.competencyList.push({name:null,description:null,status:"ACTIVE",introVideo:{status:"INACTIVE",type:"VIDEO"},rating:{defaultIndex:0,ratingList:angular.copy(self.backupRatingList)},devStrategyActionCategoryList:[{title:"Development Strategy",helpText:"",status:"ACTIVE",actionList:[{title:"New Strategy",description:null,type:"Single",active:!0,actionData:[{type:null,linkText:null,url:null,imageLink:null,altText:null}]}]}],mandatoryArticles:[]}),self.currentActionPlan=index,self.addedArticles=[],self.currentCompetencyListIndex=index,self.viewMode={preview:!1,editCreate:!0},scrollPosition()}else errorHighlighter()}function errorHighlighter(){$(".category").each(function(){$(this).find(".ng-invalid-required").length?$(this).addClass("error-category"):$(this).removeClass("error-category")}),self.actionPlanForm.$valid||(self.actionPlanForm.submitted=!0,self.viewMode={preview:!1,editCreate:!0}),"ACTIVE"===self.actionPlan.competencyList[self.currentActionPlan].status&&!self.result.length&&(self.errorCat=!0,self.viewMode={preview:!1,editCreate:!0})}function redirectToListing(){window.location.href="/sp/sysAdmin/competency/home"}function trueCheck(){return self.result=[],self.emptyCheck=[],"ACTIVE"!==self.actionPlan.competencyList[self.currentActionPlan].status||(self.actionPlan.competencyList[self.currentActionPlan].devStrategyActionCategoryList.filter(function(e,i){"ACTIVE"===e.status&&e.actionList.length&&self.emptyCheck.push(e),e.status}),self.result.length)}function submitObject(){if(self.disabled)return!0;if("update"===self.mode&&self.actionPlan.evaluationInProgress)return sharedProperties.growlMessage("Competency Evaluation in Progress..","<strong> Alert </strong>","glyphicon glyphicon-ban-circle"),!1;if(self.actionPlanForm.submitted=!1,self.errorCat=!1,self.disabled=!0,null!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[0].title&&void 0!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[0].title&&""!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[0].title&&null!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[0].description&&void 0!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[0].description&&""!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[0].description||(self.ratingValid=!1),null!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList.length-1].title&&void 0!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList.length-1].title&&""!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList.length-1].title&&null!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList.length-1].description&&void 0!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList.length-1].description&&""!==self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList[self.actionPlan.competencyList[self.currentActionPlan].rating.ratingList.length-1].description||(self.ratingValid=!1),self.actionPlanForm.$valid&&null!==self.actionPlan.description&&void 0!==self.actionPlan.description){self.noActiveCompetency=!0;for(var k=0;k<self.actionPlan.competencyList.length;k++)if(jQuery(".description-toggle").css("background-color","#666 !important"),"ACTIVE"===self.actionPlan.competencyList[k].status){self.noActiveCompetency=!1;break}if(self.noActiveCompetency)return self.disabled=!1,!1;if(self.actionPlan.companyId=self.company.id,self.noActiveCompetency=!1,self.ratingValid=!0,"update"===self.mode||"clone"===self.mode){delete self.actionPlan.company,delete self.actionPlan.evaluationInProgress;for(var i=0;i<self.actionPlan.competencyList.length;i++)delete self.actionPlan.competencyList[i].articleProgressDetailDTO,delete self.actionPlan.competencyList[i].keyOutcomes,delete self.actionPlan.competencyList[i].articlesDTOList}ajaxService.getAjaxResponse({url:self.config.createOrUpdate,data:self.actionPlan,headers:{"Content-Type":"application/json"}}).then(function(response){if("true"===response.Success){var message="update"===self.mode?"Competency Profile Updated":"Competency Profile Saved";$localStorage.set("competencyStatus",message),"update"!==self.mode?($localStorage.set("competency",{id:self.company.id,name:self.company.name,competencyProfileId:response.competencyProfile.id}),window.location.href="/sp/sysAdmin/competency/update"):getDetail("onSave"),competencyStatus(),self.disabled=!1,errorHighlighter()}else null!==response.error&&(errorHighlighter(),self.disabled=!1,sharedProperties.ajaxError(response.error))})}else self.disabled=!1,errorHighlighter()}function previewVideo(mode,url){if("Video"===mode)videoPopUp(url);else{window.open(url,"_blank").focus()}}function previewIntroVideo(url){videoPopUp(url)}function videoPopUp(url,openId){sharedProperties.videoPopUp(url)}function competencyStatus(){null!==$localStorage.get("competencyStatus")&&(sharedProperties.growlMessage($localStorage.get("competencyStatus")),$localStorage.remove("competencyStatus"))}var self=this;self.config={createOrUpdate:"/sp/sysAdmin/competency/createUpdate",getDetail:"/sp/sysAdmin/competency/get",cloneCompetencyProfile:"/sp/sysAdmin/competency/clone",deleteCompetencyProfile:"/sp/sysAdmin/competency/delete",getAllArticles:"/sp/sysAdmin/competency/getArticles",getCompaniesWithCompetencyFeature:"/sp/sysAdmin/competency/getCompanies"},self.currentActionPlan=0,self.companiesAjax=!1,self.competencyProfile={},self.linkType=[{name:"VIDEO IN DIALOG",value:"Video"},{name:"VIDEO IN NEW TAB",value:"VideoTab"},{name:"PPT",value:"PPT"},{name:"PDF",value:"PDF"},{name:"WEB",value:"Web"}],self.devStrategyLinkType=[{name:"VIDEO IN DIALOG",value:"Video"},{name:"VIDEO IN NEW TAB",value:"VideoTab"}],self.ratingScale=[{name:2,value:2},{name:3,value:3},{name:4,value:4},{name:5,value:5},{name:6,value:6},{name:7,value:7},{name:8,value:8},{name:9,value:9}],self.result=[],self.emptyCheck=[],self.clonecompanies=[],self.pageSetting={disabledInfinite:!1,lastPredicate:"name",lastReverse:!1,companyText:"",addedCategory:!1,actions:!1},self.clonePlanName=null,self.articleSearchText="",self.actionPlanForm={submitted:!1},self.originalPageSetting=angular.copy(self.pageSetting),self.initializeBool=!1,self.actionBool=!1,self.disabled=!1,self.masterArticlesList=[],self.articlesList=[],self.addedArticles=[],self.competencyDeleteOptions={},self.noActiveCompetency=!1,self.ratingValid=!0,self.viewMode={preview:!1,editCreate:!0},self.currentCompetencyId=void 0,self.currentCompetencyListIndex=0,self.responseAvailableForModal=!1,self.responseAvailableForCloning=!1,$scope.competencyRangeSlider=3,self.backupRatingList=[],self.currentRatingScale=3,self.openCloseSiblingContent=openCloseSiblingContent,self.addLink=addLink,self.singleAction=singleAction,self.deleteActionList=deleteActionList,self.changeCompetency=changeCompetency,self.createNewSection=createNewSection,self.redirectToListing=redirectToListing,self.submitObject=submitObject,self.trueCheck=trueCheck,self.initializeCompetency=initializeCompetency,self.articlesSortable=articlesSortable,self.competencySort=competencySort,self.previewVideo=previewVideo,self.previewIntroVideo=previewIntroVideo,self.clonePlan=clonePlan,self.startCloning=startCloning,self.deleteCompetencyModal=deleteCompetencyModal,self.deleteGenericModal=deleteGenericModal,self.deleteCompetencyProfile=deleteCompetencyProfile,self.selectArticleModal=selectArticleModal,self.loadAndFilterArticles=loadAndFilterArticles,self.clearArticleSearch=clearArticleSearch,self.addArticleToCompetency=addArticleToCompetency,self.removeArticleFromCompetency=removeArticleFromCompetency,self.updateRatingList=updateRatingList,self.reloadSlider=reloadSlider,self.openRatingWarnModal=openRatingWarnModal,self.closeWarnDialog=closeWarnDialog;var calculateDiff=function(a,b){return Math.abs(a-b)},moveIndexToFirstItem=function(index){self.currentActionPlan=index,self.currentCompetencyId=self.actionPlan.competencyList[index].id,self.currentCompetencyListIndex=index};self.selectThumbImage=function(videoObj,type){$rootScope.showMediaManager=!0;var destroyRoot=$scope.$on("mediaData",function(e,data){if(destroyRoot(),null===data)return!0;switch(type){case"imageUrl":videoObj.thumbnailURL=data.url,videoObj.title=data.name;break;case"linkAction":"Video"===videoObj.type||"VideoTab"===videoObj.type?(videoObj.imageLink=data.url,videoObj.altText=data.altText,videoObj.linkText=data.name):(videoObj.url=data.url,videoObj.linkText=data.name,videoObj.imageLink="",videoObj.altText="");break;default:videoObj.thumbnailURL=data.url}})},$("body").click(function(e){$(".image-edit-box").is(e.target)||0!==$(".image-edit-box").has(e.target).length||$(".upload-icon").is(e.target)||self.imageEditBox&&$scope.$apply(function(){self.imageEditBox=!1})})}function spJsonFetchAdminComp(){function spCompJson(){return{companyId:null,active:!0,name:null,description:null,deletedCompetencyList:[],ratingConfiguration:{size:3,type:"Numeric"},mediaList:[{type:null,imageLink:null,url:null,altText:null,linkText:null}],competencyList:[{name:null,description:null,status:"ACTIVE",introVideo:{status:"INACTIVE",type:"VIDEO"},rating:{defaultIndex:0,ratingList:[{title:"Test Title",description:"Test Description",score:1},{title:"Test Title",description:"Test Description",score:2},{title:"Test Title",description:"Test Description",score:3}]},devStrategyActionCategoryList:[{title:"Development Strategy",helpText:"",status:"ACTIVE",actionList:[{title:"New Strategy",description:null,type:"Single",active:!0,actionData:[{type:null,linkText:null,url:null,imageLink:null,altText:null}]}]}],mandatoryArticles:[]}]}}return{spCompJson:spCompJson}}angular.module("spApp").controller("competencyListingController",competencyListingController),angular.module("spApp").controller("competencyAdminController",competencyAdminController),angular.module("spApp").service("spJsonFetchAdminComp",spJsonFetchAdminComp),competencyListingController.$inject=["$scope","ajaxService","ngDialog","$localStorage","sharedProperties","$filter","$rootScope"],angular.module("spApp").filter("selectArticleFilter",function(){return function(items,searchText,filterFilter){var filtered=[];return angular.forEach(items,function(item){""!==searchText&&(filtered=filterFilter(filtered,searchText))}),filtered}}),competencyAdminController.$inject=["$scope","ajaxService","$localStorage","ngDialog","spJsonFetchAdminComp","$rootScope","$timeout","sharedProperties","$state","$filter","filterFilter"];