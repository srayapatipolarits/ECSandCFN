function adminMediaListingController($scope,ajaxService,$localStorage,ngDialog,sharedProperties,filterFilter,$filter,$rootScope){function deleteImageModal(deleteId,imagePath){$scope.deleteId=deleteId,$scope.imagePath=imagePath,ngDialog.open({template:"/sp/resources/html/sysAdmin/media/delete-modal.html",scope:$scope})}function deleteImage(id,path){ajaxService.getAjaxResponse({url:self.serviceApis.deleteImage,data:$.param({imageId:id,imagePath:path})}).then(function(response){if("true"===response.Success)sharedProperties.spilceIndexWithBreak(self.masterImageList,"id",id),self.imageList=angular.copy(self.masterImageList),ngDialog.close(),$.growl({icon:"glyphicon glyphicon-ok",message:"Media Deleted Successfully"});else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function previewImage(mediaDetails){$scope.mediaDetails=mediaDetails,ngDialog.open({template:"/sp/resources/html/sysAdmin/media/view-modal.html",scope:$scope})}function filterResults(type){""!==self.searchText?self.showClearSearchIcon=!0:self.showClearSearchIcon=!1;var resp=$filter("mediaManagerFilter")(self.masterImageList,self.mediaTypes,self.searchText,filterFilter);self.dataSorted&&(resp=$filter("orderBy")(resp,self.lastPredicate,self.lastReverse)),self.imageList=[],self.imageList=resp}function clearSearch(){""!==self.searchText&&(self.showClearSearchIcon=!1,self.searchText=""),self.filterResults()}function resetResults(){self.mediaTypes={image:!1,pdf:!1,ppt:!1,msdoc:!1},self.searchText="",self.showClearSearchIcon=!1,self.imageList=[],self.imageList=angular.copy(self.masterImageList),self.dataSorted=!1}function active(event,setting){self.lastPredicate=setting.predicate,self.lastReverse=setting.reverse,sharedProperties.toggleFilterClick(event,self.lastPredicate),self.sortResults(self.lastPredicate,self.lastReverse)}function sortResults(predicate,reverse){self.lastPredicate=predicate,self.lastReverse=reverse;var resp=$filter("orderBy")(self.masterImageList,predicate,reverse);resp=$filter("mediaManagerFilter")(resp,self.mediaTypes,self.searchText,filterFilter),self.imageList=[],self.imageList=resp,self.dataSorted=!0}function setMediaData(obj){$localStorage.set("mediaData",obj),ngDialog.close()}function switchView(type){$rootScope.mediaView=type}var self=this;self.serviceApis={getAllImages:"/sp/media/getAll",deleteImage:"/sp/sysAdmin/media/delete"},self.media={},self.masterImageList=[],self.imageList=[],self.responseAvailable=!1,self.imageId="",self.showClearSearchIcon=!1,self.searchText="",self.lastPredicate="name",self.lastReverse=!1,self.viewType="Grid",self.mediaTypes={image:!1,pdf:!1,ppt:!1,msdoc:!1},self.dataSorted=!1,self.getAllImages=getAllImages,self.deleteImage=deleteImage,self.deleteImageModal=deleteImageModal,self.previewImage=previewImage,self.filterResults=filterResults,self.active=active,self.sortResults=sortResults,self.clearSearch=clearSearch,self.resetResults=resetResults,self.setMediaData=setMediaData,self.switchView=switchView;var getAllImages=function(){ajaxService.getAjaxResponse({url:self.serviceApis.getAllImages,method:"GET"}).then(function(response){if("true"===response.Success)self.responseAvailable=!0,self.masterImageList=response.mediaList,self.imageList=angular.copy(self.masterImageList);else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})};!function(){getAllImages()}()}angular.module("spApp").controller("adminMediaListingController",adminMediaListingController),angular.module("spApp").filter("mediaManagerFilter",function(){return function(items,types,searchText,filterFilter){var filtered=[];return angular.forEach(items,function(item){!1===types.image&&!1===types.pdf&&!1===types.ppt&&!1===types.msdoc?filtered.push(item):!0===types.image&&"IMAGE"===item.mediaType?filtered.push(item):!0===types.pdf&&"PDF"===item.mediaType?filtered.push(item):!0===types.ppt&&"PPT"===item.mediaType?filtered.push(item):!0===types.msdoc&&"MSDOC"===item.mediaType&&filtered.push(item),""!==searchText&&(filtered=filterFilter(filtered,searchText))}),filtered}}),adminMediaListingController.$inject=["$scope","ajaxService","$localStorage","ngDialog","sharedProperties","filterFilter","$filter","$rootScope"];