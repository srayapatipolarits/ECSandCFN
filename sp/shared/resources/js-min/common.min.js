angular.module("spApp",["ui.router","ngSanitize","ngTagsInput","checklist-model","ngDialog","angucomplete","ngAnimate","infinite-scroll","ui.tinymce","angularLazyImg","ui.mention"]).config(["lazyImgConfigProvider",function(lazyImgConfigProvider){lazyImgConfigProvider.setOptions({offset:500})}]);
angular.module("spApp").config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$stateProvider.state("individual",{url:"/individual",templateUrl:"/sp/resources/html/register/register_step2_individual.html"}).state("business",{url:"/business",templateUrl:"/sp/resources/html/register/register_step2_business.html"}).state("hiring",{url:"/hiring",templateUrl:"subscribe-enterprise-page.html"}).state("login",{url:"/login",templateUrl:"login-page.html"}).state("signup_individual",{url:"/signup_individual",templateUrl:"/sp/resources/html/register/register.html"}).state("thankYou",{url:"/thankYou",templateUrl:"/sp/resources/html/register/thankyou.html"}).state("resetConfirmation",{url:"/resetConfirmation",templateUrl:"/sp/resources/html/reset/reset-confirm.html"}).state("reset",{url:"/reset",templateUrl:"/sp/resources/html/reset/reset.html"}).state("browser",{url:"/browser",templateUrl:"/sp/resources/html/browser/browser.html"}).state("group",{url:"/group",templateUrl:"/sp/resources/html/admin/member/groupHome.html"}).state("member",{url:"/member",templateUrl:"/sp/resources/html/admin/member/membersHome.html"}).state("profile",{url:"/profile",templateUrl:"/sp/resources/html/admin/member/profile.html"}).state("signup_business",{url:"/signup_business",templateUrl:"/sp/resources/html/register/register_business.html"}).state("single",{url:"/add/single",templateUrl:"/sp/resources/html/admin/member/add-single.html"}).state("member-multiple",{url:"/add/multiple",templateUrl:"/sp/resources/html/admin/member/add-multiple.html"}).state("dashboardModule",{url:"/groups",templateUrl:"/sp/resources/html/dashboard/dashboardListingView.html"})}]);
!function(){function footerController($scope,sharedProperties,ngDialog){function getAppropiateTemplate(){return-1!==vm.urlPattern.indexOf(vm.pathName)?null:vm.footerUrl.footerA}function footerLinks(type,e){e.preventDefault();var userLocale=sharedProperties.getUserLocale(),templateUrl="",winWidth=$(window).width();switch(vm.mobile=winWidth<768,vm.winHeight=$(window).height()+"px",type){case"privacy":"en-US"===userLocale?templateUrl="/sp/resources/html/footer/privacy.html":"es-LA"===userLocale&&(templateUrl="/sp/resources/html/footer/privacy_es.html");break;case"agreement":"en-US"===userLocale?templateUrl="/sp/resources/html/footer/agreement.html":"es-LA"===userLocale&&(templateUrl="/sp/resources/html/footer/agreement_es.html");break;case"cookies":templateUrl="/sp/resources/html/footer/cookies.html"}ngDialog.open({template:templateUrl,scope:$scope,className:vm.mobile?"ngdialog-lnd-theme":"ngdialog-theme-default"})}var vm=this;vm.urlPattern=["/sp/dashboard","/sp/dashboard/profile","/sp/dashboard/message"],vm.footerUrl={footerA:"/sp/resources/html/common/footer-a.html",footerB:"/sp/resources/html/common/footer-b.html"},vm.pathName=window.location.pathname,vm.getAppropiateTemplate=getAppropiateTemplate,vm.footerLinks=footerLinks,jQuery("body").on("click","a.footer_agreement",function(e){e.preventDefault(),ngDialog.open({template:"/sp/resources/html/footer/agreement.html"})}),jQuery("body").on("click","a.footer_privacy",function(e){e.preventDefault(),ngDialog.open({template:"/sp/resources/html/footer/privacy.html"})}),jQuery("body").on("click","a.footer_cookies",function(e){e.preventDefault(),ngDialog.open({template:"/sp/resources/html/footer/cookies.html"})})}footerController.$inject=["$scope","sharedProperties","ngDialog"],angular.module("spApp").controller("footerController",footerController)}();
jQuery(function(){function PointerEventsPolyfill(t){if(this.options={selector:"*",mouseEvents:["click","dblclick","mousedown","mouseup"],usePolyfillIf:function(){if("Microsoft Internet Explorer"===navigator.appName){if(null!==navigator.userAgent.match(/MSIE ([0-9]{1,}[\.0-9]{0,})/)){if(11>parseFloat(RegExp.$1))return!0}}return!1}},t){var e=this;$.each(t,function(t,n){e.options[t]=n})}this.options.usePolyfillIf()&&this.register_mouse_events()}PointerEventsPolyfill.initialize=function(t){return null===PointerEventsPolyfill.singleton&&(PointerEventsPolyfill.singleton=new PointerEventsPolyfill(t)),PointerEventsPolyfill.singleton},PointerEventsPolyfill.prototype.register_mouse_events=function(){$(document).on(this.options.mouseEvents.join(" "),this.options.selector,function(t){if("none"===$(this).css("pointer-events")){var e=$(this).css("display");$(this).css("display","none");var n=document.elementFromPoint(t.clientX,t.clientY);return e?$(this).css("display",e):$(this).css("display",""),t.target=n,$(n).trigger(t),!1}return!0})},(jQuery("html").hasClass("ie9")||jQuery("html").hasClass("ie10"))&&setTimeout(function(){PointerEventsPolyfill.initialize({})},500)});
Array.prototype.filter||(Array.prototype.filter=function(fun){if(void 0===this||null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if("function"!=typeof fun)throw new TypeError;for(var res=[],thisArg=arguments.length>=2?arguments[1]:void 0,i=0;i<len;i++)if(i in t){var val=t[i];fun.call(thisArg,val,i,t)&&res.push(val)}return res}),Array.prototype.move=function(old_index,new_index){if(new_index>=this.length)for(var k=new_index-this.length;1+k--;)this.push(void 0);return this.splice(new_index,0,this.splice(old_index,1)[0]),this},Array.prototype.unique=function(){for(var a=this.concat(),i=0;i<a.length;++i)for(var j=i+1;j<a.length;++j)a[i]===a[j]&&a.splice(j--,1);return a},Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(predicate){if(null==this)throw new TypeError('"this" is null or not defined');var o=Object(this),len=o.length>>>0;if("function"!=typeof predicate)throw new TypeError("predicate must be a function");for(var thisArg=arguments[1],k=0;k<len;){var kValue=o[k];if(predicate.call(thisArg,kValue,k,o))return kValue;k++}}});
function scheduleController(ajaxService,sharedProperties,ngDialog,$localStorage,$rootScope,$timeout,$q,basicService){function getMemberList(){var deferred=$q.defer();return promise||(basicService.getAllValidMember().then(function(response){if(self.emailMemberList=response,null!==$localStorage.get("loggegdInProfile"))for(var i=0;i<self.emailMemberList.length;i++)if(self.emailMemberList[i].email===$localStorage.get("loggegdInProfile").member.email){self.emailMemberList.splice(i,1);break}}),promise=deferred.promise)}function loadTags(query){var deferred=$q.defer(),result=self.emailMemberList.filter(function(e){return-1!==e.name.toLowerCase().indexOf(query.toLowerCase())||-1!==e.email.toLowerCase().indexOf(query.toLowerCase())});return deferred.resolve(result),deferred.promise}function meetingAdded(tag){void 0!==tag.email&&(self.schedule.meetingTag.push(tag.email),self.schedule.meetingRequired=!1)}function meetingRemoved(tag){self.schedule.meetingTag.splice(self.schedule.meetingTag.indexOf(tag.email),1)}function schedulePop(){self.schedule=angular.copy(self.originalSch),self.schMeeting.actionTitle=null,self.scheduleObj=sharedProperties.getScheduleData(),self.winHeight=$(window).height()+100+"px",!self.emailMemberList.length&&self.getMemberList(),self.schMeeting.submitted=!1,self.schMeeting.actionTitle=self.scheduleObj.title,self.scheduleUID=self.scheduleObj.uid,$timeout(function(){prepareDatePicker()},200)}function scheduleMeeting(){self.schMeeting.submitted=!1,self.schedule.meetingTag.length||(self.schedule.meetingRequired=!0),self.schMeetingForm.$valid&&self.schedule.meetingTag.length?ajaxService.getAjaxResponse({url:self.serviceApis.schedule+"?subject="+self.schedule.subject+"&agenda="+self.schedule.agenda+"&location="+self.schedule.location+"&actionPlanId="+self.scheduleObj.actionPlanId+"&to="+self.schedule.meetingTag.toString()+"&startDate="+new Date(self.schedule.fromDate).toISOString()+"&endDate="+new Date(self.schedule.endDate).toISOString()+"&memberName="+$rootScope.noSelf+"&uid="+self.scheduleUID,method:"get"}).then(function(response){"true"===response.Success?(ngDialog.close(),sharedProperties.growlMessage($rootScope.pullInterNationalization("admin.organization.schduled")),sharedProperties.fireAnalyticsEvent("OrgPlans | Schedule a meeting","ActionPlan - "+self.scheduleObj.actionPlanName)):null!==response.error&&(ngDialog.close(),sharedProperties.ajaxError(response.error))}):self.schMeeting.submitted=!0}var promise,self=this;self.serviceApis={scheduleDialog:"/sp/schedulePop",schedule:"/sp/actionPlan/sendCalInvite"},self.schMeeting={},self.schMeeting.submitted=!1,self.schedule={subject:"",location:"",agenda:"",startDate:"",endDate:"",meetingTag:[],meetingRequired:!1,invalidTime:!1},self.schedule.fromDate=null,self.schedule.endDate=null,self.originalSch=angular.copy(self.schedule),self.scheduleUID="",self.scheduleObj={},self.emailMemberList=[],self.winWidth=$(window).width(),self.winHeight=$(window).height()+100+"px",self.getMemberList=getMemberList,self.schedulePop=schedulePop,self.meetingRemoved=meetingRemoved,self.meetingAdded=meetingAdded,self.loadTags=loadTags,self.scheduleMeeting=scheduleMeeting;var prepareDatePicker=function(){moment.locale(sharedProperties.provideVendorSpecificLocale("datePicker")),self.schedule.fromDate=moment().format("MM/DD/YYYY"),self.schedule.endDate=moment().format("MM/DD/YYYY"),$('input[name="dateRange"]').daterangepicker({showDropdowns:!1,minDate:moment(),startDate:moment().add(1,"h").toDate(),endDate:moment().add(2,"h").toDate(),locale:{format:"MMM DD, YYYY HH:mm"},alwaysShowCalendars:!0,timePicker:!0,drops:"down",opens:"right",timePicker24Hour:!0},function(start,end,label){self.schedule.fromDate=moment.utc(start.format("MM/DD/YYYY HH:mm"),"MM/DD/YYYY HH:mm").format(),self.schedule.endDate=moment.utc(end.format("MM/DD/YYYY HH:mm"),"MM/DD/YYYY HH:mm").format()})}}angular.module("spApp").controller("scheduleController",scheduleController),scheduleController.$inject=["ajaxService","sharedProperties","ngDialog","$localStorage","$rootScope","$timeout","$q","basicService"];
angular.module("spApp").run(["$rootScope","$location","ajaxService","sharedProperties","ngDialog","$localStorage","$timeout","localeLang","spConfig",function($rootScope,$location,ajaxService,sharedProperties,ngDialog,$localStorage,$timeout,localeLang,spConfig){"use strict";function hideElement(){loaderObject.removeClass(loaderClass)}$rootScope.Internationalization=[],$rootScope.inviteReady=!1,$rootScope.formSendNotificationError=!1,$rootScope.messageAreaEmpty=!1,$rootScope.fileStackAPIKey="ArRPmifJMQ56HiIYoIf4zz",$rootScope.defaultImage=spConfig.image.default,$rootScope.fireFox=!1,$rootScope.emailRegex=/^[A-Za-z0-9._-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/i;var loaderObject=$("#loader").find(".spinner"),loaderClass="selected";if(/firefox/i.test(navigator.userAgent)){var enURL=localeLang.setGetParameter("lang","en_US",!0),esURL=localeLang.setGetParameter("lang","es_LA",!0);$rootScope.enLangURL=localeLang.parameterLogic("clearCache",!0,enURL),$rootScope.esLangURL=localeLang.parameterLogic("clearCache",!0,esURL),sharedProperties.getParam("clearCache")&&($localStorage.flush(),localeLang.override(sharedProperties.getParam("lang"),!1)),$rootScope.fireFox=!0}$rootScope.$watch(function(){return $location.url()},function(a){var newEmail=sharedProperties.getParam("email",a);if($rootScope.noSelf=null===newEmail?"":newEmail,$localStorage.isAvailable()&&null!=$localStorage.get("interNationalization"))$rootScope.Internationalization=$localStorage.get("interNationalization"),$rootScope.inviteReady=!0;else{var options={url:"/sp/messages",data:$.param({url:window.location.pathname,localStorage:$localStorage.isAvailable()})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&$localStorage.set("interNationalization",response,function(){$rootScope.Internationalization=response,$rootScope.inviteReady=!0})})}},!0),$rootScope.pullInterNationalization=function(key,single,mem){return void 0!==single&&"custom"===single?mem+"."+key in $rootScope.Internationalization?$rootScope.Internationalization[mem+"."+key]:key:key in $rootScope.Internationalization?$rootScope.Internationalization[key]:key},$rootScope.callSwitchChange=function(param){sharedProperties.setSwitch(param)},$rootScope.notificationEmailPoP=function(args,type,defaults,params){angular.isArray(args)||(args=args.split(",")),"ASSESSMENT_PENDING"===type||"ASSESSMENT_PROGRESS"===type?type="AssessmentPendingReminder":"PROFILE_INCOMPLETE"===type?(type="ProfileIncompleteReminder",defaults="ProfileIncomplete"):"HiringCandidateReminder"===type?type="HiringCandidateReminder":"HiringCandidateProfileAccess"===type&&(type="HiringCandidateProfileAccess"),$rootScope.formSendNotificationError=!1,$rootScope.messageAreaEmpty=!1,sharedProperties.notification(args,type,defaults,params)},$rootScope.notificatationListName=function(notifyMessage,extra){var headerName;if($rootScope.formSendNotificationError=!1,$rootScope.messageAreaEmpty=!1,$rootScope.selectedNotification=notifyMessage,"ProfileIncomplete"!==notifyMessage){if("learningProgram"===notifyMessage){var comment2=$rootScope.pullInterNationalization("admin.group."+notifyMessage+".notification.text").replace("[Name]",extra.lpName);$("#commentBlock").val(comment2),headerName=$rootScope.pullInterNationalization("admin.group."+notifyMessage+".notification.brandCopy").replace("[Name]",extra.lpName)}else{var comment1=$("<div/>").html($.parseHTML($rootScope.pullInterNationalization("admin.group."+notifyMessage+".notification.text").replace("$companyName",$localStorage.get("loggegdInProfile").company.name)));$("#commentBlock").val($(comment1).html()),headerName=$rootScope.pullInterNationalization("admin.group."+notifyMessage+".notification.brandCopy")}$("#headerName").val(headerName);var ctaLabel=$rootScope.pullInterNationalization("admin.group."+notifyMessage+".notification.ctaLabel");ctaLabel==="admin.group."+notifyMessage+".notification.ctaLabel"?$("#ctaLabel").remove():$("#ctaLabel").val(ctaLabel);var ctaUrl=$rootScope.pullInterNationalization("admin.group."+notifyMessage+".notification.ctaUrl");ctaUrl==="admin.group."+notifyMessage+".notification.ctaUrl"?$("#ctaUrl").remove():$("#ctaUrl").val(ctaUrl)}var subBlock="learningProgram"===notifyMessage?$.parseHTML($rootScope.pullInterNationalization("admin.group."+notifyMessage+".notification.nosubject").replace("[Name]",extra.lpName))[0]:$.parseHTML($rootScope.pullInterNationalization("admin.group."+notifyMessage+".notification.nosubject"))[0],subBlock1=$(subBlock).text();subBlock==="admin.group."+notifyMessage+".notification.nosubject"?$("#subBlock").remove():$("#subBlock").val(subBlock1)},window.addEventListener("popstate",function(e){$("body").hasClass("ngdialog-open")&&ngDialog.close()}),$rootScope.$on("ngDialog.opened",function(e){history.pushState({action:"modal"},"",window.location.href),$("body .sticky-bottom").hide()}),$rootScope.$on("ngDialog.closed",function(e){$("body .sticky-bottom").show()}),$rootScope.$on("httpLoaderStart",function(e,loader){loaderObject=void 0!==loader?loader.obj:$("#loader").find(".spinner"),loaderClass=void 0!==loader?"loading-bar":loaderClass,loaderObject.addClass(loaderClass)}),$rootScope.$on("httpLoaderEnd",hideElement),$rootScope.setBoxSizes=function(c1,c2,h){$(c1).each(function(){var boxes=$(this).find(c2),maxHeight=0;boxes.attr("style",""),maxHeight=Math.max.apply(Math,boxes.map(function(){return $(this).outerHeight()}).get()),"full"===h?boxes.attr("style","").css({height:maxHeight}):boxes.attr("style","").css({"min-height":maxHeight})})},$rootScope.sendNotification=function(form,list,type,mode){function extractEmails(e){var _list=e,emailList=[],counter=0;if($.each(_list,function(i){emailList.push(_list[i].email),counter++}),counter===_list.length)return emailList.toString()}if($rootScope.formSendNotificationError=!1,$rootScope.messageAreaEmpty=!1,void 0!==mode&&($("#subBlock").val($rootScope.subBlockNotification),$("#commentBlock").val($rootScope.commentNotification)),"default"===$rootScope.selectedNotification)return $rootScope.formSendNotificationError=!0,!0;if($("#commentBlock").is(":visible")&&""===$("#commentBlock").val())return $rootScope.messageAreaEmpty=!0,!0;if(form.$valid){var notifyForm=$(".getNotificationForm").serialize(),mList=extractEmails(list),param="";param=angular.isObject($rootScope.extra)?notifyForm+"&type="+type+"&memberList="+mList+"&"+$rootScope.extra.key+"="+$rootScope.extra.id:notifyForm+"&type="+type+"&memberList="+mList;var options={url:"/sp/notifications/sendNotificationWithParams",data:param};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?(ngDialog.close("ngdialog1"),sharedProperties.growlMessage($rootScope.pullInterNationalization("growl.notificationSent")),"FeedbackReminder"===type&&sharedProperties.fireAnalyticsEvent("Prism Lens | Send Feedback Reminder","N/A"),"ProfileIncompleteReminder"===type&&"yes"===mode&&sharedProperties.fireAnalyticsEvent("Manage Account | Send Reminder","Profile Incomplete"),"GenericMessage"===type&&void 0===mode&&void 0!==list&&1===list.length&&sharedProperties.fireAnalyticsEvent("Manage Account | Send Message to single Member","N/A"),"GenericMessage"===type&&void 0===mode&&void 0!==list&&list.length>1&&sharedProperties.fireAnalyticsEvent("Manage Account | Send Message to entire group members","N/A")):null!==response.error&&(ngDialog.close("ngdialog1"),sharedProperties.ajaxError(response.error))})}else $rootScope.formSendNotificationError=!0,$rootScope.messageAreaEmpty=!0},Array.prototype.swapItems=function(a,b){return this[a]=this.splice(b,1,this[a])[0],this},$rootScope.handleStickyTabs=function(type,isFadeInTutorial){$rootScope.$broadcast("stickyOpen"),$(".sticky-tutorial").hide(),void 0!==isFadeInTutorial&&($rootScope.fadeInTutorial=!0),type===$rootScope.selectedNotesTab&&$rootScope.showNotesPanel?($rootScope.selectedNotesTab="",$rootScope.showNotesPanel=!1,$("#notesModal").modal("hide"),$rootScope.$broadcast("modalClosed"),$("body").css("overflow-y","visible"),sharedProperties.is_touch_supported()&&sharedProperties.is_iOS_device()&&($("body").css("position",""),$("body").animate({scrollTop:$("body").scrollTop()},0))):(sharedProperties.setSelectedNotesTab(type),sharedProperties.fireAnalyticsEvent("Sticky Footer | Open Module",type))},$rootScope.displayNotifications=function(){$rootScope.showNotifications=!0},$rootScope.setTutorialObject=function(){$rootScope.$broadcast("stickyOpen"),$(".sticky-tutorial").hide(),$rootScope.showNotesPanel&&($rootScope.showNotesPanel=!1,$("#notesModal").modal("hide"),$rootScope.selectedNotesTab="",$("body").css("overflow-y","visible"),sharedProperties.is_touch_supported()&&sharedProperties.is_iOS_device()&&($("body").css("position",""),$("body").animate({scrollTop:$("body").scrollTop()},0))),null===$localStorage.get("tutorialObj")?ajaxService.getAjaxResponse({url:"/sp/tutorial/get"}).then(function(response){if("true"===response.Success&&void 0!==response.tutorial){$rootScope.tutorialAvailable=!0;var completedPercent=Math.round(parseInt(response.tutorial.completedCount)/parseInt(response.tutorial.actionCount)*100);response.tutorial.completed=completedPercent,$localStorage.set("tutorialObj",response.tutorial),$rootScope.tutorialObj=$localStorage.get("tutorialObj")}else $rootScope.tutorialAvailable=!1}):($rootScope.tutorialObj=$localStorage.get("tutorialObj"),$rootScope.tutorialAvailable=!0)},$rootScope.setContentReferenceForModule=function(obj,type){var tempObj={data:obj,type:type};sharedProperties.setContentReference(tempObj),tempObj=null},$rootScope.redirectReferenceUrl=function(url){null!==url&&(sharedProperties.fireAnalyticsEvent("Notes Module | Reference URL Click",url),window.location.href=url)},$rootScope.handleFileStack=function(flag,supportFlag){if(flag){$("body .sticky-bottom").hide(),filepicker.setKey($rootScope.fileStackAPIKey);var serviceList=["COMPUTER","BOX","DROPBOX","GOOGLE_DRIVE","SKYDRIVE"];supportFlag&&(serviceList=["COMPUTER"]),filepicker.pick({mimetypes:"*/*",container:"modal",services:serviceList,maxSize:10485760,language:sharedProperties.provideVendorSpecificLocale("fileStack")},function(Blob){$("body .sticky-bottom").show();var fileStackObj={fileData:Blob};$rootScope.$broadcast("fileStackSuccessNotes",fileStackObj)},function(FPError){$("body .sticky-bottom").show(),$("body").hasClass("ngdialog-open")&&$(".ngdialog").show()})}},$rootScope.openProfileModal=function(){ngDialog.open({template:spConfig.talentAnalytics.memberService.dialog.openProfileModal})},$rootScope.viewTraitDesc=function(prismSection,id,trait){var aliasPersonalities=["Examiner","Designer","Promoter","Encourager","Innovator","Actuary","Motivator","Supporter","Refiner"],mappedPersonalities={Examiner:"Influencer",Designer:"Pioneer",Promoter:"Connector",Encourager:"Peacemaker",Innovator:"Strategist",Actuary:"Scientist",Motivator:"Catalyst",Supporter:"Ally",Refiner:"Architect"},_trait=-1!==aliasPersonalities.indexOf(trait.trim())?mappedPersonalities[trait.trim()]:trait.trim();$rootScope.traitDesc={section:prismSection,traitName:trait.trim(),trait:_trait.replace(" & ","").replace("_N_",""),id:id},ngDialog.open({template:spConfig.talentAnalytics.idealPortrait.dialog.traitDesc,scope:$rootScope})},jQuery(function($){var gdParam=window.location.hash.substr(2);"/sp/dashboard"!==window.location.pathname&&"/sp/signin"!==window.location.pathname||""===gdParam||$localStorage.set("gdParam",gdParam),null!==sharedProperties.getParam("support_status")&&"Success"===sharedProperties.getParam("support_status")&&(sharedProperties.growlMessage($rootScope.pullInterNationalization("support.alertMsg")),sharedProperties.fireAnalyticsEvent("Sticky Footer | Submit Support Request","N/A"))})}]);
function videoController($rootScope,ngDialog,sharedProperties,$sce,$timeout,$localStorage){function videoCall(){var videoSrc=sharedProperties.getVideoUrl();if(parseYouTube(videoSrc)){vm.videoType="youtube";var youtubeId=parseYouTube(videoSrc);vm.videoUrl=$sce.trustAsResourceUrl("https://www.youtube.com/embed/"+youtubeId+"?autoplay=1&rel=0&autohide=1&showinfo=0&wmode=transparent&modestbranding=1&iv_load_policy=3&vq=large")}else if(parseVimeo(videoSrc)){vm.videoType="vimeo";var vimeoId=parseVimeo(videoSrc),userLocale=sharedProperties.provideVendorSpecificLocale("vimeo"),options={id:vimeoId,width:630,height:354};$timeout(function(){var vimeoPlayer=new Vimeo.Player("vimeoPlayer",options);$(window).width()>1024&&vimeoPlayer.play(),vimeoPlayer.enableTextTrack(userLocale).then(function(track){track.language=userLocale,track.kind="captions"}),vimeoPlayer.on("ended",function(data){sharedProperties.fireAnalyticsEvent("Video | Watched Vimeo till the End",vimeoId)})},500)}else vm.videoType="html5",vm.videoUrl=$sce.trustAsResourceUrl(videoSrc);sharedProperties.fireAnalyticsEvent("Video | Viewed",vm.videoType)}var vm=this;vm.videoCall=videoCall,vm.videoType="",vm.videoUrl="";var parseYouTube=function(url){var p=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;return!!url.match(p)&&RegExp.$1},parseVimeo=function(url){var m=url.match(/^.+vimeo.com\/(.*\/)?([^#\?]*)/);return m?m[2]||m[1]:null}}angular.module("spApp").controller("videoController",videoController),videoController.$inject=["$rootScope","ngDialog","sharedProperties","$sce","$timeout","$localStorage"];
angular.module("spApp").constant("assessmentConfig",{services:{default:{start:"/sp/assessment/start",next:"/sp/assessment/process",previous:"/sp/assessment/previous",redirect:"/sp/assessment/completed"},prismLens:{start:"/sp/assessment360/start/",next:"/sp/assessment360/process/",previous:"/sp/assessment360/previous/",redirect:"/sp/external/thankyou"},candidatesEmployees:{start:"/sp/assessment/start",next:"/sp/assessment/process",previous:"/sp/assessment/previous",redirect:"/sp/thankYou"}},templates:{rank:"/sp/resources/html/assessment/rank.html",whoRu:"/sp/resources/html/assessment/who-ru.html",choose:"/sp/resources/html/assessment/choose.html",mostLeast:"/sp/resources/html/assessment/most-least.html"}}),angular.module("spApp").constant("spConfig",{image:{candidateDefault:"/resources/images/candidateDefault.png",default:"/resources/images/default.png"},nav:{htmlSrc:"/sp/resources/html/common/nav-module.html",fetchNavApi:"/sp/navigation/get",checkErti:"/sp/hiring/companyHasErti"},talentAnalytics:{home:"/sp",images:{relationShip:"/resources/images/bg-4.png",spectrum:"/resources/images/bg-5.jpg",idealPortrait:"/resources/images/bg-5.jpg"},commonService:{sendReminders:"/sp/notifications/sendNotificationWithParams"},groupService:{allGroups:"/sp/hiring/group/getAll",groupDetail:"/sp/hiring/group/get",createGroup:"/sp/hiring/group/create",renameGroup:"/sp/hiring/group/update",deleteGroup:"/sp/hiring/group/delete",getAllMembers:"/sp/hiring/getAllMembers",addUser:"/sp/hiring/group/addUsers",removeUsers:"/sp/hiring/group/removeUsers",getGroupCompare:"/sp/hiring/group/getPortraits",dialog:{deleteGroup:"/sp/resources/html/people-analytics/dialog/groups-delete.html",addMemberModalGroup:"/sp/resources/html/people-analytics/dialog/groups-addMembers.html",removeSingle:"/sp/resources/html/people-analytics/dialog/groups-removeSingle.html",removeMulti:"/sp/resources/html/people-analytics/dialog/groups-removeMultiple.html",deleteSingle:"/sp/resources/html/people-analytics/dialog/members-deleteSingle.html",teamAdvisor:"/sp/resources/html/common/team-advisor.html"}},memberService:{getAll:"/sp/hiring/getAll",add:"/sp/hiring/add",subscriptions:"/sp/hiring/getAvailableSubscriptions",rolesAndTag:"/sp/hiring/getRolesAndTags",isMemberPresent:"/sp/hiring/checkCandidate",delete:"/sp/hiring/delete",getProfileInfo:"/sp/hiring/getProfileDetails",getUserGroups:"/sp/hiring/group/userGroups",archiveUser:"/sp/hiring/archiveUser",addNote:"/sp/hiring/addComment",updateNote:"/sp/hiring/updateComment",removeNote:"/sp/hiring/removeComment",updateProfile:"/sp/hiring/updateProfile",hireCandidate:"/sp/hiring/hireCandidate",profileShareId:"/sp/hiring/getProfileShareId",userShareList:"/sp/hiring/getSharePortraitList",getAllPrismLensRequests:"/sp/hiring/lens/getAllRequests",getPrismLensDetails:"/sp/hiring/lens/get",submitPrismLensFeedbackRequest:"/sp/hiring/lens/create",updateLensProfile:"/sp/hiring/lens/update",deletePrismLensRequest:"/sp/hiring/lens/delete",shareUserProfile:"/sp/hiring/getSharePortraitDetails",deleteShareUser:"/sp/hiring/deleteSharePortrait",archiveProfileDetails:"/sp/hiring/getArchivedUserProfileDetails",referenceSendRequest:"/sp/hiring/lens/sendRequest",addToErti:"/sp/hiring/addToErti",updateUserTags:"/sp/hiring/updateTags",viewLensReportExt:"/sp/hiring/ext/portrait/lens/get",getAllMembers:"/sp/hiring/getAllMembers",addUpdateUrl:"/sp/hiring/addUpdateUrl",removeUrl:"/sp/hiring/removeUrl",getUserRoles:"/sp/hiring/getUserRoles",dialog:{referenceCheck:"/sp/resources/html/people-analytics/dialog/reference-check.html",deleteEmployeeSingle:"/sp/resources/html/people-analytics/dialog/employee-deleteSingle.html",deleteEmployeeMultiple:"/sp/resources/html/people-analytics/dialog/employee-deleteMultiple.html",archiveEmployeeSingle:"/sp/resources/html/people-analytics/dialog/employee-archiveSingle.html",archiveEmployeeMultiple:"/sp/resources/html/people-analytics/dialog/employee-archiveMultiple.html",addRole:"/sp/resources/html/people-analytics/dialog/addRole.html",removeRole:"/sp/resources/html/people-analytics/dialog/removeRole.html",addNote:"/sp/resources/html/people-analytics/dialog/addNote.html",removeUserFromGroup:"/sp/resources/html/people-analytics/dialog/employee-groupRemove.html",hire:"/sp/resources/html/people-analytics/dialog/hire.html",noMember:"/sp/resources/html/people-analytics/dialog/no-members.html",deleteNote:"/sp/resources/html/people-analytics/dialog/delete-note.html",shareUserId:"/sp/resources/html/people-analytics/dialog/share-profile-id.html",shareProfileId:"/sp/resources/html/people-analytics/dialog/share-profile.html",prismLensDelete:"/sp/resources/html/people-analytics/dialog/delete-feedback.html",sendRequestReference:"/sp/resources/html/people-analytics/dialog/invite-reference.html",removePortraitShare:"/sp/resources/html/people-analytics/dialog/removePortraitShare.html",addToErti:"/sp/resources/html/people-analytics/dialog/addToErti.html",updateRefListDialog:"/sp/resources/html/people-analytics/dialog/reference-lens-update.html",requestLens:"/sp/resources/html/people-analytics/dialog/request-lens.html",viewLensReportExt:"/sp/resources/html/people-analytics/dialog/lens-extDetail.html",addRolePortrait:"/sp/resources/html/people-analytics/dialog/addRole-Portrait.html",openProfileModal:"/sp/resources/html/people-analytics/dialog/profile-modal.html",accountsRequest:"/sp/resources/html/people-analytics/dialog/accounts-request.html"}},roles:{getAll:"/sp/hiring/role/getAll",get:"/sp/hiring/role/get",create:"/sp/hiring/role/create",update:"/sp/hiring/role/update",delete:"/sp/hiring/role/delete",assignPortrait:"/sp/hiring/role/assignPortrait",removePortrait:"/sp/hiring/role/removePortrait",add:"/sp/hiring/addRole",remove:"/sp/hiring/removeRole",getUserRolesAndMatch:"/sp/hiring/role/getUserRolesAndMatch",getRolesWithoutPortrait:"/sp/hiring/role/getRolesWithoutPortrait",addUserToRole:"/sp/hiring/role/addToRole",dialog:{delete:"/sp/resources/html/people-analytics/dialog/role-delete.html",removeRole:"/sp/resources/html/people-analytics/dialog/role-remove.html",createRole:"/sp/resources/html/people-analytics/dialog/create-new-role.html",assignPortrait:"/sp/resources/html/people-analytics/dialog/assign-portrait.html",removePortrait:"/sp/resources/html/people-analytics/dialog/remove-portrait.html",rolesCompareOverlay:"/sp/resources/html/people-analytics/roles-compare-overlay.html",addMemberModalGroup:"/sp/resources/html/people-analytics/dialog/roles-addMembers.html"}},archiveService:{getAll:"/sp/hiring/archiveGetAll",delete:"/sp/hiring/deleteArchiveUser",putBack:"/sp/hiring/archivePutBack",dialog:{putBack:"/sp/resources/html/people-analytics/dialog/putBack.html"}},settings:{getCompanyInfo:"/sp/admin/account/getCompanyDetails",getAccountInfo:"/sp/admin/account/businessAccountDetails",updateCompanyInfo:"/sp/admin/account/updateCompany",restrictRA:"/sp/admin/account/restrictRelationshipAdvisor",blockMembers:"/sp/admin/account/blockAllMembers",removeAdmin:"/sp/hiring/removeAdministrator",getAdminMembers:"/sp/hiring/getMembersForAdmin",addAdmin:"/sp/hiring/addAdministrator",transactions:"/sp/admin/account/paymentHistory",deactivateRenewal:"/sp/admin/account/cancel",activateRenewal:"/sp/admin/account/reActivate",enableShare:"/sp/admin/account/enableSharePortrait",getAdminSubscriptions:"/sp/hiring/getAvailableAdminSubscriptions"},idealPortrait:{homePage:"/sp/pa/ideal-portrait#/home",getAll:"/sp/hiring/match/getAll",get:"/sp/hiring/match/get",matchPortrait:"/sp/hiring/match/matchPortrait",dialog:{rolePreview:"/sp/resources/html/people-analytics/dialog/role-info.html",portraitsList:"/sp/resources/html/people-analytics/dialog/portraits-modal.html",requestNewPortrait:"/sp/resources/html/people-analytics/dialog/request-portrait.html",removeRole:"/sp/resources/html/people-analytics/dialog/remove-role-portrait.html",traitDesc:"/sp/resources/html/people-analytics/dialog/trait-descriptions.html"}},dashboard:{getEmployeeCandidateStats:"/sp/hiring/dashboard/getEmployeeCandidateStats",getDashboardSettingsDetail:"/sp/hiring/dashboard/getDashboardSettingsDetail",visitedDashboard:"/sp/hiring/dashboard/visitedDashboard",knowledge:"/sp/trainingLibrary/getArticleDetail/",search:"/sp/resources/html/people-analytics/view/dashboard-search.html",dialog:{knowledge:"/sp/resources/html/people-analytics/dialog/knowledge.html"}}},admin:{talentAnalytics:{idealPortrait:{getAll:"/sp/hiring/admin/match/getAll",get:"/sp/hiring/admin/match/get",create:"/sp/hiring/admin/match/create",update:"/sp/hiring/admin/match/update",delete:"/sp/hiring/admin/match/delete",getCompanies:"/sp/hiring/admin/match/getCompanies",assignPortrait:"/sp/hiring/admin/match/assignPortrait",removePortrait:"/sp/hiring/admin/match/removePortrait",uploadAttachment:"/sp/hiring/admin/match/addDocumentUrl",removeAttachment:"/sp/hiring/admin/match/removeDocumentUrl",dialog:{preview:"/sp/resources/html/sysAdmin/peopleAnalytics/Ideal-Portrait/dialog/preview.html",delete:"/sp/resources/html/sysAdmin/peopleAnalytics/Ideal-Portrait/dialog/portrait-delete.html",add:"/sp/resources/html/sysAdmin/peopleAnalytics/Ideal-Portrait/dialog/portrait-add.html",addConfirm:"/sp/resources/html/sysAdmin/peopleAnalytics/Ideal-Portrait/dialog/portrait-addConfirm.html",remove:"/sp/resources/html/sysAdmin/peopleAnalytics/Ideal-Portrait/dialog/portrait-remove.html",removeDoc:"/sp/resources/html/sysAdmin/peopleAnalytics/Ideal-Portrait/dialog/portrait-remove-file.html",setWeight:"/sp/resources/html/sysAdmin/peopleAnalytics/Ideal-Portrait/dialog/setWeight.html"}},dashboard:{getAll:"/sp/sysAdmin/hiring/dashboard/getAll",get:"/sp/sysAdmin/hiring/dashboard/get",create:"/sp/sysAdmin/hiring/dashboard/create",update:"/sp/sysAdmin/hiring/dashboard/update",getAllArticles:"/sp/sysAdmin/learning/getAllArticles",dialog:{selectArticle:"/sp/resources/html/sysAdmin/peopleAnalytics/dashboard/dialog/select-article.html"}}}}}),angular.module("spApp").value("spValue",{Company:"Surepeople",getAllGroups:[],getAllMembersForGroups:[],getAllEmployees:[],getAllCandidates:[],getAllRoles:[],getAllArchive:[],getAllAdminIdealPortrait:[],getAllIdealPortrait:[],getCompaniesIdealPortrait:[],getAllMembers:[]});
function fixContainer(){return{restrict:"A",link:function($scope,$element,$attrs){$scope.innerHeightSet=function(){jQuery("#content").css({"min-height":window.innerHeight-(jQuery("#header").outerHeight()+jQuery("#footer").outerHeight())}),$(".footer-container").removeClass("visibilitynone")},jQuery(window).resize(function(){$scope.innerHeightSet()}),$scope.innerHeightSet()}}}angular.module("spApp").directive("fixContainer",fixContainer);
function clickOut($http){return{restrict:"A",link:function($scope,$element,$attrs){jQuery("body").on("click",function(e){jQuery(e.target).hasClass("clickOut")||($scope.dropUp=!1,$scope.$apply())})}}}angular.module("spApp").directive("clickOut",clickOut),clickOut.$inject=["$http"];
function companyPicUploader($http,ajaxService,$rootScope,$timeout,ngDialog,$localStorage,sharedProperties){return{restrict:"A",link:function($scope,$element,$attrs){jQuery($element[0]).find(".select-image-btn").on("click",function(e){if(e.preventDefault(),jQuery($element[0]).find("form.pic-uploader").find("input:file").click(),$scope.enableBtns=!0,$scope.$apply(),jQuery("html").hasClass("ie10")&&$scope.prevImage===jQuery($element[0]).find(".image-editor").cropit("imageSrc")&&!0===$scope.resetFlag){jQuery($element[0]).find(".cropit-image-background").removeAttr("src"),jQuery($element[0]).find(".cropit-image-preview").removeClass("cropit-image-loaded");var img=jQuery($element[0]).find(".image-editor").cropit("imageSrc");jQuery($element[0]).find(".cropit-image-background").attr("src",img),jQuery($element[0]).find(".cropit-image-background-container").css({"background-image":'url("'+img+'")'}),jQuery($element[0]).find(".cropit-image-preview").css({"background-image":'url("'+img+'")'}).addClass("cropit-image-loaded"),$scope.prevImage="",$scope.resetFlag=!1}}),setTimeout(function(){jQuery($element[0]).find(".image-editor").cropit({imageBackground:!0,previewSize:{width:200,height:100},exportZoom:1,originalSize:!1})},500),jQuery($element[0]).find(".reset-image").on("click",function(e){if(e.preventDefault(),!0===$scope.enableBtns){$scope.enableBtns=!1,$scope.$apply();jQuery($element[0]).find("form.pic-uploader").find("input:file").val(""),jQuery($element[0]).find(".avatar-company-upload div").each(function(){jQuery(this).css("background-image","none")}),$scope.resetFlag=!0,$scope.prevImage=jQuery($element[0]).find(".image-editor").cropit("imageSrc"),jQuery($element[0]).find(".cropit-image-background").attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7")}}),jQuery($element[0]).find(".saveInHolder").on("click",function(e){e.preventDefault(),!0===$scope.enableBtns&&null!==$scope.imageData&&($scope.enableBtns=!1,$(document).trigger("imageSaved",[{imageData:$scope.imageData}]),ngDialog.close("ngdialog1"))}),jQuery($element[0]).find(".process-pic").on("click",function(e){if(e.preventDefault(),!("none"!==jQuery($element[0]).find(".cropit-image-preview").css("background-image")))return $scope.enableBtns=!1,!1;if(!0===$scope.enableBtns){$scope.enableBtns=!1,$scope.$apply(),$scope.imageData=jQuery($element[0]).find(".image-editor").cropit("export",{type:"image/jpeg",quality:.99,exportZoom:1,originalSize:!1});var options={url:"/sp/media/company/uploadImage",data:$.param({image:$scope.imageData,companyId:$scope.themeCompanyId})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?(ngDialog.close("ngdialog1"),sharedProperties.growlMessage($rootScope.pullInterNationalization("mediaManager.growlMessage.success")),$timeout(function(){$(document).trigger("imageSaved",[{imageData:$scope.imageData}]),ngDialog.close("ngdialog1")},500)):sharedProperties.growlMessage($rootScope.pullInterNationalization("mediaManager.growlMessage.fail"),"<strong> Alert </strong>","glyphicon glyphicon-ban-circle")})}}),jQuery($element[0]).find(".select-company-logo").on("click",function(e){e.preventDefault(),jQuery($element[0]).find("form.company-logo-uploader").find("input:file").click(),$scope.enableBtns=!0,$scope.$apply()}),jQuery($element[0]).find("form.company-logo-uploader").find("input:file").change(function(){var preview=document.querySelector("img.company-image-preview"),logoImage=this.files[0],fr=new FileReader;fr.onload=function(){$scope.imageData=fr.result,preview.src=fr.result},fr.readAsDataURL(logoImage)}),jQuery($element[0]).find(".reset-company-logo, .reset-org-image").on("click",function(e){if(e.preventDefault(),!0===$scope.enableBtns){var preview=document.querySelector("img.company-image-preview");$scope.enableBtns=!1,$scope.$apply(),preview.src="/sp/resources/images/company-default.png",$scope.imageData=null}}),jQuery($element[0]).find(".process-company-logo").on("click",function(e){if(e.preventDefault(),!0===$scope.enableBtns&&null!==$scope.imageData){$scope.enableBtns=!1;var options={url:"/sp/media/company/uploadImage",maximum:7e3,data:$.param({image:$scope.imageData,companyId:$scope.themeCompanyId})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?(sharedProperties.growlMessage($rootScope.pullInterNationalization("mediaManager.growlMessage.success")),sharedProperties.fireAnalyticsEvent("Manage Account | Company Logo updated","N/A"),$timeout(function(){$(document).trigger("imageSaved",[{imageData:$scope.imageData}]),ngDialog.close("ngdialog1")},100)):(ngDialog.close("ngdialog1"),sharedProperties.growlMessage($rootScope.pullInterNationalization("mediaManager.growlMessage.fail"),"<strong> Alert </strong>","glyphicon glyphicon-ban-circle"))})}})}}}angular.module("spApp").directive("companyPicUploader",companyPicUploader),companyPicUploader.$inject=["$http","ajaxService","$rootScope","$timeout","ngDialog","$localStorage","sharedProperties"];
function dateSame(){return{require:"ngModel",link:function(scope,elem,attrs,ngModel){function validate(value){var isValid="",firstArg=scope.$eval(attrs.dateSame);return isValid=null===firstArg||void 0===firstArg||null===value||void 0===value||firstArg.toString()!==value.toString(),ngModel.$setValidity("same",isValid),isValid?value:void 0}ngModel.$parsers.unshift(validate),scope.$watch(attrs.dateSame,function(){ngModel.$setViewValue(ngModel.$viewValue)})}}}function sameAs(){return{require:"ngModel",link:function(scope,elem,attrs,ngModel){function validate(value){var isValid=scope.$eval(attrs.sameAs)===value;return ngModel.$setValidity("same-as",isValid),isValid?value:void 0}ngModel.$parsers.unshift(validate),scope.$watch(attrs.sameAs,function(){ngModel.$setViewValue(ngModel.$viewValue)})}}}angular.module("spApp").directive("sameAs",sameAs),angular.module("spApp").directive("dateSame",dateSame),angular.module("spApp").directive("validationCheck",["$parse",function($parse){return{require:"ngModel",link:function(scope,elm,attrs,ngModel){var check=$parse(attrs.validationCheck);scope.$watch(check,function(newValue){ngModel.$setValidity(attrs.name,newValue)})}}}]);
function focusIf($timeout){function link($scope,$element,$attrs){function focusFn(condition){condition&&$timeout(function(){dom.focus()},$scope.$eval($attrs.focusDelay)||0)}var dom=$element[0];$attrs.focusIf?$scope.$watch($attrs.focusIf,focusFn):focusFn(!0)}return{restrict:"A",link:link}}function overflowHoverList($timeout,$rootScope){return{restrict:"A",scope:{list:"=list",len:"=length",mLen:"=mlength",msgProps:"=msgprops",ellipsis:"=ellipsis",addCommas:"=addcommas"},link:function(scope,element,attrs){function setupHover(fullList,partialList){moreList=[];for(var i=0;i<fullList.length;i++){-1===$.inArray(fullList[i],partialList)&&moreList.push(fullList[i])}pTag.append('<span class="list-more"> +'+moreList.length+" "+$rootScope.pullInterNationalization("spectrum.more")+"</span>");for(var j=0;j<moreList.length;j++){var cont="manageContent."+moreList[j];void 0!==scope.addCommas?moreWrap.append("<span>"+(void 0!==scope.msgProps?$rootScope.pullInterNationalization(cont):moreList[j])+(j<moreList.length-1?", ":"")+"</span>"):moreWrap.append("<span>"+(void 0!==scope.msgProps?$rootScope.pullInterNationalization(cont):moreList[j])+"</span>")}isTouch?pTag.find(".list-more").off("click").on("click",function(e){moreWrap.hasClass("hide")?(moreWrap.removeClass("hide"),moreWrap.css({top:element[0].querySelector(".list-more").offsetTop+18,left:element[0].querySelector(".list-more").offsetLeft+2})):moreWrap.addClass("hide")}):(pTag.find(".list-more").on("mouseenter",function(){moreWrap.removeClass("hide"),moreWrap.css({top:element[0].querySelector(".list-more").offsetTop+18,left:element[0].querySelector(".list-more").offsetLeft+2})}),pTag.find(".list-more").on("mouseleave",function(){moreWrap.addClass("hide")}))}function appendList(){var len=hoverList.length,limit=$(window).width()>1024?parseInt(scope.len,10):parseInt(scope.mLen,10);selectedList=[],moreWrap.hasClass("hide")||moreWrap.addClass("hide"),pTag.find(".list-more").off("click"),moreWrap.find("span").remove(),pTag.find(".selected-list-name, .elp, .list-more").remove();for(var i=0;i<(len<=limit?len:limit);i++){var cont="manageContent."+hoverList[i];pTag.append('<span class="selected-list-name">'+(void 0!==scope.msgProps?$rootScope.pullInterNationalization(cont):hoverList[i])+(len>1&&i<(len<=limit?len:limit)-1?", ":"")+"</span>"),selectedList.push(hoverList[i])}len>limit&&(void 0===scope.ellipsis&&pTag.append('<span class="elp">...</span>'),setupHover(hoverList,selectedList))}var ele=$(element[0]),pTag=ele.find("p"),moreWrap=ele.find(".more-list-wrapper"),hoverList=[],selectedList=[],isTouch="ontouchstart"in window||navigator.msMaxTouchPoints>0,moreList=[];scope.$watch("list",function(newVal,oldVal){$timeout(function(){hoverList=newVal,selectedList=[],moreList=[],appendList()},200)},!0)}}}function dropToolTip($templateRequest,$compile){return{restrict:"A",link:function($scope,$element,$attrs){$templateRequest("/sp/resources/html/common/tooltip.html").then(function(html){if(""===$attrs.desc)return!0;var user=JSON.parse($attrs.desc),self=user.id!==$attrs.self;$scope.user=user,$scope.self=self;var template=angular.element(html),elem=$compile(template)($scope);Tipped.create($element[0],elem[0],{showDelay:1e3,maxWidth:"220",detach:!0,size:"large",stem:{height:60,width:220}})})}}}function dropToolTiptext($templateRequest,$compile){return{restrict:"A",link:function($scope,$element,$attrs){Tipped.create($element[0],$attrs.desc)}}}function notesOptions($templateRequest,$compile,sharedProperties){return{restrict:"A",link:function($scope,$element,$attrs){$templateRequest("/sp/resources/html/"+$attrs.urlSrc).then(function(html){function handleNotesCallback(event){var method=$element.attr("notes-callback");$scope.$event=event,$scope.$apply(method)}var template=angular.element(html),elem=$compile(template)($scope),styles=$attrs.styles,drop=new Drop({target:$element[0],content:elem[0],position:"bottom left",openOn:"click",remove:!0,classes:void 0!==styles?styles:"notes-options",$scope:$scope});$scope.openNotesPanel=function(tab){sharedProperties.setSelectedNotesTab(tab),sharedProperties.fireAnalyticsEvent("Sticky Footer | Open Module",tab),drop.remove(),$(".drop-element").remove()},$element.bind("touchstart click",handleNotesCallback)})}}}function fileStackModal($compile,$rootScope,sharedProperties){return{restrict:"A",link:function(scope,el,$attrs){function handleFileStack(){$("body .sticky-bottom").hide(),el[0].blur(),filepicker.setKey($rootScope.fileStackAPIKey);var fileDialog=filepicker.pick({mimetypes:"*/*",container:"modal",services:["COMPUTER","BOX","DROPBOX","GOOGLE_DRIVE","SKYDRIVE"],maxSize:10485760,language:sharedProperties.provideVendorSpecificLocale("fileStack")},function(Blob){$("body .sticky-bottom").show();var fileStackObj={recordIndex:recordIndex,fileData:Blob};scope.$broadcast("fileStackSuccess",fileStackObj)},function(FPError){$("body .sticky-bottom").show(),console.log(FPError.toString())});window.addEventListener("popstate",function(e){$("body").find("#filepicker_dialog_container").length&&fileDialog.close()}),history.pushState({state:"filestack"},"",window.location.href)}var overrideStyle=void 0!==$attrs.overrideStyle?$attrs.overrideStyle:"",recordIndex=void 0!==$attrs.recordIndex?$attrs.recordIndex:0,template=(void 0!==$attrs.fsPos&&$attrs.fsPos,'<span class="file-attach icon-file_select sp-icon-color '+overrideStyle+'" data-ng-click="handleFileStack();"></span>'),elem=$compile(template)(scope);$attrs.fsPos?$($attrs.fsPos).append(elem):el.after(elem),elem.bind("touchstart click",handleFileStack)}}}function progressAnimation($timeout,$parse,sharedProperties){return{restrict:"A",scope:{progressGraph:"=progressGraph",observeParam:"@",totalTasks:"=totalTasks",remainingTasks:"=remainingTasks",iconLevel:"=iconLevel"},link:function(scope,el,$attrs){function createProgress(){var totalTasks=scope.totalTasks,remainingTasks=scope.remainingTasks,animationType=$attrs.type,customText=$attrs.customText,showIcon=$attrs.showIcon,iconClass=$attrs.iconClass,overrideIcon=$attrs.overrideIcon,iconLevel=scope.iconLevel,expressions={},uiProgress=$parse($attrs.uiProgress)(scope),optionsAnimation={strokeWidth:10,easing:"easeInOut",duration:1400,color:sharedProperties.whiteLabelColorCodes("sp-icon-color").color,trailColor:"#ccc",trailWidth:10,svgStyle:{width:"100%",height:"100%"},text:{style:{color:"#999",position:"absolute",right:"0",top:"30px",padding:0,margin:0,transform:null},autoStyleContainer:!1},step:function(state,bar){bar.setText(Math.round(100*bar.value())+" %")}},optionsRadial={color:sharedProperties.whiteLabelColorCodes("sp-icon-color").color,strokeWidth:sharedProperties.detectIE()?6:9,trailWidth:3,easing:"easeInOut",trailColor:"#ccc",duration:1400,text:{autoStyleContainer:!1},step:function(state,circle){var value=Math.round(100*circle.value())+"%";void 0!==customText&&(value=customText),0===value||showIcon?circle.setText(""):circle.setText(value)}},percentageVal=parseFloat(remainingTasks/totalTasks);if("radial"===animationType){angular.extend(expressions,optionsRadial,uiProgress),$(el[0]).empty();var radialProgress=new ProgressBar.Circle(el[0],expressions);if(radialProgress.text.style.fontSize=expressions.textFont||"14px",radialProgress.text.style.color=expressions.textColor||"#999",$timeout(function(){radialProgress.animate(percentageVal.toFixed(2)),scope.progressGraph=radialProgress},1e3),showIcon){var iconTarget=el[0].querySelector(".progressbar-text"),iconElement=angular.element(iconTarget);overrideIcon?iconElement.addClass("icon-icon-badge_level"+iconLevel):iconElement.addClass(iconClass)}}else if("linear"===animationType){angular.extend(expressions,optionsAnimation,uiProgress),$(el[0]).empty();var bar=new ProgressBar.Line(el[0],expressions);$timeout(function(){bar.animate(percentageVal.toFixed(2)),scope.progressGraph=bar},500)}}void 0!==$attrs.observeParam?$attrs.$observe("observeParam",function(newValue,oldValue){void 0!==scope.progressGraph&&scope.progressGraph.destroy(),createProgress()},!0):createProgress()}}}function sameAs(){return{require:"ngModel",link:function(scope,elem,attrs,ngModel){function validate(value){var isValid=scope.$eval(attrs.sameAs)===value;return ngModel.$setValidity("same-as",isValid),isValid?value:void 0}ngModel.$parsers.unshift(validate),scope.$watch(attrs.sameAs,function(){ngModel.$setViewValue(ngModel.$viewValue)})}}}function badgeProgress($templateRequest,$compile,$rootScope){return{restrict:"A",link:function($scope,$element,$attrs){function displayBadge(){$templateRequest("/sp/resources/html/"+$attrs.urlSrc).then(function(html){var template=angular.element(html),elem=$compile(template)($scope),styles=$attrs.styles,badge=$attrs.badgeObject,moduleName=$attrs.moduleName;new Drop({target:$element[0],content:elem[0],position:"bottom left",openOn:"click",remove:!0,classes:void 0!==styles?styles:"notes-options",$scope:$scope});$scope.badge=JSON.parse(badge),$scope.badge.module=moduleName,$scope.badge.moduleLabel="Erti"===moduleName?$rootScope.pullInterNationalization("dashboard.erti"):$rootScope.pullInterNationalization("manageAccountContent.organization")})}void 0!==$attrs.badgeObject?$attrs.$observe("badgeObject",function(newValue,oldValue){displayBadge()},!0):displayBadge()}}}angular.module("spApp").directive("ngEnter",function(){return function(scope,element,attrs){element.bind("keydown keypress",function(event){13!==event.which||event.shiftKey||(scope.$apply(function(){scope.$eval(attrs.ngEnter,{$event:event})}),event.preventDefault())})}}),angular.module("spApp").filter("addEllipsis",["$sce",function($sce){return function(input,number){if(input)return input=input.length>number?input.substring(0,number)+"...":input,input=$sce.trustAsHtml(input)}}]),angular.module("spApp").filter("unique",function(){return function(arr,field){var i,o={},l=arr.length,r=[];for(i=0;i<l;i+=1)o[arr[i][field]]=arr[i];for(i in o)r.push(o[i]);return r}}),angular.module("spApp").directive("autoFocus",function(){return function(scope,element,attr){element[0].focus()}}),angular.module("spApp").directive("focusIf",focusIf),focusIf.$inject=["$timeout"],angular.module("spApp").filter("secureHtml",["$sce",function($sce){return function(input){return $sce.trustAsHtml(input)}}]),angular.module("spApp").filter("secureHtmlAndReplace",["$sce","$localStorage",function($sce,$localStorage){return function(input){if(null===input||void 0===input)return"";var personalityMap=$localStorage.get("loggegdInProfile").member.personalityMap;return input=input.replace("{primaryPersonality}",personalityMap.Primary).replace("{personalityUnderPressure}",personalityMap.UnderPressure),input=$sce.trustAsHtml(input)}}]),angular.module("spApp").filter("replacePlaceholder",["$localStorage",function($localStorage){return function(input){if(null===input||void 0===input)return"";var personalityMap=$localStorage.get("loggegdInProfile").member.personalityMap;return input=input.replace("{primaryPersonality}",personalityMap.Primary).replace("{personalityUnderPressure}",personalityMap.UnderPressure)}}]),angular.module("spApp").directive("dynamicName",["$parse",function($parse){return{restrict:"A",priority:1e4,controller:["$scope","$element","$attrs",function($scope,$element,$attrs){var name=null,updateName=function(){var customIndex=$attrs.dynamicName.search("customIndex"),fixedIndex=$attrs.dynamicName.search("fixedIndex");name=-1!==customIndex?$attrs.dynamicName.replace("customIndex",$scope.customIndex):-1!==fixedIndex?$attrs.dynamicName.replace("fixedIndex",$scope.fixedIndex):$attrs.dynamicName.replace("$index",$scope.$index),$attrs.$set("name",name)};updateName(),$element.removeAttr("data-dynamic-name"),$element.removeAttr("dynamic-name"),$scope.$watch($attrs.updatedIndex,function(newVal,oldVal){newVal!==oldVal&&updateName()})}]}}]),angular.module("spApp").directive("changeName",["$parse",function($parse){return{restrict:"A",priority:1e4,controller:["$scope","$element","$attrs",function($scope,$element,$attrs){var name=$attrs.changeName.replace("$index",$scope.$index).replace("ctrl.currentActionPlan",$scope.ctrl.currentActionPlan).replace("actionList.type",void 0===$scope.actionList?"":$scope.actionList.type).replace("parentIndex",$scope.parentIndex).replace("superIndex",$scope.superIndex).replace("currentIndex",$scope.currentIndex);delete $attrs.changeName,$element.removeAttr("data-change-name"),$element.removeAttr("change-name"),$attrs.$set("name",name)}]}}]),angular.module("checklist-model",[]).directive("checklistModel",["$parse","$compile",function($parse,$compile){function contains(arr,item){if(angular.isArray(arr))for(var i=0;i<arr.length;i++)if(angular.equals(arr[i],item))return!0;return!1}function add(arr,item){arr=angular.isArray(arr)?arr:[];for(var i=0;i<arr.length;i++)if(angular.equals(arr[i],item))return arr;return arr.push(item),arr}function remove(arr,item){if(angular.isArray(arr))for(var i=0;i<arr.length;i++)if(angular.equals(arr[i],item)){arr.splice(i,1);break}return arr}function postLinkFn(scope,elem,attrs){$compile(elem)(scope);var getter=$parse(attrs.checklistModel),setter=getter.assign,value=$parse(attrs.checklistValue)(scope.$parent);scope.$watch("checked",function(newValue,oldValue){if(newValue!==oldValue){var current=getter(scope.$parent);!0===newValue?setter(scope.$parent,add(current,value)):setter(scope.$parent,remove(current,value))}}),scope.$parent.$watch(attrs.checklistModel,function(newArr,oldArr){scope.checked=contains(newArr,value)},!0)}return{restrict:"A",priority:1e3,terminal:!0,scope:!0,compile:function(tElement,tAttrs){if("INPUT"!==tElement[0].tagName||!tElement.attr("type","checkbox"))throw'checklist-model should be applied to `input[type="checkbox"]`.';if(!tAttrs.checklistValue)throw"You should provide `checklist-value`.";return tElement.removeAttr("checklist-model"),tElement.attr("ng-model","checked"),postLinkFn}}}]),angular.module("spApp").directive("repeatDone",function(){return function(scope,element,attrs){scope.$last&&window.setTimeout(function(){scope.$eval(attrs.repeatDone)},100)}}),angular.module("spApp").filter("thousandSuffix",function(){return function(input,decimals){var exp,suffixes=["k","M","G","T","P","E"];return window.isNaN(input)?null:input<1e3?input:(exp=Math.floor(Math.log(input)/Math.log(1e3)),(input/Math.pow(1e3,exp)).toFixed(decimals)+suffixes[exp-1])}}),angular.module("spApp").directive("imageonload",function(){return{restrict:"A",link:function(scope,element,attrs){element.bind("load",function(){scope.$apply(attrs.imageonload)})}}}),angular.module("spApp").directive("convertToNumber",function(){return{require:"ngModel",link:function(scope,element,attrs,ngModel){ngModel.$parsers.push(function(val){return parseInt(val,10)}),ngModel.$formatters.push(function(val){return""+val})}}}),angular.module("spApp").directive("spClickOutside",["$document",function($document){return{restrict:"A",scope:{spCondition:"=",spClickOutside:"="},link:function(scope,element,attrs){var bodyCheck=function(e){element!==e.target&&!element[0].contains(e.target)&&scope.spClickOutside&&(scope.spClickOutside=!1,scope.$apply(scope.spClickOutside),$document.off("click",bodyCheck))};element.bind("click",function(e){e.preventDefault(),scope.spCondition&&(scope.spClickOutside?(scope.spClickOutside=!1,scope.$apply(scope.spClickOutside),$document.off("click",bodyCheck)):(scope.spClickOutside=!0,scope.$apply(scope.spClickOutside),$document.off("click",bodyCheck).on("click",bodyCheck)))})}}}]),angular.module("spApp").directive("overflowHoverList",overflowHoverList),overflowHoverList.$inject=["$timeout","$rootScope"],angular.module("spApp").directive("dropToolTip",dropToolTip),dropToolTip.$inject=["$templateRequest","$compile"],angular.module("spApp").directive("dropToolTiptext",dropToolTiptext),dropToolTiptext.$inject=["$templateRequest","$compile"],angular.module("spApp").directive("notesOptions",notesOptions),notesOptions.$inject=["$templateRequest","$compile","sharedProperties"],angular.module("spApp").filter("spDateFormat",["$filter","$localStorage","sharedProperties",function($filter,$localStorage,sharedProperties){return function(input){if(null===input||void 0===input)return"";var userTimeZone=$localStorage.get("loggegdInProfile").timeZome,year=input[0],month=input[1],day=input[2],hours=input[3],mins=input[4],secs="00";moment.locale(sharedProperties.provideVendorSpecificLocale("datePicker"));var momentDateTime=new Date(year+"/"+month+"/"+day+" "+hours+":"+mins+":"+secs);momentDateTime=moment(momentDateTime).format("YYYY-MM-DD HH:mm:ss");var utcTime=moment.tz(momentDateTime,userTimeZone).toISOString();return moment.utc(utcTime).format("MMM DD, YYYY").toUpperCase()}}]),angular.module("spApp").filter("spTimeUpdate",["$filter","$localStorage","sharedProperties",function($filter,$localStorage,sharedProperties){return function(input){if(null===input||void 0===input||!angular.isArray(input))return!0;if(null!==$localStorage.get("loggegdInProfile")){var userTimeZone=$localStorage.get("loggegdInProfile").timeZome,year=input[0],month=input[1],day=input[2],hours=input[3],mins=input[4],secs=input[5];moment.locale(sharedProperties.provideVendorSpecificLocale("datePicker"));var momentDateTime=new Date(year+"/"+month+"/"+day+" "+hours+":"+mins+":"+secs);return momentDateTime=moment(momentDateTime).format("YYYY-MM-DD HH:mm:ss"),moment.tz(momentDateTime,userTimeZone).fromNow()}}}]),angular.module("spApp").directive("numbersOnly",function(){return{require:"ngModel",link:function(scope,element,attrs,modelCtrl){modelCtrl.$parsers.push(function(inputValue){return parseInt(inputValue)<=200&&parseInt(inputValue)>=0?(modelCtrl.$setValidity("numbersOnly",!0),inputValue):(modelCtrl.$setValidity("numbersOnly",!1),modelCtrl.$modelValue)})}}}),angular.module("spApp").filter("htmlLinky",["$sanitize","linkyFilter",function($sanitize,linkyFilter){var ELEMENT_NODE=1,TEXT_NODE=3,linkifiedDOM=document.createElement("div"),inputDOM=document.createElement("div"),linkify=function linkify(startNode){var i,currentNode;for(i=0;i<startNode.childNodes.length;i++)switch(currentNode=startNode.childNodes[i],currentNode.nodeType){case ELEMENT_NODE:linkify(currentNode);break;case TEXT_NODE:var mode=-1!==currentNode.textContent.indexOf(window.location.host)?"_self":"_blank";for(linkifiedDOM.innerHTML=linkyFilter(currentNode.textContent,mode),i+=linkifiedDOM.childNodes.length-1;linkifiedDOM.childNodes.length;)startNode.insertBefore(linkifiedDOM.childNodes[0],currentNode);startNode.removeChild(currentNode)}return startNode};return function(input){return inputDOM.innerHTML=input,linkify(inputDOM).innerHTML}}]),angular.module("spApp").directive("setFocusLast",function(){return{scope:{setFocusLast:"=",setEl:"=",setHeight:"="},link:function(scope,element){var _this=$(element[0]);scope.setFocusLast?window.setTimeout(function(){void 0!==scope.setEl?$(scope.setEl).scrollTop($(scope.setHeight).height()):_this.parent().scrollTop(_this.position().top)},200):void 0!==scope.setEl?$(scope.setEl).scrollTop(0):_this.parent().scrollTop(0)}}}),angular.module("spApp").filter("convertToLink",function(){return function(input){return input&&(input=input.replace(/((https?\:\/\/)|(www\.))(\S+)(\w{2,4})(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi,function(url){var full_url=url;return full_url.match("^https?://")||(full_url="http://"+full_url),'<a class="wrap-url" target="_blank" href="'+full_url+'">'+url+"</a>"})),input}}),angular.module("spApp").directive("fileStackModal",fileStackModal),fileStackModal.$inject=["$compile","$rootScope","sharedProperties"],angular.module("spApp").filter("newMediaManagerFilter",function(){return function(items,types,searchText,filterFilter){var filtered=[];return angular.forEach(items,function(item){!1===types.image&&!1===types.pdf&&!1===types.ppt&&!1===types.msdoc&&!1===types.video&&!1===types.web&&!1===types.excel?filtered.push(item):!0===types.image&&"IMAGE"===item.mediaType?filtered.push(item):!0===types.pdf&&"PDF"===item.mediaType?filtered.push(item):!0===types.ppt&&"PPT"===item.mediaType?filtered.push(item):!0===types.msdoc&&"MSDOC"===item.mediaType?filtered.push(item):!0===types.video&&"Video"===item.mediaType?filtered.push(item):!0===types.web&&"Web"===item.mediaType?filtered.push(item):!0===types.excel&&"MSEXCEL"===item.mediaType&&filtered.push(item),""!==searchText&&(filtered=filterFilter(filtered,searchText))}),filtered}}),angular.module("spApp").directive("myMention",["basicService",function(basicService){return{require:"uiMention",link:function($scope,$element,$attrs,uiMention){var choices=null;basicService.getAllValidMember().then(function(response){choices=response}),uiMention.label=function(choice){return choice.name},uiMention.labelWord=function(choice){return choice.firstName},uiMention.findChoices=function(match,mentions){return choices.filter(function(choice){return!mentions.some(function(mention){return mention.id===choice.id})}).filter(function(choice){return-1!==choice.name.toLowerCase().indexOf(match[1].toLowerCase())})},uiMention.encode=function(choice){return'<a href="'+window.location.origin+"/sp/dashboard/profile?userId="+choice.id+'" class="sp-user-tool-tip">'+this.label(choice)+"</a>"}}}}]),angular.module("spApp").filter("spLocaleDate",["sharedProperties",function(sharedProperties){return function(input){if(null===input||void 0===input)return"";var year=input[0],month=input[1],day=input[2];moment.locale(sharedProperties.provideVendorSpecificLocale("datePicker"));var momentDate=new Date(year+"/"+month+"/"+day);return momentDate=moment(momentDate).format("MMM DD, YYYY").toUpperCase()}}]),angular.module("spApp").directive("displayRole",["$compile","$rootScope",function($compile,$rootScope){return{restrict:"A",scope:{displayRole:"=displayRole"},link:function(scope,element,attr){var elem,userRoles=scope.displayRole.roles,complete=[],classTobind=attr.addClass;-1!==userRoles.indexOf("GroupLead")&&complete.push('<span class="thin">'+$rootScope.pullInterNationalization("manageAccountContent.l")+"</span>"),-1!==userRoles.indexOf("AccountAdministrator")&&complete.push('<span class="thin">'+$rootScope.pullInterNationalization("manageAccountContent.admin")+"</span>"),scope.displayRole.deactivated&&complete.push('<span class="thin blocked">'+$rootScope.pullInterNationalization("manageAccountContent.blocked")+"</span>"),complete.length?(elem=$compile(complete.join(""))(scope),element.empty().append(elem),element.addClass(classTobind)):element.removeClass(classTobind)}}}]),angular.module("spApp").directive("progressAnimation",progressAnimation),progressAnimation.$inject=["$timeout","$parse","sharedProperties"],angular.module("spApp").directive("sameAs",sameAs),angular.module("spApp").directive("validationCheck",["$parse",function($parse){return{require:"ngModel",link:function(scope,elm,attrs,ngModel){var check=$parse(attrs.validationCheck);scope.$watch(check,function(newValue){ngModel.$setValidity(attrs.name,newValue)})}}}]),angular.module("spApp").directive("badgeProgress",badgeProgress),badgeProgress.$inject=["$templateRequest","$compile","$rootScope"],angular.module("spApp").filter("unescapeText",function(){return function(text){return unescape(text)}}),angular.module("spApp").filter("replaceName",["$sce",function($sce){return function(text,name){return text=text.replace("[name]",name),text=$sce.trustAsHtml(text)}}]);
angular.module("spApp").directive("feedbackResponse",["$rootScope","ajaxService","$localStorage","sharedProperties","feedbackService","ngDialog","$q","basicService","$filter",function($rootScope,ajaxService,$localStorage,sharedProperties,feedbackService,ngDialog,$q,basicService,$filter){return{restrict:"EA",scope:{responseObj:"@"},templateUrl:function(element,attrs){return attrs.urlSrc||"/sp/resources/html/common/feedback-response.html"},link:function(scope,element,attrs){function startup(){responseObj=JSON.parse(attrs.responseObj),sharedProperties.setFeedbackObjectForPanel(responseObj),vm.feedbackRefObj={},vm.referenceId=null,vm.parentId=null,vm.feedbackForm={},vm.masterList=[],vm.feedbackRequestList=[],vm.activeFeedId="",vm.inputRequired=!1,vm.feedbackUpdated=!1,vm.responseAvailable=!1,vm.feedbackUsers=[],vm.loggedInUser=null,vm.noDataOnLoad=!1,vm.selectedFilter="",vm.listingFilter="",vm.formSubmitted=!1,vm.activeResponseFeed=-1,vm.spFeatureName="",vm.allMember=[],vm.showNotesOptions=!1,vm.individualFeedbackId=null,vm.pullInterNationalization=$rootScope.pullInterNationalization,vm.feedbackRefObj=sharedProperties.getFeedbackObjectForPanel(),vm.statusFilterName=$rootScope.pullInterNationalization("feedback.filters.status.viewAll.label"),vm.listingFilterName=$rootScope.pullInterNationalization("feedback.filters.status.viewAll.label"),vm.loggedInUser=$localStorage.get("loggegdInProfile"),vm.feedResponse=[],feedbackService.getAllFeedbackRequests(vm.feedbackRefObj.id,vm.feedbackRefObj.spFeature).then(function(data){void 0!==data&&data.Success&&(vm.masterList=data.developmentFeedbackListing,vm.feedbackRequestList=angular.copy(vm.masterList),vm.activeFeedId=vm.feedbackRefObj.id,vm.responseAvailable=!0,vm.masterList.length||(vm.noDataOnLoad=!0))})}var vm=scope,responseObj=null;attrs.$observe("responseObj",function(newValue,oldValue){void 0!==vm.responseObj&&startup()}),vm.openFeedback=function(mode,dialog){vm.feedbackView=mode,vm.formSubmitted=!1,vm.winHeight=$(window).height()-140+"px",vm.winWidth=$(window).width(),0===mode?(vm.newFeedbackFlow(mode),sharedProperties.fireAnalyticsEvent("Feedback | Open Request Feedback",vm.feedbackRefObj.spFeature)):sharedProperties.fireAnalyticsEvent("Feedback | Open Feedback Responses",vm.feedbackRefObj.spFeature),void 0===dialog&&ngDialog.open({template:"/sp/resources/html/common/feedback-response-dialog.html",scope:scope,className:vm.winWidth>767?"ngdialog-theme-default":"ngdialog-theme-default no-overflow no-padding"})},vm.tagAdded=function(tag){vm.feedbackUsers.push(tag.email)},vm.tagRemoved=function(tag){vm.feedbackUsers.splice(vm.feedbackUsers.indexOf(tag.email),1)},vm.loadEmail=function(query){var deferred=$q.defer(),result=vm.allMember.filter(function(e){return-1!==e.name.toLowerCase().indexOf(query.toLowerCase())||-1!==e.email.toLowerCase().indexOf(query.toLowerCase())});return deferred.resolve(result),deferred.promise};var prepareFeedbackForm=function(){return vm.feedbackForm.devFeedRefId=vm.feedbackRefObj.id,vm.feedbackForm.spFeature=vm.feedbackRefObj.spFeature,vm.feedbackForm.feedbackUsers=vm.feedbackUsers,vm.feedbackForm.feedParentRefId=vm.feedbackRefObj.parentId,vm.feedbackForm};vm.submitFeedbackRequest=function(){vm.formSubmitted=!0,""!==vm.feedbackForm.comment.trim()&&void 0!==vm.feedbackForm.comment&&vm.feedbackUsers.length&&(vm.inputRequired=!1,vm.feedbackForm=prepareFeedbackForm(),vm.feedbackUpdated=!1,feedbackService.submitFeedbackRequest(vm.feedbackForm).then(function(data){data&&(ngDialog.close(),sharedProperties.growlMessage($rootScope.pullInterNationalization("feedback.ajaxMessage.requestSent")),vm.feedbackUpdated=!0,vm.noDataOnLoad=!1,vm.goBackToListing(),sharedProperties.fireAnalyticsEvent("Feedback | Request sent","Name - "+vm.feedbackRefObj.name+", Feature -    "+vm.feedbackRefObj.spFeature))}))},vm.goBackToListing=function(){vm.formSubmitted=!1,vm.selectedFilter="",vm.listingFilter="",vm.feedbackUsers=[],vm.feedbackUpdated&&feedbackService.getAllFeedbackRequests(vm.feedbackRefObj.id,vm.feedbackRefObj.spFeature).then(function(data){data.Success&&(vm.masterList=data.developmentFeedbackListing,vm.feedbackRequestList=angular.copy(vm.masterList),vm.responseAvailable=!0)})},vm.newFeedbackFlow=function(mode){vm.selectedFilter="",vm.listingFilter="",vm.feedbackView=mode,vm.inputRequired=!1,vm.feedbackUpdated=!1,vm.tagsAdded=!1,vm.feedbackForm.comment="",vm.allMember.length||basicService.getAllValidMember().then(function(response){if(vm.allMember=response,null!==vm.loggedInUser)for(var i=0;i<vm.allMember.length;i++)if(vm.allMember[i].email===vm.loggedInUser.member.email){vm.allMember.splice(i,1);break}})},vm.emailFeedback=function(feedbackId){vm.feedbackForm={},vm.feedbackForm.spFeature=vm.feedbackRefObj.spFeature,null!==feedbackId&&void 0!==feedbackId?(vm.feedbackForm.id=feedbackId,vm.feedbackForm.devFeedRefId=null):(vm.feedbackForm.id=null,vm.feedbackForm.devFeedRefId=vm.feedbackRefObj.id),feedbackService.emailFeedback(vm.feedbackForm).then(function(data){data&&(sharedProperties.growlMessage($rootScope.pullInterNationalization("feedback.ajaxMessage.emailSent")),sharedProperties.fireAnalyticsEvent("Feedback | Send email from side panel","N/A"))})},vm.deleteModal=function(feedbackId){vm.individualFeedbackId=feedbackId,ngDialog.open({template:"/sp/resources/html/feedback/delete-feedback.html",scope:scope})},vm.deleteFeedback=function(){var devFeedId=vm.activeFeedId;null!==vm.individualFeedbackId&&(devFeedId=null),feedbackService.deleteFeedback(vm.individualFeedbackId,devFeedId,vm.feedbackRefObj.spFeature).then(function(data){data&&(ngDialog.close("ngdialog2"),sharedProperties.growlMessage($rootScope.pullInterNationalization("feedback.ajaxMessage.delete")),vm.feedbackUpdated=!0,null!==vm.individualFeedbackId?(sharedProperties.spilceIndexWithBreak(vm.masterList,"id",vm.individualFeedbackId),vm.feedbackRequestList=angular.copy(vm.masterList),vm.feedbackRequestList.length||(vm.feedbackRequestList=[],vm.masterList=[],vm.noDataOnLoad=!0,vm.newFeedbackFlow(vm.feedbackView))):(vm.feedbackRequestList=[],vm.masterList=[],vm.noDataOnLoad=!0,vm.newFeedbackFlow(vm.feedbackView)),sharedProperties.fireAnalyticsEvent("Feedback | Delete feedback from side panel","N/A"))})},vm.filterData=function(data,displayName){var resp=[];resp=$filter("feedbackFilter")(vm.masterList,data,"status"),vm.feedbackRequestList=[],vm.feedbackRequestList=resp,vm.statusFilterName=displayName,vm.selectedFilter=data}}}}]);
angular.module("spApp").directive("footerStick",["$rootScope",function($rootScope){return{restrict:"EA",templateUrl:function(element,attrs){return attrs.urlSrc||"/sp/resources/html/common/footer-b.html"},link:function(scope,element,attrs){scope.pullInterNationalization=$rootScope.pullInterNationalization}}}]);
function navModule($compile,$templateRequest,spConfig){var controller=function($scope,$rootScope,sharedProperties,ajaxService,$q,basicService,$localStorage,$timeout){var self=this;$scope.showMenu=!1,$rootScope.navLoaded=!1,$scope.showNav=!1,self.globalNav={},self.userNav="",self.acceptedNav=["erti","pplAnalytics","superAdmin"],self.paPathName="/pa/",$rootScope.selectedNav="",$rootScope.smallViewPort=$(window).width()<768;var init=function(){-1===window.location.pathname.indexOf(self.paPathName)&&"pplAnalytics"===$localStorage.get("userSelectedNav")&&$localStorage.remove("userSelectedNav"),localstorageCheck("globalNav")?fetchSiteNavigationData():processNavigation()},fetchSiteNavigationData=function(){ajaxService.getAjaxResponse({url:spConfig.nav.fetchNavApi}).then(function(response){"true"===response.Success&&($localStorage.set("globalNav",response),processNavigation())})},checkForErti=function(){ajaxService.getAjaxResponse({url:spConfig.nav.checkErti}).then(function(response){"true"!==response.Success||response.hasErti||$localStorage.set("noErti",!0)})},processNavigation=function(){var storedGlobalNav=$localStorage.get("globalNav").navigation.navigationList;if(localstorageCheck("userSelectedNav")?(-1===Object.keys(storedGlobalNav).indexOf("erti")&&-1===Object.keys(storedGlobalNav).indexOf("pplAnalytics")?self.userNav="superAdmin":-1!==Object.keys(storedGlobalNav).indexOf("erti")?self.userNav="erti":(checkForErti(),self.userNav="pplAnalytics"),$localStorage.set("userSelectedNav",self.userNav)):self.userNav=$localStorage.get("userSelectedNav"),null!==sharedProperties.getParam("nav")){var navParam="";navParam=null===$localStorage.get("noErti")?-1===self.acceptedNav.indexOf(sharedProperties.getParam("nav"))?"erti":sharedProperties.getParam("nav"):-1===self.acceptedNav.indexOf(sharedProperties.getParam("nav"))?"pplAnalytics":sharedProperties.getParam("nav"),$localStorage.set("userSelectedNav",navParam),self.userNav=$localStorage.get("userSelectedNav")}-1!==window.location.pathname.indexOf(self.paPathName)&&($localStorage.set("userSelectedNav","pplAnalytics"),self.userNav=$localStorage.get("userSelectedNav")),"erti"===self.userNav?$rootScope.showStickyFooter=!0:$rootScope.showStickyFooter=!1,$rootScope.selectedNav=self.userNav,self.globalNav=storedGlobalNav[self.userNav],$rootScope.navLoaded=!0,storedGlobalNav=null},localstorageCheck=function(key){return null===$localStorage.get(key)};$scope.$on("updatePermissionSSE",function(e,data){if(null===data)return!0;$scope.$apply(function(){$localStorage.set("globalNav",data),processNavigation()})}),$scope.$on("updateNavigationSSE",function(e,data){if(null===data)return!0;$scope.$apply(function(){$localStorage.set("globalNav",data),processNavigation()})});!function(){init()}()};return controller.$inject=["$scope","$rootScope","sharedProperties","ajaxService","$q","basicService","$localStorage","$timeout"],{restrict:"EA",link:function($scope,$element,$attrs){$templateRequest(spConfig.nav.htmlSrc).then(function(html){var template=angular.element(html);$element.append(template),$compile(template)($scope)})},controller:controller,controllerAs:"navCtrl",bindToController:!0}}function flyoutNav($timeout){return{restrict:"A",scope:{showNav:"=show"},link:function(scope,element,attrs){function openFlyoutMenu(isEnabled){isEnabled&&($(".nav-col1, .nav-col2").stop().removeClass("addPos animate_slideLeft animate_slideLeft1").removeAttr("style"),$(".header-body-wrap").stop().addClass("hide").css({left:"-9999em"}).removeAttr("style"),$("body").css({overflow:"hidden"}),$(".header-body-wrap").css({left:0}).removeClass("hide").fadeIn(400),$(".nav-col1").addClass("animate_slideLeft"),$timeout(function(){$(".nav-col2").addClass("addPos animate_slideLeft1"),$("body .sticky-bottom").hide()},timer))}function closeFlyoutMenu(){$(".nav-col1, .nav-col2, .header-body-wrap").fadeOut(250,function(){$(".nav-col1, .nav-col2").removeClass("addPos animate_slideLeft animate_slideLeft1").removeAttr("style"),$(".header-body-wrap").addClass("hide").css({left:"-9999em"}).removeAttr("style"),$("body").removeAttr("style"),scope.$apply(function(){scope.$parent.showMenu=!1}),$("body .sticky-bottom").show()})}$(".header-body-wrap, .nav-close-btn").off("click").on("click",function(e){closeFlyoutMenu()}),$(document).keyup(function(e){27===e.keyCode&&closeFlyoutMenu()});var timer=$(window).width()<768?100:50;$("body").on("click",".flyout-global-nav a",function(e){closeFlyoutMenu()});scope.$on("disableNavClick",function(){closeFlyoutMenu()});scope.$watch("showNav",function(){openFlyoutMenu(scope.showNav)},!0)}}}navModule.$inject=["$compile","$templateRequest","spConfig"],angular.module("spApp").directive("navModule",navModule),angular.module("spApp").directive("flyoutNav",flyoutNav),flyoutNav.$inject=["$timeout"];
function profilePicUploader($http,ajaxService,$rootScope,$timeout,ngDialog,$localStorage,sharedProperties){return{restrict:"A",link:function($scope,$element,$attrs){jQuery($element[0]).find(".select-image-btn").on("click",function(e){if(e.preventDefault(),jQuery($element[0]).find("form.pic-uploader").find("input:file").click(),$scope.enableBtns=!0,$scope.$apply(),jQuery("html").hasClass("ie10")&&$scope.prevImage===jQuery($element[0]).find(".image-editor").cropit("imageSrc")&&!0===$scope.resetFlag){jQuery($element[0]).find(".cropit-image-background").removeAttr("src"),jQuery($element[0]).find(".cropit-image-preview").removeClass("cropit-image-loaded");var img=jQuery($element[0]).find(".image-editor").cropit("imageSrc");jQuery($element[0]).find(".cropit-image-background").attr("src",img),jQuery($element[0]).find(".cropit-image-background-container").css({"background-image":'url("'+img+'")'}),jQuery($element[0]).find(".cropit-image-preview").css({"background-image":'url("'+img+'")'}).addClass("cropit-image-loaded"),$scope.prevImage="",$scope.resetFlag=!1}}),setTimeout(function(){jQuery($element[0]).find(".image-editor").cropit({imageBackground:!0,previewSize:{width:170,height:170},exportZoom:.51,originalSize:!1})},500),jQuery($element[0]).find(".reset-image").on("click",function(e){if(e.preventDefault(),!0===$scope.enableBtns){$scope.enableBtns=!1,$scope.$apply();jQuery($element[0]).find("form.pic-uploader").find("input:file").val(""),jQuery($element[0]).find(".avatar-upload div").each(function(){jQuery(this).css("background-image","none")}),$scope.resetFlag=!0,$scope.prevImage=jQuery($element[0]).find(".image-editor").cropit("imageSrc"),jQuery($element[0]).find(".cropit-image-background").attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7")}}),jQuery($element[0]).find(".process-pic").on("click",function(e){if(e.preventDefault(),!("none"!==jQuery($element[0]).find(".cropit-image-preview").css("background-image")))return $scope.enableBtns=!1,!1;if(!0===$scope.enableBtns){$scope.enableBtns=!1,$scope.$apply(),$scope.imageData=jQuery($element[0]).find(".image-editor").cropit("export",{type:"image/jpeg",quality:.99,exportZoom:.5});var options={url:"company"===$scope.imageType?"/sp/admin/company/uploadImage":"/sp/uploadImage",data:$.param({image:$scope.imageData})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?(ngDialog.close("ngdialog1"),sharedProperties.growlMessage($rootScope.pullInterNationalization("growl.imageUploaded")),$timeout(function(){$localStorage.remove("loggegdInProfile"),window.location.reload()},1e3)):sharedProperties.ajaxError($rootScope.pullInterNationalization("mediaManager.growlMessage.fail"))})}})}}}profilePicUploader.$inject=["$http","ajaxService","$rootScope","$timeout","ngDialog","$localStorage","sharedProperties"],angular.module("spApp").directive("profilePicUploader",profilePicUploader);
function toggleSection(){return{restrict:"A",link:function($scope,$element,$attrs){jQuery($element[0]).on("click",function(e){e.preventDefault();var activeTab,secInfo=jQuery(this).attr("data-rel"),secCont=jQuery("body").find("div[data-section="+secInfo+"]");$.each(jQuery("body").find(".btn-wrap a.toggle-btn"),function(){jQuery(this).hasClass("on")&&(activeTab=jQuery(this).attr("data-rel"))}),$.each(jQuery("body").find("div[data-section]"),function(){jQuery(this).removeClass("toggleShow").addClass("toggleHide")}),$.each(jQuery("body").find(".btn-wrap a.toggle-btn"),function(){jQuery(this).removeClass("on")}),secInfo!==activeTab?(secCont.removeClass("toggleHide").addClass("toggleShow"),jQuery(this).addClass("on"),jQuery("html,body").animate({scrollTop:jQuery(secCont).offset().top-40},300)):(secCont.removeClass("toggleShow").addClass("toggleHide"),jQuery(this).removeClass("on"))})}}}angular.module("spApp").directive("toggleSection",toggleSection);
function rangeSlider(){return{restrict:"A",priority:10,link:function($scope,$element,$attrs){jQuery('input[type="range"]').rangeslider({polyfill:!1,onSlideEnd:function(position,value){$scope.$apply(function(){$scope.competencyRangeSlider=value})}})}}}angular.module("spApp").directive("rangeSlider",rangeSlider);
function wolLinks($http,ajaxService,$rootScope,$timeout,ngDialog){return{restrict:"A",link:function($scope,$element,$attrs){$scope.redirectToPage=function(l){window.open(l),$timeout(function(){ngDialog.close("ngdialog1")},200)},jQuery($element[0]).on("click","a",function(e){e.preventDefault(),$scope.link=jQuery(this).attr("href"),ngDialog.open({template:"/sp/resources/html/curriculum/wol.html",scope:$scope})})}}}angular.module("spApp").directive("wolLinks",wolLinks),wolLinks.$inject=["$http","ajaxService","$rootScope","$timeout","ngDialog"];
function actionPlan($compile,$templateRequest,sharedProperties,$localStorage,actionPlanService,ngDialog,processSSEData,ajaxService,$timeout){var controller=function($scope,$rootScope,$filter){function closeModal(){$rootScope.showNotesPanel=!1,$rootScope.selectedNotesTab="",$("#notesModal").modal("hide"),sharedProperties.is_touch_supported()&&sharedProperties.is_iOS_device()&&($("body").css("position",""),$("body").animate({scrollTop:self.scrollPos},0)),$localStorage.remove("ertiId")}function saveTodo(){if(""===self.newTodoEntry||void 0===self.newTodoEntry)return void(self.inputRequired=!0);self.inputRequired=!1,self.todoForm.parentRefId="Todo",self.todoForm.type="Todo",self.todoForm.text=self.newTodoEntry,self.todoForm.completed=!1,actionPlanService.saveTodo(self.todoForm).then(function(data){data.Success&&(self.newTodoEntry="",void 0!==self.todoObj.incompleteTasks&&self.todoObj.incompleteTasks.length?self.todoObj.incompleteTasks.unshift(data.todo.tasks[data.todo.tasks.length-1]):(self.todoObj.incompleteTasks=[],self.todoObj.incompleteTasks.push(data.todo.tasks[data.todo.tasks.length-1])),updateLocalStorageTasks(data.todo),"dashboard"===self.parentPage?sharedProperties.fireAnalyticsEvent("Action Plan | Create a new TODO from dashboard","N/A"):sharedProperties.fireAnalyticsEvent("Action Plan | Create a new TODO from side panel","N/A"))})}function updateTodo(index){var tempObj=self.todoObj.incompleteTasks[index];self.todoForm={},self.todoForm.parentRefId="Todo",self.todoForm.refId=tempObj.refId,self.todoForm.type="Todo",self.todoForm.text=tempObj.text,self.todoForm.completed=!1,actionPlanService.updateTodo(self.todoForm).then(function(data){data.Success&&updateLocalStorageTasks(data.todo)})}function deleteModal(options){self.deleteOptions=options,ngDialog.open({template:"/sp/resources/html/common/delete-todo.html",scope:$scope})}function deleteTodo(){actionPlanService.deleteTodo(self.deleteOptions.refId).then(function(data){if(data.Success){ngDialog.close(),sharedProperties.growlMessage($rootScope.pullInterNationalization("actionPlan.ajaxMessage.todo.delete")),self.deleteOptions.completed?sharedProperties.spilceIndexWithBreak(self.todoObj.completedTasks,"refId",self.deleteOptions.refId):sharedProperties.spilceIndexWithBreak(self.todoObj.incompleteTasks,"refId",self.deleteOptions.refId);for(var todoLists=$localStorage.get("todoListing"),i=0;i<todoLists.length;i++)if("Todo"===todoLists[i].type){sharedProperties.spilceIndexWithBreak(todoLists[i].tasks,"refId",self.deleteOptions.refId);break}$localStorage.set("todoListing",todoLists),"dashboard"===self.parentPage?sharedProperties.fireAnalyticsEvent("Action Plan | Delete a TODO from dashboard","N/A"):sharedProperties.fireAnalyticsEvent("Action Plan | Delete a TODO from side panel","N/A")}})}function markTodo(todoObj){self.todoForm={},self.todoForm.parentRefId="Todo",self.todoForm.refId=todoObj.refId,self.todoForm.type="Todo",self.todoForm.text=todoObj.text,self.todoForm.completed=!todoObj.completed,actionPlanService.updateTodo(self.todoForm).then(function(data){if(data.Success){self.todoObj={},self.todoObj.completedTasks=[],self.todoObj.incompleteTasks=[];for(var i=0;i<data.todo.tasks.length;i++)data.todo.tasks[i].completed?self.todoObj.completedTasks.push(data.todo.tasks[i]):self.todoObj.incompleteTasks.push(data.todo.tasks[i]),jQuery("#incomplete_"+i).removeAttr("checked");updateLocalStorageTasks(data.todo),"dashboard"===self.parentPage?sharedProperties.fireAnalyticsEvent("Action Plan | Mark a TODO from dashboard",self.todoForm.completed):sharedProperties.fireAnalyticsEvent("Action Plan | Mark a TODO from side panel",self.todoForm.completed)}})}function redirectToPulse(pulseObj){"dashboard"===self.parentPage?sharedProperties.fireAnalyticsEvent("Action Plan | Click Pulse Survey from dashboard","N/A"):sharedProperties.fireAnalyticsEvent("Action Plan | Click Pulse Survey from side panel","N/A"),window.location.href="/sp/pulseUser/pulseStartAssessment?pulseRequestId="+pulseObj.refId}function redirectToCompetency(competencyObj){$localStorage.set("competencyObj",competencyObj),$localStorage.set("competencyAlertType",competencyObj.taskType),"dashboard"===self.parentPage?sharedProperties.fireAnalyticsEvent("Action Plan | Click Competency Notification from dashboard","N/A"):sharedProperties.fireAnalyticsEvent("Action Plan | Click Competency Notification from side panel","N/A"),window.location.href="/sp/competency/home"}function feedbackRequestAction(feedbackData){switch(feedbackData.id){case 5:handleRedirects(feedbackData.url,$rootScope.pullInterNationalization("actionPlan.tasks.lens"));break;case 1:$localStorage.set("feedbackRefId",feedbackData.refId),"sidePanel"===self.parentPage&&self.closeModal(),$rootScope.showFeedbackOverlay=!0,"dashboard"===self.parentPage?sharedProperties.fireAnalyticsEvent("Action Plan | Click Feedback request from dashboard","N/A"):sharedProperties.fireAnalyticsEvent("Action Plan | Click Feedback request from side panel","N/A");break;case 3:handleRedirects(feedbackData.url,$rootScope.pullInterNationalization("actionPlan.tasks.bp"));break;case 2:handleRedirects(feedbackData.url,$rootScope.pullInterNationalization("actionPlan.tasks.bf"));break;case 4:handleRedirects(feedbackData.url,$rootScope.pullInterNationalization("actionPlan.tasks.comp"))}}function goBackToListing(){self.pageView="listing",self.prepareActionPlanData($localStorage.get("todoListing")),self.taskList=[],self.progressBar.destroy(),self.objDestroyed=!0}function updateTabView(tab){self.selectedTab=tab}function displayDetail(taskData,taskType){if(self.taskData=$filter("orderBy")(taskData,"sortDate",!1),self.taskType=taskType,$rootScope.ertiDetailView=!1,self.completedPercent=0,null!==self.taskData.actionCount&&0!==self.taskData.actionCount&&null!==self.taskData.completedCount){self.completedPercent=Math.round(parseInt(self.taskData.completedCount)/parseInt(self.taskData.actionCount)*100);var percentageVal=parseFloat(self.taskData.completedCount/self.taskData.actionCount);self.objDestroyed&&redrawGraph(percentageVal)}actionPlanService.getLearningProgram(self.taskData.id).then(function(data){if(data.Success){self.learningProgram=data.actionPlan,self.completedTaskCount=self.learningProgram.completedCount,self.remainingTaskCount=self.learningProgram.actionCount-(self.completedTaskCount+1);for(var i=0;i<self.learningProgram.practiceAreaList.length;i++)if(self.learningProgram.practiceAreaList[i].enabled)for(var j=0;j<self.learningProgram.practiceAreaList[i].devStrategyActionCategoryList.length;j++)for(var k=0;k<self.learningProgram.practiceAreaList[i].devStrategyActionCategoryList[j].actionList.length;k++)if(1!==self.learningProgram.practiceAreaList[i].devStrategyActionCategoryList[j].actionList[k].completedActions)if("Single"===self.learningProgram.practiceAreaList[i].devStrategyActionCategoryList[j].actionList[k].type&&!0===self.learningProgram.practiceAreaList[i].devStrategyActionCategoryList[j].actionList[k].permissions.Completion)self.lpTask.stepId=self.learningProgram.practiceAreaList[i].id,self.lpTask.enabled=self.learningProgram.practiceAreaList[i].enabled,self.lpTask.taskData=self.learningProgram.practiceAreaList[i].devStrategyActionCategoryList[j].actionList[k],self.taskList.push(self.lpTask),self.lpTask={};else if("Group"===self.learningProgram.practiceAreaList[i].devStrategyActionCategoryList[j].actionList[k].type){!0===self.learningProgram.practiceAreaList[i].devStrategyActionCategoryList[j].actionList[k].permissions.Completion&&(self.lpTask.stepId=self.learningProgram.practiceAreaList[i].id,self.lpTask.enabled=self.learningProgram.practiceAreaList[i].enabled,self.lpTask.taskData=self.learningProgram.practiceAreaList[i].devStrategyActionCategoryList[j].actionList[k],self.taskList.push(self.lpTask),self.lpTask={});for(var abc=0;abc<self.learningProgram.practiceAreaList[i].devStrategyActionCategoryList[j].actionList[k].actionData.length;abc++)0===self.learningProgram.practiceAreaList[i].devStrategyActionCategoryList[j].actionList[k].actionData[abc].completedActions&&!0===self.learningProgram.practiceAreaList[i].devStrategyActionCategoryList[j].actionList[k].actionData[abc].permissions.Completion&&(self.lpTask.stepId=self.learningProgram.practiceAreaList[i].id,self.lpTask.enabled=self.learningProgram.practiceAreaList[i].enabled,self.lpTask.taskData=self.learningProgram.practiceAreaList[i].devStrategyActionCategoryList[j].actionList[k].actionData[abc],self.taskList.push(self.lpTask),self.lpTask={})}self.taskList.length&&(self.pageView="detail",self.currentActionTask=0,self.completedActionTask=-1)}})}function redirectToLP(type){"all"===type?(sharedProperties.fireAnalyticsEvent("Action Plan | LP View all Tasks","N/A"),window.location.href="/sp/goalsOrg?parentId="+self.learningProgram.id):(sharedProperties.fireAnalyticsEvent("Action Plan | LP View specific Task","N/A"),window.location.href="/sp/goalsOrg?parentId="+self.learningProgram.id+"&stepId="+self.taskList[self.currentActionIndex].stepId+"&actionId="+self.taskList[self.currentActionIndex].taskData.uid)}function displayConfirmBox(){self.showConfirmBox?self.showConfirmBox=!1:self.showConfirmBox=!0}function markCompletion(uid,stepId){ajaxService.getAjaxResponse({url:"/sp/actionPlan/completeAction?actionPlanId="+self.learningProgram.id+"&stepId="+stepId+"&uid="+uid+"&completed=true",method:"get"}).then(function(response){if("true"===response.Success){self.completedTaskCount=self.completedTaskCount+1,self.completedPercent=Math.round(parseInt(self.completedTaskCount)/parseInt(self.learningProgram.actionCount)*100);var percentageVal=parseFloat(self.completedTaskCount/self.learningProgram.actionCount);self.remainingTaskCount=self.learningProgram.actionCount-(self.completedTaskCount+1),self.progressBar.destroy(),redrawGraph(percentageVal),self.completedActionTask=self.currentActionIndex,$timeout(function(){$("#actionTask_"+self.currentActionIndex).hide(),self.currentActionIndex=self.currentActionIndex+1,self.currentActionTask=self.currentActionIndex,void 0===self.taskList[self.currentActionIndex]&&self.completedTaskCount!==self.learningProgram.actionCount&&window.location.reload()},500),self.completedTaskCount===self.learningProgram.actionCount&&(sharedProperties.growlMessage($rootScope.pullInterNationalization("actionPlan.tasksCompleted")),self.goBackToListing()),sharedProperties.fireAnalyticsEvent("ActionPlan | Complete LP Task","N/A")}})}function sortData(option,sortType){"oldToNew"===option?self.taskData=$filter("orderBy")(self.taskData,"sortDate",!1):"newToOld"===option?self.taskData=$filter("orderBy")(self.taskData,"sortDate",!0):"type"===option&&(self.taskData=$filter("orderBy")(self.taskData,"type",!1)),self.sortType=sortType}function prevErti(){self.currentSlide=self.currentSlide-1,self.ertiSlider.data("unslider").prev()}function nextErti(){self.currentSlide=self.currentSlide+1,self.ertiSlider.data("unslider").next()}function displayErtiDetail(id,name){$rootScope.ertiProgress=self.progressMap[id],$localStorage.set("ertiId",id),self.taskType="ert-i",self.pageView="detail",sharedProperties.fireAnalyticsEvent("Action Plan | Click ERT-i Practice Area from side panel",name)}function previewMedia(mode,url,title,uid){if("Video"===mode)sharedProperties.videoPopUp(url);else if("Schedule"===mode)sharedProperties.schedulePopUp(title,uid,self.learningProgram.id,self.learningProgram.name);else if("WebInternal"===mode)window.location.href=url;else if("ActionPlan"===mode)$rootScope.handleStickyTabs("action");else{var win=window.open(url,"_blank");win.focus()}}function init(){$rootScope.showFeedbackOverlay=!1,$localStorage.remove("feedbackRefId"),$rootScope.taskCount=0,$localStorage.set("taskCount",0),self.parentPage=$scope.parentPage,self.pageView="listing",self.selectedTab="tasks",self.sortType=$rootScope.pullInterNationalization("actionPlan.module.feedback.filters.displayLabel1"),delete $rootScope.ertiDetailView,pulseTaskCheck(),getErtiListing(),null===$localStorage.get("todoListing")?actionPlanService.getAllTasks().then(function(data){data.Success&&data.todoListing&&($localStorage.set("todoListing",data.todoListing),self.prepareActionPlanData(data.todoListing))}):self.prepareActionPlanData($localStorage.get("todoListing"))}function prepareActionPlanData(tempListing){self.actionPlanMap={},self.competencyNotification=null,self.pulseNotification=null,self.todoObj.remainingTasks=0,self.todoObj.completedTasks=[],self.todoObj.incompleteTasks=[];for(var i=0;i<tempListing.length;i++)switch(tempListing[i].type){case"OrgPlan":var orgListing=self.actionPlanMap[tempListing[i].type];void 0!==orgListing&&orgListing.length||(orgListing=[]);var orgObject={},orgActionList=[],orgActionObject={};orgObject.name=tempListing[i].name,orgObject.actionCount=tempListing[i].actionCount,orgObject.completedCount=tempListing[i].completedCount,orgObject.id=tempListing[i].parentRefId;for(var k=0;k<tempListing[i].steps.length;k++)for(var zz=0;zz<tempListing[i].steps[k].actions.length;zz++)orgActionObject={},orgActionObject.actionId=tempListing[i].steps[k].actions[zz].uid,orgActionObject.name=tempListing[i].steps[k].actions[zz].name,orgActionObject.stepName=tempListing[i].steps[k].name,orgActionObject.stepId=tempListing[i].steps[k].refId,orgActionObject.dueBy=calculatePastDue(tempListing[i].steps[k].dueBy),orgActionObject.sortDate=formatDate(tempListing[i].steps[k].dueBy),orgActionObject.timeInMins=calculateEstimatedTime(tempListing[i].steps[k].actions[zz].timeInMins),orgActionList.push(orgActionObject);orgActionList=$filter("orderBy")(orgActionList,"sortDate",!1),orgObject.actionList=angular.copy(orgActionList),void 0!==orgObject.actionList&&orgObject.actionList.length&&orgObject.actionList.length>2?orgObject.remainingTasks=orgObject.actionList.length-2:orgObject.remainingTasks=0,orgListing.push(orgObject),orgListing=$filter("orderBy")(orgListing,"actionList[0].sortDate",!1),self.actionPlanMap[tempListing[i].type]=orgListing,orgListing=null;break;case"Todo":for(var kk=0;kk<tempListing[i].tasks.length;kk++)tempListing[i].tasks[kk].completed?self.todoObj.completedTasks.push(tempListing[i].tasks[kk]):self.todoObj.incompleteTasks.push(tempListing[i].tasks[kk]);self.todoObj.incompleteTasks.length&&self.todoObj.incompleteTasks.length>2&&(self.todoObj.remainingTasks=self.todoObj.incompleteTasks.length-2);break;case"CompetencyEvaluation":for(var competencyListing=tempListing[i].requests,j=0;j<competencyListing.length;j++)if("CompetencyEvaluation"===competencyListing[j].taskType){var feedbackCompListing=self.actionPlanMap.Feedback;void 0!==feedbackCompListing&&feedbackCompListing.length||(feedbackCompListing=[]),feedbackCompListing.push(competencyListing[j]),self.actionPlanMap.Feedback=feedbackCompListing,feedbackCompListing=null}else self.competencyNotification=angular.copy(competencyListing[j]),self.competencyNotification.showPeerRating=!1,self.competencyNotification.showManagerRating=!1,"CompetencyEvaluationInitiateManagerPeer"!==self.competencyNotification.taskType&&"CompetencyEvaluationInitiate"!==self.competencyNotification.taskType||(self.competencyNotification.showPeerRating=!0,self.competencyNotification.showManagerRating=!0),"CompetencyEvaluationInitiateSelfPeer"===self.competencyNotification.taskType&&(self.competencyNotification.showPeerRating=!0),"CompetencyEvaluationInitiateManagerSelf"!==self.competencyNotification.taskType&&"CompetencyEvaluationInitiateManager"!==self.competencyNotification.taskType||(self.competencyNotification.showManagerRating=!0),self.competencyNotification.title="Initiate Competency Evaluation",self.competencyNotification.description=$rootScope.pullInterNationalization("taskList.competency.CompetencyEvaluationInitiate.description"),"CompetencyEvaluationSelf"===self.competencyNotification.taskType&&(self.competencyNotification.title=$rootScope.pullInterNationalization("taskList.competency.CompetencyEvaluationSelf.title"),self.competencyNotification.description=$rootScope.pullInterNationalization("taskList.competency.CompetencyEvaluationSelf.description"));competencyListing=[];break;case"Pulse":self.pulseNotification=tempListing[i];break;default:var feedbackListing=self.actionPlanMap.Feedback;void 0!==feedbackListing&&feedbackListing.length||(feedbackListing=[]),feedbackListing.push(tempListing[i]),self.actionPlanMap.Feedback=feedbackListing,feedbackListing=null}if(void 0!==self.actionPlanMap.Feedback){for(var tempFeedbackListing=self.actionPlanMap.Feedback,feed=0;feed<tempFeedbackListing.length;feed++)null!==tempFeedbackListing[feed].dueBy?tempFeedbackListing[feed].sortDate=formatDate(tempFeedbackListing[feed].dueBy):tempFeedbackListing[feed].sortDate=formatDate(tempFeedbackListing[feed].createdOn),tempFeedbackListing[feed].dueBy=formatDate(tempFeedbackListing[feed].dueBy,!0),tempFeedbackListing[feed].createdOn=formatDate(tempFeedbackListing[feed].createdOn,!0),"Feedback"===tempFeedbackListing[feed].type?tempFeedbackListing[feed].id=1:"BlueprintFeedback"===tempFeedbackListing[feed].type?(tempFeedbackListing[feed].type=$rootScope.pullInterNationalization("actionPlan.tasks.bf"),tempFeedbackListing[feed].id=2):"BlueprintApproval"===tempFeedbackListing[feed].type?(tempFeedbackListing[feed].type=$rootScope.pullInterNationalization("actionPlan.tasks.bp"),tempFeedbackListing[feed].id=3):"CompetencyEvaluation"===tempFeedbackListing[feed].type?(tempFeedbackListing[feed].type=$rootScope.pullInterNationalization("actionPlan.tasks.comp"),tempFeedbackListing[feed].id=4):"PrismLens"===tempFeedbackListing[feed].type&&(tempFeedbackListing[feed].type=$rootScope.pullInterNationalization("actionPlan.tasks.lens"),tempFeedbackListing[feed].id=5);tempFeedbackListing=$filter("orderBy")(tempFeedbackListing,"sortDate",!1),tempFeedbackListing.length&&tempFeedbackListing.length>2?tempFeedbackListing.remainingTasks=tempFeedbackListing.length-2:tempFeedbackListing.remainingTasks=0,self.actionPlanMap.Feedback=tempFeedbackListing}null!==self.competencyNotification&&($localStorage.set("competencyObj",self.competencyNotification),$localStorage.set("competencyAlertType",self.competencyNotification.taskType))}var self=this;self.actionPlanMap={},self.parentPage="",self.todoForm={},self.competencyNotification=null,self.pulseNotification=null,self.responseAvailable=!1,self.orgActionList=[],self.pageView="listing",self.taskData=null,self.taskType="",self.selectedTab="tasks",self.todoObj={},self.deleteOptions="",self.newTodoEntry="",self.inputRequired=!1,self.displayOrgGraph=!1,self.completedPercent=0,self.dataSorted=!1,self.tempData=null,self.sortType=$rootScope.pullInterNationalization("actionPlan.module.feedback.filters.displayLabel1"),self.ertiListing=[],self.currentSlide=0,self.prevSlide=-1,self.nextSlide=1,self.showConfirmBox=!1,self.learningProgram={},self.lpTask={},self.taskList=[],self.currentActionTask=0,self.completedActionTask=-1,self.currentActionIndex=0,self.progressBar=null,self.completedTaskCount=0,self.remainingTaskCount=0,self.objDestroyed=!1,self.progressMap={},self.progressBar=null,self.ertiSlider=null,self.init=init,self.saveTodo=saveTodo,self.goBackToListing=goBackToListing,self.displayDetail=displayDetail,self.feedbackRequestAction=feedbackRequestAction,self.redirectToCompetency=redirectToCompetency,self.redirectToPulse=redirectToPulse,self.deleteModal=deleteModal,self.deleteTodo=deleteTodo,self.markTodo=markTodo,self.updateTodo=updateTodo,self.updateTabView=updateTabView,self.sortData=sortData,self.closeModal=closeModal,self.prepareActionPlanData=prepareActionPlanData,self.prevErti=prevErti,self.nextErti=nextErti,self.displayErtiDetail=displayErtiDetail,self.displayConfirmBox=displayConfirmBox,self.markCompletion=markCompletion,self.previewMedia=previewMedia,self.redirectToLP=redirectToLP;var updateLocalStorageTasks=function(obj){var todoLists=$localStorage.get("todoListing");sharedProperties.spilceIndexWithBreak(todoLists,"type","Todo"),todoLists.push(obj),$localStorage.set("todoListing",todoLists)},handleRedirects=function(url,type){"dashboard"===self.parentPage?sharedProperties.fireAnalyticsEvent("Action Plan | Click "+type+" request from dashboard","N/A"):sharedProperties.fireAnalyticsEvent("Action Plan | Click "+type+" request from side panel","N/A"),window.open(url,"_blank").focus(),self.pageView="listing"},redrawGraph=function(percentageVal){var bar=new ProgressBar.Line(".lp-progress-linear",{strokeWidth:10,easing:"easeInOut",duration:1400,color:sharedProperties.whiteLabelColorCodes("sp-icon-color").color,trailColor:"#ccc",trailWidth:10,svgStyle:{width:"100%",height:"100%"},text:{style:{color:"#999",position:"absolute",right:"0",top:"30px",padding:0,margin:0,transform:null},autoStyleContainer:!1},step:function(state,bar){bar.setText(Math.round(100*bar.value())+" %")}});bar.animate(percentageVal.toFixed(2)),self.progressBar=bar},pulseTaskCheck=function(){"true"===$localStorage.get("pulseDone")&&sharedProperties.growlMessage($rootScope.pullInterNationalization("dashboard.pulse.completion"))&&$localStorage.remove("pulseDone")},calculateEstimatedTime=function(totalMin,hour,min){return{min:totalMin%60,hour:Math.floor(totalMin/60)}},getErtiListing=function(){var randomValue=(new Date).getTime();ajaxService.getAjaxResponse({url:"/sp/goals/getUserGoals?rand="+randomValue,method:"get"}).then(function(response){if("true"===response.Success){self.responseAvailable=!0,self.ertiListing=response.userGoal;for(var zz=0;zz<self.ertiListing.length;zz++)self.progressMap[self.ertiListing[zz].id]=self.ertiListing[zz]}else null!==response.error&&sharedProperties.ajaxError(response.error)})};jQuery(function($){var currentVal="",currentIndex=0;$("body").on("focusin",".todo-task-entry",function(){currentVal=$(this).val(),currentIndex=$(this).attr("id").substring(5)}),$("body").on("focusout",".todo-task-entry",function(){""!==$(this).val().trim()&&$(this).val()!==currentVal?self.updateTodo(currentIndex):$(this).val(currentVal)}),$("body").on("click touchend",".modal-backdrop",function(){$scope.$apply(function(){self.closeModal()})}),$(document).keyup(function(e){27===e.keyCode&&$scope.$apply(function(){self.closeModal()})})});var formatDate=($scope.$on("actionPlanSSE",function(e,data){if(null===data)return!0;$scope.$apply(function(){processSSEData.processData(self,data)})}),function(input,display){if(""===input||null===input||void 0===input)return null;var year=input[0],month=input[1].toString().length<2?"0"+input[1]:input[1],day=input[2].toString().length<2?"0"+input[2]:input[2],formatDate=new Date(year+"-"+month+"-"+day);return display?$filter("date")(new Date(formatDate),"MMM dd, yyyy"):formatDate}),calculatePastDue=function(input){if(""===input||null===input||void 0===input)return null;var year=input[0],month=input[1].toString().length<2?"0"+input[1]:input[1],day=input[2].toString().length<2?"0"+input[2]:input[2],formatDate=new Date(year+"-"+month+"-"+day);return formatDate<new Date?$rootScope.pullInterNationalization("actionPlan.module.lp.pastDue"):$filter("date")(new Date(formatDate),"MMM dd, yyyy")};window.addEventListener("storage",function(e){"todoListing"===e.key&&$scope.$apply(function(){self.prepareActionPlanData($localStorage.get("todoListing"))})}),jQuery(function($){$("body").on("click",".detail-entry a.lp-link, .detail-entry a.lp-panel-link",function(event){event.preventDefault();var redirectUrl=$(this).attr("href");"dashboard"!==self.parentPage||$rootScope.showActionPanel?sharedProperties.fireAnalyticsEvent("Action Plan | Click Learning Program step from side panel","N/A"):sharedProperties.fireAnalyticsEvent("Action Plan | Click Learning Program step from dashboard","N/A"),window.location.href=redirectUrl})}),window.addEventListener("popstate",function(e){$("#notesModal").length&&$scope.$apply(function(){self.closeModal()})})};return controller.$inject=["$scope","$rootScope","$filter"],{restrict:"EA",link:function($scope,$element,$attrs){$scope.parentPage=$attrs.parentPage,$templateRequest("/sp/resources/html/"+$attrs.urlSrc).then(function(html){var template=angular.element(html);$element.append(template),$compile(template)($scope)})},controller:controller,controllerAs:"actionCtrl",bindToController:!0}}angular.module("spApp").directive("actionPlan",actionPlan),actionPlan.$inject=["$compile","$templateRequest","sharedProperties","$localStorage","actionPlanService","ngDialog","processSSEData","ajaxService","$timeout"];
angular.module("spApp").directive("bookmarkPanel",["$rootScope","ajaxService","$localStorage","sharedProperties","$q",function($rootScope,ajaxService,$localStorage,sharedProperties,$q){return{restrict:"EA",replace:!0,templateUrl:function(element,attrs){return"/sp/resources/html/"+attrs.urlSrc},link:function(scope,element,attrs){var promise,self=scope;self.bookmarks=[],function(){var deferred=$q.defer();promise||(ajaxService.getAjaxResponse({url:"/sp/tracking/getAllBookMarkedArticles",method:"get"}).then(function(response){"true"===response.Success&&(self.bookmarks=response.articles)}),promise=deferred.promise)}()}}}]);
function editProfileWidget($localStorage,ajaxService,$timeout,sharedProperties,$rootScope,ngDialog){return{restrict:"EA",templateUrl:function(element,attrs){return attrs.urlSrc||"/sp/resources/html/common/edit-profile.html"},link:function(scope,element,attrs,$ctrl){function getUserDetail(){ajaxService.getAjaxResponse({url:serviceApis.getUserDetail,data:$.param({userEmail:vm.signedInUser.member.email}).replace(/%40/g,"@")}).then(function(response){"true"===response.Success&&(vm.userProfileBackup=angular.copy(response),vm.profile=angular.copy(response.profileForm),vm.profileSummary=angular.copy(response.userSummary),null!==response.address?(vm.profile.country="USA"===response.address.country?"US":response.address.country,vm.stateCheck.forSelectedCountry=vm.profile.country,vm.profile.address1=response.address.addressLine1,vm.profile.address2=response.address.addressLine2,vm.profile.city=response.address.city,vm.profile.state=response.address.state,vm.profile.zip=response.address.zipCode,vm.profile.state=response.address.state):(vm.profile.country="default",vm.stateCheck.forSelectedCountry="default",vm.profile.address1=null,vm.profile.address2=null,vm.profile.city=null,vm.profile.state=null,vm.profile.zip=null),null===vm.profile.gender&&(vm.profile.gender="default"),0===vm.profile.year&&(vm.profile.year="default"),0===vm.profile.month&&(vm.profile.month="default"),0===vm.profile.day&&(vm.profile.day="default"),vm.ready=!0)})}var vm=scope,serviceApis={getUserDetail:"/sp/admin/user",deleteImage:"/sp/admin/user/deleteImage",updateProfile:"/sp/updateProfile",changePassword:"/sp/changePassword"},mortalUrl={deleteImage:"/sp/resources/html/admin/account/delete-image-modal.html"};vm.signedInUser=$localStorage.get("loggegdInProfile"),vm.userGroupList=[],vm.imageEditBox=!1,vm.ready=!1,vm.stateCheck={},vm.profile={},vm.formStatus={},vm.userProfileBackup={},vm.pageView="home",vm.enableBtns=!1,vm.disableForm=!0,vm.resetPwdError=!1,vm.resetPwdFormError={validationErrors:!1},vm.resetPwd={},vm.pwdFlag=!1,vm.deleteImageModal=function(imageType){vm.imageEditBox=!1,ngDialog.open({template:mortalUrl.deleteImage,scope:vm})},vm.deleteImage=function(){ajaxService.getAjaxResponse({url:serviceApis.deleteImage}).then(function(response){"true"===response.Success?(ngDialog.close("ngdialog1"),sharedProperties.growlMessage($rootScope.pullInterNationalization("growl.imageDeleted")),$timeout(function(){$localStorage.remove("loggegdInProfile"),window.location.reload()},1e3)):sharedProperties.ajaxError($rootScope.pullInterNationalization("mediaManager.growlMessage.fail"))})},vm.resetPasswordForm=function(){vm.imageEditBox=!1,vm.resetPwdError=!1,vm.resetPwdFormError.validationErrors=!1,document.getElementById("reset-pwd-form").reset(),vm.goto("change")},vm.addressFormReset=function(t){vm.profile.address1=null,vm.profile.address2=null,vm.profile.city=null,vm.profile.zip=null,vm.stateCheck.forSelectedCountry=vm.profile.country,"US"===vm.stateCheck.forSelectedCountry?vm.profile.state="default":vm.profile.state=null},vm.cancelAndUpdate=function(){var _response=angular.copy(vm.userProfileBackup);vm.profile=_response.profileForm,vm.profileSummary=_response.userSummary,null!==_response.address?(vm.profile.country="USA"===_response.address.country?"US":_response.address.country,vm.stateCheck.forSelectedCountry=vm.profile.country,vm.profile.address1=_response.address.addressLine1,vm.profile.address2=_response.address.addressLine2,vm.profile.city=_response.address.city,vm.profile.state=_response.address.state,vm.profile.zip=_response.address.zipCode,vm.profile.state=_response.address.state):(vm.profile.country="default",vm.stateCheck.forSelectedCountry="default",vm.profile.address1=null,vm.profile.address2=null,vm.profile.city=null,vm.profile.state=null,vm.profile.zip=null),null===vm.profile.gender&&(vm.profile.gender="default"),0===vm.profile.year&&(vm.profile.year="default"),0===vm.profile.month&&(vm.profile.month="default"),0===vm.profile.day&&(vm.profile.day="default")},vm.saveAndUpdate=function(formData,formName){var empCountErr;empCountErr=!(void 0!==formData.numberOfEmployees&&formData.numberOfEmployees<1);var vCount=0;vm.formStatus.sumbit=!1;for(var k in formData)if("object"==typeof formData[k])for(var l in formData[k])"default"!==formData[k][l]&&"default1"!==formData[k][l]&&0!==formData[k][l]&&0!==formData[k][l]||vCount++;else"default"!==formData[k]&&"default1"!==formData[k]&&0!==formData[k]&&0!==formData[k]||vCount++;this[formName].$valid&&0===vCount&&empCountErr?(vm.disableCompanyEditing=!0,vm.disableProfileEditing=!0,vm.disableIndividualEditing=!0,vm.disableUserProfileEditing=!0,ajaxService.getAjaxResponse({url:serviceApis.updateProfile,data:$.param(formData).replace(/address%5B/g,"").replace(/%5D/g,"").replace(/%2C/g,",")}).then(function(response){"true"===response.Success&&($localStorage.remove("loggegdInProfile"),window.location.reload())})):vm.formStatus.sumbit=!0},vm.updatePwdFlag=function(){$("#newPassword").val().length>=8&&(vm.pwdFlag=sharedProperties.passwordCriterionCheck($("#newPassword").val()))},vm.processPasswordReset=function(fData){vm.resetPwdFormError.validationErrors=!1,vm.resetPwdError=!1,vm.pwdFlag=!1,vm.pwdFlag=sharedProperties.passwordCriterionCheck($("#newPassword").val()),this.resetPwdForm.$valid&&vm.pwdFlag?ajaxService.getAjaxResponse({url:serviceApis.changePassword,data:$.param({oldPassword:fData.oldPassword,newPassword:fData.newPassword})}).then(function(response){if("true"===response.Success)vm.resetPwdError=!1,document.getElementById("reset-pwd-form").reset(),vm.pageView="home",sharedProperties.growlMessage($rootScope.pullInterNationalization("growl.passwordChange"));else{vm.resetPwdFormError.validationErrors=!1,vm.resetPwdError=!0;for(var key in response.error)vm.resetPwdErrorMsg=response.error[key]}}):(vm.resetPwdError=!1,this.resetPwdFormError.validationErrors=!0)},vm.goto=function(pointer){vm.pageView=pointer},function(){vm.countries=$localStorage.get("countriesFullList").countries,getUserDetail()}()}}}editProfileWidget.$inject=["$localStorage","ajaxService","$timeout","sharedProperties","$rootScope","ngDialog"],angular.module("spApp").directive("editProfileWidget",editProfileWidget);
function ertiPanel($compile,$templateRequest,sharedProperties,$localStorage,actionPlanService,ngDialog){var controller=function($scope,ajaxService,$localStorage,$state,$q,sharedProperties,$filter,$rootScope,ngDialog,$timeout,$sce){function redirectToListing(){$rootScope.ertiDetailView=!1,self.pageView="listing"}function setRootScopeView(){$rootScope.ertiDetailView=!0}function infinteScroll(arg){self.returnArticleListings(arg)}function returnArticleListings(pageSize){if(!self.allArticlesListingsMaster.length)return!0;var result=self.masterCopy?self.allArticlesListingsMaster:self.allArticlesListings;self.allArticlesListings=result,self.pageSetting.pageSize=pageSize,pageSize>=self.allArticlesListingsMaster.length&&(self.pageSetting.disabledInfinite=!0,self.pageSetting.pageSize=self.allArticlesListingsMaster.length),self.masterCopy=!0}function applyArticleFilterMobile(v,displayName){switch(self.articlesFilterStatus=!1,self.articleMediaFilters="ALL",self.filterLabel=displayName,v){case"all":self.applyArticleFilter("","",0,"auto",!1);break;case"mandatoryArticle":self.applyArticleFilter("mandatoryArticle",!0,3,"click",!1);break;case"articleRecommendedByUser":self.applyArticleFilter("articleRecommendedByUser",!0,4,"click",!1);break;case"articleBookmarked":self.applyArticleFilter("articleBookmarked",!0,5,"click",!1);break;case"userArticleStatus":self.applyArticleFilter("userArticleStatus","COMPLETED",6,"click",!1)}}function applyArticleFilterMedia(v){switch(self.articlesFilterStatus=!1,self.articlesFilter="",v){case"ALL":self.applyArticleFilter("","",0,"auto",!0);break;case"TEXT":self.applyArticleFilter("articleType","TEXT",7,"click",!0);break;case"VIDEO":self.applyArticleFilter("articleType","VIDEO",8,"click",!0);break;case"PODCAST":self.applyArticleFilter("articleType","PODCAST",9,"click",!0);break;case"SLIDESHARE":self.applyArticleFilter("articleType","SLIDESHARE",10,"click",!0)}}function applyArticleFilter(k,v,i,action,mediaType){if(self.showMoreLink&&"click"===action)ajaxService.getAjaxResponse({url:self.config.loadAllArticles,data:$.param({goalId:self.currentActive.goalId,memberEmail:$rootScope.noSelf})}).then(function(response){if("true"===response.Success){self.showMoreLink=!1,self.allArticlesListings=[],self.allArticlesListingsMaster=[],self.allArticlesListingsMaster=response.userArticles,self.allArticlesListings=angular.copy($scope.allArticlesListingsMaster),self.infinteScroll(response.userArticles.length),self.articlesFilterStatus=!1;var _params=[];self.articlesFilterSelected=i,0!==i?(_params[k]=v,self.articlesFilter=$filter("filter")(_params),self.articlesFilterStatus=!0,!1===mediaType&&(self.articleMediaFilters="ALL")):(self.articlesFilter="",self.articlesFilterStatus=!1,self.articleMediaFilters="ALL")}else null!==response.error&&sharedProperties.ajaxError(response.error)});else{self.articlesFilterStatus=!1;var _params=[];self.articlesFilterSelected=i,0!==i?(_params[k]=v,self.articlesFilter=$filter("filter")(_params),self.articlesFilterStatus=!0,!1===mediaType&&(self.articleMediaFilters="ALL")):(self.articlesFilter="",self.articlesFilterStatus=!1,self.articleMediaFilters="ALL")}}function showMobileHomePage(){self.showRightCol=!1,self.showMobileDD=!1}function changeGroup(){self.viewDetails(self.selectedGroup)}function prevDevStrategy(){jQuery("#devStrategy_"+self.currentIndex).hide(),self.currentIndex=self.currentIndex-1,jQuery("#devStrategy_"+self.currentIndex).fadeIn(1e3)}function nextDevStrategy(){jQuery("#devStrategy_"+self.currentIndex).hide(),self.currentIndex=self.currentIndex+1,jQuery("#devStrategy_"+self.currentIndex).fadeIn(1e3)}function loadAllArticles(){ajaxService.getAjaxResponse({url:self.config.loadAllArticles,data:$.param({goalId:self.currentActive.goalId,memberEmail:$rootScope.noSelf})}).then(function(response){"true"===response.Success?(self.showMoreLink=!1,self.allArticlesListings=[],self.allArticlesListingsMaster=[],self.applyArticleFilter("","",0,"auto"),self.allArticlesListingsMaster=response.userArticles,self.allArticlesListings=angular.copy($scope.allArticlesListingsMaster),self.infinteScroll(response.userArticles.length)):null!==response.error&&sharedProperties.ajaxError(response.error)})}function getPracticeGoalDetail(){ajaxService.getAjaxResponse({url:self.config.goalDetail,data:$.param({goalId:$localStorage.get("ertiId")})}).then(function(response){"true"===response.Success?(self.pageView="detail",self.currentIndex=0,self.showMoreLink=!0,self.articleMediaFilters="ALL",self.filterLabel=$rootScope.pullInterNationalization("practiceArea.Filter2"),self.goalsDetail=response.goalDetail,self.allArticlesListings=[],self.viewDetailsList=null,self.changeManageStrategy=!0,self.feedRequired=!0,self.goalsCompleted=[],self.articleBookmarks=[],self.articleLikes=[],self.articleLikesCount=[],self.applyArticleFilter("","",0,"auto"),self.allArticlesListingsMaster=self.goalsDetail.userGoalsDto.userArticlesProgress.length?self.goalsDetail.userGoalsDto.userArticlesProgress:[],self.allArticlesListings=angular.copy(self.allArticlesListingsMaster),self.currentActive.goalId=self.goalsDetail.id,self.currentActive.name=self.goalsDetail.name):null!==response.error&&sharedProperties.ajaxError(response.error)})}function viewDetails(group){self.viewDetailsListIndex=group,self.viewDetailsList=group in self.allNotesFeedbackData?self.allNotesFeedbackData[group]:null;var $enableSCroll=$(".overflow-enable");$enableSCroll.length&&$enableSCroll.scrollTop(0)}function viewDetailsIndexChange(i){i===self.openTabId?self.openTabId=-1:self.openTabId=i}function videoPopUp(url){sharedProperties.videoPopUp(url),"dashboard"===self.parentPage?sharedProperties.fireAnalyticsEvent("Action Plan | View ERT-i Dev strategy video from dashboard",self.currentActive.name+" | "+url):sharedProperties.fireAnalyticsEvent("Action Plan | View ERT-i Dev strategy video from side panel",self.currentActive.name+" | "+url)}function toggleToolTipMobile(i){self.winWidth<768&&self.activeToolTipId!==i?self.activeToolTipId=i:self.activeToolTipId=-1}var self=this,randomValue=(new Date).getTime();window.location.href;self.config={goals:"/sp/goals/getUserGoals?rand="+randomValue,goalDetail:"/sp/goals/getGoalDetail?memberEmail="+$rootScope.noSelf,videoPopUpDialog:"/sp/support/videoPopUp",loadAllArticles:"/sp/goals/getGoalArticles"},self.goalAvailable=[],self.pageType="individual",self.goalsDetail=[],self.currentActive={name:"",goalId:-1},self.btnEnable=!0,self.feedRequired=!0,self.viewDetailsList=null,self.responseAvailable=!1,self.getPracticeGoalDetail=getPracticeGoalDetail,self.viewDetails=viewDetails,self.viewDetailsIndexChange=viewDetailsIndexChange,self.videoPopUp=videoPopUp,self.showMobileDD=!1,self.ddSelectedText,self.winWidth=$(window).width(),self.winHeight=$(window).height()+100+"px",self.showRightCol=!1,self.showMoreLink=!0,self.loadAllArticles=loadAllArticles,self.pageView="detail",self.currentIndex=0,self.prevDevStrategy=prevDevStrategy,self.nextDevStrategy=nextDevStrategy,self.redirectToListing=redirectToListing,self.setRootScopeView=setRootScopeView,self.parentPage="",self.progressBar=null,self.changeGroup=changeGroup,self.openTabId,self.activeToolTipId=-1,self.toggleToolTipMobile=toggleToolTipMobile,self.showMobileHomePage=showMobileHomePage,self.pageTempaltes={note:"/sp/resources/html/goals/addNoteResponsive.html",feedback:"/sp/resources/html/goals/requestFeedbackResponsive.html",notification:"/sp/resources/html/goals/notesFeedbackOverlayResponsive.html",articlecomplete:"/sp/resources/html/goals/completedArticleResponsive.html",manageStratagies:"/sp/resources/html/goals/manageStratagiesResponsive.html"},self.allArticlesListings=[],self.allArticlesListingsMaster=[],self.pageSetting={pageSize:10,intialPageSize:10,disabledInfinite:!1},self.infinteScroll=infinteScroll,self.returnArticleListings=returnArticleListings,self.masterCopy=!0,self.articleBookmarks=[],self.articleLikes=[],self.articleLikesCount=[],self.articlesFilterSelected=0,self.articlesFilter="",self.applyArticleFilterMobile=applyArticleFilterMobile,self.applyArticleFilter=applyArticleFilter,self.applyArticleFilterMedia=applyArticleFilterMedia,self.articleMediaFilters="ALL",self.filterLabel=$rootScope.pullInterNationalization("practiceArea.Filter2"),function(){self.getPracticeGoalDetail()}(),jQuery(function($){$("body").on("click touchstart",".event-practice-article a",function(event){event.preventDefault();var redirectUrl=$(this).attr("href");"dashboard"===self.parentPage?sharedProperties.fireAnalyticsEvent("Action Plan | Click ERT-i Article from dashboard",redirectUrl):sharedProperties.fireAnalyticsEvent("Action Plan | Click ERT-i Article from side panel",redirectUrl),window.location.href=redirectUrl})})};return controller.$inject=["$scope","ajaxService","$localStorage","$state","$q","sharedProperties","$filter","$rootScope","ngDialog","$timeout","$sce"],{restrict:"EA",link:function($scope,$element,$attrs){$templateRequest("/sp/resources/html/"+$attrs.urlSrc).then(function(html){var template=angular.element(html);$element.append(template),$compile(template)($scope)})},controller:controller,controllerAs:"ctrl",bindToController:!0}}angular.module("spApp").directive("ertiPanel",ertiPanel),ertiPanel.$inject=["$compile","$templateRequest","sharedProperties","$localStorage","actionPlanService","ngDialog"];
function imageModal($compile,$templateRequest,sharedProperties,$rootScope){var controller=function($scope){function closeModal(){$rootScope.showImageModal=!1,$("#imageModal").modal("hide"),sharedProperties.is_touch_supported()&&sharedProperties.is_iOS_device()&&!$("#notesModal").length&&!$("#mediaModal").length&&($("body").css("position",""),$("body").animate({scrollTop:self.scrollPos},0)),$(".side-panel").length&&$(".side-panel").css("display","block"),window.setTimeout(function(){($("#notesModal").length||$("#mediaModal").length)&&$("body").addClass("modal-open")},1e3)}function init(){$(".side-panel").length&&$(".side-panel").css("display","none"),window.setTimeout(function(){$("#imageModal").modal("show"),$("#imageModal").length&&(sharedProperties.is_touch_supported()&&sharedProperties.is_iOS_device()&&!$("#notesModal").length&&!$("#mediaModal").length&&(self.scrollPos=$("body").scrollTop(),$("body").css("position","fixed")),history.pushState({action:"modal"},"",window.location.href))},100),jQuery(function($){$("body").on("click touchend",".modal-backdrop",function(){$scope.$apply(function(){self.closeModal()})}),$(document).keyup(function(e){27===e.keyCode&&$scope.$apply(function(){self.closeModal()})})})}var self=this;self.init=init,self.closeModal=closeModal,self.scrollPos=0,window.addEventListener("popstate",function(e){$("#imageModal").length&&$scope.$apply(function(){self.closeModal()})})};return controller.$inject=["$scope"],{restrict:"EA",link:function($scope,$element,$attrs){$templateRequest("/sp/resources/html/"+$attrs.urlSrc).then(function(html){var template=angular.element(html);$element.append(template),$compile(template)($scope)})},controller:controller,controllerAs:"imageCtrl",bindToController:!0}}angular.module("spApp").directive("imageModal",imageModal),imageModal.$inject=["$compile","$templateRequest","sharedProperties","$rootScope"];
function mediaManager($compile,$templateRequest,sharedProperties,$rootScope,$localStorage,ajaxService,ngDialog,filterFilter,$filter){var controller=function($scope,$filter,filterFilter){function tagAdded(tag){self.tags.push(tag.name)}function tagRemoved(tag){self.tags.splice(self.tags.indexOf(tag.name),1)}function updateImage(formData){formData.tags=self.tags.toString();var _params={};if(self.uploadFormSubmitted=!1,self.uploadMediaForm.$valid){_params=formData;var options={url:self.serviceApis.updateImage,data:$.param(_params)};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?(sharedProperties.growlMessage("Media updated Successfully"),self.getAllMedia(),self.mediaView="listing"):sharedProperties.growlMessage("Image update failed.","<strong> Alert </strong>","glyphicon glyphicon-ban-circle")})}else self.uploadFormSubmitted=!0}function selectMedia(obj){$localStorage.set("mediaData",obj),$rootScope.$broadcast("mediaData",obj),self.closeModal()}function deleteImageModal(deleteId,imagePath){$scope.deleteId=deleteId,$scope.imagePath=imagePath,ngDialog.open({template:"/sp/resources/html/sysAdmin/media/delete-modal.html",scope:$scope})}function displayMedia(id){ajaxService.getAjaxResponse({url:self.serviceApis.getImage,data:$.param({id:id}),method:"POST"}).then(function(response){"true"===response.Success?(self.media={},self.media=response.mediaInfo,self.previewImage=self.media.url,self.mediaView="editMedia"):null!==response.error&&sharedProperties.ajaxError(response.error)})}function deleteImage(id,path){ajaxService.getAjaxResponse({url:self.serviceApis.deleteImage,data:$.param({imageId:id,imagePath:path})}).then(function(response){"true"===response.Success?(sharedProperties.spilceIndexWithBreak(self.masterMediaList,"id",id),self.mediaList=angular.copy(self.masterMediaList),ngDialog.close(),sharedProperties.growlMessage("Media Deleted Successfully")):null!==response.error&&sharedProperties.ajaxError(response.error)})}function resetResults(){self.searchText="",self.mediaTypes={image:!1,pdf:!1,ppt:!1,msdoc:!1,video:!1,web:!1,excel:!1}}function filterResults(type){""!==self.searchText?self.showClearSearchIcon=!0:self.showClearSearchIcon=!1;var resp=$filter("newMediaManagerFilter")(self.masterMediaList,self.mediaTypes,self.searchText,filterFilter);self.mediaList=[],self.mediaList=angular.copy(resp)}function clearSearch(){""!==self.searchText&&(self.showClearSearchIcon=!1,self.searchText=""),self.filterResults()}function previewMedia(url,type){if("Video"===type)sharedProperties.videoPopUp(url);else if("IMAGE"===type)$rootScope.showImageModal=!0,$rootScope.modalImageUrl=url;else{var win=window.open(url,"_blank");win.focus()}}function getAllMedia(){ajaxService.getAjaxResponse({url:self.serviceApis.getAllMedia,method:"GET"}).then(function(response){"true"===response.Success?(self.responseAvailable=!0,self.masterMediaList=response.mediaList,self.mediaList=angular.copy(self.masterMediaList)):null!==response.error&&sharedProperties.ajaxError(response.error)})}function closeModal(){$rootScope.showMediaManager=!1,$("#mediaModal").modal("hide"),sharedProperties.is_touch_supported()&&sharedProperties.is_iOS_device()&&($("body").css("position",""),$("body").animate({scrollTop:self.scrollPos},0)),self.clearMedia()}function clearMedia(){self.media={},self.previewImage="/sp/resources/images/placeholder.png",self.tags=[];var mediaPick=jQuery("input:file");mediaPick.replaceWith(mediaPick.val("").clone(!0))}function changeMediaView(view){self.mediaView=view,self.resetResults(),self.filterResults(),self.clearMedia(),self.showMobMenu=!1}function openFilePicker(){filepicker.setKey($rootScope.fileStackAPIKey),filepicker.pick({mimetypes:"*/*",container:"modal",services:["BOX","DROPBOX","GOOGLE_DRIVE","SKYDRIVE"],maxSize:10485760,language:sharedProperties.provideVendorSpecificLocale("fileStack")},function(Blob){var fileData=angular.copy(Blob);fileData.name=fileData.filename,fileData.altText=fileData.filename,$rootScope.$broadcast("mediaData",fileData),$scope.$apply(function(){self.closeModal()})},function(FPError){$scope.$apply(function(){"upload"!==self.mediaView&&"uploadSubmit"!==self.mediaView||(self.clearMedia(),self.mediaView="upload"),"listing"===self.mediaView&&(self.resetResults(),self.filterResults())})})}function uploadMediaFile(){if(self.uploadFormSubmitted=!1,self.uploadMediaForm.$valid&&void 0!==self.media.file.name){var formObj=new FormData(document.getElementById("mediaForm"));"IMAGE"===self.media.mediaType&&(formObj.append("width",self.media.width),formObj.append("height",self.media.height)),formObj.append("file",self.media.file,self.media.file.name),formObj.append("mediaType",self.media.mediaType),formObj.append("tags",self.tags.toString()),-1!==self.orgURLs.indexOf(window.location.pathname)?(formObj.append("companyId",$localStorage.get("companyId").id),formObj.append("companyName",$localStorage.get("companyId").name)):(formObj.append("companyId","SurePeople"),formObj.append("companyName","SurePeople")),"dialogView"===self.parentPage&&formObj.append("status","Active");var multiPartRequest=$.ajax({url:self.serviceApis.uploadMedia,type:"POST",data:formObj,processData:!1,contentType:!1,beforeSend:function(){$rootScope.$broadcast("httpLoaderStart")}});multiPartRequest.done(function(response){"true"===response.success.Success?(sharedProperties.growlMessage($rootScope.pullInterNationalization("mediaManager.growlMessage.success")),$rootScope.$broadcast("httpLoaderEnd"),"dialogView"===self.parentPage?($localStorage.set("mediaData",response.success.mediaInfo),$rootScope.$broadcast("mediaData",response.success.mediaInfo),$scope.$apply(function(){self.closeModal()})):(self.getAllMedia(),self.mediaView="listing")):(sharedProperties.growlMessage($rootScope.pullInterNationalization("mediaManager.growlMessage.fail"),"<strong> Alert </strong>","glyphicon glyphicon-ban-circle"),$rootScope.$broadcast("httpLoaderEnd"),$scope.$apply(function(){self.closeModal()}))}),multiPartRequest.fail(function(jqXHR,textStatus){sharedProperties.growlMessage($rootScope.pullInterNationalization("mediaManager.growlMessage.fail"),"<strong> Alert </strong>","glyphicon glyphicon-ban-circle"),$rootScope.$broadcast("httpLoaderEnd"),$scope.$apply(function(){self.closeModal()})})}else self.uploadFormSubmitted=!0}function init(){self.getAllMedia(),self.parentPage=$scope.parentPage,sharedProperties.detectIE()&&(self.ieMode=!0),window.setTimeout(function(){$("#mediaModal").modal("show"),$("#mediaModal").length&&(sharedProperties.is_touch_supported()&&sharedProperties.is_iOS_device()&&(self.scrollPos=$("body").scrollTop(),$("body").css("position","fixed")),"spAdminView"===self.parentPage&&$(".modal-backdrop").css("position","relative"),"dialogView"===self.parentPage&&history.pushState({action:"modal"},"",window.location.href))},200),$("body").on("click touchend",".modal-backdrop",function(){"dialogView"===self.parentPage&&$scope.$apply(function(){self.closeModal()})}),$(document).keyup(function(e){27===e.keyCode&&"dialogView"===self.parentPage&&$scope.$apply(function(){self.closeModal()})}),$("body").on("change","input:file",function(e){if(this.files[0].size>self.maxFileSize)return sharedProperties.growlMessage($rootScope.pullInterNationalization("mediaManager.growlMessage.alert"),"","glyphicon glyphicon-ban-circle"),!1;if(self.mediaView="uploadSubmit",self.media.file=this.files[0],self.media.mediaType=sharedProperties.mapMediaType(this.files[0].type),self.media.status="Active",$scope.$apply(),"IMAGE"===self.media.mediaType){var fr=new FileReader;fr.onload=function(){var img=new Image;img.onload=function(){self.media.width=img.width,self.media.height=img.height},img.src=fr.result,$scope.$apply(function(){self.previewImage=fr.result})},fr.readAsDataURL(self.media.file)}})}var self=this;self.scrollPos=0,self.mediaView="listing",self.mobileView=$(window).width()<768,self.serviceApis={uploadMedia:"/sp/media/save",getAllMedia:"/sp/media/getAll",deleteImage:"/sp/sysAdmin/media/delete",updateImage:"/sp/sysAdmin/media/update",getImage:"/sp/sysAdmin/media/get"},self.media={},self.hasValidationErrors=!1,self.uploadFormSubmitted=!1,self.responseAvailable=!1,self.imageData=null,self.media.status="Active",self.tags=[],self.previewImage="/sp/resources/images/placeholder.png",self.orgURLs=["/sp/admin/account/actionPlan/updatePage","/sp/admin/account/actionPlan/createPage","/sp/sysAdmin/actionPlan/updateOrgPlan","/sp/sysAdmin/actionPlan/createOrgPlan"],self.masterMediaList=[],self.mediaList=[],self.maxFileSize=10485760,self.filterView="List",self.showClearSearchIcon=!1,self.searchText="",self.mediaTypes={image:!1,pdf:!1,ppt:!1,msdoc:!1,video:!1,web:!1,excel:!1},self.showMobMenu=!1,self.parentPage="",self.ieMode=!1,self.closeModal=closeModal,self.init=init,self.changeMediaView=changeMediaView,self.openFilePicker=openFilePicker,self.uploadMediaFile=uploadMediaFile,self.clearMedia=clearMedia,self.getAllMedia=getAllMedia,self.selectMedia=selectMedia,self.previewMedia=previewMedia,self.filterResults=filterResults,self.clearSearch=clearSearch,self.resetResults=resetResults,self.deleteImage=deleteImage,self.deleteImageModal=deleteImageModal,self.displayMedia=displayMedia,self.updateImage=updateImage,self.tagAdded=tagAdded,self.tagRemoved=tagRemoved,window.addEventListener("popstate",function(e){$("#mediaModal").length&&"dialogView"===self.parentPage&&$scope.$apply(function(){self.closeModal()})})};return controller.$inject=["$scope","$filter","filterFilter"],{restrict:"EA",link:function($scope,$element,$attrs){$scope.parentPage=$attrs.parentPage,$templateRequest("/sp/resources/html/"+$attrs.urlSrc).then(function(html){var template=angular.element(html);$element.append(template),$compile(template)($scope)})},controller:controller,controllerAs:"mediaCtrl",bindToController:!0}}angular.module("spApp").directive("mediaManager",mediaManager),mediaManager.$inject=["$compile","$templateRequest","sharedProperties","$rootScope","$localStorage","ajaxService","ngDialog","filterFilter","$filter"];
function miniPolls($compile,$templateRequest,sharedProperties,$timeout,newsFeedService,basicService,ngDialog,$q,$sce){function miniPollsCtrl($compile,$templateRequest,$rootScope,sharedProperties,$timeout,$scope,newsFeedService,basicService,ngDialog,$q,$sce){var _this=this;_this.shareUpdate=$scope.$parent.notesCtrl,_this.miniPollsForm={},_this.pollDetails={},_this.pollDetails.selectionType="SingleSelect",_this.pollDetails.multiLabel=[],_this.pollDetails.hideResults=!1,_this.pollDetails.sendNotifications=!1,_this.newPolljson={},_this.multiOptsConfig=[{id:0,lName:"multiLabel",phName:$rootScope.pullInterNationalization("createPollsCont.optLabel"),required:!0,deleteBtn:!1},{id:1,lName:"multiLabel",phName:$rootScope.pullInterNationalization("createPollsCont.optLabel"),required:!0,deleteBtn:!1}],_this.miniPollsForm.submitted=!1,_this.showInstruction=!1,_this.pollType=-1,_this.maxOptions=5,_this.minOptions=2,_this.postView=!1,_this.hexChar=$sce.trustAsHtml(sharedProperties.processRatingHex(1,"minipolls")),_this.validateNewPoll=function(){if(_this.miniPollsForm.submitted=!1,"MultipleOptions"===_this.pollDetails.type){if(_this.pollDetails.multiLabel.toString().replace(",,",",").split(",").length<2)return _this.miniPollsForm.submitted=!0,void(_this.optionsLengthError=!0)}if(_this.miniPollsForm.$valid&&-1!==_this.pollType){var tempDt,momentDt=null;void 0!==_this.pollDetails.endDate&&(tempDt=moment(_this.pollDetails.endDate,"MM/DD/YYYY"),momentDt=[parseInt(tempDt.format("Y")),parseInt(tempDt.format("M")),parseInt(tempDt.format("D")),0,0,0,0]),_this.miniPollsForm.submitted=!1,_this.newPolljson={miniPolls:{question:_this.pollDetails.question,instructionStr:_this.pollDetails.instructionStr,type:_this.pollDetails.type,selectionType:_this.pollDetails.selectionType,endDate:momentDt,options:"MultipleOptions"===_this.pollDetails.type?_this.pollDetails.multiLabel.filter(function(e){return""!==e&&null!==e&&void 0!==e}):["1","2","3","4","5"],hideResults:_this.pollDetails.hideResults,sendNotificationEmail:_this.pollDetails.sendNotifications,result:null}},_this.postView=!0,_this.focusOnShare()}else _this.miniPollsForm.submitted=!0},_this.closePollsView=function(action){_this.shareUpdate.miniPollsView=!1,_this.focusOnShare()},_this.focusOnShare=function(){$("html,body").animate({scrollTop:$(".share-update").scrollTop()-80},200)},_this.delMultiOpt=function(id){id>=_this.minOptions&&(_this.multiOptsConfig.splice(id,1),_this.pollDetails.multiLabel.splice(id,1))},_this.addMultiOpt=function(id){if(id<_this.maxOptions){var newInput={id:id,lName:"multiLabel",phName:"Option",required:!0,deleteBtn:!0};_this.multiOptsConfig.push(newInput),_this.miniPollsForm.submitted=!1}},_this.setupQuestionsDD=function(){var ddId="#"+_this.uniqueId+"_questionsDD";$timeout(function(){Tipped.create(ddId,$(ddId).next()[0],{position:"bottomLeft",padding:!1,showOn:"click",stem:!1,hideOn:"click",hideOnClickOutside:!0})},100)},_this.setQuestionType=function(opt){0===opt?(_this.pollDetails.type="MultipleOptions",_this.pollType=0,_this.pollDetails.multiLabel=[]):1===opt?(_this.pollDetails.type="Scale",_this.pollType=1):(_this.pollDetails.type="",_this.pollType=-1),_this.miniPollsForm.submitted=!1,$("#"+_this.uniqueId+"_questionsDD").trigger("click")},_this.rootScope=function(msg){return $rootScope.pullInterNationalization(msg)},_this.setupMiniPoll=function(){switch(_this.parentDirective){case"shareNote":var postObj=_this.shareUpdate.postMessageObject;postObj.comment.miniPoll=_this.newPolljson.miniPolls,_this.shareUpdate.processMessage(postObj);break;case"groupDiscussion":"create"===_this.gdMode?_this.shareUpdate.saveGD(_this.newPolljson.miniPolls):_this.shareUpdate.updateGD(_this.newPolljson.miniPolls)}_this.closePollsView()},_this.initDtPicker=function(){$timeout(function(){moment.locale(sharedProperties.provideVendorSpecificLocale("datePicker")),$('input[name="endDate"]').daterangepicker({showDropdowns:!1,minDate:moment().add(1,"days").toDate(),maxDate:moment().add(14,"days").toDate(),locale:{format:"MMM D, YYYY"},alwaysShowCalendars:!0,singleDatePicker:!0,autoUpdateInput:!1,opens:"right"},function(start,end,label){$scope.$apply(function(){_this.pollDetails.endDate=start.format("MM/DD/YYYY")})})},500)}}function link($scope,$element,$attrs){$templateRequest("/sp/resources/html/"+$attrs.urlSrc).then(function(html){var template=angular.element(html);$element.append(template),$compile(template)($scope)})}return miniPollsCtrl.$inject=["$compile","$templateRequest","$rootScope","sharedProperties","$timeout","$scope","newsFeedService","basicService","ngDialog","$q","$sce"],{scope:{},restrict:"EA",link:link,controller:miniPollsCtrl,controllerAs:"_ctrl",bindToController:{parentDirective:"@",uniqueId:"@",gdMode:"@"}}}angular.module("spApp").directive("miniPolls",miniPolls),miniPolls.$inject=["$compile","$templateRequest","sharedProperties","$timeout","newsFeedService","basicService","ngDialog","$q","$sce"];
function notificationCenter($compile,$templateRequest,sharedProperties,$rootScope,$localStorage,notificationService){var controller=function($scope){function closeModal(){$rootScope.showNotifications=!1,$("#notifyModal").modal("hide"),$("body").css("overflow-y","visible"),$("body .sticky-bottom").show()}function init(){$rootScope.notifyCount=0,$localStorage.set("notifyCount",0),self.getAllNotifications(),window.setTimeout(function(){$("#notifyModal").modal("show"),$("#notifyModal").length&&(sharedProperties.fireAnalyticsEvent("Notifications | Click Bell Icon","N/A"),$("body .sticky-bottom").hide(),$("body").css("overflow-y","hidden"),history.pushState({action:"modal"},"",window.location.href))},200),jQuery(function($){$("body").on("click touchend",".modal-backdrop",function(){$scope.$apply(function(){self.closeModal()})}),$(document).keyup(function(e){27===e.keyCode&&$scope.$apply(function(){self.closeModal()})})})}function getAllNotifications(){self.notifications=[],notificationService.getAllNotifications().then(function(data){if(data.Success&&data.notifications){self.notifications=data.notifications;for(var i=0;i<self.notifications.length;i++){var tempObj=null;tempObj=notificationService.prepareNotifyIconAndUrl(self.notifications[i],"listing"),self.notifications[i].showIcon=tempObj.showIcon,self.notifications[i].icon=tempObj.icon,self.notifications[i].url=tempObj.url}}})}function markAsRead(obj){obj.read||notificationService.markAsRead(obj.id).then(function(data){data.Success&&sharedProperties.fireAnalyticsEvent("Notifications | Mark Read","N/A")}),self.mobileView?"GroupLead"!==obj.logActionType&&"WorkspacePulsePermission"!==obj.logActionType&&"SpectrumPermission"!==obj.logActionType&&"CompetencyAdminPermission"!==obj.logActionType&&"HiringAccount"!==obj.logActionType&&"PrimaryAccount"!==obj.logActionType&&(window.location.href=obj.url):window.location.href=obj.url}function resetNotificationCount(){notificationService.resetNotificationCount().then(function(data){data.Success&&console.log("Count Reset")})}var self=this;self.closeModal=closeModal,self.init=init,self.scrollPos=0,self.notifications=[],self.mobileView=$(window).width()<768,self.getAllNotifications=getAllNotifications,self.markAsRead=markAsRead,self.resetNotificationCount=resetNotificationCount;$scope.$on("notificationSSE",function(e,data){if(null===data)return!0;$scope.$apply(function(){self.getAllNotifications(),self.resetNotificationCount(),$rootScope.notifyCount=0,$localStorage.set("notifyCount",0)})});window.addEventListener("popstate",function(e){$("#notifyModal").length&&$scope.$apply(function(){self.closeModal()})})};return controller.$inject=["$scope"],{restrict:"EA",link:function($scope,$element,$attrs){$templateRequest("/sp/resources/html/"+$attrs.urlSrc).then(function(html){var template=angular.element(html);$element.append(template),$compile(template)($scope)})},controller:controller,controllerAs:"notifyCtrl",bindToController:!0}}angular.module("spApp").directive("notificationCenter",notificationCenter),notificationCenter.$inject=["$compile","$templateRequest","sharedProperties","$rootScope","$localStorage","notificationService"],angular.module("spApp").filter("replaceSpanClass",function(){return function(input){return null===input||void 0===input?"":input=input.replace("<span>",'<span class="sp-link-color">').replace("<span>",'<span class="sp-link-color">')}});
function siteHeaderController($scope,$rootScope,ajaxService,$localStorage,eventSourceProvider,processSSEData,$timeout,sharedProperties,localeLang,actionPlanService){$scope.userProfile={},$scope.selectedLang=localeLang.getCookie("sp-locale")||localeLang.getLang(!0).replace("-","_"),localeLang.override($scope.selectedLang.replace("_","-"),!1),sharedProperties.countriesList(),$scope.updateLang=function(param){localeLang.override(param,!0)};$scope.$on("groupDiscussion",function(e,data){if(null===data)return!0;$rootScope.gdActive||$scope.$apply(function(){processSSEData.processData(null,data)})}),$scope.$on("actionPlanSSE",function(e,data){if(null===data)return!0;"action"!==$rootScope.selectedNotesTab&&$scope.$apply(function(){processSSEData.processData(null,data)})}),$scope.$on("notificationSSE",function(e,data){if(null===data)return!0;$scope.$apply(function(){processSSEData.processData(null,data)})}),$scope.$on("badgeSSE",function(e,data){if(null===data)return!0;$scope.$apply(function(){$localStorage.remove("loggegdInProfile"),$scope.headerFn.getUserProfile()})});$scope.getProfileInfo=function(){this.getUserProfile=function(){ajaxService.getAjaxResponse({url:"/sp/signedIn/getProfile"}).then(function(response){if("true"===response.Success){$scope.userProfile=response.member;var userRoles=$scope.userProfile.roles;$rootScope.isSuperAdmin=-1!==userRoles.indexOf("SuperAdministrator"),$localStorage.set("loggegdInProfile",response),$rootScope.$broadcast("profileCreated"),$scope.headerFn.welcomeConsole($localStorage.get("loggegdInProfile").member.name),$rootScope.profileReady=!0,$localStorage.set("spSession",localeLang.getCookie("JSESSIONID"));var userCookie={};userCookie.uid=response.member.id,userCookie.cid=response.member.companyId,localeLang.setCookie("udata",JSON.stringify(userCookie),14,";path=/; domain=.surepeople.com")}})},this.welcomeConsole=function(name){-1!==navigator.userAgent.indexOf("Firefox")?console.log("\nWelcome %s to SUREPEOPLE\nLearn about our intelligent learning, development and hiring platform that drives performance and innovation for companies worldwide.\n",name):console.log("%cWelcome %s to SUREPEOPLE\n%c\nLearn about our intelligent learning, development and hiring platform that drives performance and innovation for companies worldwide.\n","color: #ff6633; font-size: 24px",name,"color: black; font-size: 18px")},this.init=function(){if(this.localstorageCheck("loggegdInProfile"))this.getUserProfile();else{var storedProfile=$localStorage.get("loggegdInProfile");$scope.userProfile=storedProfile.member,$rootScope.profileReady=!0;var userRoles=$scope.userProfile.roles;$rootScope.isSuperAdmin=-1!==userRoles.indexOf("SuperAdministrator"),this.welcomeConsole(storedProfile.member.name)}this.localstorageCheck("gdCount")?this.getUnreadDiscussionCount():$rootScope.unreadCount=$localStorage.get("gdCount"),this.localstorageCheck("taskCount")?$rootScope.taskCount=0:$rootScope.taskCount=$localStorage.get("taskCount"),this.localstorageCheck("notifyCount")?this.getUnreadNotifyCount():$rootScope.notifyCount=$localStorage.get("notifyCount"),this.localstorageCheck("marketingVersion")?this.getMarketingVersion():$rootScope.marketingVersion=$localStorage.get("marketingVersion")},this.getUnreadDiscussionCount=function(){ajaxService.getAjaxResponse({url:"/sp/gd/getUnreadCount"}).then(function(response){"true"===response.Success&&($localStorage.set("gdCount",response.unreadCount),$rootScope.unreadCount=$localStorage.get("gdCount"))})},this.getUnreadNotifyCount=function(){ajaxService.getAjaxResponse({url:"/sp/logs/getDashboardNotificationLogs"}).then(function(response){"true"===response.Success&&($localStorage.set("notifyCount",response.notifyCount),$rootScope.notifyCount=$localStorage.get("notifyCount"))})},this.getMarketingVersion=function(){ajaxService.getAjaxResponse({url:"/sp/marketing/get"}).then(function(response){if("true"===response.Success&&null!==response.marketing)$localStorage.set("marketingVersion",response.marketing.version),$rootScope.marketingVersion=response.marketing.version;else{var randomValue=Math.round(Math.random())<.5?"A":"B";ajaxService.getAjaxResponse({url:"/sp/marketing/save",data:$.param({version:randomValue})}).then(function(response){"true"===response.Success&&($localStorage.set("marketingVersion",randomValue),$rootScope.marketingVersion=randomValue)})}})},this.localstorageCheck=function(key){return null===$localStorage.get(key)}};var initSSE=function(){eventSourceProvider.initEventSource()};$scope.$on("updatePermissionSSE",function(e,data){if(null===data)return!0;$scope.$apply(function(){$scope.headerFn.getUserProfile(),$timeout(function(){$rootScope.$broadcast("updateUserInfoSSE")},100)})}),$scope.$on("updateNavigationSSE",function(e,data){if(null===data)return!0;$scope.$apply(function(){$scope.headerFn.getUserProfile(),$timeout(function(){$rootScope.$broadcast("updateUserInfoSSE")},100)})});!function(){$scope.headerFn=new $scope.getProfileInfo,$scope.headerFn.init(),initSSE();var notification=window.Notification||window.mozNotification||window.webkitNotification;void 0===notification?console.log("notification not supported"):notification.requestPermission(function(permission){});var receiveProfileData=$scope.$on("profileCreated",function(){receiveProfileData(),null===window.sessionStorage.getItem("loggedIn")&&$scope.selectedLang.toLowerCase()!==$localStorage.get("loggegdInProfile").locale.toLowerCase()&&(localeLang.override($localStorage.get("loggegdInProfile").locale,!0),window.sessionStorage.setItem("loggedIn",!0))})}()}function loginLangController(localeLang,sharedProperties){var _this=this;_this.selectedLang=localeLang.getCookie("sp-locale")||localeLang.getLang(!0).replace("-","_"),localeLang.override(_this.selectedLang.replace("_","-"),!1),_this.updateLang=function(param){localeLang.override(param,!0)},sharedProperties.countriesList()}angular.module("spApp").controller("siteHeaderController",siteHeaderController),siteHeaderController.$inject=["$scope","$rootScope","ajaxService","$localStorage","eventSourceProvider","processSSEData","$timeout","sharedProperties","localeLang","actionPlanService"],angular.module("spApp").controller("loginLangController",loginLangController),loginLangController.$inject=["localeLang","sharedProperties"];
angular.module("spApp").directive("ogDirective",["ajaxService","sharedProperties","$rootScope","$timeout",function(ajaxService,sharedProperties,$rootScope,$timeout){return{require:["ngModel"],scope:{reference:"=",ogProcessing:"=",clearUrl:"="},restrict:"A",link:function(scope,element,attrs,ngModel){function splitString(string,element){string=string.split(" ");for(var i=0;i<string.length;i++)if(regex.test(string[i])){getOgDetail(string[i],element);break}}function getOgDetail(matchedUrl,element){scope.ogProcessing=!0,ajaxService.getAjaxResponse({url:"/sp/utility/og",data:$.param({url:matchedUrl})}).then(function(response){void 0!==response.contentRef&&(scope.reference=response.contentRef,response.contentRef.valid&&!ngModel[0].$isEmpty(ngModel[0].$viewValue)&&(scope.clearUrl=ngModel[0].$modelValue.replace(matchedUrl,"")),element[0].focus(),$timeout(function(){$rootScope.$emit("lazyImg:refresh")},100)),scope.ogProcessing=!1})}var pattern=/https?:\/\/(?:www\.|(?!www))[^\s\.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,}/,regex=new RegExp(pattern),height=attrs.height;element.on("paste",function(){null===scope.reference.title&&setTimeout(function(){splitString(ngModel[0].$modelValue.replace(/\n/g," "),element)},100)}),height&&(element.on("keyup",function(){this.style.overflow="hidden",this.style.height=(height||0)+"px",this.style.height=this.scrollHeight+"px"}),scope.$watch(attrs.ngModel,function(newArr,oldArr){element[0].style.overflow="hidden",element[0].style.height=(height||0)+"px",element[0].style.height=(element[0].scrollHeight||height)+"px"},!0)),scope.$on("fileStackSuccess",function(e,data){scope.$apply(function(){var mediaType=sharedProperties.mapMediaType(data.fileData.mimetype);scope.reference.title=data.fileData.filename,scope.reference.description=null,scope.reference.fileStack=!0,scope.reference.authorSource=null,scope.reference.client=data.fileData.client,scope.reference.media=[],scope.reference.media.push({id:null,name:null,altText:null,tags:null,url:null,height:0,width:0,companyId:null,createdOn:null,status:null,mediaType:mediaType,companyName:null,linkText:null}),scope.reference.spFeature=null,scope.reference.url=data.fileData.url,scope.reference.newTab=!0,scope.reference.subTitle=null,scope.reference.imageUrl="Video"===mediaType?"/sp/resources/images/video-default.png":"IMAGE"===mediaType?data.fileData.url:"/sp/resources/images/media_default.jpg"}),element[0].focus(),$timeout(function(){$rootScope.$emit("lazyImg:refresh")},100)})}}}]);
function spTutorial($compile,$templateRequest){var controller=function($scope,$rootScope,sharedProperties,ajaxService,$q,basicService,$localStorage,$timeout){function getTutorial(){var deferred=$q.defer();return promise||(ajaxService.getAjaxResponse({url:self.serviceApis.getDetail,data:$.param({tutorialId:$localStorage.get("tutorialObj").id})}).then(function(response){if("true"===response.Success){self.tutorial=response.tutorial,self.tutorial.completedCount>self.tutorial.actionCount&&(self.tutorial.completedCount=self.tutorial.actionCount),self.cloneObject=angular.copy(self.tutorial);var completedPercent=Math.round(parseInt(self.tutorial.completedCount)/parseInt(self.tutorial.actionCount)*100);if(self.tutorial.completed=completedPercent,null!==$localStorage.get("tutState")){self.userState=JSON.parse($localStorage.get("tutState"));for(var i=0;i<self.tutorial.steps.length;i++)0===self.userState[i]?self.tutorial.steps[i].defaultOpen=!1:self.tutorial.steps[i].defaultOpen=!0}}else null!==response.error&&sharedProperties.ajaxError(response.error)}),promise=deferred.promise)}function handleLinks(url,mode,newtab,stepId,actionId,completed){if(self.selectedStepId=stepId,self.selectedActionId=actionId,self.completed=completed,"Video"===mode)sharedProperties.videoPopUp(url);else if("WebInternal"===mode)window.location.href=url;else if("ActionPlan"===mode)$rootScope.handleStickyTabs("action");else if("Private"===mode)$rootScope.handleStickyTabs("private");else if("GD"===mode)$rootScope.handleStickyTabs("gd");else{var win=window.open(url,"_blank");win.focus()}}function markComplete(stepId,actionId,completed,parentIndex,stepCompleteCount,stepCount){self.selectedStepId=stepId,self.selectedActionId=actionId,self.parentIndex=parentIndex,self.completedStepCount=stepCompleteCount,self.stepCount=stepCount,completed||self.clickState||markTaskAsComplete()}function imagePop(url){$rootScope.showImageModal=!0,$rootScope.modalImageUrl=url}function toggle(index){null!==$localStorage.get("tutState")&&(self.userState=JSON.parse($localStorage.get("tutState")));for(var i=0;i<self.tutorial.steps.length;i++)self.tutorial.steps[i].defaultOpen&&index!==i&&(self.tutorial.steps[i].defaultOpen=!1,self.userState[i]=0);switch(self.tutorial.steps[index].defaultOpen=!self.tutorial.steps[index].defaultOpen,index){case 0:self.userState[0]=self.tutorial.steps[0].defaultOpen?1:0;break;case 1:self.userState[1]=self.tutorial.steps[1].defaultOpen?1:0;break;case 2:self.userState[2]=self.tutorial.steps[2].defaultOpen?1:0;break;case 3:self.userState[3]=self.tutorial.steps[3].defaultOpen?1:0}$localStorage.set("tutState",JSON.stringify(self.userState))}var promise,self=this;$scope.pullInterNationalization=$rootScope.pullInterNationalization,self.selectedStepId=null,self.selectedActionId=null,self.parentIndex=null,self.completedStepCount=null,self.stepCount=null,self.completed=!1,self.tutorial={},self.handleLinks=handleLinks,self.markComplete=markComplete,self.getTutorial=getTutorial,self.imagePop=imagePop,self.toggle=toggle,self.cloneObject=null,self.userState=[0,0,0,0],self.clickState=!1,self.serviceApis={getDetail:"/sp/tutorial/getDetails"};var markTaskAsComplete=($scope.$on("videoEnded",function(){self.completed||markTaskAsComplete()}),function(){self.clickState=!0,ajaxService.getAjaxResponse({url:"/sp/tutorial/markComplete",data:$.param({tutorialId:self.tutorial.id,stepId:self.selectedStepId,actionId:self.selectedActionId})}).then(function(response){if("true"===response.Success){$rootScope.$broadcast("taskCompleted"),sharedProperties.growlMessage($rootScope.pullInterNationalization("tutorial.completeTask"));var tmpObject=angular.copy(self.tutorial);self.tutorial={};for(var i=0;i<tmpObject.steps.length;i++)if(tmpObject.steps[i].id===self.selectedStepId){tmpObject.steps[i].completedCount=tmpObject.steps[i].completedCount+1;for(var j=0;j<tmpObject.steps[i].devStrategyActionCategoryList[0].actionList.length;j++)self.selectedActionId===tmpObject.steps[i].devStrategyActionCategoryList[0].actionList[j].uid&&(tmpObject.steps[i].devStrategyActionCategoryList[0].actionList[j].completed=!0)}self.tutorial=tmpObject,self.tutorial.completedCount=self.tutorial.completedCount+1;var completedPercent=Math.round(parseInt(self.tutorial.completedCount)/parseInt(self.tutorial.actionCount)*100);self.tutorial.completed=completedPercent,null!==$localStorage.get("tutorialObj")&&($localStorage.set("tutorialObj",self.tutorial),$rootScope.tutorialObj=$localStorage.get("tutorialObj")),self.completedStepCount=self.completedStepCount+1,sharedProperties.fireAnalyticsEvent("Sticky Footer | Complete a Tutorial Task","N/A"),self.clickState=!1}else null!==response.error&&(sharedProperties.ajaxError(response.error),self.clickState=!1)})})};return controller.$inject=["$scope","$rootScope","sharedProperties","ajaxService","$q","basicService","$localStorage","$timeout"],{restrict:"EA",link:function($scope,$element,$attrs){$templateRequest("/sp/resources/html/"+$attrs.urlSrc).then(function(html){var template=angular.element(html);$element.append(template),$compile(template)($scope)})},scope:{},controller:controller,controllerAs:"ctrl",bindToController:!0,replace:!0}}spTutorial.$inject=["$compile","$templateRequest"],angular.module("spApp").directive("spTutorial",spTutorial);
function supportPanel($compile,$templateRequest){var controller=function($scope,$rootScope,sharedProperties,$localStorage){function removeAttachment(){self.attachmentObj={url:null,name:null,type:null}}function submitRequest(e){$(".support_textarea").val().length>0?self.showError=!1:(self.showError=!0,e.preventDefault())}var self=this;$scope.pullInterNationalization=$rootScope.pullInterNationalization,$scope.handleFileStack=$rootScope.handleFileStack,self.redirectUrl=window.location.origin+window.location.pathname+"?support_status=Success",self.attachmentObj={url:null,name:null,type:null},self.showError=!1,self.userLang=sharedProperties.getUserLocale(),self.removeAttachment=removeAttachment,self.submitRequest=submitRequest,self.userInfo=$localStorage.get("loggegdInProfile");$scope.$on("fileStackSuccessNotes",function(e,data){if(null===data)return!0;$scope.$apply(function(){self.attachmentObj.url=data.fileData.url,self.attachmentObj.name=data.fileData.filename,self.attachmentObj.type=sharedProperties.mapMediaType(data.fileData.mimetype)})})};return controller.$inject=["$scope","$rootScope","sharedProperties","$localStorage"],{restrict:"EA",link:function($scope,$element,$attrs){$templateRequest("/sp/resources/html/"+$attrs.urlSrc).then(function(html){var template=angular.element(html);$element.append(template),$compile(template)($scope)})},scope:{},controller:controller,controllerAs:"ctrl",bindToController:!0,replace:!0}}supportPanel.$inject=["$compile","$templateRequest"],angular.module("spApp").directive("supportPanel",supportPanel);
function tutorialWidget($compile,$templateRequest){var controller=function($scope,$rootScope,sharedProperties,ajaxService,$q,basicService,$localStorage){function getDashboardTutorial(){var deferred=$q.defer();if(null===$localStorage.get("tutorialObj")){if(promise)return promise;ajaxService.getAjaxResponse({url:self.serviceApis.get}).then(function(response){"true"===response.Success&&void 0!==response.tutorial&&(self.dashboardTutorial=response.tutorial,self.dashboardTutorial.completedCount>self.dashboardTutorial.actionCount&&(self.dashboardTutorial.completedCount=self.dashboardTutorial.actionCount),setLocalStorageObj(),$rootScope.showStickyTutorial?checkIfStickyDisplay():self.dashboardTutorial.completedCount===self.dashboardTutorial.actionCount?self.tutorialAvailable=!1:self.tutorialAvailable=!0)})}else self.dashboardTutorial=$localStorage.get("tutorialObj"),$rootScope.showStickyTutorial?checkIfStickyDisplay():self.dashboardTutorial.completedCount===self.dashboardTutorial.actionCount?self.tutorialAvailable=!1:self.tutorialAvailable=!0;return promise=deferred.promise}function openStickyTutorial(){$rootScope.handleStickyTabs("tutorial"),sharedProperties.fireAnalyticsEvent("Dashboard | Open Tutorial from Widget","N/A")}var promise,self=this;$scope.pullInterNationalization=$rootScope.pullInterNationalization,self.openStickyTutorial=openStickyTutorial,self.serviceApis={get:"/sp/tutorial/get"},self.dashboardTutorial={},self.tutorialAvailable=!1;var checkIfStickyDisplay=function(){self.dashboardTutorial.completedCount!==self.dashboardTutorial.actionCount&&"/sp/admin/manageAccount"!==window.location.pathname&&"/sp/hiring"!==window.location.pathname?(self.tutorialAvailable=!0,setTimeout(function(){$(".sticky-tutorial").fadeIn("slow"),$rootScope.$broadcast("tutorialShow")},5e3)):self.tutorialAvailable=!1},setLocalStorageObj=function(){var completedPercent=Math.round(parseInt(self.dashboardTutorial.completedCount)/parseInt(self.dashboardTutorial.actionCount)*100);self.dashboardTutorial.completed=completedPercent,$localStorage.set("tutorialObj",self.dashboardTutorial)};$scope.$on("taskCompleted",function(){self.dashboardTutorial.completedCount=self.dashboardTutorial.completedCount+1,self.dashboardTutorial.completedCount===self.dashboardTutorial.actionCount&&$(".ert-development").fadeOut("slow")}),$scope.$on("stickyOpen",function(){$(".sticky-tutorial").addClass("hide")}),$scope.$on("tutorialShow",function(){$(".sticky-tutorial").length&&$(".sticky-tutorial").delay(6e3).fadeOut("slow")});!function(){getDashboardTutorial()}()};return controller.$inject=["$scope","$rootScope","sharedProperties","ajaxService","$q","basicService","$localStorage"],{restrict:"EA",link:function($scope,$element,$attrs){$templateRequest($attrs.urlSrc||"/sp/resources/html/dashboard/tutorial-widget.html").then(function(html){var template=angular.element(html);$element.append(template),$compile(template)($scope)})},controller:controller,controllerAs:"tutCtrl",bindToController:!0}}tutorialWidget.$inject=["$compile","$templateRequest"],angular.module("spApp").directive("tutorialWidget",tutorialWidget);
function routerBlueConfig($stateProvider){$stateProvider.state("create",{url:"/create",templateUrl:"/sp/resources/html/blueprint/create.html",controllerAs:"vm"}).state("createAdmin",{url:"/create",templateUrl:"/sp/resources/html/blueprint/createAdmin.html",controllerAs:"vm"}).state("approvalRequest",{url:"/approvalRequest",templateUrl:"/sp/resources/html/blueprint/approvalRequest.html",controllerAs:"vm"}).state("publish",{url:"/publish",templateUrl:"/sp/resources/html/blueprint/publish.html",controllerAs:"vm"})}angular.module("spApp").config(routerBlueConfig),routerBlueConfig.$inject=["$stateProvider"];
function routerConfig($stateProvider){$stateProvider.state("practice",{url:"/practice",templateUrl:"/sp/resources/html/goals/practice.html",controllerAs:"vm"}).state("addNote",{url:"/addnote",templateUrl:"/sp/resources/html/goals/addNote.html",controllerAs:"vm"}).state("requestFeedback",{url:"/requestFeedback",templateUrl:"/sp/resources/html/goals/requestFeedback.html",controllerAs:"vm"}).state("completedArticle",{url:"/completedArticle",templateUrl:"/sp/resources/html/goals/completedArticle.html",controllerAs:"vm"}).state("notesAndFeedback",{url:"/notesAndFeedback",templateUrl:"/sp/resources/html/goals/notesFeedbackOverlay.html",controllerAs:"vm"}).state("manageArticle",{url:"/manageArticle",templateUrl:"/sp/resources/html/goals/manageStratagies.html",controllerAs:"vm"}).state("selectActionPlan",{url:"/selectActionPlan",templateUrl:"/sp/resources/html/goals/orgLanding.html",controllerAs:"vm"}).state("organization",{url:"/organization",templateUrl:"/sp/resources/html/goals/organization.html",controllerAs:"vm"}).state("admin",{views:{create:{templateUrl:"/sp/resources/html/sysAdmin/organization/admin-create.html",controllerAs:"vm"},edit:{templateUrl:"/sp/resources/html/sysAdmin/organization/admin-edit.html",controllerAs:"vm"},preview:{templateUrl:"/sp/resources/html/sysAdmin/organization/admin-preview.html",controllerAs:"vm"},setting:{templateUrl:"/sp/resources/html/sysAdmin/organization/admin-setting.html",controllerAs:"vm"},step:{templateUrl:"/sp/resources/html/sysAdmin/organization/admin-stepSetting.html",controllerAs:"vm"}}}).state("adminTutorial",{views:{create:{templateUrl:"/sp/resources/html/sysAdmin/tutorial/create.html",controllerAs:"vm"},edit:{templateUrl:"/sp/resources/html/sysAdmin/tutorial/edit.html",controllerAs:"vm"},preview:{templateUrl:"/sp/resources/html/sysAdmin/tutorial/preview.html",controllerAs:"vm"},setting:{templateUrl:"/sp/resources/html/sysAdmin/tutorial/setting.html",controllerAs:"vm"}}}).state("visual",{views:{"personality-balance":{templateUrl:"/sp/resources/html/spectrum/personality-balance.html",controllerAs:"vm"},"personality-balance-filter":{templateUrl:"/sp/resources/html/spectrum/personality-balance-filter.html",controllerAs:"vm"},"blueprint-analytics-filter":{templateUrl:"/sp/resources/html/spectrum/blueprint-analytics-filter.html",controllerAs:"vm"},"blueprint-analytics":{templateUrl:"/sp/resources/html/spectrum/blueprint-analytics.html",controllerAs:"vm"},"ert-insights-filter":{templateUrl:"/sp/resources/html/spectrum/ert-insights-filter.html",controllerAs:"vm"},"ert-insights":{templateUrl:"/sp/resources/html/spectrum/ert-insights.html",controllerAs:"vm"},"org-plan":{templateUrl:"/sp/resources/html/spectrum/org-plan.html",controllerAs:"vm"},"org-plan-filter":{templateUrl:"/sp/resources/html/spectrum/org-plan-filter.html",controllerAs:"vm"},"ert-analytics-filter":{templateUrl:"/sp/resources/html/spectrum/ert-analytics-filter.html",controllerAs:"vm"},"ert-analytics":{templateUrl:"/sp/resources/html/spectrum/ert-analytics.html",controllerAs:"vm"},"competency-filter":{templateUrl:"/sp/resources/html/spectrum/competency-filter.html",controllerAs:"vm"},competency:{templateUrl:"/sp/resources/html/spectrum/competency.html",controllerAs:"vm"},"engagement-filter":{templateUrl:"/sp/resources/html/spectrum/engagement-filter.html",controllerAs:"vm"},engagement:{templateUrl:"/sp/resources/html/spectrum/engagement.html",controllerAs:"vm"}}}).state("competencyView",{views:{create:{templateUrl:"/sp/resources/html/sysAdmin/competency/create.html",controllerAs:"vm"},edit:{templateUrl:"/sp/resources/html/sysAdmin/competency/update.html",controllerAs:"vm"},preview:{templateUrl:"/sp/resources/html/sysAdmin/competency/preview.html",controllerAs:"vm"}}}).state("addNoteCompetency",{url:"/addnote",templateUrl:"/sp/resources/html/competency/addNote.html",controllerAs:"vm"}).state("profiles",{url:"/profiles",templateUrl:"/sp/resources/html/competency/competency-details.html",controllerAs:"vm"}).state("members",{url:"/members",templateUrl:"/sp/resources/html/admin/manage-account/home-members.html",controller:"adminMemberController",controllerAs:"ctrl"}).state("groups",{url:"/groups",templateUrl:"/sp/resources/html/admin/manage-account/home-groups.html",controller:"groupListController",controllerAs:"ctrl"}).state("memberDetails",{url:"/memberDetails?email",templateUrl:"/sp/resources/html/admin/manage-account/home-memberDetails.html",controller:"memberDetailsController",controllerAs:"ctrl"}).state("groupMember",{url:"/groupMember?email",templateUrl:"/sp/resources/html/dashboard/home-memberDetails.html",controller:"memberDetailsController",controllerAs:"ctrl"}).state("accountOrganization",{url:"/accountOrganization",templateUrl:"/sp/resources/html/admin/manage-account/account-admin-organization.html",controller:"organizationAccountAdmin",controllerAs:"ctrl"}).state("accountCompetency",{url:"/accountCompetency",templateUrl:"/sp/resources/html/admin/manage-account/account-admin-competency.html",controller:"competencyAccountAdmin",controllerAs:"ctrl"}).state("settings",{url:"/settings",templateUrl:"/sp/resources/html/admin/manage-account/home-settings.html",controller:"manageSettingsController",controllerAs:"ctrl"}).state("SurePeople",{url:"/learningProgramSP",templateUrl:"/sp/resources/html/sysAdmin/organization/home-surepeople.html",controllerAs:"ctrl"}).state("Company",{url:"/learningProgramAP",templateUrl:"/sp/resources/html/sysAdmin/organization/home-company.html",controllerAs:"ctrl"}).state("archives",{url:"/archives",templateUrl:"/sp/resources/html/hiring/home-archives.html",controller:"candidatesListing",controllerAs:"ctrl"}).state("advisor",{url:"/advisor?cemail",templateUrl:"/sp/resources/html/hiring/home-advisor.html",controller:"candidateAdvisorController",controllerAs:"ctrl"}).state("candidateDetails",{url:"/candidateDetails?cemail",templateUrl:"/sp/resources/html/hiring/home-candidateDetails.html",controller:"candidateDetailsController",controllerAs:"ctrl"})}angular.module("spApp").config(routerConfig),routerConfig.$inject=["$stateProvider"];
function paRouteConfig($stateProvider){$stateProvider.state("candidatesModule",{url:"/candidates",template:"<candidates-list url-src='candidates-list.html' active-view='candidatesModule' class='candidates-list-container'></candidates-list>"}).state("employeesModule",{url:"/employees",template:"<employees url-src='employees-list.html' active-view='employeesModule' class='employees-list-container'></employees>"}).state("employeeDetailsModule",{url:"/memberDetail",template:"<employee-detail url-src='employeeDetails-home.html' class='employees-list-container posRel'></employee-detail>"}).state("archiveDetailsModule",{url:"/memberDetail",template:"<employee-detail url-src='archiveDetails-home.html' class='employees-list-container posRel'></employee-detail>"}).state("employeeCompare",{url:"/compare?email",templateUrl:"/sp/resources/html/people-analytics/view/employee-compare.html",controller:"candidateAdvisorController",controllerAs:"ctrl"}).state("groupsPAModule",{url:"/groupsPA",template:"<groups-list url-src='groups-list.html' active-view='groupsPAModule' class='groups-list-container'></groups-list>"}).state("rolesPAModule",{url:"/rolesPA",template:"<roles-list url-src='roles-list.html' active-view='rolesPAModule' class='roles-list-container'></roles-list>"}).state("roleDetails",{url:"/roleDetails?id",template:"<role-details url-src='role-details.html'></role-details>"}).state("archivesPAModule",{url:"/archivesPA",template:"<archives url-src='archives-list.html' active-view='archivesPAModule' class='archives-list-container'></archives>"}).state("settingsPAModule",{url:"/settingsPA",template:"<settings-section active-view='settingsPAModule' url-src='settings-section.html' active-view='settings' class='settings-list-container'></settings-section>"}).state("PersonalityPA",{url:"/PersonalityPA",templateUrl:"/sp/resources/html/sysAdmin/peopleAnalytics/Ideal-Portrait/view/personality.html"}).state("ProcessingPA",{url:"/ProcessingPA",templateUrl:"/sp/resources/html/sysAdmin/peopleAnalytics/Ideal-Portrait/view/processing.html"}).state("DecisionMakingPA",{url:"/DecisionMakingPA",templateUrl:"/sp/resources/html/sysAdmin/peopleAnalytics/Ideal-Portrait/view/decision-making.html"}).state("ConflictManagementPA",{url:"/ConflictManagementPA",templateUrl:"/sp/resources/html/sysAdmin/peopleAnalytics/Ideal-Portrait/view/conflict-management.html"}).state("MotivationPA",{url:"/MotivationPA",templateUrl:"/sp/resources/html/sysAdmin/peopleAnalytics/Ideal-Portrait/view/motivation.html"}).state("FundamentalNeedsPA",{url:"/FundamentalNeedsPA",templateUrl:"/sp/resources/html/sysAdmin/peopleAnalytics/Ideal-Portrait/view/fundamental-needs.html"}).state("LearningStylePA",{url:"/LearningStylePA",templateUrl:"/sp/resources/html/sysAdmin/peopleAnalytics/Ideal-Portrait/view/learning-style.html"}).state("paDashboard",{views:{articles:{templateUrl:"/sp/resources/html/sysAdmin/peopleAnalytics/dashboard/view/articles.html"},images:{templateUrl:"/sp/resources/html/sysAdmin/peopleAnalytics/dashboard/view/images.html"}}}).state("portrait-listing",{url:"/home",templateUrl:"/sp/resources/html/people-analytics/view/portrait-listing.html"}).state("portrait-compare",{url:"/viewPortrait",templateUrl:"/sp/resources/html/people-analytics/view/portrait-compare.html"})}angular.module("spApp").config(paRouteConfig),paRouteConfig.$inject=["$stateProvider"];
function feedbackReply($compile,$templateRequest,feedbackService,ngDialog,$localStorage,sharedProperties){var controller=function($scope,$rootScope,$filter){function closeOverlay(){$localStorage.remove("feedbackRefId"),$rootScope.showFeedbackOverlay=!1}function showTips(){$("html, body").animate({scrollTop:$("#feedbackTips").offset().top},500)}function getFeedbackDetail(id,feature){self.activeFeedId=id,self.activeFeature=feature,self.inputRequired=!1,feedbackService.getFeedbackDetailForResponse(id).then(function(data){void 0!==data&&data.Success&&(self.feedbackDetail=data.developmentFeedback,self.responseAvailable=!0,void 0!==self.feedbackDetail&&void 0!==self.feedbackDetail.dataMap&&void 0!==self.feedbackDetail.dataMap.blueprint?(self.blueprint=self.feedbackDetail.dataMap.blueprint,self.dataMap=self.feedbackDetail.dataMap.blueprintSettings.dataMap):self.goalObj=self.feedbackDetail.dataMap.dataMap)})}function declineFeedback(){self.inputRequired=!1,self.feedbackForm.response="",self.declineFlag=!0,ngDialog.open({template:"/sp/resources/html/feedback/decline-feedback.html",scope:$scope}).closePromise.then(function(data){self.declineFlag=!1,self.inputRequired=!1,self.inputRequiredForModal=!1,self.feedbackForm.declineResponse=""})}function sendFeedbackResponse(){if(!self.declineFlag&&(""===self.feedbackForm.response||void 0===self.feedbackForm.response))return void(self.inputRequired=!0);self.inputRequired=!1,self.inputRequiredForModal=!1,self.feedbackForm=prepareFeedbackForm(),feedbackService.sendFeedbackResponse(self.feedbackForm).then(function(data){data.Success?(sharedProperties.growlMessage($rootScope.pullInterNationalization("feedback.ajaxMessage.responseSent")),self.winWidth<768&&self.closeOverlay(),"dashboard"===self.parentPage?self.declineFlag?sharedProperties.fireAnalyticsEvent("Feedback | Response declined from Action Plan","N/A"):sharedProperties.fireAnalyticsEvent("Feedback | Response sent from Action Plan","N/A"):self.declineFlag?sharedProperties.fireAnalyticsEvent("Feedback | Response declined from Email link","N/A"):sharedProperties.fireAnalyticsEvent("Feedback | Response sent from Email link","N/A")):sharedProperties.ajaxError(data.error),self.feedbackForm={},self.declineFlag&&ngDialog.close(),sharedProperties.spilceIndexWithBreak(self.feedbackRequestList,"id",self.activeFeedId),self.feedbackRequestList.length?self.getFeedbackDetail(self.feedbackRequestList[0].id,self.feedbackRequestList[0].spFeature):(self.feedbackRequestList=[],self.feedbackDetail=[],$rootScope.showFeedbackOverlay?$rootScope.showFeedbackOverlay=!1:window.location.href=window.location.origin)})}function init(){self.parentPage=$scope.parentPage,$("body").css("overflow-y","visible"),feedbackService.getAllFeedbacksForResponse($localStorage.get("feedbackRefId")).then(function(data){if(void 0!==data&&data.Success){if(self.feedbackRequestList=data.developmentFeedbacklisting,self.feedbackDetail=data.developmentFeedbackdetail,void 0!==self.feedbackDetail&&(self.activeFeedId=self.feedbackDetail.id),void 0!==self.feedbackRequestList&&self.feedbackRequestList.length)for(var i=0;i<self.feedbackRequestList.length;i++)if(self.feedbackRequestList[i].id===self.activeFeedId){self.activeFeature=self.feedbackRequestList[i].spFeature;break}void 0!==self.feedbackDetail&&void 0!==self.feedbackDetail.dataMap&&void 0!==self.feedbackDetail.dataMap.blueprint?(self.blueprint=self.feedbackDetail.dataMap.blueprint,self.dataMap=self.feedbackDetail.dataMap.blueprintSettings.dataMap):self.goalObj=self.feedbackDetail.dataMap.dataMap,self.responseAvailable=!0}window.setTimeout(function(){$("body .feeedback-list").scrollTop($("body .feeedback-list").scrollTop()+$("body .feeedback-list li.active").position().top)},100)})}var self=this;self.feedbackForm={},self.inputRequired=!1,self.feedbackRequestList=[],self.feedbackDetail={},self.responseAvailable=!1,self.activeFeedId="",self.feedbackForm={},self.activeFeature="",self.declineFlag=!1,self.inputRequiredForModal=!1,self.winWidth=$(window).width(),self.blueprint=null,self.dataMap=null,self.goalObj=null,self.parentPage="",self.init=init,self.getFeedbackDetail=getFeedbackDetail,self.sendFeedbackResponse=sendFeedbackResponse,self.declineFeedback=declineFeedback,self.closeOverlay=closeOverlay,self.showTips=showTips;var prepareFeedbackForm=function(){return self.feedbackForm.devFeedRefId=self.feedbackDetail.devFeedRefId,self.feedbackForm.id=self.feedbackDetail.id,self.feedbackForm.spFeature=self.activeFeature,self.feedbackForm.decline=self.declineFlag,self.declineFlag&&(self.feedbackForm.response=self.feedbackForm.declineResponse),self.feedbackForm}};return controller.$inject=["$scope","$rootScope","$filter"],{restrict:"EA",link:function($scope,$element,$attrs){$scope.parentPage=$attrs.parentPage,$templateRequest("/sp/resources/html/"+$attrs.urlSrc).then(function(html){var template=angular.element(html);$element.append(template),$compile(template)($scope)})},controller:controller,controllerAs:"feedbackCtrl",bindToController:!0}}angular.module("spApp").directive("feedbackReply",feedbackReply),feedbackReply.$inject=["$compile","$templateRequest","feedbackService","ngDialog","$localStorage","sharedProperties"];
function feedbackRequests($compile,$templateRequest,sharedProperties,feedbackService,ngDialog,$localStorage,$rootScope,basicService,$q){var controller=function($scope,$filter){function requestsTabFilters(label,val,dname){var result=angular.copy(self.dashboardMasterFeedbackResponseListing);self.listingFilter1=val,self.spFeatureName=label,self.listingFilterName1=dname,"ALL"!==val?(self.dashboardFeedbackResponseListing=result.filter(function(e){return e.spFeature===label}),getDashboardDetailResponse(self.dashboardFeedbackResponseListing[0].refId)):(self.dashboardFeedbackResponseListing=result,getDashboardDetailResponse(0))}function switchTabs(id){if(self.feedbackTabId!==id)switch(self.feedbackTabId=id,self.feedbackTabId){case 0:self.init(),sharedProperties.fireAnalyticsEvent("Feedback Page | Click Responses Tab","N/A");break;case 1:self.initResponseList(),sharedProperties.fireAnalyticsEvent("Feedback Page | Click Requests Tab","N/A");break;default:self.init()}}function closeModal(){$rootScope.showFeedbackPanel=!1,$rootScope.mobileDashboardFeedback=!1}function filterData(data,type,displayName){var resp=[];"panelListing"===type?(resp=$filter("feedbackFilter")(self.masterList,data,"status"),self.feedbackRequestList=[],self.feedbackRequestList=resp,self.statusFilterName=displayName,self.selectedFilter=data):"dashboardDetail"===type?(resp=$filter("feedbackFilter")(self.dashboardMasterFeedbackDetailListing,data,"status"),self.dashboardFeedbackDetailListing=[],self.dashboardFeedbackDetailListing=resp,self.statusFilterName=displayName,self.selectedFilter=data):"dashboardListing"===type&&(resp=$filter("feedbackFilter")(self.dashboardMasterFeedbackListing,data,"feature"),self.dashboardFeedbackListing=[],self.dashboardFeedbackListing=resp,self.dashboardFeedbackListing.length?getDashboardDetail(self.dashboardFeedbackListing[0]):(self.dashboardMasterFeedbackDetailListing=[],self.dashboardFeedbackDetailListing=[]),self.listingFilterName=displayName,self.statusFilterName=$rootScope.pullInterNationalization("feedback.filters.status.viewAll.label"),self.listingFilter=data)}function getDashboardDetail(obj,scroll){self.winWidth=$(window).width(),self.selectedFilter="",self.listingFilter="",self.activeFeedId=obj.devFeedRefId,feedbackService.getAllFeedbackRequests(self.activeFeedId,obj.spFeature).then(function(data){data.Success&&(self.dashboardMasterFeedbackDetailListing=[],self.dashboardMasterFeedbackDetailListing=data.developmentFeedbackListing,self.dashboardFeedbackDetailListing=angular.copy(self.dashboardMasterFeedbackDetailListing),"Erti"===obj.name?self.feedbackRefObj.parentName="ERT-i":self.feedbackRefObj.parentName=obj.name,self.feedbackRefObj.name=null===obj.title?obj.name:obj.title,self.feedbackRefObj.id=obj.devFeedRefId,self.feedbackRefObj.feature=obj.spFeature,self.responseAvailable=!0,self.isDashboardOrigin&&(scroll&&!self.urlId?$("html,body").animate({scrollTop:$("#"+self.urlId).offset().top},500):$(".note-entry-details").animate({scrollTop:0},500)))}),self.winWidth<768&&(self.winHeight=$(window).height()+100+"px",ngDialog.open({template:"/sp/resources/html/feedback/feedbackLanding-allFeedbacks-responsive.html",scope:$scope,className:"new-mobile-theme"}))}function displayDetail(obj){self.feedbackView="detailView",self.selectedFilter="",self.listingFilter="",self.feedbackUpdated=!1,self.statusFilterName=$rootScope.pullInterNationalization("feedback.filters.status.viewAll.label"),self.listingFilterName=$rootScope.pullInterNationalization("feedback.filters.status.viewAll.label"),self.activeFeedId=obj.devFeedRefId,feedbackService.getAllFeedbackRequests(self.activeFeedId,obj.spFeature).then(function(data){data.Success&&(self.dashboardMasterFeedbackDetailListing=[],self.dashboardMasterFeedbackDetailListing=data.developmentFeedbackListing,self.dashboardFeedbackDetailListing=angular.copy(self.dashboardMasterFeedbackDetailListing),self.feedbackRefObj.parentName=obj.name,self.feedbackRefObj.name=null===obj.title?obj.name:obj.title,self.feedbackRefObj.id=obj.devFeedRefId,self.feedbackRefObj.feature=obj.spFeature,self.responseAvailable=!0)})}function emailFeedback(feedbackId){$(window).width()<768&&ngDialog.close(),self.feedbackForm={},self.feedbackForm.spFeature=self.feedbackRefObj.feature,null!==feedbackId&&void 0!==feedbackId?(self.feedbackForm.id=feedbackId,self.feedbackForm.devFeedRefId=null):(self.feedbackForm.id=null,self.feedbackForm.devFeedRefId=self.feedbackRefObj.id),feedbackService.emailFeedback(self.feedbackForm).then(function(data){data&&(sharedProperties.growlMessage($rootScope.pullInterNationalization("feedback.ajaxMessage.emailSent")),self.isDashboardOrigin||self.isMobileDashboard?sharedProperties.fireAnalyticsEvent("Feedback | Send email from Dashboard","N/A"):sharedProperties.fireAnalyticsEvent("Feedback | Send email from side panel","N/A"))})}function deleteModal(feedbackId){$(window).width()<768&&ngDialog.close(),self.individualFeedbackId=feedbackId,ngDialog.open({template:"/sp/resources/html/feedback/delete-feedback.html",scope:$scope})}function deleteFeedbackMobile(){var devFeedId=self.activeFeedId;null!==self.individualFeedbackId&&(devFeedId=null),feedbackService.deleteFeedback(self.individualFeedbackId,devFeedId,self.feedbackRefObj.feature).then(function(data){data&&(ngDialog.close(),sharedProperties.growlMessage($rootScope.pullInterNationalization("feedback.ajaxMessage.delete")),self.feedbackUpdated=!0,null!==self.individualFeedbackId?(sharedProperties.spilceIndexWithBreak(self.dashboardMasterFeedbackDetailListing,"id",self.individualFeedbackId),self.dashboardMasterFeedbackDetailListing.length?(self.dashboardFeedbackDetailListing=[],self.dashboardFeedbackDetailListing=angular.copy(self.dashboardMasterFeedbackDetailListing)):self.goBackToListingMobile()):self.goBackToListingMobile(),sharedProperties.fireAnalyticsEvent("Feedback | Delete feedback from dashboard","N/A"))})}function deleteFeedback(){var devFeedId=self.activeFeedId;null!==self.individualFeedbackId&&(devFeedId=null),feedbackService.deleteFeedback(self.individualFeedbackId,devFeedId,self.feedbackRefObj.feature).then(function(data){if(data){if(ngDialog.close(),sharedProperties.growlMessage($rootScope.pullInterNationalization("feedback.ajaxMessage.delete")),self.feedbackUpdated=!0,self.isDashboardOrigin)if(null!==self.individualFeedbackId)if(sharedProperties.spilceIndexWithBreak(self.dashboardMasterFeedbackDetailListing,"id",self.individualFeedbackId),self.dashboardMasterFeedbackDetailListing.length){self.dashboardFeedbackDetailListing=angular.copy(self.dashboardMasterFeedbackDetailListing);for(var i=0;i<self.dashboardFeedbackListing.length;i++)self.activeFeedId===self.dashboardFeedbackListing[i].devFeedRefId&&self.dashboardFeedbackListing[i].count--}else self.init();else self.init();else null!==self.individualFeedbackId?(sharedProperties.spilceIndexWithBreak(self.masterList,"id",self.individualFeedbackId),self.feedbackRequestList=angular.copy(self.masterList),self.feedbackRequestList.length||(self.feedbackRequestList=[],self.masterList=[],self.noDataOnLoad=!0,self.newFeedbackFlow())):(self.feedbackRequestList=[],self.masterList=[],self.noDataOnLoad=!0,self.newFeedbackFlow());self.isDashboardOrigin?sharedProperties.fireAnalyticsEvent("Feedback | Delete feedback from dashboard","N/A"):sharedProperties.fireAnalyticsEvent("Feedback | Delete feedback from side panel","N/A")}})}function newFeedbackFlow(){self.selectedFilter="",self.listingFilter="",self.feedbackView="newRequest",self.inputRequired=!1,self.feedbackUpdated=!1,self.tagsAdded=!1,self.feedbackForm.comment="",self.allMember.length||basicService.getAllValidMember().then(function(response){if(self.allMember=response,null!==self.loggedInUser)for(var i=0;i<self.allMember.length;i++)if(self.allMember[i].email===self.loggedInUser.member.email){self.allMember.splice(i,1);break}})}function goBackToListing(){self.feedbackView="listing",self.formSubmitted=!1,self.selectedFilter="",self.listingFilter="",self.feedbackUsers=[],self.feedbackUpdated&&feedbackService.getAllFeedbackRequests(self.feedbackRefObj.id,self.feedbackRefObj.feature).then(function(data){data.Success&&(self.masterList=data.developmentFeedbackListing,self.feedbackRequestList=angular.copy(self.masterList),self.responseAvailable=!0)})}function goBackToListingMobile(){self.feedbackView="listing",self.selectedFilter="",self.listingFilter="",self.statusFilterName=$rootScope.pullInterNationalization("feedback.filters.status.viewAll.label"),self.listingFilterName=$rootScope.pullInterNationalization("feedback.filters.status.viewAll.label"),self.dashboardFeedbackListing=angular.copy(self.dashboardMasterFeedbackListing),self.feedbackUpdated&&feedbackService.getAllFeedbackForDashboard().then(function(data){void 0!==data&&data.Success&&(self.dashboardMasterFeedbackListing=[],self.dashboardMasterFeedbackListing=data.developmentFeedbacks,void 0!==self.dashboardMasterFeedbackListing&&self.dashboardMasterFeedbackListing.length?(self.dashboardFeedbackListing=[],self.dashboardFeedbackListing=angular.copy(self.dashboardMasterFeedbackListing)):(self.dashboardMasterFeedbackListing=[],self.dashboardFeedbackListing=[]),self.responseAvailable=!0)})}function submitFeedbackRequest(){self.formSubmitted=!0,""!==self.feedbackForm.comment.trim()&&void 0!==self.feedbackForm.comment&&self.feedbackUsers.length&&(self.inputRequired=!1,self.feedbackForm=prepareFeedbackForm(),self.feedbackUpdated=!1,feedbackService.submitFeedbackRequest(self.feedbackForm).then(function(data){data&&(ngDialog.close(),closeModal(),sharedProperties.growlMessage($rootScope.pullInterNationalization("feedback.ajaxMessage.requestSent")),self.feedbackUpdated=!0,self.noDataOnLoad=!1,self.goBackToListing(),sharedProperties.fireAnalyticsEvent("Feedback | Request sent","Name - "+self.feedbackRefObj.name+", Feature -    "+self.feedbackRefObj.feature))}))}function getDashboardDetailResponse(rId){if(self.winWidth=$(window).width(),void 0!==self.dashboardMasterFeedbackResponseListing&&self.dashboardMasterFeedbackResponseListing.length){for(var id,i=0;i<self.dashboardMasterFeedbackResponseListing.length;i++)if(self.dashboardMasterFeedbackResponseListing[i].refId===rId){id=i;break}self.activeResponseFeed=id,self.dashboardFeedbackDetailResponseListing=self.dashboardMasterFeedbackResponseListing[id].feedbackResponseList,self.feedbackResponseRefObj.parentName=null===self.dashboardMasterFeedbackResponseListing[id].parentTitle?self.dashboardMasterFeedbackResponseListing[id].spFeature:self.dashboardMasterFeedbackResponseListing[id].parentTitle,self.feedbackResponseRefObj.feature=self.dashboardMasterFeedbackResponseListing[id].spFeature,self.feedbackResponseRefObj.name=null===self.dashboardMasterFeedbackResponseListing[id].title?self.dashboardMasterFeedbackResponseListing[id].name:self.dashboardMasterFeedbackResponseListing[id].title}else self.activeResponseFeed=-1,self.dashboardFeedbackDetailResponseListing=[];self.winWidth<768&&(self.winHeight=$(window).height()+100+"px",ngDialog.open({template:"/sp/resources/html/feedback/feedbackLanding-allFeedbacks-responsive.html",scope:$scope,className:"new-mobile-theme"}))}function initResponseList(){if(self.responseAvailable=!1,void 0===$localStorage.get("feedbackReqData")||null===$localStorage.get("feedbackReqData")||""===$localStorage.get("feedbackReqData"))feedbackService.getAllFeedbackResponses().then(function(data){if(void 0!==data&&data.Success){if($localStorage.set("feedbackReqData",data.developmentFeedbackResponseListing),self.dashboardMasterFeedbackResponseListing=data.developmentFeedbackResponseListing,void 0!==self.dashboardMasterFeedbackResponseListing&&self.dashboardMasterFeedbackResponseListing.length){for(var i=0;i<self.dashboardMasterFeedbackResponseListing.length;i++)self.dashboardMasterFeedbackResponseListing[i].refId=i;self.dashboardFeedbackResponseListing=angular.copy(self.dashboardMasterFeedbackResponseListing),self.feedbackResponseRefObj.parentName=self.dashboardFeedbackResponseListing[0].parentTitle,self.feedbackResponseRefObj.feature=self.dashboardFeedbackResponseListing[0].spFeature,self.feedbackResponseRefObj.name=null===self.dashboardFeedbackResponseListing[0].title?self.dashboardFeedbackResponseListing[0].name:self.dashboardFeedbackResponseListing[0].title,$(window).width()>767&&getDashboardDetailResponse(0)}else self.dashboardMasterFeedbackResponseListing=[],self.dashboardFeedbackResponseListing=[];self.responseAvailable=!0}});else{if(self.dashboardMasterFeedbackResponseListing=$localStorage.get("feedbackReqData"),void 0!==self.dashboardMasterFeedbackResponseListing&&self.dashboardMasterFeedbackResponseListing.length){for(var i=0;i<self.dashboardMasterFeedbackResponseListing.length;i++)self.dashboardMasterFeedbackResponseListing[i].refId=i;self.dashboardFeedbackResponseListing=angular.copy(self.dashboardMasterFeedbackResponseListing),self.feedbackResponseRefObj.parentName=self.dashboardFeedbackResponseListing[0].parentTitle,self.feedbackResponseRefObj.feature=self.dashboardFeedbackResponseListing[0].spFeature,self.feedbackResponseRefObj.name=null===self.dashboardFeedbackResponseListing[0].title?self.dashboardFeedbackResponseListing[0].name:self.dashboardFeedbackResponseListing[0].title,$(window).width()>767&&getDashboardDetailResponse(0)}else self.dashboardMasterFeedbackResponseListing=[],self.dashboardFeedbackResponseListing=[];self.responseAvailable=!0}}function init(){self.parentPage=$scope.parentPage,self.selectedFilter="",self.listingFilter="",void 0!==self.parentPage&&"dashboard"===self.parentPage?self.isDashboardOrigin=!0:void 0!==self.parentPage&&"mobileDashboard"===self.parentPage&&(self.isMobileDashboard=!0),self.isDashboardOrigin||self.isMobileDashboard?self.isDashboardOrigin?(self.responseAvailable=!1,void 0===$localStorage.get("feedbackResData")||null===$localStorage.get("feedbackResData")||""===$localStorage.get("feedbackResData")?feedbackService.getAllFeedbackForDashboard().then(function(data){void 0!==data&&data.Success&&(self.dashboardMasterFeedbackListing=data.developmentFeedbacks,self.dashboardMasterFeedbackDetailListing=data.feedbackDetail,void 0!==self.dashboardMasterFeedbackListing&&self.dashboardMasterFeedbackListing.length?($localStorage.set("feedbackResData",data.developmentFeedbacks),$localStorage.set("feedbackResDetail",data.feedbackDetail),self.dashboardFeedbackListing=angular.copy(self.dashboardMasterFeedbackListing),self.urlId?feedbackService.getFeedbackDetailForResponse(self.urlId).then(function(data){if(void 0!==data&&data.Success)for(var i=0;i<self.dashboardFeedbackListing.length;i++)if(self.dashboardFeedbackListing[i].devFeedRefId===data.developmentFeedback.devFeedRefId){$(window).width()>767&&self.getDashboardDetail(self.dashboardFeedbackListing[i],!0);break}}):(self.feedbackRefObj.parentName=self.dashboardFeedbackListing[0].name,self.feedbackRefObj.feature=self.dashboardFeedbackListing[0].spFeature,self.feedbackRefObj.name=null===self.dashboardFeedbackListing[0].title?self.dashboardFeedbackListing[0].name:self.dashboardFeedbackListing[0].title)):(self.dashboardMasterFeedbackListing=[],self.dashboardFeedbackListing=[]),void 0!==self.dashboardMasterFeedbackDetailListing&&self.dashboardMasterFeedbackDetailListing.length?self.urlId||(self.activeFeedId=self.dashboardMasterFeedbackDetailListing[0].devFeedRefId,self.feedbackRefObj.id=self.dashboardMasterFeedbackDetailListing[0].devFeedRefId,self.dashboardFeedbackDetailListing=angular.copy(self.dashboardMasterFeedbackDetailListing)):(self.dashboardMasterFeedbackDetailListing=[],self.dashboardFeedbackDetailListing=[]),self.responseAvailable=!0)}):(self.dashboardMasterFeedbackListing=$localStorage.get("feedbackResData"),self.dashboardMasterFeedbackDetailListing=$localStorage.get("feedbackResDetail"),void 0!==self.dashboardMasterFeedbackListing&&self.dashboardMasterFeedbackListing.length?(self.dashboardFeedbackListing=angular.copy(self.dashboardMasterFeedbackListing),self.feedbackRefObj.parentName=self.dashboardFeedbackListing[0].name,self.feedbackRefObj.feature=self.dashboardFeedbackListing[0].spFeature,self.feedbackRefObj.name=null===self.dashboardFeedbackListing[0].title?self.dashboardFeedbackListing[0].name:self.dashboardFeedbackListing[0].title):(self.dashboardMasterFeedbackListing=[],self.dashboardFeedbackListing=[]),void 0!==self.dashboardMasterFeedbackDetailListing&&self.dashboardMasterFeedbackDetailListing.length?(self.activeFeedId=self.dashboardMasterFeedbackDetailListing[0].devFeedRefId,self.feedbackRefObj.id=self.dashboardMasterFeedbackDetailListing[0].devFeedRefId,self.dashboardFeedbackDetailListing=angular.copy(self.dashboardMasterFeedbackDetailListing)):(self.dashboardMasterFeedbackDetailListing=[],self.dashboardFeedbackDetailListing=[]),self.responseAvailable=!0)):self.isMobileDashboard&&($rootScope.mobileDashboardFeedback=!0,window.setTimeout(function(){ngDialog.open({template:"/sp/resources/html/feedback/responsesRequests-dialog.html",scope:$scope})},100),feedbackService.getAllFeedbackForDashboard().then(function(data){void 0!==data&&data.Success&&(self.responseAvailable=!0,self.dashboardMasterFeedbackListing=data.developmentFeedbacks,void 0!==self.dashboardMasterFeedbackListing&&self.dashboardMasterFeedbackListing.length?self.dashboardFeedbackListing=angular.copy(self.dashboardMasterFeedbackListing):(self.dashboardMasterFeedbackListing=[],self.dashboardFeedbackListing=[]))})):($rootScope.showFeedbackPanel=!0,self.feedbackRefObj=sharedProperties.getFeedbackObjectForPanel(),window.setTimeout(function(){ngDialog.open({template:"/sp/resources/html/feedback/responsesRequests-dialog.html",scope:$scope})},100),self.loggedInUser=$localStorage.get("loggegdInProfile"),feedbackService.getAllFeedbackRequests(self.feedbackRefObj.id,self.feedbackRefObj.feature).then(function(data){void 0!==data&&data.Success&&(self.masterList=data.developmentFeedbackListing,self.feedbackRequestList=angular.copy(self.masterList),self.activeFeedId=self.feedbackRefObj.id,self.responseAvailable=!0,self.masterList.length||(self.noDataOnLoad=!0,self.newFeedbackFlow()))})),jQuery(function($){$("body").on("click touchend",".modal-backdrop",function(){$scope.$apply(function(){self.closeModal()})}),$(document).keyup(function(e){27===e.keyCode&&$scope.$apply(function(){self.closeModal()})})})}var self=this;self.feedbackRefObj={},self.referenceId=null,self.parentId=null,self.feedbackForm={},self.masterList=[],self.feedbackRequestList=[],self.feedbackView="listing",self.allMember=[],self.feedbackUsers=[],self.loggedInUser=null,self.inputRequired=!1,self.feedbackUpdated=!1,self.responseAvailable=!1,self.searchText="",self.individualFeedbackId=null,self.parentPage="",self.isDashboardOrigin=!1,self.isMobileDashboard=!1,self.dashboardMasterFeedbackListing=[],self.dashboardFeedbackListing=[],self.dashboardMasterFeedbackDetailListing=[],self.dashboardFeedbackDetailListing=[],self.activeFeedId="",self.selectedFilter="",self.listingFilter="",self.listingFilter1="ALL",self.listingFilterName1=$rootScope.pullInterNationalization("feedback.filters.status.viewAll.label"),self.formSubmitted=!1,self.statusFilterName=$rootScope.pullInterNationalization("feedback.filters.status.viewAll.label"),self.listingFilterName=$rootScope.pullInterNationalization("feedback.filters.status.viewAll.label"),self.noDataOnLoad=!1,self.scrollPos=0,self.feedbackTabId=-1,self.dashboardMasterFeedbackResponseListing=[],self.dashboardFeedbackResponseListing=[],self.feedbackResponseRefObj={},self.dashboardFeedbackDetailResponseListing=[],self.activeResponseFeed=-1,self.spFeatureName="",self.closeModal=closeModal,self.init=init,self.initResponseList=initResponseList,self.newFeedbackFlow=newFeedbackFlow,self.goBackToListing=goBackToListing,self.submitFeedbackRequest=submitFeedbackRequest,self.emailFeedback=emailFeedback,self.deleteModal=deleteModal,self.deleteFeedback=deleteFeedback,self.filterData=filterData,self.getDashboardDetail=getDashboardDetail,self.displayDetail=displayDetail,self.deleteFeedbackMobile=deleteFeedbackMobile,self.goBackToListingMobile=goBackToListingMobile,self.switchTabs=switchTabs,self.getDashboardDetailResponse=getDashboardDetailResponse,self.requestsTabFilters=requestsTabFilters,self.urlId=void 0!==sharedProperties.getParam("id")&&null!==sharedProperties.getParam("id")&&""!==sharedProperties.getParam("id")&&sharedProperties.getParam("id"),function(){$localStorage.remove("feedbackReqData","feedbackResData","feedbackResDetail")}();var prepareFeedbackForm=function(){return self.feedbackForm.devFeedRefId=self.feedbackRefObj.id,self.feedbackForm.spFeature=self.feedbackRefObj.feature,self.feedbackForm.feedbackUsers=self.feedbackUsers,self.feedbackForm.feedParentRefId=self.feedbackRefObj.parentId,self.feedbackForm};self.loadEmail=function(query){var deferred=$q.defer(),result=self.allMember.filter(function(e){return-1!==e.name.toLowerCase().indexOf(query.toLowerCase())||-1!==e.email.toLowerCase().indexOf(query.toLowerCase())});return deferred.resolve(result),deferred.promise},self.tagAdded=function(tag){self.feedbackUsers.push(tag.email)},self.tagRemoved=function(tag){self.feedbackUsers.splice(self.feedbackUsers.indexOf(tag.email),1)},window.addEventListener("popstate",function(e){$("#feedbackModal").length&&$scope.$apply(function(){self.closeModal()})})};return controller.$inject=["$scope","$filter"],{restrict:"EA",link:function($scope,$element,$attrs){$scope.parentPage=$attrs.parentPage,$templateRequest("/sp/resources/html/"+$attrs.urlSrc).then(function(html){var template=angular.element(html);$element.append(template),$compile(template)($scope)})},controller:controller,controllerAs:"feedbackCtrl",bindToController:!0}}angular.module("spApp").directive("feedbackRequests",feedbackRequests),angular.module("spApp").filter("feedbackFilter",function(){return function(items,type,filterType){var filtered=[];return"status"===filterType?angular.forEach(items,function(item){"ALL"===type?filtered.push(item):"NOT_INITIATED"===type&&"NOT_INITIATED"===item.requestStatus?filtered.push(item):"DECLINED"===type&&"DECLINED"===item.requestStatus?filtered.push(item):"COMPLETED"===type&&"COMPLETED"===item.requestStatus&&filtered.push(item)}):"feature"===filterType&&angular.forEach(items,function(item){"ALL"===type?filtered.push(item):"ERT-i"===type&&"Erti"===item.spFeature?filtered.push(item):"OrganizationPlan"===type&&"OrganizationPlan"===item.spFeature?filtered.push(item):"Competency"===type&&"Competency"===item.spFeature?filtered.push(item):"Blueprint"===type&&"Blueprint"===item.spFeature&&filtered.push(item)}),filtered}}),feedbackRequests.$inject=["$compile","$templateRequest","sharedProperties","feedbackService","ngDialog","$localStorage","$rootScope","basicService","$q","$filter"];
function notesGroupDiscussion($compile,$templateRequest,sharedProperties,notesService,basicService,$q,$localStorage,processSSEData,ngDialog,$timeout,miniPollsService){var controller=function($scope,$rootScope,$filter,$sce,miniPollsService){function miniPollHexOps(newsId,index,pIndex,mEvents){if(mEvents)self.hexHoverIndex[newsId]=index;else if(self.hexSelectedIndex[newsId]!==index)self.hexSelectedIndex[newsId]=index;else{var ele="#pollOptsScaleOl_"+pIndex+"_"+newsId+" input[type=radio]";self.hexSelectedIndex[newsId]=-1,$timeout(function(){$(ele).prop("checked",!1),self.pollVotingDetails[newsId]=""},200)}}function hasCompletedPoll(id,obj){var completed=!1;for(var key in obj)if(obj.hasOwnProperty(key)&&parseInt(key,10)===parseInt(id,10)){completed=obj[key];break}return completed}function assignPollCheck(ary,id){var ele="#miniPoll_"+id+" li.miniPollsOptsInput";$timeout(function(){$.each($(ele),function(index,val){-1!==ary.indexOf(index)&&$(this).find("input").prop("checked","checked")})},200)}function pollActions(type,id){for(var gId=-1,i=0;i<self.gdObj.comments.length;i++)self.gdObj.comments[i].cid===id&&(gId=i);switch(type){case"view":-1!==gId&&(self.gdObj.comments[gId].miniPoll.hideResults=!1);break;case"share":-1!==gId&&updatePollActions("share",id);break;case"end":-1!==gId&&updatePollActions("end",id)}}function setPollEndDate(){var dt=new Date;return[parseInt(dt.getFullYear(),10),parseInt(dt.getMonth()+1,10),parseInt(dt.getDate(),10),parseInt(dt.getHours(),10),parseInt(dt.getMinutes(),10),parseInt(dt.getSeconds(),10),parseInt(dt.getMilliseconds(),10)]}function updatePollActions(type,id,gid){miniPollsService.updatePoll("groupDiscussion",type,{commentId:id,gdId:gid}).then(function(response){if(null===response)return!0;for(var gId=-1,i=0;i<self.gdObj.comments.length;i++)self.gdObj.comments[i].cid===id&&(gId=i);-1!==gId&&("share"===type?(self.gdObj.comments[gId].miniPoll.hideResults=!1,self.pollHideResult[id]=!1):"end"===type&&(self.gdObj.comments[gId].miniPoll.result=response.miniPollResult,self.gdObj.comments[gId].miniPoll.endDate=setPollEndDate()))})}function getPollTotal(ary){return ary.reduce(function(a,b){return a+b})}function processVote(id,gid,cList){self.pollVotingError[id]=!0;var param={commentId:id,gdId:gid},opts=[];if(void 0!==self.pollVotingDetails[id]&&null!==self.pollVotingDetails[id]&&""!==self.pollVotingDetails[id])if(self.pollVotingError[id]=!1,"object"==typeof self.pollVotingDetails[id]){for(var key in self.pollVotingDetails[id])self.pollVotingDetails[id].hasOwnProperty(key)&&self.pollVotingDetails[id][key]&&opts.push(parseInt(key,10));opts.length?(param.selection=opts.toString(),answerPoll(id,param)):self.pollVotingError[id]=!0}else param.selection=parseInt(self.pollVotingDetails[id],10),answerPoll(id,param);else self.pollVotingError[id]=!0}function answerPoll(id,param){miniPollsService.updatePoll("groupDiscussion","answer",param).then(function(response){if(null===response)return!0;self.pollHasCompleted[id]=!0,self.gdObj.hasCompletedPolls[id]=!0;for(var gId=-1,i=0;i<self.gdObj.comments.length;i++)self.gdObj.comments[i].cid===id&&(gId=i);-1!==gId&&(self.gdObj.comments[gId].miniPoll.result=response.miniPollResult)})}function pollsView(action){self.miniPollsView=!0,self.gdEntry=""}function imagePop(url,title){$rootScope.showImageModal=!0,$rootScope.modalImageUrl=url}function ogPopup(url,mode,newtab){if("Video"===mode)if(newtab){var wind=window.open(url,"_blank");wind.focus()}else sharedProperties.videoPopUp(url);else{var modes=newtab?"_blank":"_self";window.open(url,modes).focus()}}function imageUrl(loop){var arrayofObj=[];for(var key in loop.media)if("Video"===loop.media[key].mediaType||"VideoTab"===loop.media[key].mediaType){arrayofObj.push(loop.media[key]);break}return arrayofObj.length||arrayofObj.push({url:loop.imageUrl,mediaType:"image"}),arrayofObj}function removeOGReference(){self.ogReference.authorSource=null,self.ogReference.description=null,self.ogReference.imageUrl=null,self.ogReference.media=[],self.ogReference.title=null,self.ogReference.valid=!1}function removeFileStackData(){self.fileStackEnabled=!1,self.ogReference.title=null,self.contentReference={},self.isDashboardOrigin||"dashboard"===self.noteSource||$rootScope.globalGDState||(self.contentReference=notesService.getReferenceData())}function previewMedia(url,type){if("Video"===type)sharedProperties.videoPopUp(url);else{window.open(url,"_blank").focus()}self.isDashboardOrigin?sharedProperties.fireAnalyticsEvent("Preview Media | GD dashboard",type):$rootScope.globalGDState?sharedProperties.fireAnalyticsEvent("Preview Media | GD global nav icon",type):sharedProperties.fireAnalyticsEvent("Preview Media | GD side panel",type)}function cancelNewGD(){self.tagsAdded=[],self.newGDFlow()}function getGD(id){notesService.getGD(id).then(function(data){self.gdObj=data,self.gdObj.comments.reverse(),self.activeGdId=data.id,self.showGDState="discussion",null!==$localStorage.get("shareComment")?self.gdEntry=$localStorage.get("shareComment"):self.gdEntry="",self.mode="update",self.inputRequired=!1,self.fileStackEnabled=!1,self.memberListing=[],self.userIdList=[],self.newGDUsersList=[],self.contentRefChecked=!1,self.hideDashboardDiscussion=!1,self.notifyCheck=!self.gdObj.filterNotification,null!==self.contentReference.spFeature&&"KnowledgeCenter"===self.contentReference.spFeature&&(self.gdEntry=self.contentReference.articleEntry),$timeout(function(){$("body .note-comments-updates-wrapper").animate({scrollTop:$("body .note-comments-updates-wrapper").prop("scrollHeight")},0)},500)}),self.removeOGReference()}function goBackToListing(){self.showGDState="listing",self.hideDashboardDiscussion=!1,self.memberListing=[],self.userIdList=[],self.newGDUsersList=[],self.tagsAdded=[],self.miniPollsView=!1,$localStorage.remove("shareComment"),self.gdUpdated&&(self.gdUpdated=!1,self.init())}function validateNewGroup(){if(self.inputRequired=!0,1===self.userIdList.length)return void(self.memberSelected=!1);self.memberSelected=!0,self.inputRequired=!1,self.notifyCheck=!0}function validateSaveGD(len){len&&self.validateNewGroup(),self.saveGD()}function saveGD(mpData){if(!(self.ogReference.valid||self.fileStackEnabled||""!==self.gdEntry&&void 0!==self.gdEntry||self.miniPollsView))return void(self.inputRequired=!0);self.inputRequired=!1,self.gdForm=prepareFormData(),self.gdUpdated=!1,self.contentRefChecked||(self.gdForm.comment.contentReference={}),self.fileStackEnabled&&(self.gdForm.comment.contentReference=self.fileStackData),self.ogReference.valid&&(self.ogReference.ogRef=!0,self.gdForm.comment.contentReference=self.ogReference),self.gdForm.comment.miniPoll=void 0!==mpData&&null!==mpData&&""!==mpData?mpData:null,notesService.saveGD(self.gdForm).then(function(data){if(data){var moduleName="";if(sharedProperties.growlMessage($rootScope.pullInterNationalization("gd.ajaxMessage.commentPost")),self.gdUpdated=!0,self.gdObj=data,self.gdObj.comments.reverse(),self.gdForm.name=data.name,self.activeGdId=data.id,self.gdEntry="",self.mode="update",self.showGDState="savedDiscussion",self.notifyCheck=!self.gdObj.filterNotification,$localStorage.remove("shareComment"),self.contentReference.articleEntry="",$timeout(function(){$("body .note-comments-updates-wrapper").animate({scrollTop:$("body .note-comments-updates-wrapper").prop("scrollHeight")},0)},500),self.isDashboardOrigin){void 0===self.gdListing&&(self.gdListing=[]);var tempObj={};tempObj.id=self.gdObj.id,tempObj.name=self.gdObj.name,tempObj.unreadCount=0,tempObj.lastComment=self.gdObj.comments[0],self.gdListing.unshift(tempObj),tempObj=null}else notesService.getAllGD(self.isDashboardOrigin).then(function(data){data.Success&&(self.gdListing=data.gdListing)});self.isDashboardOrigin?sharedProperties.fireAnalyticsEvent("GD | New group created from dashboard","N/A"):$rootScope.globalGDState?sharedProperties.fireAnalyticsEvent("GD | New group created from global nav icon","N/A"):(moduleName=null===self.contentReference.spFeature?"Module Name - Knowledge Center":"Module Name - "+self.contentReference.spFeature,sharedProperties.fireAnalyticsEvent("GD | New group created from side panel","Title - "+self.contentReference.title+", "+moduleName+", Reference Included - "+self.contentRefChecked)),self.contentRefChecked=!1,self.removeFileStackData(),self.removeOGReference(),$(".panel-fixed-height").scrollTop(0)}})}function updateGD(mpData){if(!(self.ogReference.valid||self.fileStackEnabled||""!==self.gdEntry&&void 0!==self.gdEntry||self.miniPollsView))return void(self.inputRequired=!0);self.inputRequired=!1,self.gdForm=updateFormData(),self.gdUpdated=!1,self.contentRefChecked||(self.gdForm.comment.contentReference={}),self.fileStackEnabled&&(self.gdForm.comment.contentReference=self.fileStackData),self.ogReference.valid&&(self.ogReference.ogRef=!0,self.gdForm.comment.contentReference=self.ogReference),self.gdForm.comment.miniPoll=void 0!==mpData&&null!==mpData&&""!==mpData?mpData:null,notesService.updateGD(self.gdForm).then(function(data){if(data){var moduleNameUpdate="";if(self.gdUpdated=!0,self.gdObj=data,self.gdObj.comments.reverse(),self.activeGdId=data.id,self.gdEntry="",self.mode="update",$localStorage.remove("shareComment"),self.contentReference.articleEntry="",self.notifyCheck=!self.gdObj.filterNotification,$timeout(function(){$("body .note-comments-updates-wrapper").animate({scrollTop:$("body .note-comments-updates-wrapper").prop("scrollHeight")},0)},500),self.isDashboardOrigin)for(var i=0;i<self.gdListing.length;i++)self.gdListing[i].id===self.gdObj.id&&(self.gdListing[i].name=self.gdObj.name,self.gdListing[i].unreadCount=0,self.gdListing[i].lastComment=self.gdObj.comments[0]);else notesService.getAllGD(self.isDashboardOrigin).then(function(data){data.Success&&(self.gdListing=data.gdListing)});self.isDashboardOrigin?sharedProperties.fireAnalyticsEvent("GD | comment added from dashboard","N/A"):$rootScope.globalGDState?sharedProperties.fireAnalyticsEvent("GD | comment added from global nav icon","N/A"):(moduleNameUpdate=null===self.contentReference.spFeature?"Module Name - Knowledge Center":"Module Name - "+self.contentReference.spFeature,sharedProperties.fireAnalyticsEvent("GD | comment added from side panel","Title - "+self.contentReference.title+", "+moduleNameUpdate+", Reference Included - "+self.contentRefChecked)),self.contentRefChecked=!1,self.removeFileStackData(),self.removeOGReference(),$(".panel-fixed-height").scrollTop(0)}})}function newGDFlow(){self.showGDState="newDiscussion1",self.gdUpdated=!1,self.mode="create",self.fileStackEnabled=!1,self.gdObj={},self.gdForm={},self.activeGdId="",null!==$localStorage.get("shareComment")?self.gdEntry=$localStorage.get("shareComment"):self.gdEntry="",self.newGDUsersList=[],self.memberListing=[],self.userIdList=[],self.tagsAdded=[],self.memberListing.push(self.loggedInUser.member),self.userIdList.push(self.loggedInUser.member.id),self.contentRefChecked=!1,self.inputRequired=!1,null!==self.contentReference.spFeature&&"KnowledgeCenter"===self.contentReference.spFeature&&(self.gdEntry=self.contentReference.articleEntry),self.removeOGReference(),$(window).width()<768&&/android/i.test(navigator.userAgent)?(self.adjustHeight=!0,$("body").on("focusin",".new-gd",function(){$(".note-comments-updates-wrapper").fadeOut()}),$("body").on("focusout",".new-gd",function(){$(".note-comments-updates-wrapper").fadeIn()})):self.adjustHeight=!1}function updateGroupSettings(){self.tagsAdded=[],self.hideDashboardDiscussion=!0,self.gdObj.nameOverriden?self.newGroupName=self.gdObj.name:self.newGroupName="",self.showGDState="settings",self.inputRequired=!1,notesService.getMembersInGD(self.activeGdId).then(function(data){self.memberListing=data,void 0===self.memberListing&&(self.memberListing=[],self.userIdList=[]),self.memberListing=$filter("orderBy")(self.memberListing,"name"),self.memberListing.unshift(self.loggedInUser.member),self.userIdList.unshift(self.loggedInUser.member.id);for(var i=0;i<self.memberListing.length;i++)self.memberListing[i].existing=!0,self.userIdList.push(self.memberListing[i].id)})}function leaveGroup(){self.hideDashboardDiscussion=!1,notesService.leaveGroupDiscussion(self.activeGdId).then(function(data){data&&(sharedProperties.growlMessage($rootScope.pullInterNationalization("gd.ajaxMessage.leaveGroup")),$localStorage.remove("shareComment"),self.isDashboardOrigin?(sharedProperties.spilceIndexWithBreak(self.gdListing,"id",self.activeGdId),self.gdListing.length?self.getGD(self.gdListing[0].id):self.newGDFlow()):(self.gdUpdated=!0,self.goBackToListing()),self.isDashboardOrigin?sharedProperties.fireAnalyticsEvent("GD | leave group from dashboard","N/A"):$rootScope.globalGDState?sharedProperties.fireAnalyticsEvent("GD | leave group from global nav icon","N/A"):sharedProperties.fireAnalyticsEvent("GD | leave group from side panel","N/A"))})}function filterNotification(){notesService.filterNotification(self.activeGdId,!self.notifyCheck).then(function(data){data&&console.log("notification "+self.notifyCheck)})}function updateGroupInfo(){self.gdUpdated=!1;var nameCleared=!1;nameCleared=""===self.newGroupName,self.gdObj.nameOverriden&&self.newGroupName===self.gdObj.name&&(self.newGroupName=void 0),self.gdObj.nameOverriden&&void 0!==self.newGroupName||!self.gdObj.nameOverriden&&""!==self.newGroupName||self.gdObj.nameOverriden&&""===self.newGroupName||self.newGDUsersList.length>0?notesService.updateGroupSettings(self.newGroupName,self.activeGdId,self.newGDUsersList,nameCleared).then(function(data){if(data.Success)if(sharedProperties.growlMessage($rootScope.pullInterNationalization("gd.ajaxMessage.groupUpdated")),self.gdUpdated=!0,$localStorage.remove("shareComment"),self.isDashboardOrigin){for(var i=0;i<self.gdListing.length;i++)self.gdListing[i].id===data.gd.id&&(self.gdListing[i].name=data.gd.name,self.gdListing[i].unreadCount=0,self.gdListing[i].lastComment=data.gd.comments[0]);self.getGD(self.activeGdId)}else notesService.getAllGD(self.isDashboardOrigin).then(function(data){data.Success&&(self.gdListing=data.gdListing,self.getGD(self.activeGdId))})}):(self.showGDState="discussion",self.hideDashboardDiscussion=!1),self.miniPollsView=!1}function init(){self.noteSource=$scope.noteSource,$rootScope.unreadCount=0,$localStorage.set("gdCount",0),$rootScope.gdActive=!0,self.fileStackEnabled=!1,void 0!==self.noteSource&&"dashboard"===self.noteSource&&$(window).width()>767&&(self.isDashboardOrigin=!0),null!==$localStorage.get("shareComment")&&(self.gdEntry=$localStorage.get("shareComment")),self.loggedInUser=$localStorage.get("loggegdInProfile"),notesService.getAllGD(self.isDashboardOrigin).then(function(data){if(data.Success){self.gdListing=data.gdListing;var gdParam=$localStorage.get("gdParam");self.isDashboardOrigin?void 0!==self.gdListing&&self.gdListing.length?""!==gdParam&&null!==gdParam?(self.getGD(gdParam),$localStorage.remove("gdParam")):(self.gdListing[0].unreadCount=0,self.gdObj=data.gd,self.activeGdId=self.gdObj.id,self.showGDState="discussion",self.notifyCheck=!self.gdObj.filterNotification,null!==$localStorage.get("shareComment")?self.gdEntry=$localStorage.get("shareComment"):self.gdEntry="",self.mode="update",self.inputRequired=!1,self.memberListing=[],self.userIdList=[],self.newGDUsersList=[],self.contentRefChecked=!1):self.mode="noData":""!==gdParam&&null!==gdParam&&"gd"===sharedProperties.getParam("open")&&(self.getGD(gdParam),$timeout(function(){history.replaceState("","","/sp/dashboard")},200),$localStorage.remove("gdParam")),self.responseAvailable=!0}}),basicService.getAllValidMember().then(function(response){if(self.allMember=response,null!==self.loggedInUser)for(var i=0;i<self.allMember.length;i++)if(self.allMember[i].email===self.loggedInUser.member.email){self.allMember.splice(i,1);break}}),self.isDashboardOrigin||"dashboard"===self.noteSource||$rootScope.globalGDState||(self.contentReference=notesService.getReferenceData()),self.ogReference=notesService.getOGReference()}var self=this;self.gdObj={},self.gdListing=[],self.gdForm={},self.activeGdId="",self.showGDState="listing",self.gdEntry="",self.inputRequired=!1,self.memberSelected=!0,self.commentForm={},self.contentReference={},self.mediaList=[],self.media={},self.gdUpdated=!1,self.mode="",self.searchText="",self.memberListing=[],self.userIdList=[],self.responseAvailable=!1,self.filteredMemberList=[],self.loggedInUser=null,self.newGroupName="",self.newGDUsersList=[],self.contentRefChecked=!1,self.tagsAdded=[],self.noteSource="",self.isDashboardOrigin=!1,self.hideDashboardDiscussion=!1,self.fileStackEnabled=!1,self.fileStackData={},self.notifyCheck=!0,self.fileStackMimeType="",self.ogReference={},self.processOG=!1,self.adjustHeight=!1,self.getGD=getGD,self.saveGD=saveGD,self.newGDFlow=newGDFlow,self.updateGroupSettings=updateGroupSettings,self.leaveGroup=leaveGroup,self.validateNewGroup=validateNewGroup,self.updateGD=updateGD,self.goBackToListing=goBackToListing,self.updateGroupInfo=updateGroupInfo,self.init=init,self.cancelNewGD=cancelNewGD,self.previewMedia=previewMedia,self.removeFileStackData=removeFileStackData,self.imagePop=imagePop,self.filterNotification=filterNotification,self.removeOGReference=removeOGReference,self.imageUrl=imageUrl,self.ogPopup=ogPopup,self.validateSaveGD=validateSaveGD,self.pollVotingDetails=[],self.pollResults=[],self.pollHideResult=[],self.pollHasCompleted=[],self.pollVotingError=[],self.miniPollsView=!1,self.hexSelectedIndex=[],self.hexHoverIndex=[],self.hexChar=$sce.trustAsHtml(sharedProperties.processRatingHex(1,"minipolls")),self.hexAvg=$sce.trustAsHtml(sharedProperties.processRatingHex(5,"minipolls")),self.pollsView=pollsView,self.processVote=processVote,self.getPollTotal=getPollTotal,self.pollActions=pollActions,self.assignPollCheck=assignPollCheck,self.hasCompletedPoll=hasCompletedPoll,self.miniPollHexOps=miniPollHexOps;var prepareFormData=function(){return self.gdForm.memberIds=self.userIdList,self.commentForm.comment=self.gdEntry,self.commentForm.contentReference=self.contentReference,null!==self.commentForm.contentReference&&null!==self.commentForm.contentReference.spFeature&&"KnowledgeCenter"===self.commentForm.contentReference.spFeature&&(self.commentForm.contentReference.spFeature=null),self.gdForm.comment=self.commentForm,self.gdForm},updateFormData=function(){return self.gdForm.gdId=self.activeGdId,self.commentForm.comment=self.gdEntry,self.commentForm.contentReference=self.contentReference,null!==self.commentForm.contentReference&&null!==self.commentForm.contentReference.spFeature&&"KnowledgeCenter"===self.commentForm.contentReference.spFeature&&(self.commentForm.contentReference.spFeature=null),self.gdForm.comment=self.commentForm,self.gdForm};self.filterGDList=function(query){var tmpList=angular.copy(self.allMember);tmpList=tmpList.filter(function(obj){for(var i=0;i<self.memberListing.length;i++)if(self.memberListing[i].id===obj.id)return!1;return!0});var deferred=$q.defer(),result=tmpList.filter(function(e){return-1!==e.name.toLowerCase().indexOf(query.toLowerCase())||-1!==e.email.toLowerCase().indexOf(query.toLowerCase())});return deferred.resolve(result),deferred.promise},self.loadEmail=function(query){var deferred=$q.defer(),result=self.allMember.filter(function(e){return-1!==e.name.toLowerCase().indexOf(query.toLowerCase())||-1!==e.email.toLowerCase().indexOf(query.toLowerCase())});return deferred.resolve(result),deferred.promise},self.tagAdded=function(tag){self.memberListing.push(tag),self.userIdList.push(tag.id),self.memberSelected=!0,"settings"===self.showGDState&&self.newGDUsersList.push(tag.id)},self.tagRemoved=function(tag){sharedProperties.spilceIndexWithBreak(self.memberListing,"id",tag.id),sharedProperties.spilceIndexWithBreak(self.tagsAdded,"id",tag.id);var i=self.userIdList.indexOf(tag.id);if(-1!==i&&self.userIdList.splice(i,1),"settings"===self.showGDState){var j=self.newGDUsersList.indexOf(tag.id);-1!==j&&self.newGDUsersList.splice(j,1)}};$scope.$on("groupDiscussion",function(e,data){if(null===data)return!0;$scope.$apply(function(){processSSEData.processData(self,data)})}),$scope.$on("fileStackSuccessNotes",function(e,data){if(null===data)return!0;$scope.$apply(function(){var mediaType=sharedProperties.mapMediaType(data.fileData.mimetype);self.fileStackEnabled=!0,self.fileStackData.title=data.fileData.filename,self.fileStackData.description=null,self.fileStackData.authorSource=null,self.fileStackData.media=[],self.fileStackData.media.push({id:null,name:null,altText:null,tags:null,url:null,height:0,width:0,companyId:null,createdOn:null,status:null,mediaType:mediaType,companyName:null,linkText:null}),self.fileStackData.spFeature=null,self.fileStackData.url=data.fileData.url,self.fileStackData.newTab=!0,self.fileStackData.subTitle=null,self.fileStackData.fileStack=!0,self.fileStackData.client=data.fileData.client,self.fileStackData.imageUrl="Video"===mediaType?"/sp/resources/images/video-default.png":"IMAGE"===mediaType?data.fileData.url:"/sp/resources/images/media_default.jpg",self.fileStackMimeType=mediaType,self.contentReference=self.fileStackData,self.ogReference.title=data.fileData.filename})})};return controller.$inject=["$scope","$rootScope","$filter","$sce","miniPollsService"],{restrict:"EA",link:function($scope,$element,$attrs){$scope.noteSource=$attrs.noteSource,$templateRequest("/sp/resources/html/"+$attrs.urlSrc).then(function(html){var template=angular.element(html);$element.append(template),$compile(template)($scope)})},controller:controller,controllerAs:"notesCtrl",bindToController:!0}}angular.module("spApp").directive("notesGroupDiscussion",notesGroupDiscussion),notesGroupDiscussion.$inject=["$compile","$templateRequest","sharedProperties","notesService","basicService","$q","$localStorage","processSSEData","ngDialog","$timeout"];
function notesPrivate($compile,$templateRequest,sharedProperties,notesService,ngDialog,$localStorage,$timeout){var controller=function($scope,$rootScope){function imagePop(url,title){$rootScope.showImageModal=!0,$rootScope.modalImageUrl=url}function ogPopup(url,mode,newtab){if("Video"===mode)if(newtab){var wind=window.open(url,"_blank");wind.focus()}else sharedProperties.videoPopUp(url);else{var modes=newtab?"_blank":"_self";window.open(url,modes).focus()}}function imageUrl(loop){var arrayofObj=[];for(var key in loop.media)if("Video"===loop.media[key].mediaType||"VideoTab"===loop.media[key].mediaType){arrayofObj.push(loop.media[key]);break}return arrayofObj.length||arrayofObj.push({url:loop.imageUrl,mediaType:"image"}),arrayofObj}function removeOGReference(){self.ogReference.authorSource=null,self.ogReference.description=null,self.ogReference.imageUrl=null,self.ogReference.media=[],self.ogReference.title=null,self.ogReference.valid=!1}function removeFileStackData(){self.fileStackEnabled=!1,self.ogReference.title=null,self.contentReference={},self.isDashboardOrigin||"dashboard"===self.noteSource||$rootScope.globalGDState||(self.contentReference=notesService.getReferenceData())}function previewMedia(url,type){if("Video"===type)sharedProperties.videoPopUp(url);else{window.open(url,"_blank").focus()}self.isDashboardOrigin?sharedProperties.fireAnalyticsEvent("Preview Media | Private Notes dashboard",type):$rootScope.globalGDState?sharedProperties.fireAnalyticsEvent("Preview Media | Private Notes global nav icon",type):sharedProperties.fireAnalyticsEvent("Preview Media | Private Notes side panel",type)}function shareComments(content,type){self.showNote=!1,$localStorage.set("shareComment",content),$rootScope.selectedNotesTab=type}function editMode(commentText,index){self.editCommentMode=!0,self.editedComment=commentText,jQuery("#commentEdit_"+index).fadeIn(),jQuery("#commentView_"+index).hide()}function cancelEdit(index){self.editCommentMode=!1,self.editedComment="",self.inputRequiredForComment=!1,jQuery("#commentView_"+index).fadeIn(),jQuery("#commentEdit_"+index).hide()}function getNoteDetail(noteId){notesService.getNote(noteId).then(function(data){self.noteObj=data,self.noteObj.noteData.reverse(),self.activeNoteId=data.noteId,self.showNote=!0,self.noteEntry="",self.mode="update",self.inputRequired=!1,self.inputRequiredForComment=!1,self.showNotesOptions=!1,self.contentRefChecked=!1,self.editCommentMode=!1,self.fileStackEnabled=!1,null!==self.contentReference.spFeature&&"KnowledgeCenter"===self.contentReference.spFeature&&(self.noteEntry=self.contentReference.articleEntry),$timeout(function(){$("body .notes-comments-list-wrapper").animate({scrollTop:$("body .notes-comments-list-wrapper").prop("scrollHeight")},0)},500)}),self.removeOGReference()}function emailNotes(){notesService.emailNotes(self.activeNoteId).then(function(data){data&&(self.showNotesOptions=!1,sharedProperties.growlMessage($rootScope.pullInterNationalization("notes.ajaxMessage.emailSent")),self.isDashboardOrigin?sharedProperties.fireAnalyticsEvent("Private Notes | Send Email from Dashboard","N/A"):$rootScope.globalGDState?sharedProperties.fireAnalyticsEvent("Private Notes | Send Email from global nav icon","N/A"):sharedProperties.fireAnalyticsEvent("Private Notes | Send Email from side panel","N/A"))})}function updateComment(commentId,contentRef,index){if(""===self.editedComment||void 0===self.editedComment)return void(self.inputRequiredForComment=!0);self.activeCommentId=commentId,self.notesForm={},self.notesForm=prepareFormData(contentRef),notesService.saveNote(self.notesForm,!1).then(function(data){data&&(sharedProperties.growlMessage($rootScope.pullInterNationalization("notes.ajaxMessage.notesUpdates")),self.notesUpdated=!0,jQuery("#commentView_"+index).fadeIn(),jQuery("#commentEdit_"+index).hide(),self.isDashboardOrigin?notesService.getNote(self.activeNoteId).then(function(data){self.noteObj=data,self.activeNoteId=data.noteId,self.showNote=!0,self.noteEntry="",self.mode="update",self.inputRequired=!1,self.inputRequiredForComment=!1,self.showNotesOptions=!1,self.contentRefChecked=!1,self.editCommentMode=!1;for(var i=0;i<self.notesListing.length;i++)self.notesListing[i].nid===self.activeNoteId&&(self.notesListing[i].title=self.noteObj.title,self.notesListing[i].comment=self.noteObj.noteData[0].text,self.notesListing[i].updatedOn=self.noteObj.noteData[0].createdOn)}):self.getNoteDetail(self.activeNoteId))})}function saveNotes(){var newNote=!0;if(!(self.ogReference.valid||self.fileStackEnabled||""!==self.noteEntry&&void 0!==self.noteEntry))return void(self.inputRequired=!0);self.inputRequired=!1,self.notesForm=prepareFormData(),"update"===self.mode&&(newNote=!1),self.contentRefChecked||(self.notesForm.commentForm.contentReference={}),self.fileStackEnabled&&(self.notesForm.commentForm.contentReference=self.fileStackData),self.ogReference.valid&&(self.ogReference.ogRef=!0,self.notesForm.commentForm.contentReference=self.ogReference),notesService.saveNote(self.notesForm,newNote).then(function(data){if(data){var moduleName="";if(sharedProperties.growlMessage($rootScope.pullInterNationalization("notes.ajaxMessage.noteSaved")),self.notesUpdated=!0,"create"===self.mode){if(self.noteObj=data.noteDetail,self.activeNoteId=self.noteObj.noteId,self.showNote=!0,self.noteEntry="",self.mode="update",self.inputRequired=!1,self.inputRequiredForComment=!1,self.editCommentMode=!1,self.isDashboardOrigin){var tempListObj={};tempListObj.nid=self.noteObj.noteId,tempListObj.title=self.noteObj.title,tempListObj.comment=self.noteObj.noteData[0].text,tempListObj.updatedOn=self.noteObj.noteData[0].createdOn,self.notesListing.unshift(tempListObj)}}else self.isDashboardOrigin?notesService.getNote(self.activeNoteId).then(function(data){self.noteObj=data,self.activeNoteId=data.noteId,self.showNote=!0,self.noteEntry="",self.mode="update",self.inputRequired=!1,self.inputRequiredForComment=!1,self.showNotesOptions=!1,self.editCommentMode=!1;for(var i=0;i<self.notesListing.length;i++)self.notesListing[i].nid===self.activeNoteId&&(self.notesListing[i].title=self.noteObj.title,self.notesListing[i].comment=self.noteObj.noteData[0].text,self.notesListing[i].updatedOn=self.noteObj.noteData[0].createdOn)}):self.getNoteDetail(self.activeNoteId);self.contentReference.articleEntry="",newNote?self.isDashboardOrigin?sharedProperties.fireAnalyticsEvent("Private Notes | New Note Posted from dashboard","N/A"):$rootScope.globalGDState?sharedProperties.fireAnalyticsEvent("Private Notes | New Note Posted from global nav icon","N/A"):(moduleName=null===self.contentReference.spFeature?"Module Name - Knowledge Center":"Module Name - "+self.contentReference.spFeature,sharedProperties.fireAnalyticsEvent("Private Notes | New Note Posted from side panel","Title - "+self.contentReference.title+", "+moduleName+", Reference Included - "+self.contentRefChecked)):self.isDashboardOrigin?sharedProperties.fireAnalyticsEvent("Private Notes | Comment added from dashboard","N/A"):$rootScope.globalGDState?sharedProperties.fireAnalyticsEvent("Private Notes | Comment added from global nav icon","N/A"):(moduleName=null===self.contentReference.spFeature?"Module Name - Knowledge Center":"Module Name - "+self.contentReference.spFeature,sharedProperties.fireAnalyticsEvent("Private Notes | Comment added from side panel","Title - "+self.contentReference.title+", "+moduleName+", Reference Included - "+self.contentRefChecked)),self.contentRefChecked=!1,self.removeFileStackData(),self.removeOGReference()}})}function goBackToListing(){self.showNote=!1,self.editCommentMode=!1,self.notesUpdated&&(self.notesUpdated=!1,self.init())}function newNoteFlow(){self.showNote=!0,self.mode="create",self.noteObj={},self.activeNoteId="",self.noteEntry="",self.inputRequired=!1,self.inputRequiredForComment=!1,self.showNotesOptions=!1,self.contentRefChecked=!1,self.editCommentMode=!1,self.fileStackEnabled=!1,null!==self.contentReference&&void 0!==self.contentReference&&void 0!==self.contentReference.title&&null!==self.contentReference.title&&(self.noteObj.title=self.contentReference.title.replace("&#174;","")),null!==self.contentReference&&void 0!==self.contentReference&&null!==self.contentReference.spFeature&&"KnowledgeCenter"===self.contentReference.spFeature&&(self.noteEntry=self.contentReference.articleEntry),self.removeOGReference()}function deleteNoteOrComment(){notesService.deleteNoteOrComment(self.activeNoteId,self.activeCommentId).then(function(data){if(data){if(ngDialog.close(),sharedProperties.growlMessage(0===self.activeCommentId?$rootScope.pullInterNationalization("notes.ajaxMessage.noteDeleted"):$rootScope.pullInterNationalization("notes.ajaxMessage.commentDeleted")),self.notesUpdated=!0,self.showNotesOptions=!1,0!==self.activeCommentId){if(sharedProperties.spilceIndexWithBreak(self.noteObj.noteData,"cid",self.activeCommentId),0===self.noteObj.noteData.length)self.goBackToListing();else if(self.isDashboardOrigin)for(var i=0;i<self.notesListing.length;i++)self.notesListing[i].nid===self.activeNoteId&&(self.notesListing[i].title=self.noteObj.title,self.notesListing[i].comment=self.noteObj.noteData[0].text,self.notesListing[i].updatedOn=self.noteObj.noteData[0].createdOn)}else self.goBackToListing();self.isDashboardOrigin?sharedProperties.fireAnalyticsEvent("Private Notes | Delete from dashboard",0===self.activeCommentId?"Note Deleted":"Comment Deleted"):$rootScope.globalGDState?sharedProperties.fireAnalyticsEvent("Private Notes | Delete from global nav icon",0===self.activeCommentId?"Note Deleted":"Comment Deleted"):sharedProperties.fireAnalyticsEvent("Private Notes | Delete from side panel",0===self.activeCommentId?"Note Deleted":"Comment Deleted")}})}function deleteModal(commentId){self.activeCommentId=commentId,ngDialog.open({template:"/sp/resources/html/notes/delete-note.html",scope:$scope})}function updateTitle(title){"update"===self.mode&&notesService.updateTitle(self.activeNoteId,title).then(function(data){if(data)if(self.isDashboardOrigin)for(var i=0;i<self.notesListing.length;i++)self.notesListing[i].nid===self.activeNoteId&&(self.notesListing[i].title=title);else self.notesUpdated=!0})}function init(){$localStorage.remove("shareComment"),$rootScope.gdActive=!1,self.noteSource=$scope.noteSource,void 0!==self.noteSource&&"dashboard"===self.noteSource&&$(window).width()>767&&(self.isDashboardOrigin=!0),notesService.getAllPrivateNotes(self.isDashboardOrigin).then(function(data){data.Success&&(self.notesListing=data.noteListing,self.isDashboardOrigin&&(self.notesListing.length?(self.noteObj=data.noteDetail,self.activeNoteId=self.noteObj.noteId,self.noteEntry="",self.mode="update",self.inputRequired=!1,self.inputRequiredForComment=!1,self.showNotesOptions=!1,self.contentRefChecked=!1,self.editCommentMode=!1,self.fileStackEnabled=!1):self.mode="noData"),self.responseAvailable=!0)}),self.isDashboardOrigin||"dashboard"===self.noteSource||$rootScope.globalGDState||(self.contentReference=notesService.getReferenceData()),self.ogReference=notesService.getOGReference()}var self=this;self.noteObj={},self.notesListing=[],self.notesForm={},self.activeNoteId="",self.showNote=!1,self.noteEntry="",self.inputRequired=!1,self.commentForm={},self.contentReference={},self.mediaList=[],self.media={},self.notesUpdated=!1,self.mode="",self.searchText="",self.responseAvailable=!1,self.showNotesOptions=!1,self.activeCommentId=0,self.contentRefChecked=!1,self.editCommentMode=!1,self.editedComment="",self.inputRequiredForComment=!1,self.noteSource="",self.isDashboardOrigin=!1,self.fileStackEnabled=!1,self.fileStackData={},self.fileStackMimeType="",self.ogReference={},self.processOG=!1,self.init=init,self.getNoteDetail=getNoteDetail,self.saveNotes=saveNotes,self.emailNotes=emailNotes,self.deleteNoteOrComment=deleteNoteOrComment,self.goBackToListing=goBackToListing,self.newNoteFlow=newNoteFlow,self.deleteModal=deleteModal,self.editMode=editMode,self.cancelEdit=cancelEdit,self.updateComment=updateComment,self.shareComments=shareComments,self.previewMedia=previewMedia,self.updateTitle=updateTitle,self.removeFileStackData=removeFileStackData,self.imagePop=imagePop,self.removeOGReference=removeOGReference,self.imageUrl=imageUrl,self.ogPopup=ogPopup;var prepareFormData=function(contentRef){return void 0!==self.noteObj&&void 0!==self.noteObj.noteId&&(self.notesForm.noteId=self.noteObj.noteId),"create"===self.mode&&(self.notesForm.noteId=void 0),self.notesForm.title=""===self.noteObj.title?"New Topic":self.noteObj.title,self.editCommentMode?(self.commentForm.comment=self.editedComment,self.commentForm.cid=self.activeCommentId,self.commentForm.contentReference=contentRef):(self.commentForm.comment=self.noteEntry,self.commentForm.contentReference=self.contentReference),null!==self.commentForm.contentReference&&null!==self.commentForm.contentReference.spFeature&&"KnowledgeCenter"===self.commentForm.contentReference.spFeature&&(self.commentForm.contentReference.spFeature=null),self.notesForm.commentForm=self.commentForm,self.notesForm};jQuery(function($){var currentVal="";$("body").on("focusin",".private-notes-title",function(){currentVal=$(this).val()}),$("body").on("blur",".private-notes-title",function(){$(this).val()!==currentVal?""===$(this).val().trim()?self.updateTitle("New Topic"):self.updateTitle($(this).val()):$(this).val(currentVal)})});$scope.$on("fileStackSuccessNotes",function(e,data){if(null===data)return!0;$scope.$apply(function(){var mediaType=sharedProperties.mapMediaType(data.fileData.mimetype);self.fileStackEnabled=!0,self.fileStackData.title=data.fileData.filename,self.fileStackData.description=null,self.fileStackData.authorSource=null,self.fileStackData.media=[],self.fileStackData.media.push({id:null,name:null,altText:null,tags:null,url:null,height:0,width:0,companyId:null,createdOn:null,status:null,mediaType:mediaType,companyName:null,linkText:null}),self.fileStackData.spFeature=null,self.fileStackData.url=data.fileData.url,self.fileStackData.newTab=!0,self.fileStackData.subTitle=null,self.fileStackData.fileStack=!0,self.fileStackData.client=data.fileData.client,self.fileStackData.imageUrl="Video"===mediaType?"/sp/resources/images/video-default.png":"IMAGE"===mediaType?data.fileData.url:"/sp/resources/images/media_default.jpg",self.fileStackMimeType=mediaType,self.contentReference=self.fileStackData,self.ogReference.title=data.fileData.filename})})};return controller.$inject=["$scope","$rootScope"],{restrict:"EA",link:function($scope,$element,$attrs){$scope.noteSource=$attrs.noteSource,$templateRequest("/sp/resources/html/"+$attrs.urlSrc).then(function(html){var template=angular.element(html);$element.append(template),$compile(template)($scope)})},controller:controller,controllerAs:"notesCtrl",bindToController:!0}}angular.module("spApp").directive("notesPrivate",notesPrivate),notesPrivate.$inject=["$compile","$templateRequest","sharedProperties","notesService","ngDialog","$localStorage","$timeout"];
function notesTab($compile,$templateRequest,sharedProperties,$rootScope,notesService,$localStorage){var controller=function($scope){function updateTabView(tab){$rootScope.selectedNotesTab=tab}function closeModal(){$rootScope.showNotesPanel=!1,$rootScope.gdActive=!1,$rootScope.selectedNotesTab="",delete $rootScope.fadeInTutorial,$("#notesModal").modal("hide"),$localStorage.remove("shareComment"),$rootScope.globalGDState=!1,$rootScope.$broadcast("modalClosed"),$("body").css("overflow-y","visible"),sharedProperties.is_touch_supported()&&sharedProperties.is_iOS_device()&&($("body").css("position",""),$("body").animate({scrollTop:self.scrollPos},0))}function init(){var notesReferenceObj=sharedProperties.getSelectedNotesTab();self.referenceObject=notesReferenceObj.referenceObj,notesService.mapReferenceData(self.referenceObject),$localStorage.remove("shareComment"),$rootScope.showNotifications=!1,$("#notifyModal").modal("hide"),window.setTimeout(function(){$("#notesModal").modal("show");$(window).scrollTop(),$(window).scrollTop();$("#notesModal").length&&("/sp/dashboard"===window.location.pathname&&$("body").css("overflow-y","hidden"),sharedProperties.is_touch_supported()&&sharedProperties.is_iOS_device()&&(self.scrollPos=$("body").scrollTop(),$("body").css("position","fixed")),history.pushState({action:"modal"},"",window.location.href))},200),jQuery(function($){$("body").on("click touchend",".modal-backdrop",function(){$scope.$apply(function(){self.closeModal()})}),$(document).keyup(function(e){27===e.keyCode&&$scope.$apply(function(){self.closeModal()})})})}var self=this;self.selectedNotesTab="",self.referenceObject={},self.closeModal=closeModal,self.updateTabView=updateTabView,self.mobileView=$(window).width()<768,self.dashboardView="/sp/dashboard"===window.location.pathname,self.init=init,self.scrollPos=0,$rootScope.$on("ngDialog.opened",function(e){$("body .modal.right.fade .sticky-footer").css("z-index","990")}),$rootScope.$on("ngDialog.closed",function(e){$("body .modal.right.fade .sticky-footer").css("z-index","1000")}),window.addEventListener("popstate",function(e){var closeIt=!0;"gd"===sharedProperties.getParam("open")&&"gd"===$rootScope.selectedNotesTab&&(closeIt=!1,history.pushState({action:"modal"},"","/sp/dashboard")),$("#notesModal").length&&closeIt&&$scope.$apply(function(){self.closeModal()})})};return controller.$inject=["$scope"],{restrict:"EA",link:function($scope,$element,$attrs){$templateRequest("/sp/resources/html/"+$attrs.urlSrc).then(function(html){var template=angular.element(html);$element.append(template),$compile(template)($scope)})},controller:controller,controllerAs:"notesCtrl",bindToController:!0}}angular.module("spApp").directive("notesTab",notesTab),notesTab.$inject=["$compile","$templateRequest","sharedProperties","$rootScope","notesService","$localStorage"];
function basicService(ajaxService,sharedProperties,$localStorage,$q){var promise,serviceUrl={allUser:"/sp/allUsers",allGroups:"/sp/admin/group/all",allCompetency:"/sp/admin/competency/getUserCompetency",allOrganization:"/sp/admin/account/actionPlan/getCompanyActionPlans",combinedUserDetail:"/sp/goals/groupView/getMemberLndCompDetails"};this.getAllValidMember=function(){var deferred=$q.defer();if(sharedProperties.getValidUser().length)deferred.resolve(sharedProperties.getValidUser());else{if(promise)return promise;ajaxService.getAjaxResponse({url:serviceUrl.allUser,data:$.param({isAccountAdmin:!0})}).then(function(response){"true"===response.Success?(sharedProperties.setValidUser(response.allMembers),deferred.resolve(response.allMembers)):null!==response.error&&sharedProperties.ajaxError(response.error)})}return promise=deferred.promise},this.getAllGroup=function(callback){sharedProperties.getGroup().length?callback&&callback(sharedProperties.getGroup()):ajaxService.getAjaxResponse({url:serviceUrl.allGroups}).then(function(response){"true"===response.Success?(sharedProperties.setGroup(response.groupInfoList),callback&&callback(response.groupInfoList)):null!==response.error&&sharedProperties.ajaxError(response.error)})},this.getAllCompetency=function(callback){null===sharedProperties.getCompetency()?ajaxService.getAjaxResponse({url:serviceUrl.allCompetency}).then(function(response){"true"===response.Success?(sharedProperties.setCompetency(response),callback&&callback(response)):null!=response.error&&sharedProperties.ajaxError(response.error)}):callback&&callback(sharedProperties.getCompetency())},this.getAllOrganization=function(callback){null===sharedProperties.getOrganization()?ajaxService.getAjaxResponse({url:serviceUrl.allOrganization}).then(function(response){"true"===response.Success?(sharedProperties.setOrganization(response),callback&&callback(response)):null!=response.error&&sharedProperties.ajaxError(response.error)}):callback&&callback(sharedProperties.getOrganization())},this.combinedUserDetail=function(callback){ajaxService.getAjaxResponse({url:serviceUrl.combinedUserDetail}).then(function(response){"true"===response.Success?callback&&callback(response):null!=response.error&&sharedProperties.ajaxError(response.error)})},this.getUserInfo=function(){return $localStorage.get("loggegdInProfile")}}angular.module("spApp").service("basicService",basicService),basicService.$inject=["ajaxService","sharedProperties","$localStorage","$q"];
function ajaxService($http,$q,$rootScope,$filter,$localStorage,$timeout){function getAjaxResponse(options){return void 0===options?void console.log("Please Provide Options to Perform Ajax Request"):$http({method:void 0!==options.method?options.method:"post",url:void 0!==options.url?options.url:"#",data:void 0!==options.data?options.data:"",param:void 0!==options.param?options.param:"",headers:void 0!==options.headers?options.headers:{"Content-Type":"application/x-www-form-urlencoded"},delay:options.delay,maximum:options.maximum,loader:options.loader}).then(handleSuccess,handleError)}function handleError(response){return angular.isObject(response.success)&&response.success?$q.reject(response.data.error):$q.reject("An unknown error occurred.")}function handleSuccess(response){if(null!==response.data&&void 0!==response.data){if(null!==response.data.success&&void 0!==response.data.success)return void 0!==response.data.success.Actions&&updateLocalStorage(response.data.success.Actions),response.data.success;if(null!==response.data.error&&void 0!==response.data.error){if(void 0===response.data.error.DashboardRedirectException)return void 0!==response.data.error.Actions&&updateLocalStorage(response.data.error.Actions),response.data;$timeout(function(){window.location.href="/sp/"},1500)}}return response.data}function updateLocalStorage(Action){void 0!==Action.UpdateNavigation&&($localStorage.set("globalNav",Action.UpdateNavigation),$localStorage.remove("navHtml")),void 0!==Action.UpdatePermission&&$localStorage.set("loggegdInProfile",Action.UpdatePermission),void 0!==Action.UpdateParams&&Action.UpdateParams.doLogout&&(window.location.href="/sp/logout")}return{getAjaxResponse:getAjaxResponse}}function sharedProperties($rootScope,ngDialog,ajaxService,$localStorage,$timeout,localeLang){var objectValue={},resetEmail="",videoUrl=null,member=[],candidates=[],archiveCandidates=[],group=[],companiesList=[],validUser=[],organization=null,competency=null,permissionLevel={prism:!1,blueprint:!1,org:!1,competency:!1,iamaccountadmin:!1,prismLens:!1,relationshipadvisor:!1},notesState={selectedNotesTab:"",referenceObj:null},feedbackObject={devFeedRefId:null,feedParentRefId:null},schedule={title:null,uid:null,actionPlanId:null,actionPlanName:null};return $rootScope.showNotesPanel=!1,{setMember:function(value){member=value},getMember:function(){return member},setValidUser:function(value){validUser=value},getValidUser:function(){return validUser},setCompetency:function(value){competency=value},getCompetency:function(){return competency},setOrganization:function(value){organization=value},getOrganization:function(){return organization},setGroup:function(value){group=value},getGroup:function(){return group},setAllCompaniesList:function(value){companiesList=value},getAllCompaniesList:function(){return companiesList},setObject:function(obj){objectValue=angular.copy(obj)},getObject:function(){return objectValue},setResetEmail:function(val){resetEmail=val},getResetEmail:function(){return resetEmail},spliceIndex:function(parent,searchkey,parentkey){return angular.forEach(parent,function(value,index){value[searchkey]===parentkey&&parent.splice(index,1)}),parent},spilceIndexWithBreak:function(parent,searchkey,parentkey){if(null===parent)return!0;for(var i=0;i<parent.length;i++)if(parent[i][searchkey]===parentkey){parent.splice(i,1);break}return parent},toggleFilterClick:function(event,currentPredicate){var currentElem=$(event.currentTarget);currentElem.data("predicate"),currentElem.find("h4").hasClass("on")||currentElem.hasClass("on")?currentElem.find("h4").hasClass("reverseon")||currentElem.hasClass("reverseon")?(currentElem.find("h4").removeClass("reverseon"),currentElem.removeClass("reverseon")):(currentElem.find("h4").addClass("reverseon"),currentElem.addClass("reverseon")):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"),currentElem.parent().parent().find(".tog h4").removeClass("on reverseon"),currentElem.addClass("on"))},singleElementSearch:function(textVar,parent,num){if(!(void 0!==textVar&&textVar.length>=num))return parent;if("undefined"==typeof key)if(""===angular.lowercase(parent.name)||null===angular.lowercase(parent.name)){if(angular.lowercase(parent.email).indexOf(angular.lowercase(textVar))>-1)return parent}else if(angular.lowercase(parent.email).indexOf(angular.lowercase(textVar))>-1||angular.lowercase(parent.name).indexOf(angular.lowercase(textVar))>-1)return parent},searchModuleName:function(textVar,parent,num,change,key){var type=void 0===change?"email":change;if(textVar.length>=num){for(var copyArray=[],i=0;i<parent.length;i++)void 0===key?""===angular.lowercase(parent[i].name)||null===angular.lowercase(parent[i].name)?angular.lowercase(parent[i][type]).indexOf(angular.lowercase(textVar))>-1&&copyArray.push(parent[i]):(angular.lowercase(parent[i][type]).indexOf(angular.lowercase(textVar))>-1||angular.lowercase(parent[i].name).indexOf(angular.lowercase(textVar))>-1)&&copyArray.push(parent[i]):""===angular.lowercase(parent[i][key].name)||null===angular.lowercase(parent[i][key].name)?angular.lowercase(parent[i][key][type]).indexOf(angular.lowercase(textVar))>-1&&copyArray.push(parent[i]):(angular.lowercase(parent[i][key][type]).indexOf(angular.lowercase(textVar))>-1||angular.lowercase(parent[i][key].name).indexOf(angular.lowercase(textVar))>-1)&&copyArray.push(parent[i]);return copyArray}return parent},getParam:function(param,loc){var url=void 0===loc?location.href:loc,regexS="[\\?&]"+param+"=([^&#]*)",regex=new RegExp(regexS),results=regex.exec(url);return null==results?null:results[1]},setGetParameter:function(paramName,paramValue){var url=window.location.href,hash=location.hash;if(url=url.replace(hash,""),url.indexOf(paramName+"=")>=0){var prefix=url.substring(0,url.indexOf(paramName)),suffix=url.substring(url.indexOf(paramName));suffix=suffix.substring(suffix.indexOf("=")+1),suffix=suffix.indexOf("&")>=0?suffix.substring(suffix.indexOf("&")):"",url=prefix+paramName+"="+paramValue+suffix}else url.indexOf("?")<0?url+="?"+paramName+"="+paramValue:url+="&"+paramName+"="+paramValue;window.location.href=url+hash},setSwitch:function(param){$rootScope.switchType=param},notification:function(args,userTypeName,disabledName,extra){if($rootScope.notificationList=args,$rootScope.extra=null,$rootScope.userTypeName=void 0===userTypeName?"GenericMessage":userTypeName,void 0===disabledName)$rootScope.disabledName=null,$rootScope.selectedNotification="default";else{if($rootScope.disabledName=disabledName,$rootScope.selectedNotification=disabledName,"ProfileIncomplete"!==disabledName){var comment=$.parseHTML($rootScope.pullInterNationalization("admin.group."+disabledName+".notification.text").replace("$companyName",$localStorage.get("loggegdInProfile").company.name))[0];$rootScope.commentNotification=$(comment).text()}var subBlock=$.parseHTML($rootScope.pullInterNationalization("admin.group."+disabledName+".notification.nosubject"))[0];$rootScope.subBlockNotification=subBlock==="admin.group."+disabledName+".notification.nosubject"?"":$(subBlock).text()}$rootScope.notify=["Profile","Goals","Prism"],angular.isObject(extra)&&($rootScope.extra=extra),ngDialog.open({template:"/sp/notification/email"})},printPdfProfile:function(options){var $getCont=$(options.holder),cssToApply=void 0===options.cssName?"global.min.css":options.cssName,parObj=options.obj;if(!$getCont.length)return!0;var printContents=$getCont.html(),currentPath=window.location.origin,data={content:encodeURIComponent('<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><script src="//use.typekit.net/ofk8xcu.js"><\/script><script> try {Typekit.load();} catch (e) {}<\/script><link type="text/css" rel="stylesheet" href="'+currentPath+'/resources/css/css-min/bootstrap.min.css"><link type="text/css" rel="stylesheet" href="'+currentPath+"/resources/css/css-min/"+cssToApply+'"></head><body>'+printContents+"</body></html>")};options.extraParam,data.pdfName=options.extraParam,ajaxService.getAjaxResponse({url:options.url,data:$.param(data)}).then(function(response){if("true"===response.Success)$rootScope.$broadcast("pdfGenerated",{obj:parObj,url:response.url});else if(null!==response.error){var errorMessage="",responses=response.error;for(var key in responses)errorMessage=responses[key];$.notify({icon:"glyphicon glyphicon-ban-circle",title:$rootScope.pullInterNationalization("service.growl.alert")+" ",message:errorMessage},{offset:{x:400,y:200},allow_dismiss:!1}),$rootScope.$broadcast("pdfGenerated",parObj),ngDialog.close("ngdialog1")}})},openMediaModal:function(){$rootScope.mediaView="select",ngDialog.open({template:"/sp/resources/html/sysAdmin/media/select-modal.html"}).closePromise.then(function(data){$rootScope.$broadcast("mediaData",$localStorage.get("mediaData")),$localStorage.remove("mediaData")})},videoPopUp:function(url,openId){videoUrl=url;ngDialog.open({template:"/sp/resources/html/common/videoPopUp.html"})},schedulePopUp:function(title,uid,actionPlanId,actionPlanName){schedule.tite=title,schedule.uid=uid,schedule.actionPlanId=actionPlanId,schedule.actionPlanName=actionPlanName;ngDialog.open({template:"/sp/schedulePop",className:$(window).width()>767?"ngdialog-theme-default":"new-mobile-theme"})},getScheduleData:function(){return schedule},getVideoUrl:function(){return videoUrl},fireAnalyticsEvent:function(name,value){var googleDataLayer="dataLayer";void 0!==window[googleDataLayer]&&window[googleDataLayer].push({event:"spAppAnalytics",attributes:{spAction:name,spActionValue:value}})},changeMomentDefaults:function(){moment.relativeTimeThreshold("s",59),moment.relativeTimeThreshold("m",59),moment.relativeTimeThreshold("h",23),moment.relativeTimeThreshold("d",28),moment.relativeTimeThreshold("M",11);var locale=localeLang.getLang(!1);"en-US"===locale?moment.updateLocale("en",{relativeTime:{future:"in %s",past:"%s",s:"now",m:"1m",mm:"%dm",h:"1h",hh:"%dh",d:"1d",dd:"%dd",M:"1mo",MM:"%dmo",y:"1y",yy:"%dy"}}):"es-LA"===locale&&moment.updateLocale("es",{relativeTime:{future:"in %s",past:"%s",s:"ahora",m:"1m",mm:"%dm",h:"1h",hh:"%dh",d:"1d",dd:"%dd",M:"1me",MM:"%dme",y:"1ao",yy:"%dao"}})},checkPermission:function(){var permissions=$localStorage.get("loggegdInProfile").member.roles;return permissionLevel={prism:-1!==permissions.indexOf("Prism"),blueprint:-1!==permissions.indexOf("Blueprint"),org:-1!==permissions.indexOf("OrganizationPlan"),competency:-1!==permissions.indexOf("Competency"),iamaccountadmin:-1!==permissions.indexOf("AccountAdministrator"),groupLead:-1!==permissions.indexOf("GroupLead"),prismLens:-1!==permissions.indexOf("PrismLens"),relationshipadvisor:-1!==permissions.indexOf("RelationShipAdvisor")}},setContentReference:function(obj){notesState.referenceObj=obj},setSelectedNotesTab:function(tab){notesState.selectedNotesTab=tab,$rootScope.showNotesPanel=!0,$rootScope.selectedNotesTab=tab},getSelectedNotesTab:function(){return notesState},setFeedbackObjectForPanel:function(obj){feedbackObject=obj},getFeedbackObjectForPanel:function(){return feedbackObject},notifyUser:function(titleText,bodyText){var notification=window.Notification||window.mozNotification||window.webkitNotification;if(void 0===notification)return!1;var notify=new notification(titleText,{body:bodyText,dir:"auto",lang:"EN",tag:"uniqueNotify",icon:"/resources/images/sure_people.ico"});return notify.onclick=function(){},notify.onerror=function(){},notify.onshow=function(){},notify.onclose=function(){},!0},is_touch_supported:function(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0},is_iOS_device:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},detectIE:function(){var ua=window.navigator.userAgent,msie=ua.indexOf("MSIE ");if(msie>0)return parseInt(ua.substring(msie+5,ua.indexOf(".",msie)),10);if(ua.indexOf("Trident/")>0){var rv=ua.indexOf("rv:");return parseInt(ua.substring(rv+3,ua.indexOf(".",rv)),10)}var edge=ua.indexOf("Edge/");return edge>0&&parseInt(ua.substring(edge+5,ua.indexOf(".",edge)),10)},mapMediaType:function(type){var mimeType=type.toLowerCase();return"image/png"===mimeType||"image/jpeg"===mimeType||"image/jpg"===mimeType||"image/gif"===mimeType||"image/svg"===mimeType?"IMAGE":"application/vnd.openxmlformats-officedocument.wordprocessingml.document"===mimeType||"application/msword"===mimeType?"MSDOC":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===mimeType||"application/vnd.ms-excel"===mimeType?"MSEXCEL":"application/pdf"===mimeType?"PDF":"application/vnd.ms-powerpoint"===mimeType?"PPT":"video/mp4"===mimeType||"video/mov"===mimeType||"video/avi"===mimeType||"video/flv"===mimeType||"video/mpeg"===mimeType||"video/quicktime"===mimeType?"Video":"Web"},processRatingHex:function(ratingCount,type){var str="";if(void 0!==type&&"minipolls"===type)for(var i=1;i<=ratingCount;i++)str+="";else for(var j=1;j<=ratingCount;j++)str+="";return str},whiteLabelColorCodes:function(cssName){var element=document.querySelector("."+cssName);return getComputedStyle(element)},provideVendorSpecificLocale:function(vendor){var locale=localeLang.getLang(!1),vendorLocale="";switch(vendor){case"fileStack":"en-US"===locale?vendorLocale="en":"es-LA"===locale&&(vendorLocale="es");break;case"vimeo":"en-US"===locale?vendorLocale="en":"es-LA"===locale&&(vendorLocale="es-419");break;case"datePicker":"en-US"===locale?vendorLocale="en":"es-LA"===locale&&(vendorLocale="es")}return vendorLocale},getUserLocale:function(){return localeLang.getLang(!1)},ajaxError:function(response){var xAxis=window.matchMedia("(min-width: 768px)").matches?400:20,errorMessage="";for(var key in response)errorMessage=response[key];$.notify({icon:"glyphicon glyphicon-ban-circle",message:errorMessage},{offset:{x:xAxis,y:200},allow_dismiss:!1,z_index:10001})},growlMessage:function(gMessage,title,icon){var xAxis=window.matchMedia("(min-width: 768px)").matches?400:20;$.notify({icon:void 0!==icon?icon:"glyphicon glyphicon-ok",title:void 0!==title?title:"",message:void 0!==gMessage?gMessage:"Success"},{offset:{x:xAxis,y:200},allow_dismiss:!1,z_index:10001})},setCandidates:function(value){candidates=value},getCandidates:function(){return candidates},setArchivedCandidates:function(value){archiveCandidates=value},getArchivedCandidates:function(){return archiveCandidates},emitLazy:function(){$timeout(function(){$rootScope.$emit("lazyImg:refresh")},100)},countriesList:function(){if(null!==$localStorage.get("countriesFullList")&&void 0!==$localStorage.get("countriesFullList")&&""!==$localStorage.get("countriesFullList"))return $localStorage.get("countriesFullList");ajaxService.getAjaxResponse({url:"/sp/getCountries?locale="+localeLang.getLang(!1).replace("-","_"),method:"GET"}).then(function(response){if("true"===response.Success)$localStorage.set("countriesFullList",$.parseJSON(response.countries));else if(null!==response.error){var errorMessage="",responses=response.error;for(var key in responses)errorMessage=responses[key];$.notify({icon:"glyphicon glyphicon-ban-circle",title:$rootScope.pullInterNationalization("service.growl.alert")+" ",message:errorMessage},{offset:{x:400,y:200},allow_dismiss:!1})}})},passwordCriterionCheck:function(pwd){var numPatteren=/[0-9]/,lcPatteren=/[a-z]/,ucPatteren=/[A-Z]/,splPatteren=/[-!$%^&*()@#&_+|~=`{}\[\]:";'<>?,.\/]/,numCheck=!1,lcCheck=!1,ucCheck=!1,splCheck=!1,count=0;return count<5&&(numCheck||(numPatteren.test(pwd)?(numCheck=!0,count++):numCheck=!1),lcCheck||(lcPatteren.test(pwd)?(lcCheck=!0,count++):lcCheck=!1),ucCheck||(ucPatteren.test(pwd)?(ucCheck=!0,count++):ucCheck=!1),splCheck||(splPatteren.test(pwd)?(splCheck=!0,count++):splCheck=!1)),count>=4}}}function $localStorage($window){var localStorageOn=!1,$privateMode={};if("localStorage"in window)try{$window.localStorage.setItem("_tmptest","tmpval"),localStorageOn=!0,$window.localStorage.removeItem("_tmptest")}catch(error){localStorageOn=!1}return{isAvailable:function(){return localStorageOn},executeMethod:function(fnSuccess,fnFail){return localStorageOn?fnSuccess&&fnSuccess():fnFail&&fnFail()},remove:function(){if(localStorageOn)for(var j=0;j<arguments.length;j++)$window.localStorage.removeItem(arguments[j]);else for(var i=0;i<arguments.length;i++)arguments[i]in $privateMode&&($privateMode.arguments[i]=null)},flush:function(){return localStorageOn?$window.localStorage.clear():$privateMode={},this},get:function(key){return localStorageOn?$privateMode=JSON.parse($window.localStorage[key]||null):$privateMode[key]||null},set:function(key,value,callback){if(localStorageOn){if(void 0===value)return $localStorage.remove(key);$window.localStorage[key]=JSON.stringify(value)}else $privateMode[key]=value;return"function"==typeof callback&&callback&&callback(),this},redirect:function(url){console.log("url "+url),/firefox/i.test(navigator.userAgent)?(console.log("ff"),history.pushState("","",url),window.location.reload()):window.location.replace(url)}}}angular.module("spApp").config(["$compileProvider",function($compileProvider){$compileProvider.debugInfoEnabled(!1)}]),angular.module("spApp").config(["$httpProvider",function($httpProvider){$httpProvider.interceptors.push(["$location","$injector","$rootScope",function($location,$injector,$rootScope){function startRequest(delay,maximum,loader){requestCount||(startTimeout=setTimeout(function(){$rootScope.$broadcast("httpLoaderStart",loader),endTimeout=setTimeout(function(){requestCount&&(requestCount=0,$rootScope.$broadcast("httpLoaderEnd"))},maximum)},delay)),requestCount++}function endRequest(){requestCount&&(--requestCount||(clearTimeout(startTimeout),clearTimeout(endTimeout),$rootScope.$broadcast("httpLoaderEnd")))}var requestCount=0,startTimeout=0,endTimeout=0;return{request:function(config){return config.timeout=6e4,startRequest(config.delay||500,config.maximum||5e3,config.loader),config.headers["X-Requested-With"]="XMLHttpRequest",config},requestError:function(rejection){return endRequest(),rejection},response:function(response){return endRequest(),response},responseError:function(rejection){return 408===rejection.status||null===rejection.data&&0===rejection.status||-1===rejection.status?(window.location.reload(),!1):(endRequest(),rejection)}}}])}]),angular.module("spApp").service("ajaxService",ajaxService),ajaxService.$inject=["$http","$q","$rootScope","$filter","$localStorage","$timeout"],angular.module("spApp").service("sharedProperties",sharedProperties),sharedProperties.$inject=["$rootScope","ngDialog","ajaxService","$localStorage","$timeout","localeLang"],angular.module("spApp").service("$localStorage",$localStorage),$localStorage.$inject=["$window"];
function eventSourceProvider($rootScope,$localStorage){function initEventSource(){eventSource=new EventSource("/sp/sse/push"),eventSource.onopen=function(){connectionState(!0)},eventSource.onerror=function(){connectionState(!1)},eventSource.onmessage=function(event){var fireEvent=$.parseJSON(event.data);switch(fireEvent.success.actionType){case"DashboardMessage":$rootScope.$broadcast("dashboardMessage",fireEvent.success);break;case"GroupDiscussion":$rootScope.$broadcast("groupDiscussion",fireEvent.success);break;case"PublicChannel":$rootScope.$broadcast("publicChannel",fireEvent.success);break;case"ActionPlan":$rootScope.$broadcast("actionPlanSSE",fireEvent.success);break;case"UpdatePermission":$rootScope.$broadcast("updatePermissionSSE",fireEvent.success);break;case"UpdateNavigation":$rootScope.$broadcast("updateNavigationSSE",fireEvent.success);break;case"NotificationLog":$rootScope.$broadcast("notificationSSE",fireEvent.success);break;case"BadgeCompletion":$rootScope.$broadcast("badgeSSE",fireEvent.success);break;case"Logout":eventSource.close()}};var connectionState=function(flag){if(flag)console.log("Connection Successful");else{console.log("Connection Error"),eventSource.close();getCookie("JSESSIONID")!==$localStorage.get("spSession")&&window.location.reload(),clearTimeout(clearPingFn)}},getCookie=function(cookieName){for(var name=cookieName+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "===c.charAt(0);)c=c.substring(1);if(0===c.indexOf(name))return c.substring(name.length,c.length)}return""}}function closeEventSource(){null!==eventSource&&eventSource.close()}function pingEventSource(){null!==eventSource&&(eventSource.close(),initEventSource()),clearPingFn=setTimeout(pingEventSource,12e4)}var eventSource=null,clearPingFn=null;return pingEventSource(),{initEventSource:initEventSource,closeEventSource:closeEventSource}}angular.module("spApp").factory("eventSourceProvider",eventSourceProvider),eventSourceProvider.$inject=["$rootScope","$localStorage"];
function localeLang($localStorage,$rootScope,ajaxService){function getAcceptLanguages(){if(null===$localStorage.get("loggegdInProfile")){if(Array.isArray(nav.languages))for(i=0;i<nav.languages.length;i++)if((language=nav.languages[i])&&language.length)return mylang=language,-1===supportedLocale.indexOf(mylang)&&(mylang="en_US"),this;for(i=0;i<browserLanguagePropertyKeys.length;i++)if((language=nav[browserLanguagePropertyKeys[i]])&&language.length)return mylang=language,-1===supportedLocale.indexOf(mylang)&&(mylang="en_US"),this}else mylang=$localStorage.get("loggegdInProfile").locale;return this}function getLang(refresh){return""===mylang&&this.getAcceptLanguages().setLang().setCookieLang(),refresh&&$localStorage.flush(),mylang}function setLang(){return document.getElementsByTagName("html")[0].setAttribute("lang",mylang),this}function setCookieLang(){return setCookie("sp-locale",mylang.replace("-","_"),31536e6),this}function compareBrowserLang(){navigator.browserLanguage!==localeLang.getCookie("sp-locale")&&console.log("NOT SAME NOT")}function setCookie(cookieName,cookieValue,days,pathValue){var date,expires;days?(date=new Date,date.setTime(date.getTime()+24*days*60*60*1e3),expires="; expires="+date.toGMTString()):expires="",document.cookie=cookieName+"="+cookieValue+(pathValue||"; Path=/;")+expires}function getCookie(cookieName){for(var name=cookieName+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "===c.charAt(0);)c=c.substring(1);if(0===c.indexOf(name))return c.substring(name.length,c.length)}return""}function changeLang(language){return mylang=language,this}function override(language,reload){this.changeLang(language).setLang().setCookieLang(),reload&&reloadMessages(language)}function reloadMessages(language){$localStorage.flush().redirect(setGetParameter("lang",language.replace("-","_"),!0))}function setGetParameter(paramName,paramValue,local){var url=window.location.href,hash=location.hash;if(url=url.replace(hash,""),url=parameterLogic(paramName,paramValue,url),void 0!==local&&local){return parameterLogic("at",(new Date).getTime(),url)+hash}window.location.href=url+hash}function parameterLogic(paramName,paramValue,url){if(url.indexOf(paramName+"=")>=0){var prefix=url.substring(0,url.indexOf(paramName)),suffix=url.substring(url.indexOf(paramName));suffix=suffix.substring(suffix.indexOf("=")+1),suffix=suffix.indexOf("&")>=0?suffix.substring(suffix.indexOf("&")):"",url=prefix+paramName+"="+paramValue+suffix}else url.indexOf("?")<0?url+="?"+paramName+"="+paramValue:url+="&"+paramName+"="+paramValue;return url}var i,language,nav=window.navigator,browserLanguagePropertyKeys=["language","browserLanguage","systemLanguage","userLanguage"],mylang="",supportedLocale=["en-US","es-LA","en-us","es-la"];return{getAcceptLanguages:getAcceptLanguages,setLang:setLang,getLang:getLang,changeLang:changeLang,setCookieLang:setCookieLang,compareBrowserLang:compareBrowserLang,setCookie:setCookie,getCookie:getCookie,override:override,setGetParameter:setGetParameter,parameterLogic:parameterLogic}}angular.module("spApp").service("localeLang",localeLang),localeLang.$inject=["$localStorage","$rootScope","ajaxService"];
function actionPlanService(ajaxService,sharedProperties){var self=this;self.getAllTasks=function(){return ajaxService.getAjaxResponse({url:"/sp/todo/getAll"}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.saveTodo=function(todoForm){return ajaxService.getAjaxResponse({url:"/sp/todo/create",data:todoForm,headers:{"Content-Type":"application/json"}}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.updateTodo=function(todoForm){return ajaxService.getAjaxResponse({url:"/sp/todo/update",data:todoForm,headers:{"Content-Type":"application/json"}}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.deleteTodo=function(refId){return ajaxService.getAjaxResponse({url:"/sp/todo/delete",data:$.param({refId:refId,parentRefId:"Todo"})}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.getLearningProgram=function(id){return ajaxService.getAjaxResponse({url:"/sp/actionPlan/getActionPlan?actionPlanId="+id,method:"get"}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})}}actionPlanService.$inject=["ajaxService","sharedProperties"],angular.module("spApp").service("actionPlanService",actionPlanService);
function feedbackService(ajaxService,sharedProperties){var self=this;self.submitFeedbackRequest=function(feedbackForm){return ajaxService.getAjaxResponse({url:"/sp/developmentfeedback/create",data:feedbackForm,headers:{"Content-Type":"application/json"}}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.sendFeedbackResponse=function(feedbackForm){return ajaxService.getAjaxResponse({url:"/sp/developmentfeedback/update",data:feedbackForm,headers:{"Content-Type":"application/json"}}).then(function(response){return response})},self.getAllFeedbackRequests=function(feedbackRefId,spFeature){return ajaxService.getAjaxResponse({url:"/sp/developmentfeedback/getAllByDevFeedRefId",data:$.param({devFeedRefId:feedbackRefId,spFeature:spFeature})}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.getAllFeedbacksForResponse=function(id){return ajaxService.getAjaxResponse({url:null===id?"/sp/developmentfeedback/getAllFeedbackRequest":"/sp/developmentfeedback/getAllFeedbackRequest?id="+id,method:"GET"}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.getAllFeedbackForDashboard=function(){return ajaxService.getAjaxResponse({url:"/sp/dashboard/getDevelopmentFeedbacks"}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.getAllFeedbackResponses=function(){return ajaxService.getAjaxResponse({url:"/sp/developmentfeedback/getAllFeedbackResponses"}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.getFeedbackDetailForResponse=function(id){return ajaxService.getAjaxResponse({url:"/sp/developmentfeedback/get",data:$.param({id:id})}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.emailFeedback=function(feedbackForm){return ajaxService.getAjaxResponse({url:"/sp/developmentfeedback/emailFeedbacks",data:feedbackForm,headers:{"Content-Type":"application/json"}}).then(function(response){if("true"===response.Success)return response.Success;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.deleteFeedback=function(id,devFeedRefId,feature){return ajaxService.getAjaxResponse({url:"/sp/developmentfeedback/delete",data:$.param({id:id,devFeedRefId:devFeedRefId,spFeature:feature})}).then(function(response){if("true"===response.Success)return response.Success;null!==response.error&&sharedProperties.ajaxError(response.error)})}}angular.module("spApp").service("feedbackService",feedbackService),feedbackService.$inject=["ajaxService","sharedProperties"];
function memberEmailCheck(ajaxService,sharedProperties,$localStorage,$q,spConfig,spValue){this.isMemberPresent=function(list){return ajaxService.getAjaxResponse({url:"/sp/signup/validateEmails",data:$.param({memberList:list.join()})}).then(function(response){return"true"===response.Success?response:null!==response.error?response:void 0})}}memberEmailCheck.$inject=["ajaxService","sharedProperties","$localStorage","$q"],angular.module("spApp").service("memberEmailCheck",memberEmailCheck);
function miniPollsService(ajaxService,sharedProperties,$localStorage){var services={shareNote:{answer:"/sp/dashboard/message/answerMiniPoll",end:"/sp/dashboard/message/endMiniPoll",share:"/sp/dashboard/message/shareMiniPoll"},groupDiscussion:{answer:"/sp/gd/answerMiniPoll",end:"/sp/gd/endMiniPoll",share:"/sp/gd/shareMiniPoll"}};this.updatePoll=function(type,action,param){return ajaxService.getAjaxResponse({url:services[type][action],data:$.param(param)}).then(function(response){return"true"===response.Success?response:null!==response.error?(sharedProperties.ajaxError(response.error),null):void 0})}}angular.module("spApp").service("miniPollsService",miniPollsService),miniPollsService.$inject=["ajaxService","sharedProperties","$localStorage"];
function newsFeedService(ajaxService,sharedProperties,$localStorage){var vm=this;vm.news={newsFeed:[],newsFeedArray:[]},vm.postMessageObject=function(){return{comment:{comment:"",contentReference:{title:null,description:null,name:null,SPMedia:null},cid:-1},allMembers:!0,taggedMemberIds:[],groupIds:[],competencyIds:[],actionPlanIds:[],messageId:null,deletedTaggedMemberIds:[],follow:!0,announcement:!1,cid:-1,childCid:-1,sendEmail:!1}},vm.postMessage=function(param){return ajaxService.getAjaxResponse({url:"/sp/dashboard/message/new",data:param,headers:{"Content-Type":"application/json"},loader:{obj:$(".sp-loading-bar")}}).then(function(response){return"true"===response.Success?response:null!==response.error?(sharedProperties.ajaxError(response.error),null):void 0})},vm.updatePost=function(param){return ajaxService.getAjaxResponse({url:"/sp/dashboard/message/update",data:param,headers:{"Content-Type":"application/json"},loader:{obj:$(".sp-loading-bar")}}).then(function(response){return"true"===response.Success?response:null!==response.error?(sharedProperties.ajaxError(response.error),null):void 0})},vm.addComment=function(param){return ajaxService.getAjaxResponse({url:"/sp/dashboard/message/addComment",data:param,headers:{"Content-Type":"application/json"},loader:{obj:$(".sp-loading-bar")}}).then(function(response){return"true"===response.Success?response:null!==response.error?(sharedProperties.ajaxError(response.error),null):void 0})},vm.likePost=function(param){return ajaxService.getAjaxResponse({url:"/sp/dashboard/message/like",data:$.param(param),loader:{obj:$(".sp-loading-bar")}}).then(function(response){return"true"===response.Success?response:null!==response.error?(sharedProperties.ajaxError(response.error),null):void 0})},vm.previousComments=function(param){return ajaxService.getAjaxResponse({url:"/sp/dashboard/message/details",data:$.param(param),loader:{obj:$(".sp-loading-bar")}}).then(function(response){return"true"===response.Success?response:null!==response.error?(sharedProperties.ajaxError(response.error),null):void 0})},vm.deletePost=function(param){return ajaxService.getAjaxResponse({url:"/sp/dashboard/message/delete",data:$.param(param),loader:{obj:$(".sp-loading-bar")}}).then(function(response){return"true"===response.Success?response:null!==response.error?(sharedProperties.ajaxError(response.error),null):void 0})},vm.blockComment=function(param){return ajaxService.getAjaxResponse({url:"/sp/dashboard/message/blockCommenting",data:$.param(param),loader:{obj:$(".sp-loading-bar")}}).then(function(response){return"true"===response.Success?response:null!==response.error?(sharedProperties.ajaxError(response.error),null):void 0})},vm.deleteComment=function(param){return ajaxService.getAjaxResponse({url:"/sp/dashboard/message/deleteComment",data:$.param(param),loader:{obj:$(".sp-loading-bar")}}).then(function(response){return"true"===response.Success?response:null!==response.error?(sharedProperties.ajaxError(response.error),null):void 0})},vm.follow=function(param){return ajaxService.getAjaxResponse({url:"/sp/dashboard/message/followUnfollow",data:$.param(param),loader:{obj:$(".sp-loading-bar")}}).then(function(response){return"true"===response.Success?response:null!==response.error?(sharedProperties.ajaxError(response.error),null):void 0})},vm.likeUserName=function(param){return ajaxService.getAjaxResponse({url:"/sp/dashboard/message/likeUserInfo",data:$.param(param),loader:{obj:$(".sp-loading-bar")}}).then(function(response){return"true"===response.Success?response:null!==response.error?(sharedProperties.ajaxError(response.error),null):void 0})}}angular.module("spApp").service("newsFeedService",newsFeedService),newsFeedService.$inject=["ajaxService","sharedProperties","$localStorage"];
function notesService(ajaxService,sharedProperties,$rootScope,$sce,$localStorage){var self=this;self.getAllPrivateNotes=function(isDashboardRequest){return ajaxService.getAjaxResponse({url:"/sp/notes/getAllNotes",data:$.param({dashboardRequest:isDashboardRequest})}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.getNote=function(noteId){return ajaxService.getAjaxResponse({url:"/sp/notes/getDetail",data:$.param({noteId:noteId})}).then(function(response){if("true"===response.Success)return response.noteDetail;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.saveNote=function(noteForm,newNote){return ajaxService.getAjaxResponse({url:"/sp/notes/addNote?newNote="+newNote,data:noteForm,headers:{"Content-Type":"application/json"}}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.updateTitle=function(noteId,title){return ajaxService.getAjaxResponse({url:"/sp/notes/updateTitle",data:$.param({noteId:noteId,title:title})}).then(function(response){if("true"===response.Success)return response.Success;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.emailNotes=function(noteId){return ajaxService.getAjaxResponse({url:"/sp/notes/emailNotes",data:$.param({noteId:noteId})}).then(function(response){if("true"===response.Success)return response.Success;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.deleteNoteOrComment=function(noteId,commentId){return ajaxService.getAjaxResponse({url:"/sp/notes/deleteNotes",data:$.param({noteId:noteId,cid:commentId})}).then(function(response){if("true"===response.Success)return response.Success;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.getAllGD=function(isDashboardRequest){return ajaxService.getAjaxResponse({url:"/sp/gd/getAll",data:$.param({isDashboardRequest:isDashboardRequest})}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.saveGD=function(gdForm){return ajaxService.getAjaxResponse({url:"/sp/gd/create",data:gdForm,headers:{"Content-Type":"application/json"}}).then(function(response){if("true"===response.Success)return response.gd;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.updateGD=function(gdForm){return ajaxService.getAjaxResponse({url:"/sp/gd/update",data:gdForm,headers:{"Content-Type":"application/json"}}).then(function(response){if("true"===response.Success)return response.gd;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.getGD=function(id){return ajaxService.getAjaxResponse({url:"/sp/gd/getDetails",data:$.param({gdId:id})}).then(function(response){if("true"===response.Success)return response.gd;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.getMembersInGD=function(id){return ajaxService.getAjaxResponse({url:"/sp/gd/groupMemberDetails",data:$.param({gdId:id})}).then(function(response){if("true"===response.Success)return response.memberList;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.leaveGroupDiscussion=function(gdId){return ajaxService.getAjaxResponse({url:"/sp/gd/leaveGroupDiscussion",data:$.param({gdId:gdId})}).then(function(response){if("true"===response.Success)return response.Success;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.updateGroupSettings=function(newName,gdId,userIdList,nameCleared){return ajaxService.getAjaxResponse({url:"/sp/gd/addMember",data:$.param({newName:newName,gdId:gdId,memberIds:userIdList.join(),nameCleared:nameCleared})}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.filterNotification=function(gdId,notifyFlag){return ajaxService.getAjaxResponse({url:"/sp/gd/filterNotification",data:$.param({gdId:gdId,doFilter:notifyFlag})}).then(function(response){if("true"===response.Success)return response.Success;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.savePublicChannel=function(publicChannelForm){return ajaxService.getAjaxResponse({url:"/sp/pubchannel/createPublicChannel",data:publicChannelForm,headers:{"Content-Type":"application/json"}}).then(function(response){if("true"===response.Success)return response.Success;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.getPublicChannel=function(id){return ajaxService.getAjaxResponse({url:"/sp/pubchannel/getPublicChannel",data:$.param({pcRefId:id})}).then(function(response){if("true"===response.Success)return response.publicChannel;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.followPublicChannel=function(id,followFlag){return ajaxService.getAjaxResponse({url:"/sp/pubchannel/followPublicChannel",data:$.param({follow:followFlag,pcRefId:id})}).then(function(response){if("true"===response.Success)return response.Success;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.addComment=function(publicChannelForm){return ajaxService.getAjaxResponse({url:"/sp/pubchannel/addComment",data:publicChannelForm,headers:{"Content-Type":"application/json"}}).then(function(response){return"true"===response.Success?response:null!==response.error?(sharedProperties.ajaxError(response.error),null):void 0})},self.publicChannelObj=function(){return{comment:{comment:[],contentReference:{title:null,description:null,name:null,SPMedia:null},cid:-1},spFeature:null,pcRefId:null,parentRefId:null,title:null,id:null,subModuleFeature:null,cid:-1,childCid:-1}},self.getAllComment=function(param){return ajaxService.getAjaxResponse({url:"/sp/pubchannel/getAllComments",data:$.param(param)}).then(function(response){return"true"===response.Success?response:null!==response.error?(sharedProperties.ajaxError(response.error),null):void 0})};var clearLocalReference=function(){self.contentReference={id:null,title:null,subModule:null,description:null,imageUrl:null,authorSource:null,media:[],refType:null,includeRef:!1,spFeature:null,parentRefId:null,subModuleName:null,articleEntry:null,pubChannelTitle:null,pubChannelDesc:null,overviewText:null,subTitle:null,url:null,fileStack:!1,client:null}};self.mapReferenceData=function(contentReference){if(clearLocalReference(),null!==contentReference){var ref=contentReference,media=null,bpSettings=$localStorage.get("bluePrintSetting");switch(ref.type){case"pa":self.contentReference.id=ref.data.id,self.contentReference.title=ref.data.name,self.contentReference.includeRef=!1,self.contentReference.spFeature="Erti",self.contentReference.pubChannelTitle=ref.data.name,self.contentReference.pubChannelDesc="ERT-i "+$rootScope.pullInterNationalization("practiceArea.parea"),self.contentReference.overviewText=ref.data.overviewText,self.contentReference.subTitle="ERT-i "+$rootScope.pullInterNationalization("practiceArea.parea"),self.contentReference.url="/sp/goals#/practice?refId="+self.contentReference.id;break;case"devStrategy":self.contentReference.id=ref.data.paId,self.contentReference.title=ref.data.paName,""!==ref.data.videoUrl&&null!==ref.data.videoUrl&&(media={},self.contentReference.imageUrl=ref.data.imageUrl,media.url=ref.data.videoUrl,media.mediaType="Video",self.contentReference.media.push(media)),self.contentReference.includeRef=!0,self.contentReference.spFeature="Erti",self.contentReference.pubChannelTitle=ref.data.paName,self.contentReference.pubChannelDesc="ERT-i "+$rootScope.pullInterNationalization("practiceArea.parea"),self.contentReference.overviewText=ref.data.overviewText,self.contentReference.subTitle=$rootScope.pullInterNationalization("practiceArea.devStrategy")+" "+$rootScope.pullInterNationalization("generic.for"),self.contentReference.url="/sp/goals#/practice?refId="+self.contentReference.id;break;case"competency":self.contentReference.id=ref.data.id,self.contentReference.title=ref.data.name,self.contentReference.parentRefId=ref.data.parentId,self.contentReference.includeRef=!1,self.contentReference.spFeature="Competency",self.contentReference.pubChannelTitle=ref.data.pubChannelTitle,self.contentReference.pubChannelDesc=ref.data.pubChannelDesc,self.contentReference.overviewText=ref.data.overviewText,self.contentReference.subTitle=$rootScope.pullInterNationalization("sysadmin.organization.competency"),self.contentReference.url="/sp/competency/home#/profiles?refId="+self.contentReference.id;break;case"competencyStrategy":self.contentReference.id=ref.data.competencyId,self.contentReference.title=ref.data.competencyName,self.contentReference.parentRefId=ref.data.parentId,ref.data.actionData.length&&null!==ref.data.actionData[0].url&&(media={},self.contentReference.imageUrl=ref.data.actionData[0].imageLink,media.url=ref.data.actionData[0].url,media.mediaType="Video",self.contentReference.media.push(media)),self.contentReference.includeRef=!0,self.contentReference.spFeature="Competency",self.contentReference.pubChannelTitle=ref.data.pubChannelTitle,self.contentReference.pubChannelDesc=ref.data.pubChannelDesc,self.contentReference.overviewText=ref.data.overviewText,self.contentReference.subTitle=$rootScope.pullInterNationalization("practiceArea.devStrategy")+" "+$rootScope.pullInterNationalization("generic.for"),self.contentReference.url="/sp/competency/home#/profiles?refId="+self.contentReference.id;break;case"orgPlans":self.contentReference.id=ref.data.id,self.contentReference.parentRefId=ref.data.parentId,self.contentReference.title=ref.data.title,self.contentReference.includeRef=!1,self.contentReference.spFeature="OrganizationPlan",self.contentReference.pubChannelTitle=ref.data.title,self.contentReference.pubChannelDesc=ref.data.description,self.contentReference.overviewText=ref.data.overviewText,self.contentReference.url="/sp/goalsOrg#/organization?parentId="+self.contentReference.parentRefId+"&stepId="+self.contentReference.id;break;case"orgPlanTasks":if(self.contentReference.id=ref.data.id,self.contentReference.title=ref.data.title,self.contentReference.parentRefId=ref.data.parentId,void 0!==ref.data.actionData)if(null!==ref.data.mediaUrl)media={},media.url=ref.data.mediaUrl,media.mediaType=ref.data.mediaType,media.linkText=ref.data.mediaAltText,""!==ref.data.mediaImageLink&&null!==ref.data.mediaImageLink&&(self.contentReference.imageUrl=ref.data.mediaImageLink),"Schedule"!==media.mediaType&&"ActionPlan"!==media.mediaType&&self.contentReference.media.push(media);else for(var i=0;i<ref.data.actionData.length;i++)media={},media.url=ref.data.actionData[i].url,media.mediaType=ref.data.actionData[i].type,media.linkText=ref.data.actionData[i].linkText,""!==ref.data.actionData[i].imageLink&&null!==ref.data.actionData[i].imageLink&&(self.contentReference.imageUrl=ref.data.actionData[i].imageLink),"Schedule"!==media.mediaType&&"ActionPlan"!==media.mediaType&&self.contentReference.media.push(media);else media={},media.url=ref.data.url,media.mediaType=ref.data.type,media.linkText=ref.data.linkText,""!==ref.data.imageLink&&null!==ref.data.imageLink&&(self.contentReference.imageUrl=ref.data.imageLink),"Schedule"!==media.mediaType&&"ActionPlan"!==media.mediaType&&self.contentReference.media.push(media);self.contentReference.includeRef=!0,self.contentReference.spFeature="OrganizationPlan",self.contentReference.pubChannelTitle=ref.data.pubChannelTitle,self.contentReference.pubChannelDesc=ref.data.pubChannelDesc,self.contentReference.overviewText=ref.data.overviewText,self.contentReference.subTitle=ref.data.pubChannelDesc,self.contentReference.url="/sp/goalsOrg#/organization?parentId="+self.contentReference.parentRefId+"&stepId="+self.contentReference.id;break;case"Blueprint_Published":self.contentReference.id="Blueprint",self.contentReference.title=null!==bpSettings?bpSettings.dataMap.mission.title:"Mission Statement",self.contentReference.includeRef=!1,self.contentReference.spFeature="Blueprint",self.contentReference.pubChannelTitle=ref.data.title,self.contentReference.pubChannelDesc="",self.contentReference.subTitle="Blueprint",self.contentReference.url="/sp/blueprint";break;case"Blueprint_NotPublished":self.contentReference.id="Blueprint",self.contentReference.title=ref.data.title,self.contentReference.includeRef=!1,self.contentReference.spFeature="Blueprint",self.contentReference.pubChannelTitle=ref.data.title,self.contentReference.pubChannelDesc="",self.contentReference.url="/sp/blueprint";break;case"keyInitiative":self.contentReference.id="Blueprint",self.contentReference.title=null!==bpSettings?bpSettings.dataMap.initiatives.title:"KeyInitiatives",self.contentReference.includeRef=!0,self.contentReference.spFeature="Blueprint",self.contentReference.pubChannelTitle=ref.data.title,self.contentReference.pubChannelDesc="",self.contentReference.subTitle="Blueprint",self.contentReference.url="/sp/blueprint";break;case"articles":self.contentReference.title=ref.data.name,self.contentReference.articleEntry=ref.data.content,self.contentReference.spFeature="KnowledgeCenter",self.contentReference.url=window.location.href;break;case"prismMain":self.contentReference.id="Prism",self.contentReference.parentRefId="Prism",self.contentReference.title=$rootScope.pullInterNationalization("dashboard.publicchannel.name."+self.contentReference.id),self.contentReference.includeRef=!1,self.contentReference.spFeature="Prism",self.contentReference.pubChannelTitle=$rootScope.pullInterNationalization("dashboard.publicchannel.name."+self.contentReference.id),self.contentReference.pubChannelDesc="",self.contentReference.url="/sp/profile";break;case"prism":self.contentReference.id=ref.data.subModule,self.contentReference.parentRefId="Prism",self.contentReference.title=$rootScope.pullInterNationalization("dashboard.publicchannel.title."+ref.data.subModule),self.contentReference.subModule=ref.data.subModule,self.contentReference.includeRef=!1,self.contentReference.spFeature="Prism",self.contentReference.subModuleName=$rootScope.pullInterNationalization("dashboard.publicchannel.name."+ref.data.subModule),self.contentReference.pubChannelTitle=$rootScope.pullInterNationalization("dashboard.publicchannel.title."+ref.data.subModule),self.contentReference.pubChannelDesc="Prism&#174; Portrait",self.contentReference.overviewText=$rootScope.pullInterNationalization("dashboard.publicchannel.description."+ref.data.subModule),self.contentReference.subTitle="Prism&#174; Portrait",self.contentReference.url="/sp/profile?refId="+self.contentReference.subModule;break;case"prismLens":self.contentReference.id="PrismLens",self.contentReference.parentRefId="PrismLens",self.contentReference.parentName=ref.data.mainModule,self.contentReference.title=$rootScope.pullInterNationalization("dashboard.publicchannel.name."+self.contentReference.id),self.contentReference.includeRef=!1,self.contentReference.spFeature="PrismLens",self.contentReference.pubChannelTitle=$rootScope.pullInterNationalization("dashboard.publicchannel.name."+self.contentReference.id),self.contentReference.pubChannelDesc="",self.contentReference.url="/sp/feedback";break;case"relationshipAdvisor":self.contentReference.id="RelationShipAdvisor",self.contentReference.parentRefId="RelationShipAdvisor",self.contentReference.parentName=ref.data.mainModule,self.contentReference.title=$rootScope.pullInterNationalization("dashboard.publicchannel.name."+self.contentReference.id),self.contentReference.includeRef=!1,self.contentReference.spFeature="RelationShipAdvisor",self.contentReference.pubChannelTitle=$rootScope.pullInterNationalization("dashboard.publicchannel.name."+self.contentReference.id),self.contentReference.pubChannelDesc="",self.contentReference.url="/sp/prism/relationship-advisor"}ref=null}},self.getReferenceData=function(){return self.contentReference},self.getOGReference=function(){return{id:null,title:null,subModule:null,description:null,imageUrl:null,authorSource:null,media:[],refType:null,includeRef:!1,spFeature:null,parentRefId:null,subModuleName:null,articleEntry:null,pubChannelTitle:null,pubChannelDesc:null,overviewText:null,subTitle:null,url:null,fileStack:!1,client:null,valid:!1,ogRef:!1}}}angular.module("spApp").service("notesService",notesService),notesService.$inject=["ajaxService","sharedProperties","$rootScope","$sce","$localStorage"];
function notificationService(ajaxService,sharedProperties){var self=this;self.getAllNotifications=function(){return ajaxService.getAjaxResponse({url:"/sp/logs/getAllNotificationLogs"}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.markAsRead=function(id){return ajaxService.getAjaxResponse({url:"/sp/logs/markAsRead",data:$.param({notificationId:id})}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.resetNotificationCount=function(){return ajaxService.getAjaxResponse({url:"/sp/logs/resetNotificationLogsCount"}).then(function(response){if("true"===response.Success)return response;null!==response.error&&sharedProperties.ajaxError(response.error)})},self.prepareNotifyIconAndUrl=function(data,type){var obj={};switch(data.logActionType){case"AltBillSignupWelcome":obj.url="/sp",obj.showIcon=!0,obj.icon="icon-logo-badge";break;case"FeedbackCompleted":obj.url="/sp/feedback?feedbackId="+data.urlParam,obj.showIcon=!1,obj.icon=null;break;case"ActionPlanAssign":case"ActionPlanRemove":case"ActionPlanResume":case"ActionPlanOnHold":obj.url="/sp/goalsOrg?parentId="+data.urlParam,obj.showIcon=!0,obj.icon="icon-LearningProgram_new";break;case"ArticleShare":obj.url="/sp/trainingLibrary/article?"+data.urlParam,obj.showIcon=!1,obj.icon=null;break;case"PulseAssessmentStart":obj.url="/sp/pulseUser/pulseStartAssessment?pulseRequestId="+data.urlParam,obj.showIcon=!0,obj.icon="icon-logo-badge";break;case"BlueprintFeedback":case"BlueprintApprovalRevise":case"BlueprintApproved":obj.url="/sp/blueprint",obj.showIcon=!1,obj.icon=null;break;case"CompetencyProfileAssigned":obj.url="/sp/competency/home",obj.showIcon=!0,obj.icon="icon-icon_spectrum_competency";break;case"CompetencyEvaluationActivated":obj.url="/sp/competency/home?from=notification",obj.showIcon=!0,obj.icon="icon-icon_spectrum_competency";break;case"SubmitRequestFeedback":obj.url="/sp/developmentfeedback/home?id="+data.urlParam,obj.showIcon=!1,obj.icon=null;break;case"GroupLead":obj.url="/sp/dashboard/groups",obj.showIcon=!0,obj.icon="icon-icon_accounts_settings";break;case"WorkspacePulsePermission":obj.url="/sp/pulse",obj.showIcon=!0,obj.icon="icon-icon_accounts_settings";break;case"SpectrumPermission":obj.url="/sp/spectrum",obj.showIcon=!0,obj.icon="icon-icon_accounts_settings";break;case"CompetencyAdminPermission":obj.url="/sp/admin/competency/manager",obj.showIcon=!0,obj.icon="icon-icon_accounts_settings";break;case"HiringAccount":obj.url="/sp/hiring",obj.showIcon=!0,obj.icon="icon-icon_accounts_settings";break;case"PrimaryAccount":obj.url="/sp/admin/manageAccount",obj.showIcon=!0,obj.icon="icon-icon_accounts_settings";break;case"BadgeCompletedErti":case"BadgeCompleted":obj.url="/sp/dashboard/profile",obj.showIcon=!1,obj.icon=null;break;case"AddMember":obj.url="/sp/profile",obj.showIcon=!1,obj.icon=null;break;default:obj.url="/sp/dashboard?msgId="+data.urlParam,obj.showIcon=!1,obj.icon=null}return"flyMessage"===type?obj.url:obj}}notificationService.$inject=["ajaxService","sharedProperties"],angular.module("spApp").service("notificationService",notificationService);
function processSSEData($localStorage,$rootScope,sharedProperties,$timeout){function processData(controller,data){function processCompetencyObject(todo){for(var competencyNotification=null,competencyListing=todo.requests,j=0;j<competencyListing.length;j++)"CompetencyEvaluation"!==competencyListing[j].taskType&&(competencyNotification=angular.copy(competencyListing[j]),competencyNotification.showPeerRating=!1,competencyNotification.showManagerRating=!1,"CompetencyEvaluationInitiateManagerPeer"!==competencyNotification.taskType&&"CompetencyEvaluationInitiate"!==competencyNotification.taskType||(competencyNotification.showPeerRating=!0,competencyNotification.showManagerRating=!0),"CompetencyEvaluationInitiateSelfPeer"===competencyNotification.taskType&&(competencyNotification.showPeerRating=!0),"CompetencyEvaluationInitiateManagerSelf"!==competencyNotification.taskType&&"CompetencyEvaluationInitiateManager"!==competencyNotification.taskType||(competencyNotification.showManagerRating=!0),competencyNotification.title="Initiate Competency Evaluation",competencyNotification.description=$rootScope.pullInterNationalization("taskList.competency.CompetencyEvaluationInitiate.description"),"CompetencyEvaluationSelf"===competencyNotification.taskType&&(competencyNotification.title=$rootScope.pullInterNationalization("taskList.competency.CompetencyEvaluationSelf.title"),competencyNotification.description=$rootScope.pullInterNationalization("taskList.competency.CompetencyEvaluationSelf.description")));competencyListing=[],null!==competencyNotification&&($localStorage.set("competencyObj",competencyNotification),$localStorage.set("competencyAlertType",competencyNotification.taskType))}var self=controller;switch(data.actionType){case"NotificationLog":var notifyCount=$localStorage.get("notifyCount");if(null!==notifyCount){notifyCount++,$localStorage.set("notifyCount",notifyCount),$rootScope.notifyCount=$localStorage.get("notifyCount");new Audio("/resources/audio/notifcation.mp3").play()}data.showBox&&$.notify({message:data.notifications.message,url:data.notifications.url,target:"_self",delay:1e4},{animate:{enter:"animated fadeInRight",exit:"animated fadeOutRight"}});break;case"GroupDiscussion":var gdData=data.gdComment,gdCount=0,loggedInUser=$localStorage.get("loggegdInProfile");switch(data.op){case"CREATE":if(null!==self){void 0===self.gdListing&&(self.gdListing=[]),self.gdListing.unshift(gdData);for(var kkk=0;kkk<self.gdListing.length;kkk++)self.gdListing[kkk].id===gdData.id&&(self.gdListing[kkk].unreadCount=parseInt(gdData.lastComment.cid)+1);self.isDashboardOrigin&&1===self.gdListing.length&&(self.gdObj=self.gdListing[0],self.notifyCheck=!self.gdObj.filterNotification)}$rootScope.gdActive||null!==(gdCount=$localStorage.get("gdCount"))&&(gdCount++,$localStorage.set("gdCount",gdCount),$rootScope.unreadCount=$localStorage.get("gdCount")),sharedProperties.notifyUser($rootScope.pullInterNationalization("gd.sse.welcome")+" "+loggedInUser.member.firstName,$rootScope.pullInterNationalization("gd.sse.message1"));break;case"ADD":if(null!==self){void 0===self.gdListing&&(self.gdListing=[]),self.gdListing.unshift(gdData);for(var i=0;i<self.gdListing.length;i++)self.gdListing[i].id===gdData.id&&(self.gdListing[i].unreadCount=parseInt(gdData.lastComment.cid)+1);self.isDashboardOrigin&&1===self.gdListing.length&&(self.gdObj=self.gdListing[0],self.notifyCheck=!self.gdObj.filterNotification)}$rootScope.gdActive||null!==(gdCount=$localStorage.get("gdCount"))&&(gdCount++,$localStorage.set("gdCount",gdCount),$rootScope.unreadCount=$localStorage.get("gdCount")),sharedProperties.notifyUser($rootScope.pullInterNationalization("gd.sse.welcome")+" "+loggedInUser.member.firstName,$rootScope.pullInterNationalization("gd.sse.message1"));break;case"UPDATE":if(null!==self)if(void 0!==self.gdObj.name&&(self.isDashboardOrigin||(self.gdObj.name=gdData.name,self.newGroupName=gdData.name,self.gdObj.comments.push(gdData.lastComment),$timeout(function(){$("body .note-comments-updates-wrapper").animate({scrollTop:$("body .note-comments-updates-wrapper").prop("scrollHeight")},0)},500)),self.gdUpdated=!0),self.gdListing.length)for(var j=0;j<self.gdListing.length;j++)self.gdListing[j].id===gdData.id&&(self.gdListing[j].name=gdData.name,self.gdListing[j].unreadCount++,self.gdListing[j].lastComment=gdData.lastComment);else void 0===self.gdListing&&(self.gdListing=[]),self.gdListing.unshift(gdData);$rootScope.gdActive||null!==(gdCount=$localStorage.get("gdCount"))&&(gdCount++,$localStorage.set("gdCount",gdCount),$rootScope.unreadCount=$localStorage.get("gdCount")),sharedProperties.notifyUser($rootScope.pullInterNationalization("gd.sse.message2")+" "+gdData.lastComment.user.name,gdData.lastComment.text);break;case"VOTE_MINIPOLL":if(null!==self)for(var z=0;z<self.gdObj.comments.length;z++)if(self.gdObj.comments[z].cid===data.cId){self.gdObj.comments[z].miniPoll.result=data.miniPollResult;break}}break;case"PublicChannel":break;case"ActionPlan":var todoListing=$localStorage.get("todoListing"),taskCount=0;switch(data.op){case"ADD":if("CompetencyEvaluation"===data.todo.type){for(var cba=0;angular.isArray(todoListing)&&cba<todoListing.length;cba++)if(data.todo.parentRefId===todoListing[cba].parentRefId){sharedProperties.spilceIndexWithBreak(todoListing,"parentRefId",data.todo.parentRefId);break}null===self&&"/sp/competency/home"!==window.location.pathname&&processCompetencyObject(data.todo)}null!==todoListing&&todoListing.push(data.todo),"Todo"!==data.todo.type&&null!==(taskCount=$localStorage.get("taskCount"))&&(taskCount++,$localStorage.set("taskCount",taskCount),$rootScope.taskCount=$localStorage.get("taskCount"));break;case"UPDATE":if("OrgPlan"===data.todo.type)for(var abc=0;angular.isArray(todoListing)&&abc<todoListing.length;abc++)if(data.todo.parentRefId===todoListing[abc].parentRefId){sharedProperties.spilceIndexWithBreak(todoListing,"parentRefId",data.todo.parentRefId);break}if("CompetencyEvaluation"===data.todo.type){for(var xyz=0;angular.isArray(todoListing)&&xyz<todoListing.length;xyz++)if(data.todo.parentRefId===todoListing[xyz].parentRefId){sharedProperties.spilceIndexWithBreak(todoListing,"parentRefId",data.todo.parentRefId);break}null===self&&"/sp/competency/home"!==window.location.pathname&&processCompetencyObject(data.todo)}null!==todoListing&&todoListing.push(data.todo),"OrgPlan"!==data.todo.type&&"Todo"!==data.todo.type&&null!==(taskCount=$localStorage.get("taskCount"))&&(taskCount++,$localStorage.set("taskCount",taskCount),$rootScope.taskCount=$localStorage.get("taskCount"));break;case"DELETE":if("Todo"!==data.type&&"CompetencyEvaluation"!==data.type&&(null!==data.parentRefId?sharedProperties.spilceIndexWithBreak(todoListing,"parentRefId",data.parentRefId):sharedProperties.spilceIndexWithBreak(todoListing,"refId",data.refId)),"CompetencyEvaluation"===data.type){var deleted=!1;null===$localStorage.get("competencyObj")||$localStorage.get("competencyObj").refId!==data.refId&&$localStorage.get("competencyObj").refId!==data.parentRefId||($localStorage.remove("competencyObj"),$localStorage.remove("competencyAlertType"));for(var xxx=0;!deleted&&angular.isArray(todoListing)&&xxx<todoListing.length;xxx++)data.parentRefId===todoListing[xxx].parentRefId&&(null!==data.refId&&void 0!==data.refId?(sharedProperties.spilceIndexWithBreak(todoListing[xxx].requests,"refId",data.refId),deleted=!0):(sharedProperties.spilceIndexWithBreak(todoListing,"parentRefId",data.parentRefId),deleted=!0))}}$localStorage.set("todoListing",todoListing),null!==self&&self.prepareActionPlanData($localStorage.get("todoListing"))}}return{processData:processData}}angular.module("spApp").factory("processSSEData",processSSEData),processSSEData.$inject=["$localStorage","$rootScope","sharedProperties","$timeout"];