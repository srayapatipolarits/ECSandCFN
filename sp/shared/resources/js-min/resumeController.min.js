function resumeController($scope,ajaxService,ngDialog,$filter,sharedProperties,$timeout,ProfileDataService,$rootScope,$localStorage){$scope.createFormError=!1,$scope.itemPositioned=[],$scope.linkedIn=[],$scope.profileContentDisplay=!0,$scope.contactInfo=!1,$scope.coverLetter=!1,$scope.displayCover=!1,$scope.profile={},$scope.manageResumeLength=0;var date=new Date;$scope.fullmonth=date.getMonth(),$scope.fullyear=date.getFullYear(),$scope.getAllResume=function(){ajaxService.getAjaxResponse({url:"/sp/resume/getAllResumes",method:"get"}).then(function(response){if("true"===response.Success)$scope.resultStat=response.resume,$scope.firstView=$scope.resultStat.length?"true":"false",$scope.order("formattedDate",!0);else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.openDialogCreateResume=function(){ngDialog.open({template:"/sp/createResume",scope:$scope})},$scope.order=function(predicate,reverse){$scope.resultStat=$filter("orderBy")($scope.resultStat,predicate,reverse)},$scope.active=function(event){sharedProperties.toggleFilterClick(event,$scope.currentPredicate)},$scope.createResumeDetail=function(form){if($scope.createFormError=!1,form.$valid){$localStorage.remove("firstViewEnable"),$localStorage.set("createResumeContent",{resumeLength:$scope.resultStat.length,createResumeRoleName:form.createResumeRole.$viewValue,createResumeProviderName:form.createResumeName.$viewValue});$localStorage.get("profileDone");window.location.href="/sp/resume/resumeDetailsView"}else $scope.createFormError=!0},$scope.openMessage=function(result){$scope.displayName=result,ngDialog.open({template:"/sp/messageAll",scope:$scope})},$scope.openPreview=function(id){var popupWin=window.open("/sp/resume/getResume/"+id,"_blank","width=700,height=700,scrollbars=no,menubar=no,toolbar=no,location=no,status=no,titlebar=no");"Microsoft Internet Explorer"===navigator.appName?window.print():popupWin.print(),popupWin.window.focus()},$scope.openPreviewNew=function(id){window.open("/sp/resume/getResume/"+id,"_blank")},$scope.displayResume=function(){$scope.openDialogCreateResume()},$scope.createLayout=function(){var $slidesElem=$("ul.ordering-tool-list"),slidesHeight=$slidesElem.find("li").outerHeight();$slidesElem.find("li").outerWidth();return void 0!==$scope.pckry&&$slidesElem.packery("destroy"),this.initialize=function(execute){$scope.pckry=$slidesElem.packery({itemSelector:".handleMe",rowHeight:slidesHeight,transitionDuration:0});var itemElems=$scope.pckry.packery("getItemElements");$scope.initialItem=itemElems;for(var i=0,len=itemElems.length;i<len;i++){var draggie=new Draggabilly(itemElems[i],{axis:"y",containment:$slidesElem,grid:[0,35]});$scope.pckry.packery("bindDraggabillyEvents",draggie)}$scope.pckry.packery("on","dragItemPositioned",this.orderItems)},this.orderItems=function(){for(var $itemElems=$scope.pckry.packery("getItemElements"),i=0;i<$itemElems.length;i++){var indexToPut=$($itemElems[i]).attr("tabindex");$scope.itemPositioned[i]=indexToPut,$scope.profileContent[indexToPut].id=i,$($itemElems[i]).attr("data-module-index",i)}$scope.$apply()},this.resetOrder=function(){for(var $itemElems=$scope.pckry.packery("getItemElements"),number=0,i=0;i<$itemElems.length;i++){var _this=$($itemElems[i]);$scope.itemPositioned[i]=_this.attr("tabindex"),_this.attr("data-module-index",i),_this.css("top",number),number+=slidesHeight,$scope.profileContent[i].id=i}},this.destroy=function(destroy){$scope.pckry.packery("reloadItems"),this.resetOrder()},this},$scope.callReorder=function(){$scope.initAside.destroy(),$scope.destroyProfileContent()},$scope.destroyProfileContent=function(){for(var i=0;i<$scope.profileContent.length;i++)$scope.profileContent[i].status=!0},$scope.displatyContent=function(){$scope.initAside=new $scope.createLayout,$scope.initAside.initialize(!0)},$scope.previewPDF=function(section){var printContents=$("."+section).html(),frontPage=$(".htmlFront").html(),coverLetter="",graphs=$(".graphs").html(),messageContent=$(".coverLetterPDF").find(".messageContent").html();if(this.displayCover&&""!==messageContent){var sub=$rootScope.nl2br(messageContent);$(".htmlCover").find(".messageContent").html(sub),coverLetter=$(".htmlCover").html()}var data={content:encodeURIComponent('<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link type="text/css" rel="stylesheet" href="/sp/resources/css/css-min/bootstrap.min.css"><link type="text/css" rel="stylesheet" href="/sp/resources/css/css-min/spResume.css"><script src="//use.typekit.net/ofk8xcu.js"><\/script><script> try {Typekit.load();} catch (e) {}<\/script></head><body class="sp-resume sp-resume-print-preview"><div class="container"><article class="resume-content">'+frontPage+coverLetter+"<div>"+printContents+"</div>"+graphs+"</article></div></body></html>"),role:$scope.roleName,providerName:$scope.providerName};ajaxService.getAjaxResponse({url:"/sp/resume/previewResume",data:$.param(data)}).then(function(response){if("true"===response.Success)window.open(response.url,"_blank");else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.createResumeCall=function(section){var printContents=$("."+section).html(),frontPage=$(".htmlFront").html(),coverLetter="",graphs=$(".graphs").html(),messageContent=$(".coverLetterPDF").find(".messageContent").html();if(this.displayCover&&""!==messageContent){var sub=$rootScope.nl2br(messageContent);$(".htmlCover").find(".messageContent").html(sub),coverLetter=$(".htmlCover").html()}var data={content:encodeURIComponent('<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link type="text/css" rel="stylesheet" href="/sp/resources/css/css-min/bootstrap.min.css"><link type="text/css" rel="stylesheet" href="/sp/resources/css/css-min/spResume.css"><script src="//use.typekit.net/ofk8xcu.js"><\/script><script> try {Typekit.load();} catch (e) {}<\/script></head><body class="sp-resume sp-resume-print-preview"><div class="container"><article class="resume-content">'+frontPage+coverLetter+"<div>"+printContents+"</div>"+graphs+"</article></div></body></html>"),role:$scope.roleName,providerName:$scope.providerName};ajaxService.getAjaxResponse({url:"/sp/resume/createResume",data:$.param(data)}).then(function(response){if("true"===response.Success)window.location.href="/sp/spResume",$.growl({icon:"glyphicon glyphicon-ok",message:"PDF Created"});else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.goBack=function(){window.location.href="/sp/connect/linkedin"},$scope.getProfileDetails=function(param){var _obj="";void 0!==param?_obj={url:"/sp/linkedin/getProfileFull?updateProfile="+!0,method:"get"}:($scope.getUserDetail(),_obj={url:"/sp/linkedin/getProfileFull",method:"get"}),ajaxService.getAjaxResponse(_obj).then(function(response){if("true"===response.Success)$scope.linkedIn=response.linkedProfile,$localStorage.set("profileDone",!0),$scope.mapToResponse(),void 0!==response.otherProfileData&&($scope.linkedIn.otherProfileData=response.otherProfileData),$scope.createNewMappingObject($scope.linkedIn);else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.mapToResponse=function(){$scope.searchContent=["summary","projects","positions","testScores","educations","certifications","courses","interests","skills","languages","volunteer","Organizations","Supported Organizations","honorsAwards","patents","publications"]},$scope.createNewMappingObject=function(response){$scope.profileContent=[],$scope.asideContent=[];for(var count=0,i=0;i<$scope.searchContent.length;i++)for(var key in response)if("otherProfileData"===key||"linkedProfile"===key)for(var subKey in response[key])$scope.searchContent[i]===subKey&&null!==response[key][subKey]&&($scope.asideContent.push($scope.searchContent[i]),$scope.profileContent.push({id:count,content:response[key][subKey],status:"true",type:angular.lowercase(subKey)}),count++);$timeout(function(){$scope.displatyContent()},500)},$scope.changeStatusType=function(event,tabIndex){var _this=angular.element(event.currentTarget),dataType=$(_this).closest("li").attr("data-type");$scope.profileContent[tabIndex].status=!$scope.profileContent[tabIndex].status,$(_this).closest("li").attr("data-type",dataType=!dataType)},$scope.getUserDetail=function(){ajaxService.getAjaxResponse({url:"/sp/admin/user"}).then(function(response){if("true"===response.Success){$scope.userProfileDetail=response.profileForm,$scope.userProfileAddress=response.address,$scope.userSummary=response.userSummary;var fullDetail=$localStorage.get("createResumeContent");null!==fullDetail&&($scope.roleName=fullDetail.createResumeRoleName,$scope.providerName=fullDetail.createResumeProviderName,$scope.manageResumeLength=fullDetail.resumeLength)}else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.coverletterfn=function(){this.displayCover?(this.contactInfo=!1,this.profileContentDisplay=!1,this.coverLetter=!0):(this.contactInfo=!1,this.profileContentDisplay=!0,this.coverLetter=!1)},$scope.deleteResumePop=function(id){$scope.deleteResumeId=id,ngDialog.open({template:"/sp/resume/deleteConfirmation",scope:$scope})},$scope.deleteResume=function(){ajaxService.getAjaxResponse({url:"/sp/resume/delete/"+$scope.deleteResumeId,method:"get"}).then(function(response){if("true"===response.Success)sharedProperties.spliceIndex($scope.resultStat,"id",$scope.deleteResumeId),ngDialog.close("ngdialog1"),$scope.firstView=$scope.resultStat.length?"true":"false",$.growl({icon:"glyphicon glyphicon-ok",message:"Delete Successfully"});else if(null!=response.error){ngDialog.close("ngdialog1");for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.messageItem=function(param){if($scope.errpat=!1,param.$valid){var data=$(".shareResume").serialize();ajaxService.getAjaxResponse({url:"/sp/resume/share",data:data}).then(function(response){if("true"===response.Success)ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:"Resume Shared"});else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})}else $scope.errpat=!0},$scope.callGraphs=function(){ajaxService.getAjaxResponse({url:"/sp/signedIn/getAnalysisFull"}).then(function(response){if("true"===response.Success)$scope.profile.analysis=response.Analysis,$scope.profileContentGraphs=response,ProfileDataService.save(response);else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})}}angular.module("spApp").controller("resumeController",resumeController),resumeController.$inject=["$scope","ajaxService","ngDialog","$filter","sharedProperties","$timeout","ProfileDataService","$rootScope","$localStorage"];