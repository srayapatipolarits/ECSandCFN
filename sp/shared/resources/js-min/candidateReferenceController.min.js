function candidateReferenceController($scope,ajaxService,sharedProperties){function addReferenceObject(){vm.candidateReference.referenceList.push({firstName:null,lastName:null,email:null,phoneNumber:null,referenceType:null})}function init(){ajaxService.getAjaxResponse({url:"/sp/hiring/ext/getProfile",data:vm.candidateReference,headers:{"Content-Type":"application/json"}}).then(function(response){if("true"===response.Success){vm.candidateReferenceDetail.loop=response.referenceTypes.length,vm.candidateReferenceDetail.reference=response.referenceTypes,vm.candidateReferenceDetail.user=response.hiring;for(var i=0;i<vm.candidateReferenceDetail.loop;i++)addReferenceObject()}})}var vm=this;vm.candidateReferenceDetail={loop:0,reference:null,user:null},vm.candidateReference={referenceList:[]},$scope.candidateRefList={},$scope.uniqueEmailError=!1,$scope.selfEmailAdded=!1,init(),$scope.processRefList=function(fData){if($scope.candidateRefList.submitted=!1,$scope.uniqueEmailError=!1,$scope.selfEmailAdded=!1,$scope.candidateRefList.$valid){for(var emails=[],uniqueEmails=[],i=0;i<vm.candidateReferenceDetail.loop;i++)emails[i]=vm.candidateReference.referenceList[i].email;uniqueEmails=emails.unique(),uniqueEmails.length===vm.candidateReferenceDetail.loop&&-1===emails.indexOf(vm.candidateReferenceDetail.user.email)?ajaxService.getAjaxResponse({url:"/sp/hiring/ext/addReferences",data:vm.candidateReference,headers:{"Content-Type":"application/json"}}).then(function(response){"true"===response.Success?window.location.reload():sharedProperties.ajaxError(response)}):($scope.uniqueEmailError=uniqueEmails.length<vm.candidateReferenceDetail.loop,$scope.selfEmailAdded=-1!==emails.indexOf(vm.candidateReferenceDetail.user.email),jQuery("html, body").animate({scrollTop:0}))}else $scope.candidateRefList.submitted=!0,jQuery("html, body").animate({scrollTop:0})}}angular.module("spApp").controller("candidateReferenceController",candidateReferenceController),candidateReferenceController.$inject=["$scope","ajaxService","sharedProperties"];