function spMatchController($scope,ajaxService,$q,spJsonFetch,$filter,$rootScope,$localStorage,sharedProperties){function defaultFormatter(){vm.isCustomPtpPage===!0?null===sharedProperties.getParam("ptpId")?(vm.responseFormatter=spJsonFetch.spMatchJsonCustom().success.ptpAnalysis,getMatchedSelectedResults()):vm.editPTP():null===sharedProperties.getParam("ptpId")?(vm.responseFormatter=spJsonFetch.spMatchJson().success.ptpAnalysis,getMatchedSelectedResults()):vm.editPTP()}function getAvailableMember(){ajaxService.getAjaxResponse({url:vm.config.getAvailableMember}).then(function(response){if("true"===response.Success)vm.emailMemberList=response.allMembers,vm.isCustomPtpPage!==!0&&defaultFormatter();else{var errorMessage=null;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function cancelRedirect(){window.location.href="/sp/spmatch/spMatchListing"}function editPTP(){ajaxService.getAjaxResponse({url:vm.config.editPtpForm,data:$.param({ptpId:sharedProperties.getParam("ptpId")})}).then(function(response){if("true"===response.Success){vm.responseFormatter=response.ptpAnalysis,vm.pageSetting.countTotalMatch=0,vm.pageSetting.totalTrait=0,vm.pageSetting.totalSet=0,vm.pageSetting.matchedSelectedSet.name=response.ptpDetail.ptpName,vm.pageSetting.roles=response.ptpDetail.roles,vm.pageSetting.rolesTag=angular.copy(vm.pageSetting.roles),vm.pageSetting.matchedSelectedSet.description=response.ptpDetail.description;for(var i=0;i<vm.emailMemberList.length;i++)-1!==response.ptpDetail.users.indexOf(vm.emailMemberList[i].email)&&(vm.pageSetting.tags.push(vm.emailMemberList[i]),vm.pageSetting.searchTag.push(vm.emailMemberList[i].email));getMatchedSelectedResults(),vm.pageSetting.newSet=!vm.pageSetting.newSet}else{var errorMessage=null;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function loadTags(query){var deferred=$q.defer(),result=vm.emailMemberList.filter(function(e){return-1!==e.name.toLowerCase().indexOf(query.toLowerCase())||-1!==e.email.toLowerCase().indexOf(query.toLowerCase())});return deferred.resolve(result),deferred.promise}function tagAdded(tag){vm.pageSetting.searchTag.push(tag.email),vm.getPtPAnalysis()}function tagRemoved(tag){vm.pageSetting.searchTag.splice(vm.pageSetting.searchTag.indexOf(tag.email),1),vm.getPtPAnalysis()}function roleAdded(tag){vm.pageSetting.rolesTag.push(tag.text)}function roleRemoved(tag){vm.pageSetting.rolesTag.splice(vm.pageSetting.matchedSelectedSet.roles.indexOf(tag.text),1)}function getPtPAnalysis(){ajaxService.getAjaxResponse({url:vm.config.getPtPAnalysis,data:$.param({memberIds:vm.pageSetting.searchTag.toString()})}).then(function(response){if("true"===response.Success)vm.responseFormatter=response.ptpAnalysis,vm.pageSetting.countTotalMatch=0,vm.pageSetting.totalTrait=0,vm.pageSetting.totalSet=0,getMatchedSelectedResults(),vm.pageSetting.newSet=!vm.pageSetting.newSet;else{var errorMessage=null;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function getMatchedSelectedResults(){vm.pageSetting.jsonParent={},vm.pageSetting.jsonTraitType={},vm.pageSetting.matchedSelectedSet.analysisDTO.categoryTypeAnalysisDtos=vm.responseFormatter.categoryTypeAnalysisDtos.map(function(e,i){return vm.pageSetting.jsonParent[e.categoryType]=i,{categoryType:e.categoryType,analysisTraitsDTOs:e.analysisTraitsDTOs.filter(function(e1,i){return vm.pageSetting.jsonTraitType[e.categoryType+"."+e1.traitType]=i,e1.selectedCheckBox===!0&&e1.matched===!0})}}).filter(function(e){return e.analysisTraitsDTOs.length})}function savePtP(){if(vm.createPtpForm.$valid){if(vm.createPtpForm.submitted=!1,getMatchedSelectedResults(),vm.error=!1,!vm.pageSetting.matchedSelectedSet.analysisDTO.categoryTypeAnalysisDtos.length)return vm.error=!0,!0;vm.pageSetting.matchedSelectedSet.users=vm.pageSetting.searchTag,vm.pageSetting.matchedSelectedSet.roles=vm.pageSetting.rolesTag,vm.overrideEditable||(vm.pageSetting.matchedSelectedSet.ptpId=sharedProperties.getParam("ptpId")),ajaxService.getAjaxResponse({url:vm.config.createPtpForm,headers:{"Content-Type":"application/json"},data:vm.pageSetting.matchedSelectedSet}).then(function(response){if("true"===response.Success)$localStorage.set("ptpCreated","true"),window.location.href="/sp/spmatch/spMatchListing";else{var errorMessage=null;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}else vm.createPtpForm.submitted=!0}function setOptions(page){"CustomPTP"===page?vm.isCustomPtpPage=!0:vm.isCustomPtpPage=!1,getAvailableMember(),vm.isCustomPtpPage===!0&&defaultFormatter()}var vm=this;vm.emailMemberList=[],vm.pageSetting={tags:[],searchTag:[],rolesTag:[],matchedSelectedSet:{analysisDTO:{categoryTypeAnalysisDtos:[]},ptpType:"Company",users:[],roles:[]},selected:[],countTotalMatch:0,totalTrait:0,newSet:0,totalSet:0,jsonParent:{},jsonTraitType:{},roles:[]},vm.createPtpForm={submitted:!1},vm.config={getAvailableMember:"/sp/allUsers",getPtPAnalysis:"/sp/hiring/spmatch/admin/getPtpAnalysis",createPtpForm:"/sp/hiring/spmatch/admin/createPTP",editPtpForm:"/sp/hiring/spmatch/admin/editPTP"},vm.responseFormatter={},vm.overrideEditable=null===sharedProperties.getParam("ptpId")?!0:!1,vm.setOptions=setOptions,vm.isCustomPtpPage=!1,vm.loadTags=loadTags,vm.tagAdded=tagAdded,vm.tagRemoved=tagRemoved,vm.roleAdded=roleAdded,vm.roleRemoved=roleRemoved,vm.getPtPAnalysis=getPtPAnalysis,vm.savePtP=savePtP,vm.editPTP=editPTP,vm.cancelRedirect=cancelRedirect}function spMatchListing($scope,ajaxService,sharedProperties,ngDialog,$localStorage,$rootScope){function getPtpList(){ajaxService.getAjaxResponse({url:vm.config.getPtpList}).then(function(response){if("true"===response.Success)vm.ptpList=response.spMatchPTPs,vm.masterptpList=response.spMatchPTPs,vm.masterptpList.length&&vm.getPtpDetail(vm.isptpIdAvailable!==!1?vm.isptpIdAvailable:vm.masterptpList[0].id),vm.pageSetting.ajaxDone=!0;else{vm.pageSetting.ajaxDone=!0,vm.errorFormatter=$rootScope.pullInterNationalization("spmatch.errorState");var errorMessage=null;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function getPtpDetail(ptpid){return vm.pageSetting.currentId===ptpid?!0:void ajaxService.getAjaxResponse({url:vm.config.getPtpDetail,data:$.param({ptpId:ptpid})}).then(function(response){if("true"===response.Success)vm.pageSetting.currentId=ptpid,vm.responseFormatter=response.ptpDetail,orderDefine();else{var errorMessage=null;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function orderDefine(){vm.pageSetting.jsonParent={};for(var i=0;i<vm.responseFormatter.categoryTypeTraitsMaps.length;i++)vm.pageSetting.jsonParent[vm.responseFormatter.categoryTypeTraitsMaps[i].categoryType]=i}function searchTextFilter(){var options="All"===vm.pageSetting.radio?null:vm.pageSetting.radio;vm.ptpList=vm.masterptpList.filter(function(e){return(""!==options&&e.ptpType===options||null===options&&e)&&-1!==angular.lowercase(e.ptpName).indexOf(angular.lowercase(vm.pageSetting.searchText))})}function candidateListFilter(){var result="",stringSearch="";"0"===vm.pageSetting.candidateradio?(stringSearch="name",result=vm.candidateList):(stringSearch="name",result=vm.rolesList),vm.matchWithCandidateList=result.filter(function(e){return-1!==angular.lowercase(e[stringSearch]).indexOf(angular.lowercase(vm.pageSetting.candidateText))})}function editRedirect(ptpId){window.location.href=vm.responseFormatter.users.length?"/sp/spmatch/createPtpMember?ptpId="+vm.responseFormatter.id:"/sp/spmatch/createCustomPtp?ptpId="+vm.responseFormatter.id}function memberListFilter(){var result="",stringSearch="";switch(vm.pageSetting.memberradio){case"0":stringSearch="name",result=vm.memberList;break;case"1":stringSearch="name",result=vm.groupList;break;case"2":stringSearch="name",result=vm.titleList;break;default:stringSearch="name",result=vm.memberList}vm.matchWithMemberList=result.filter(function(e){return-1!==angular.lowercase(e[stringSearch]).indexOf(angular.lowercase(vm.pageSetting.memberText))})}function clearSearch(){vm.pageSetting.searchText="",vm.searchTextFilter()}function clearList(){vm.pageSetting.candidateText="",vm.candidateListFilter()}function clearMemberList(){vm.pageSetting.memberText="",vm.memberListFilter()}function fetchMemberList(){ajaxService.getAjaxResponse({url:vm.config.fetchMemberList}).then(function(response){if("true"===response.Success)vm.memberList=response.allMembers,vm.groupList=response.allGroups,vm.titleList=response.allTitles,vm.memberListFilter();else{var errorMessage=null;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function fetchCandidateList(){ajaxService.getAjaxResponse({url:vm.config.fetchCandidateList}).then(function(response){if("true"===response.Success)vm.candidateList=response.hiring,vm.rolesList=response.hiringRoles,vm.candidateListFilter();else{var errorMessage=null;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function selectCandidate(){vm.candidateList.length?vm.candidateListFilter():fetchCandidateList(),vm.pageSetting.candidateradio="0";var dialog=ngDialog.open({template:vm.config.candidateDialog,scope:$scope});dialog.closePromise.then(function(){vm.pageSetting.candidateText=""})}function selectMember(){vm.memberList.length?vm.memberListFilter():fetchMemberList(),vm.pageSetting.memberradio="0";var dialog=ngDialog.open({template:vm.config.memberDialog,scope:$scope});dialog.closePromise.then(function(){vm.pageSetting.memberText=""})}function runSpMatch(id,member,role){return void 0!==member&&0===member?!0:($localStorage.set("runPtP",{candidateId:id,ptpId:vm.pageSetting.currentId,mode:vm.pageSetting.candidateradio,roleName:role}),void(window.location.href="/sp/spmatch/spMatchCandidate"))}function runSpMatchMember(id,member,group){return void 0!==member&&0===member?!0:($localStorage.set("runPtPMember",{memberId:id,ptpId:vm.pageSetting.currentId,mode:vm.pageSetting.memberradio,altName:group}),void(window.location.href="/sp/spmatch/spMatchMember"))}function deletePtp(){ngDialog.open({template:vm.config.deletePtpDialog,scope:$scope})}function removePtp(){ajaxService.getAjaxResponse({url:vm.config.deletePtp,data:$.param({ptpId:vm.responseFormatter.id})}).then(function(response){if("true"===response.Success){for(var i=0;i<vm.masterptpList.length;i++)vm.masterptpList[i].id===vm.responseFormatter.id&&vm.masterptpList.splice(i,1);ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("spmatch.ptpDeleted")}),vm.masterptpList.length&&vm.getPtpDetail(vm.masterptpList[0].id)}else{var errorMessage=null;ngDialog.close("ngdialog1");for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function ptpStatus(listid){ajaxService.getAjaxResponse({url:vm.config.ptpStatus,data:$.param({ptpId:vm.responseFormatter.id,active:!vm.responseFormatter.active})}).then(function(response){if("true"===response.Success){vm.responseFormatter.active=!vm.responseFormatter.active;for(var i=0;i<vm.masterptpList.length;i++)if(vm.masterptpList[i].id===listid){vm.masterptpList[i].active=vm.responseFormatter.active;break}for(var ii=0;ii<vm.ptpList.length;ii++)if(vm.ptpList[ii].id===listid){vm.ptpList[ii].active=vm.responseFormatter.active;break}$.growl({icon:"glyphicon glyphicon-ok",message:vm.responseFormatter.active?$rootScope.pullInterNationalization("spMatch.active"):$rootScope.pullInterNationalization("spMatch.inactive")})}else{var errorMessage=null;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}var vm=this;vm.ptpList=[],vm.masterptpList=[],vm.responseFormatter=null,vm.candidateList=[],vm.rolesList=[],vm.memberList=[],vm.titleList=[],vm.groupList=[],vm.matchWithCandidateList=[],vm.matchWithMemberList=[],vm.pageSetting={radio:"All",searchText:"",candidateText:"",currentId:null,jsonParent:{},candidateradio:"0",memberradio:"0",memberText:"",ajaxDone:!1},vm.config={getPtpList:"/sp/hiring/spmatch/getAllPtps",getPtpDetail:"/sp/hiring/spmatch/getPtpDetail",fetchCandidateList:"/sp/hiring/spMatch/getAllValidCandidates",candidateDialog:"/sp/spmatch/spMatchCandidatesDialog",memberDialog:"/sp/spmatch/spMatchMemberDialog",deletePtp:"/sp/hiring/spmatch/admin/deletePtp",deletePtpDialog:"/sp/spmatch/spMatchDeletePtp",ptpStatus:"/sp/hiring/spmatch/changeActiveStatus",fetchMemberList:"/sp/hiring/spmatch/getMembersGroupsTitle"},vm.isptpIdAvailable=null===sharedProperties.getParam("ptpId")?!1:sharedProperties.getParam("ptpId"),vm.getPtpList=getPtpList,vm.getPtpDetail=getPtpDetail,vm.searchTextFilter=searchTextFilter,vm.clearSearch=clearSearch,vm.clearList=clearList,vm.selectCandidate=selectCandidate,vm.selectMember=selectMember,vm.candidateListFilter=candidateListFilter,vm.memberListFilter=memberListFilter,vm.runSpMatch=runSpMatch,vm.deletePtp=deletePtp,vm.removePtp=removePtp,vm.ptpActiveInactive=ptpStatus,vm.clearMemberList=clearMemberList,vm.runSpMatchMember=runSpMatchMember,vm.errorFormatter=null,vm.editRedirect=editRedirect,function(){"true"===$localStorage.get("ptpCreated")&&($.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("spMatch.ptpCreated")}),$localStorage.remove("ptpCreated")),vm.getPtpList()}()}function spMatchCandidate($scope,ajaxService,sharedProperties,$localStorage,ngDialog,$rootScope){function runCandidate(){vm.pageSetting.runPtP=$localStorage.get("runPtP"),null===vm.pageSetting.runPtP?vm.returnToProfile():(vm.pageSetting.screenMode="c",vm.pageSetting.candidateradio=vm.pageSetting.runPtP.mode,"0"===vm.pageSetting.runPtP.mode?vm.runPtPMatchFn({url:vm.config.runPtPCandidate,data1:vm.pageSetting.runPtP.candidateId,data2:vm.pageSetting.runPtP.ptpId,name:"candidateId"}):vm.runPtPMatchFn({url:vm.config.role,data1:vm.pageSetting.runPtP.roleName,data2:vm.pageSetting.runPtP.ptpId,name:"roleName"}))}function runMember(){if(vm.pageSetting.runPtP=$localStorage.get("runPtPMember"),null===vm.pageSetting.runPtP)vm.returnToProfile();else switch(vm.pageSetting.screenMode="m",vm.pageSetting.memberradio=vm.pageSetting.runPtP.mode,vm.pageSetting.runPtP.mode){case"0":vm.runPtPMatchFn({url:vm.config.runPtPMember,data1:vm.pageSetting.runPtP.memberId,data2:vm.pageSetting.runPtP.ptpId,name:"memberId"});break;case"1":vm.runPtPMatchFn({url:vm.config.group,data1:vm.pageSetting.runPtP.altName,data2:vm.pageSetting.runPtP.ptpId,name:"groupName"});break;case"2":vm.runPtPMatchFn({url:vm.config.title,data1:vm.pageSetting.runPtP.altName,data2:vm.pageSetting.runPtP.ptpId,name:"title"})}}function runPtPMatchFn(options){var obj={};obj[options.name]=options.data1,obj.ptpId=options.data2,ajaxService.getAjaxResponse({url:options.url,data:$.param(obj)}).then(function(response){if("true"===response.Success)vm.selectedResponse=response.runResult,vm.selectedResponse.length&&(vm.responseFormatter=vm.selectedResponse[0],vm.pageSetting.currentIndex=0),null===vm.responseFormatter.tagList&&(vm.responseFormatter.tagList=[]),orderDefine(),ngDialog.close("ngdialog1");else{var errorMessage=null;ngDialog.close("ngdialog1");for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function changeResponseDetail(index){return vm.pageSetting.currentIndex===index?!1:(vm.responseFormatter=vm.selectedResponse[index],vm.pageSetting.currentIndex=index,null===vm.responseFormatter.tagList&&(vm.responseFormatter.tagList=[]),void 0)}function getHiringProfile(){ajaxService.getAjaxResponse({url:vm.config.candidateTopMatch,data:$.param({memberId:vm.responseFormatter.baseUserDTO.id,userType:vm.responseFormatter.userType})}).then(function(response){if("true"===response.Success)vm.topHiringProfile=response.topMatch;else{var errorMessage=null;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function getHiringDetailResult(id){ajaxService.getAjaxResponse({url:vm.config.topHiringResult,data:$.param({resultMatchId:id,userType:vm.responseFormatter.userType})}).then(function(response){if("true"===response.Success)vm.selectedResponse=response.runResult,vm.selectedResponse.length&&(vm.responseFormatter=vm.selectedResponse[0],vm.pageSetting.currentIndex=0),null===vm.responseFormatter.tagList&&(vm.responseFormatter.tagList=[]),orderDefine(),ngDialog.close("ngdialog1");else{var errorMessage=null;ngDialog.close("ngdialog1");for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function allHiringProfile(){ajaxService.getAjaxResponse({url:vm.config.getAllPtps}).then(function(response){if("true"===response.Success)vm.allHiringProfileList=response.spMatchPTPs;else{vm.allHiringProfileList=[];var errorMessage=null;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function showTopHiringProfile(){!vm.topHiringProfile.length&&getHiringProfile();ngDialog.open({template:vm.config.hiringDialog,scope:$scope})}function viewAllHiringProfile(){!vm.allHiringProfileList.length&&allHiringProfile();ngDialog.open({template:vm.config.allhiringDialog,scope:$scope})}function orderDefine(){vm.pageSetting.jsonParent={};for(var i=0;i<vm.responseFormatter.categoryResults.length;i++)vm.pageSetting.jsonParent[vm.responseFormatter.categoryResults[i].categoryType]=i}function runSpMatch(id,member,name){if(void 0!==member&&0===member)return!0;switch(vm.pageSetting.runPtP.mode=vm.pageSetting.candidateradio,vm.pageSetting.runPtP.mode){case"0":vm.runPtPMatchFn({url:vm.config.runPtPCandidate,data1:id,data2:vm.responseFormatter.baseDTO.id,name:"candidateId"});break;case"1":vm.pageSetting.runPtP.roleName=name,vm.runPtPMatchFn({url:vm.config.role,data1:name,data2:vm.responseFormatter.baseDTO.id,name:"roleName"})}}function viewAllSpMatch(id,top){void 0!==top?getHiringDetailResult(id):(vm.pageSetting.runPtP.mode="0",vm.pageSetting.candidateradio="0",vm.runPtPMatchFn({url:vm.config.runPtPCandidate,data1:vm.responseFormatter.baseUserDTO.id,data2:id,name:"candidateId"}))}function viewAllSpMatchMember(id,top){void 0!==top?getHiringDetailResult(id):(vm.pageSetting.runPtP.mode="0",vm.pageSetting.memberradio="0",vm.runPtPMatchFn({url:vm.config.runPtPMember,data1:vm.responseFormatter.baseUserDTO.id,data2:id,name:"memberId"}))}function runSpMatchMember(id,member,name){if(void 0!==member&&0===member)return!0;switch(vm.pageSetting.runPtP.mode=vm.pageSetting.memberradio,vm.pageSetting.runPtP.mode){case"0":vm.runPtPMatchFn({url:vm.config.runPtPMember,data1:id,data2:vm.responseFormatter.baseDTO.id,name:"memberId"});break;case"1":vm.pageSetting.runPtP.altName=name,vm.runPtPMatchFn({url:vm.config.group,data1:name,data2:vm.responseFormatter.baseDTO.id,name:"groupName"});break;case"2":vm.pageSetting.runPtP.altName=name,vm.runPtPMatchFn({url:vm.config.title,data1:name,data2:vm.responseFormatter.baseDTO.id,name:"title"})}}function candidateListFilter(){var result="",stringSearch="";"0"===vm.pageSetting.candidateradio?(stringSearch="name",result=vm.candidateList):(stringSearch="name",result=vm.rolesList),vm.matchWithCandidateList=result.filter(function(e){return-1!==angular.lowercase(e[stringSearch]).indexOf(angular.lowercase(vm.pageSetting.candidateText))})}function clearList(){vm.pageSetting.candidateText="",vm.candidateListFilter()}function fetchCandidateList(){ajaxService.getAjaxResponse({url:vm.config.fetchCandidateList}).then(function(response){if("true"===response.Success)vm.candidateList=response.hiring,vm.rolesList=response.hiringRoles,vm.candidateListFilter();else{var errorMessage=null;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function selectCandidate(){vm.candidateList.length?vm.candidateListFilter():fetchCandidateList(),vm.pageSetting.candidateradio=vm.pageSetting.runPtP.mode;var dialog=ngDialog.open({template:vm.config.candidateDialog,scope:$scope});dialog.closePromise.then(function(){vm.pageSetting.candidateText=""})}function selectMember(){vm.memberList.length?vm.memberListFilter():fetchMemberList(),vm.pageSetting.memberradio=vm.pageSetting.runPtP.mode;var dialog=ngDialog.open({template:vm.config.memberDialog,scope:$scope});dialog.closePromise.then(function(){vm.pageSetting.memberText=""})}function memberListFilter(){var result="",stringSearch="";switch(vm.pageSetting.memberradio){case"0":stringSearch="name",result=vm.memberList;break;case"1":stringSearch="name",result=vm.groupList;break;case"2":stringSearch="name",result=vm.titleList;break;default:stringSearch="name",result=vm.memberList}vm.matchWithMemberList=result.filter(function(e){return-1!==angular.lowercase(e[stringSearch]).indexOf(angular.lowercase(vm.pageSetting.memberText))})}function clearMemberList(){vm.pageSetting.memberText="",vm.memberListFilter()}function fetchMemberList(){ajaxService.getAjaxResponse({url:vm.config.fetchMemberList}).then(function(response){if("true"===response.Success)vm.memberList=response.allMembers,vm.groupList=response.allGroups,vm.titleList=response.allTitles,vm.memberListFilter();else{var errorMessage=null;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function tagUser(userType){var spliceIndex=vm.responseFormatter.tagList.indexOf(vm.responseFormatter.baseDTO.ptpName),message="";ajaxService.getAjaxResponse({url:vm.config.tagUser,data:$.param({tagName:vm.responseFormatter.baseDTO.ptpName,userType:vm.responseFormatter.userType,userId:vm.responseFormatter.baseUserDTO.id,tagged:-1===spliceIndex})}).then(function(response){if("true"===response.Success)-1!==spliceIndex?(vm.responseFormatter.tagList.splice(spliceIndex,1),message=$rootScope.pullInterNationalization("spMatch.profileUnTagged")):(vm.responseFormatter.tagList.push(vm.responseFormatter.baseDTO.ptpName),message=$rootScope.pullInterNationalization("spMatch.profileTagged")),$.growl({icon:"glyphicon glyphicon-ok",message:message});else{var errorMessage=null;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function returnToProfile(){window.location.href="/sp/spmatch/spMatchListing"}var vm=this;vm.responseFormatter={},vm.topHiringProfile=[],vm.candidateList=[],vm.rolesList=[],vm.matchWithCandidateList=[],vm.memberList=[],vm.groupList=[],vm.titleList=[],vm.matchWithMemberList=[],vm.allHiringProfileList=[],vm.selectedResponse=null,vm.pageSetting={runPtP:null,jsonParent:{},hiringWidgetdesc:!1,candidateText:"",candidateradio:"0",totalSet:0,currentIndex:0,memberradio:0,memberText:"",screenMode:null},vm.config={runPtPCandidate:"/sp/hiring/spmatch/runmatch/candidate",runPtPMember:"/sp/hiring/spmatch/runmatch/member",group:"/sp/hiring/spmatch/runmatch/memberGroup",title:"/sp/hiring/spmatch/runmatch/memberTitle",role:"/sp/hiring/spmatch/runmatch/role",candidateTopMatch:"/sp/hiring/spmatch/topMatch/profile",hiringDialog:"/sp/spmatch/spMatchTopHiringProfile",allhiringDialog:"/sp/spmatch/spMatchAllHiringProfile",candidateDialog:"/sp/spmatch/spMatchCandidatesDialog",memberDialog:"/sp/spmatch/spMatchMemberDialog",fetchCandidateList:"/sp/hiring/spMatch/getAllValidCandidates",fetchMemberList:"/sp/hiring/spmatch/getMembersGroupsTitle",getAllPtps:"/sp/hiring/spmatch/getAllPtps",tagUser:"/sp/hiring/spmatch/tagUser",topHiringResult:"/sp/hiring/spmatch/topMatch/profile/result"},vm.runPtPMatchFn=runPtPMatchFn,vm.showTopHiringProfile=showTopHiringProfile,vm.clearList=clearList,vm.clearMemberList=clearMemberList,vm.selectCandidate=selectCandidate,vm.selectMember=selectMember,vm.candidateListFilter=candidateListFilter,vm.memberListFilter=memberListFilter,vm.runSpMatch=runSpMatch,vm.viewAllHiringProfile=viewAllHiringProfile,vm.viewAllSpMatch=viewAllSpMatch,vm.viewAllSpMatchMember=viewAllSpMatchMember,vm.changeResponseDetail=changeResponseDetail,vm.returnToProfile=returnToProfile,vm.tagUser=tagUser,vm.runCandidate=runCandidate,vm.runMember=runMember,vm.runSpMatchMember=runSpMatchMember}function spJsonFetch(){function spMatchJson(){return{success:{ptpAnalysis:{categoryTypeAnalysisDtos:[{categoryType:"ConflictManagement",analysisTraitsDTOs:[{traitType:"Avoid",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Compete",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Collaborate",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Compromise",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Accommodate",percentageMatch:null,averageMatch:null,matched:!1}]},{categoryType:"FundamentalNeeds",analysisTraitsDTOs:[{traitType:"Control",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Significance",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Security",percentageMatch:null,averageMatch:null,matched:!1}]},{categoryType:"Motivation",analysisTraitsDTOs:[{traitType:"AttainmentOfGoals",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"RecognitionForEffort",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Power",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Compliance",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Activity",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Affiliation",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"SelfAffirmed",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"AffirmedByOthers",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"ExchangeOfIdeas",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"ReceiveDirection",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Freedom",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Consistency",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"TaskCompletion",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"PrefersProcess",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Hygiene",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Accomplishment",percentageMatch:null,averageMatch:null,matched:!1}]},{categoryType:"Processing",analysisTraitsDTOs:[{traitType:"Internal",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"External",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Concrete",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Intuitive",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Affective",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Cognitive",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Orderly",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Spontaneous",percentageMatch:null,averageMatch:null,matched:!1}]},{categoryType:"LearningStyle",analysisTraitsDTOs:[{traitType:"Global",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Analytical",percentageMatch:null,averageMatch:null,matched:!1}]},{categoryType:"Personality",analysisTraitsDTOs:[{traitType:"Powerfull",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Versatile",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Precise",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Adaptable",percentageMatch:null,averageMatch:null,matched:!1}]},{categoryType:"UnderPresssure",analysisTraitsDTOs:[{traitType:"Powerfull",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Versatile",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Precise",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Adaptable",percentageMatch:null,averageMatch:null,matched:!1}]},{categoryType:"Accuracy",analysisTraitsDTOs:[]},{categoryType:"DecisionMaking",analysisTraitsDTOs:[{traitType:"Inward",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Outward",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Rapid",percentageMatch:null,averageMatch:null,matched:!1},{traitType:"Careful",percentageMatch:null,averageMatch:null,matched:!1}]}]},Success:"true"},error:null,doRedirect:!1}}function spMatchJsonCustom(){return{success:{ptpAnalysis:{categoryTypeAnalysisDtos:[{categoryType:"ConflictManagement",analysisTraitsDTOs:[{traitType:"Avoid",percentageMatch:null,averageMatch:null,matched:!0},{traitType:"Compete",percentageMatch:null,averageMatch:null,matched:!0},{traitType:"Collaborate",percentageMatch:null,averageMatch:null,matched:!0},{traitType:"Compromise",percentageMatch:null,averageMatch:null,matched:!0},{traitType:"Accommodate",percentageMatch:null,averageMatch:null,matched:!0}]},{categoryType:"FundamentalNeeds",analysisTraitsDTOs:[{traitType:"Control",percentageMatch:null,averageMatch:null,matched:!0},{traitType:"Significance",percentageMatch:null,averageMatch:null,matched:!0},{traitType:"Security",percentageMatch:null,averageMatch:null,matched:!0}]},{categoryType:"Motivation",analysisTraitsDTOs:[{traitType:"AttainmentOfGoals",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"RecognitionForEffort",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Power",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Compliance",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Activity",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Affiliation",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"SelfAffirmed",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"AffirmedByOthers",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"ExchangeOfIdeas",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"ReceiveDirection",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Freedom",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Consistency",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"TaskCompletion",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"PrefersProcess",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Hygiene",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Accomplishment",percentageMatch:null,averageMatch:50,matched:!0}]},{categoryType:"Processing",analysisTraitsDTOs:[{traitType:"Internal",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"External",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Concrete",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Intuitive",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Affective",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Cognitive",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Orderly",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Spontaneous",percentageMatch:null,averageMatch:50,matched:!0}]},{categoryType:"LearningStyle",analysisTraitsDTOs:[{traitType:"Global",
percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Analytical",percentageMatch:null,averageMatch:50,matched:!0}]},{categoryType:"Personality",analysisTraitsDTOs:[{traitType:"Powerfull",percentageMatch:null,averageMatch:0,matched:!0},{traitType:"Versatile",percentageMatch:null,averageMatch:0,matched:!0},{traitType:"Precise",percentageMatch:null,averageMatch:0,matched:!0},{traitType:"Adaptable",percentageMatch:null,averageMatch:0,matched:!0}]},{categoryType:"UnderPresssure",analysisTraitsDTOs:[{traitType:"Powerfull",percentageMatch:null,averageMatch:0,matched:!0},{traitType:"Versatile",percentageMatch:null,averageMatch:0,matched:!0},{traitType:"Precise",percentageMatch:null,averageMatch:0,matched:!0},{traitType:"Adaptable",percentageMatch:null,averageMatch:0,matched:!0}]},{categoryType:"Accuracy",analysisTraitsDTOs:[]},{categoryType:"DecisionMaking",analysisTraitsDTOs:[{traitType:"Inward",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Outward",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Rapid",percentageMatch:null,averageMatch:50,matched:!0},{traitType:"Careful",percentageMatch:null,averageMatch:50,matched:!0}]}]},Success:"true"},error:null,doRedirect:!1}}return{spMatchJson:spMatchJson,spMatchJsonCustom:spMatchJsonCustom}}angular.module("spApp").controller("spMatchController",spMatchController),angular.module("spApp").controller("spMatchListing",spMatchListing),angular.module("spApp").controller("spMatchCandidate",spMatchCandidate),angular.module("spApp").service("spJsonFetch",spJsonFetch),spMatchController.$inject=["$scope","ajaxService","$q","spJsonFetch","$filter","$rootScope","$localStorage","sharedProperties"],spMatchListing.$inject=["$scope","ajaxService","sharedProperties","ngDialog","$localStorage","$rootScope"],spMatchCandidate.$inject=["$scope","ajaxService","sharedProperties","$localStorage","ngDialog","$rootScope"],angular.module("spApp").directive("singleView",["$rootScope",function($rootScope){var directiveDefinitionObject={restrict:"E",replace:!1,templateUrl:"/sp/resources/html/spMatch/singleView.html",scope:{data:"=rangeData",label:"=labelData",original:"=originalData"},link:function(scope,element,attr){var inputCreator=function(){return void 0===scope.data?!0:(scope.currentValue=scope.data,scope.currentLabel=$rootScope.pullInterNationalization(scope.label),scope.originalData=void 0===scope.original?!1:scope.original,void scope.$parent.ctrl.pageSetting.totalSet++)};scope.$watch("data",function(newValue,oldValue){inputCreator()},!0)}};return directiveDefinitionObject}]),angular.module("spApp").directive("singleRange",["$rootScope",function($rootScope){var directiveDefinitionObject={restrict:"E",replace:!1,templateUrl:"/sp/resources/html/spMatch/singleRange.html",scope:{data:"=rangeData",editable:"=editable",mode:"=rangeMode",refresh:"=refreshData",overrideEditable:"=overrideEditable"},link:function(scope,element,attr){element.bind("change",function(){getSliderValue()});var getSliderValue=function(){scope.data.averageMatch=scope.currentValue},inputCreator=function(){scope.minValue=0,scope.maxValue=100,scope.editable=void 0===scope.editable?!1:scope.editable,scope.currentValue=null===scope.data.averageMatch?0:scope.data.averageMatch,scope.currentLabel=$rootScope.pullInterNationalization("spmatch."+scope.data.traitType),scope.sourceSelected=void 0===scope.overrideEditable?scope.data.matched:!0,scope.scopeModelName=(scope.currentLabel.trim()+"_"+scope.mode.trim()).toLowerCase().replace(/ /g,"_"),scope.data.selectedCheckBox=scope.overrideEditable===!0?!1:scope.data.selectedCheckBox,scope.sourceSelected&&scope.$parent.ctrl.pageSetting.countTotalMatch++,scope.data.selectedCheckBox&&scope.$parent.ctrl.pageSetting.totalTrait++,scope.$parent.ctrl.pageSetting.totalSet++};scope.sliderValue=function(){(scope.data.selectedCheckBox=!scope.data.selectedCheckBox)?scope.$parent.ctrl.pageSetting.totalTrait++:scope.$parent.ctrl.pageSetting.totalTrait--},scope.$watch("refresh",function(newValue,oldValue){inputCreator()},!0)}};return directiveDefinitionObject}]),angular.module("spApp").directive("twoView",["$rootScope",function($rootScope){var directiveDefinitionObject={restrict:"E",replace:!1,templateUrl:"/sp/resources/html/spMatch/twoView.html",scope:{data_1:"=rangeData1",data_2:"=rangeData2",label_1:"=labelData1",label_2:"=labelData2",original_1:"=originalData1",original_2:"=originalData2"},link:function(scope,element,attr){var inputCreator=function(){return void 0===scope.data_1||void 0===scope.data_2?!0:(scope.currentValue1=scope.data_1,scope.currentValue2=scope.data_2,scope.currentLabel1=$rootScope.pullInterNationalization(scope.label_1),scope.currentLabel2=$rootScope.pullInterNationalization(scope.label_2),scope.originalData1=void 0===scope.original_1?!1:scope.original_1,scope.originalData2=void 0===scope.original_2?!1:scope.original_2,void scope.$parent.ctrl.pageSetting.totalSet++)};scope.$watch(["data_1,data_2"],function(newValue,oldValue){inputCreator()},!0)}};return directiveDefinitionObject}]),angular.module("spApp").directive("twoRange",["$rootScope",function($rootScope){var directiveDefinitionObject={restrict:"E",replace:!1,templateUrl:"/sp/resources/html/spMatch/twoRange.html",scope:{data_1:"=rangeData1",data_2:"=rangeData2",editable:"=editable",mode:"=rangeMode",refresh:"=refreshData",overrideEditable:"=overrideEditable"},link:function(scope,element,attr){element.bind("change",function(){sliderValue()});var inputCreator=function(){scope.minValue=0,scope.maxValue=100,scope.which=-1,scope.editable=void 0===scope.editable?!1:scope.editable,scope.currentValue1=null===scope.data_1.averageMatch?0:100-parseInt(scope.data_1.averageMatch,10),scope.currentValue2=null===scope.data_2.averageMatch?0:scope.data_2.averageMatch,scope.sourceSelected=void 0===scope.overrideEditable?scope.data_1.matched&&scope.data_2.matched:!0,scope.currentLabel1=$rootScope.pullInterNationalization("spmatch."+scope.data_1.traitType),scope.currentLabel2=$rootScope.pullInterNationalization("spmatch."+scope.data_2.traitType),scope.scopeModelName1=(scope.currentLabel1.trim()+"_"+scope.mode.trim()).toLowerCase().replace(/ /g,"_"),scope.scopeModelName2=(scope.currentLabel2.trim()+"_"+scope.mode.trim()).toLowerCase().replace(/ /g,"_"),scope.data_1.selectedCheckBox=scope.overrideEditable===!0?!1:scope.data_1.selectedCheckBox,scope.data_2.selectedCheckBox=scope.overrideEditable===!0?!1:scope.data_2.selectedCheckBox,scope.$parent.ctrl.pageSetting.totalSet++,scope.sourceSelected&&scope.$parent.ctrl.pageSetting.countTotalMatch++,scope.data_1.selectedCheckBox&&scope.data_2.selectedCheckBox&&scope.$parent.ctrl.pageSetting.totalTrait++},sliderValue=function(){scope.$apply(function(){0===scope.which?scope.currentValue2=parseInt(scope.currentValue1,10):1===scope.which&&(scope.currentValue1=parseInt(scope.currentValue2,10))}),scope.data_1.averageMatch=scope.currentValue1,scope.data_2.averageMatch=scope.currentValue2};scope.valueUpdate=function(){scope.data_1.selectedCheckBox=!scope.data_1.selectedCheckBox,scope.data_2.selectedCheckBox=!scope.data_2.selectedCheckBox,scope.data_1.selectedCheckBox&&scope.data_2.selectedCheckBox?scope.$parent.ctrl.pageSetting.totalTrait++:scope.$parent.ctrl.pageSetting.totalTrait--},scope.$watch("refresh",function(newValue,oldValue){inputCreator()},!0)}};return directiveDefinitionObject}]);