function affiliateCodeListingController($scope,$q,$element,$attrs,ajaxService,$location,$http,$state,$filter,ngDialog,sharedProperties,$timeout,$rootScope,$localStorage){$scope.affiliateCodeListMaster=[],$scope.getAllError=!1,$scope.searchTag=[],$scope.pageSize=10,$scope.statusInclude=[],$scope.textSearching="",$scope.intialPageSize=10,$scope.load=!0,$scope.formatMonth=function(d){if(null!==d&&void 0!==d){var splitDate=d.split(" ");return splitDate[0].substr(0,3).toUpperCase()+" "+splitDate[1]+" "+splitDate[2]}},$scope.getAllAffiliateCodes=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/promotions/getAll"}).then(function(response){if("true"===response.Success)$scope.getAllError=!1,$scope.affiliateCodeListMaster=response.promotion,$scope.returnMemberList($scope.pageSize);else{$scope.getAllError=!0;for(var key in response.error)$scope.getAllErrorMsg=response.error[key]}})},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.returnMemberList($scope.pageSize)},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize))},$scope.enableCancel=function(search){return void 0!==search&&search.length>1},$scope.returnMemberList=function(pageSize){if(!$scope.affiliateCodeListMaster.length)return!0;if($scope.searchTag.length&&!$scope.statusInclude.length&&($scope.affiliateCodeList=angular.copy($scope.newArr)),$scope.searchTag.length&&$scope.statusInclude.length){$scope.combineArray=[];for(var i=0;i<$scope.newArr.length;i++)for(var j=0;j<$scope.checkBox.length;j++)$scope.newArr[i].email===$scope.checkBox[j].email&&$scope.combineArray.push($scope.newArr[i]);$scope.affiliateCodeList=angular.copy($scope.combineArray)}!$scope.searchTag.length&&$scope.statusInclude.length&&($scope.affiliateCodeList=angular.copy($scope.checkBox)),$scope.searchTag.length||$scope.statusInclude.length||($scope.affiliateCodeList=angular.copy($scope.affiliateCodeListMaster)),$scope.pageSize=pageSize,pageSize>=$scope.affiliateCodeListMaster.length&&($scope.disabledInfinite=!0,$scope.pageSize=$scope.affiliateCodeListMaster.length),$scope.load&&($scope.lastPredicate="code",$scope.lastReverse=!0,$scope.loadBtnCLicked=!1,$scope.load=!1),$scope.loadBtnCLicked&&($scope.loadBtnCLicked=!1),$scope.order($scope.lastPredicate,$scope.lastReverse),$scope.affiliateCodeList=$scope.affiliateCodeList},$scope.active=function(event){var currentElem=$(event.currentTarget);currentElem.find("h4").hasClass("on")?currentElem.find("h4").hasClass("reverseon")?currentElem.find("h4").removeClass("reverseon"):currentElem.find("h4").addClass("reverseon"):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"))},$scope.order=function(predicate,reverse){$scope.lastPredicate=predicate,$scope.lastReverse=reverse,$scope.affiliateCodeList=$filter("orderBy")($scope.affiliateCodeList,predicate,reverse)},$scope.resetfilter=function(allmembers){$scope.pageSize=$scope.intialPageSize,$scope.newArr=[],$scope.searchTag=[],$scope.tags=[],$scope.filter={},$scope.statusInclude=[],$scope.adminc=!1,$scope.leadC=!1,$scope.textSearching="",$scope.searchText="",void 0!==this.selectedSearch&&(this.selectedSearch.userStatusFormatted="",this.selectedSearch.hiringRoles=""),$scope.affiliateCodeList=angular.copy($scope.affiliateCodeListMaster),void 0!==allmembers&&($scope.pageSize=$scope.affiliateCodeListMaster.length),angular.element($(".tags").find("input")).scope().newTag.text="",$scope.load=!0,$scope.disabledInfinite=!1,$rootScope.$broadcast("$scrollStart"),$scope.returnMemberList($scope.pageSize);var curr=$(".memberHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")},$scope.updateStatusError=!1,$scope.updateAffiliateCodeStatus=function(status,pid){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/promotions/updateStatus",data:$.param({promotionId:pid,promotionStatus:status})}).then(function(response){if("true"===response.Success)$scope.updateStatusError=!1,ngDialog.close("ngdialog1"),$scope.getAllAffiliateCodes(),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Status</strong>",message:" updated successfully"});else{$scope.updateStatusError=!0;for(var key in response.error)$scope.updateStatusErrorMsg=response.error[key];ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.updateStatusErrorMsg})}})},$scope.deleteConfirm=function(d){$scope.afid=d,ngDialog.open({template:"/sp/resources/html/sysAdmin/affiliateCode/deleteConfirmation.html",scope:$scope})},function(){var growlNotification=$localStorage.get("gNotify");null!==growlNotification&&void 0!==growlNotification&&("AddCode"===growlNotification&&$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Code</strong>",message:" generated successfully"}),setTimeout(function(){$localStorage.remove("gNotify")},1e3)),$scope.getAllAffiliateCodes()}()}angular.module("spApp").controller("affiliateCodeListingController",affiliateCodeListingController),affiliateCodeListingController.$inject=["$scope","$q","$element","$attrs","ajaxService","$location","$http","$state","$filter","ngDialog","sharedProperties","$timeout","$rootScope","$localStorage"];