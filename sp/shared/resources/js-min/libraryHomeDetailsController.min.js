function libraryHomeDetailsController($scope,$q,$element,$attrs,ajaxService,$location,$http,$state,$filter,ngDialog,sharedProperties,$timeout,$rootScope,$localStorage){$scope.accountsListException=!1,$scope.updatedAccountListing=[],$scope.selectedAccountsCount=0,$scope.updatedListingIndex=0,$scope.accountList={},$scope.selectedCompanyIdList=[],$scope.allAccountsIdList=[],$scope.getDetailsException=!1,$scope.createNewLibraryHome={},$scope.newLibraryHome={},$scope.libraryHomeEditing={},$scope.libraryHomeEditing.status=!0,$scope.libraryHomeIdStatus=!1,$scope.selectedAccountsDisplayList=[],$scope.showAccountsDisplayList=!1,$scope.cid="",$scope.searchKeywords=[],$scope.searchTag=[],$scope.pageSize=100,$scope.statusInclude=[],$scope.textSearching="",$scope.intialPageSize=100,$scope.load=!0,$scope.selectArticlesList=[];var defaultImage="/sp/resources/images/image_not_available.jpg";$scope.newLibraryHome.articleImage0=defaultImage,$scope.newLibraryHome.articleImage1=defaultImage,$scope.newLibraryHome.articleImage2=defaultImage,$scope.newLibraryHome.articleImage3=defaultImage,$scope.libraryHomeEnableEdit=function(s){"enable"===s?$scope.libraryHomeEditing.status=!0:($scope.libraryHomeEditing.status=!1,$scope.getLibraryHomeDetails()),$scope.accountList.search=null},$scope.goLibraryHome=function(){window.location="/sp/sysAdmin/learning/curriculam/libraryHome"},$scope.getCompanyId=function(){var url=window.location.href,splitUrl=url.split("?")[1];$scope.cid=void 0!==splitUrl?splitUrl.split("=")[1]:null},$scope.getLibraryHomeDetails=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/learning/library/articles",data:$.param({companyId:$scope.cid})}).then(function(response){if("true"===response.Success)$scope.getDetailsException=!1,$scope.company=response.company,null===response.company&&"business"===$scope.cid?$scope.globalName="Global Home - Business":null===response.company&&"individual"===$scope.cid&&($scope.globalName="Global Home - Individual"),$scope.newLibraryHome.articleId0=response.Content[0].articleId,$scope.newLibraryHome.articleDescription0=response.Content[0].shortDescription,$scope.newLibraryHome.articleName0=response.Content[0].articleLinkLabel,null!==response.Content[0].imageUrl&&void 0!==response.Content[0].imageUrl&&($scope.newLibraryHome.articleImage0=response.Content[0].imageUrl+"?width=150"),$scope.newLibraryHome.articleId1=response.Content[1].articleId,$scope.newLibraryHome.articleDescription1=response.Content[1].shortDescription,$scope.newLibraryHome.articleName1=response.Content[1].articleLinkLabel,null!==response.Content[1].imageUrl&&void 0!==response.Content[1].imageUrl&&($scope.newLibraryHome.articleImage1=response.Content[1].imageUrl+"?width=150"),$scope.newLibraryHome.articleId2=response.Content[2].articleId,$scope.newLibraryHome.articleDescription2=response.Content[2].shortDescription,$scope.newLibraryHome.articleName2=response.Content[2].articleLinkLabel,null!==response.Content[2].imageUrl&&void 0!==response.Content[2].imageUrl&&($scope.newLibraryHome.articleImage2=response.Content[2].imageUrl+"?width=150"),$scope.newLibraryHome.articleId3=response.Content[3].articleId,$scope.newLibraryHome.articleDescription3=response.Content[3].shortDescription,$scope.newLibraryHome.articleName3=response.Content[3].articleLinkLabel,null!==response.Content[3].imageUrl&&void 0!==response.Content[3].imageUrl&&($scope.newLibraryHome.articleImage3=response.Content[3].imageUrl+"?width=150");else{$scope.company.name=null,$scope.getDetailsException=!0;for(var key in response.error)$scope.getDetailsExceptionMsg=response.error[key]}})},$scope.selectArticleViaModal=function(articleId,articleName,position,articleImage){null===articleImage||void 0===articleImage?articleImage=defaultImage:articleImage+="?width=150",0===position?($scope.newLibraryHome.articleId0=articleId,$scope.newLibraryHome.articleName0=unescape(articleName),$scope.newLibraryHome.articleImage0=articleImage):1===position?($scope.newLibraryHome.articleId1=articleId,$scope.newLibraryHome.articleName1=unescape(articleName),$scope.newLibraryHome.articleImage1=articleImage):2===position?($scope.newLibraryHome.articleId2=articleId,$scope.newLibraryHome.articleName2=unescape(articleName),$scope.newLibraryHome.articleImage2=articleImage):3===position&&($scope.newLibraryHome.articleId3=articleId,$scope.newLibraryHome.articleName3=unescape(articleName),$scope.newLibraryHome.articleImage3=articleImage),ngDialog.close("ngdialog1")},$scope.updateLibraryHome=function(fData){var _params=[],companyId="";if(companyId=null===$scope.company&&"business"===$scope.cid?"business":null===$scope.company&&"individual"===$scope.cid?"individual":$scope.company.id,$scope.createNewLibraryHome.validationErrors=!1,$scope.createNewLibraryHomeException=!1,_params=[{articleId:$scope.newLibraryHome.articleId0,position:0,shortDescription:fData.articleDescription0,companyId:companyId},{articleId:$scope.newLibraryHome.articleId1,position:1,shortDescription:fData.articleDescription1,companyId:companyId},{articleId:$scope.newLibraryHome.articleId2,position:2,shortDescription:fData.articleDescription2,companyId:companyId},{articleId:$scope.newLibraryHome.articleId3,position:3,shortDescription:fData.articleDescription3,companyId:companyId}],void 0!==$scope.newLibraryHome.articleId0&&void 0!==$scope.newLibraryHome.articleId1&&void 0!==$scope.newLibraryHome.articleId2&&void 0!==$scope.newLibraryHome.articleId3&&void 0!==$scope.newLibraryHome.articleDescription0&&void 0!==$scope.newLibraryHome.articleDescription1&&void 0!==$scope.newLibraryHome.articleDescription2&&void 0!==$scope.newLibraryHome.articleDescription3&&""!==$scope.newLibraryHome.articleDescription0&&""!==$scope.newLibraryHome.articleDescription1&&""!==$scope.newLibraryHome.articleDescription2&&""!==$scope.newLibraryHome.articleDescription3&&null!==companyId&&""!==companyId){for(var i=0;i<4;i++)ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/admin/add/contentArticles",data:$.param(_params[i])}).then(function(response){if("true"===response.Success)$scope.createNewLibraryHome=!1,$localStorage.set("gNotify","AddNewLibraryHome");else{$scope.createNewLibraryHomeException=!0;for(var key in response.error)$scope.createNewLibraryHomeExceptionMsg=response.error[key]}});sharedProperties.growlMessage(" Articles Added Successfully"),setTimeout(function(){window.location="/sp/sysAdmin/learning/curriculam/libraryHome"},1e3)}else sharedProperties.growlMessage("Please fill all the required Fields","<strong> Alert </strong>","glyphicon glyphicon-ban-circle"),$scope.createNewLibraryHome.validationErrors=!0},$scope.selectArticle=function(position){$scope.fetchedTopics=[],$scope.selectArticlesList=[],ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/getAllTopics",method:"POST",data:$.param({topic:"Themes"})}).then(function(response){response&&($scope.fetchedTopics=response.topics,$scope.position=position,$scope.getArticlesList=function(themeValue){$scope.selectArticlesList=[],ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/getResults",method:"POST",data:$.param({topicValue:themeValue,topicCategory:"Themes"})}).then(function(response){if("true"===response.Success)response.articles.length>0&&($scope.getAllError=!1,$scope.selectArticlesList=response.articles,$scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize));else{$scope.getAllError=!0;for(var key in response.error)$scope.getAllErrorMsg=response.error[key]}})},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.returnMemberList($scope.pageSize)},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize))},$scope.enableCancel=function(search){return void 0!==search&&search.length>1},$scope.returnMemberList=function(pageSize){if($scope.searchTag.length&&!$scope.statusInclude.length&&($scope.selectArticlesList=angular.copy($scope.newArr)),$scope.searchTag.length&&$scope.statusInclude.length){$scope.combineArray=[];for(var i=0;i<$scope.newArr.length;i++)for(var j=0;j<$scope.checkBox.length;j++)$scope.newArr[i].email===$scope.checkBox[j].email&&$scope.combineArray.push($scope.newArr[i]);$scope.selectArticlesList=angular.copy($scope.combineArray)}!$scope.searchTag.length&&$scope.statusInclude.length&&($scope.selectArticlesList=angular.copy($scope.checkBox)),$scope.searchTag.length||$scope.statusInclude.length||($scope.selectArticlesList=angular.copy($scope.selectArticlesList)),$scope.pageSize=pageSize,pageSize>=$scope.selectArticlesList.length&&($scope.pageSize=$scope.selectArticlesList.length),$scope.load&&($scope.lastPredicate="name",$scope.lastReverse=!1,$scope.loadBtnCLicked=!1,$scope.load=!1),$scope.loadBtnCLicked&&($scope.loadBtnCLicked=!1),$scope.order($scope.lastPredicate,$scope.lastReverse),$scope.selectArticlesList=$scope.selectArticlesList},$scope.active=function(event){var currentElem=$(event.currentTarget);currentElem.find("h4").hasClass("on")?currentElem.find("h4").hasClass("reverseon")?currentElem.find("h4").removeClass("reverseon"):currentElem.find("h4").addClass("reverseon"):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"))},$scope.order=function(predicate,reverse){$scope.lastPredicate=predicate,$scope.lastReverse=reverse,$scope.selectArticlesList=$filter("orderBy")($scope.selectArticlesList,predicate,reverse)},ngDialog.open({template:"/sp/resources/html/sysAdmin/curriculam/selectArticleModal.html",scope:$scope}))})},function(){$scope.getCompanyId(),$scope.getLibraryHomeDetails()}()}angular.module("spApp").controller("libraryHomeDetailsController",libraryHomeDetailsController),libraryHomeDetailsController.$inject=["$scope","$q","$element","$attrs","ajaxService","$location","$http","$state","$filter","ngDialog","sharedProperties","$timeout","$rootScope","$localStorage"];