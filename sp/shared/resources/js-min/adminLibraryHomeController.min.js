function adminLibraryHomeController($scope,$q,$element,$attrs,ajaxService,$location,$http,$state,$filter,ngDialog,sharedProperties,$timeout,$rootScope,$localStorage){$scope.libraryHomeList=[],$scope.getAllError=!1,$scope.searchTag=[],$scope.pageSize=10,$scope.statusInclude=[],$scope.textSearching="",$scope.intialPageSize=10,$scope.load=!0,$scope.getLibraryHomeList=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/learning/library/getAll"}).then(function(response){if("true"===response.Success)$scope.getAllError=!1,$scope.libraryHomeList=response.company,$scope.returnMemberList($scope.pageSize),$localStorage.set("companyLibraryHomeList",$scope.libraryHomeList);else{$scope.getAllError=!0;for(var err in response.error)$scope.getAllErrorMsg=response.error[err]}})},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.returnMemberList($scope.pageSize)},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize))},$scope.enableCancel=function(search){return void 0!==search&&search.length>1},$scope.returnMemberList=function(pageSize){if($scope.searchTag.length&&!$scope.statusInclude.length&&($scope.libraryHomeList=angular.copy($scope.newArr)),$scope.searchTag.length&&$scope.statusInclude.length){$scope.combineArray=[];for(var i=0;i<$scope.newArr.length;i++)for(var j=0;j<$scope.checkBox.length;j++)$scope.newArr[i].email===$scope.checkBox[j].email&&$scope.combineArray.push($scope.newArr[i]);$scope.libraryHomeList=angular.copy($scope.combineArray)}!$scope.searchTag.length&&$scope.statusInclude.length&&($scope.libraryHomeList=angular.copy($scope.checkBox)),$scope.searchTag.length||$scope.statusInclude.length||($scope.libraryHomeList=angular.copy($scope.libraryHomeList)),$scope.pageSize=pageSize,pageSize>=$scope.libraryHomeList.length&&($scope.disabledInfinite=!0,$scope.pageSize=$scope.libraryHomeList.length),$scope.load&&($scope.lastPredicate="name",$scope.lastReverse=!1,$scope.loadBtnCLicked=!1,$scope.load=!1),$scope.loadBtnCLicked&&($scope.loadBtnCLicked=!1),$scope.order($scope.lastPredicate,$scope.lastReverse),$scope.libraryHomeList=$scope.libraryHomeList},$scope.active=function(event){var currentElem=$(event.currentTarget);currentElem.find("h4").hasClass("on")?currentElem.find("h4").hasClass("reverseon")?currentElem.find("h4").removeClass("reverseon"):currentElem.find("h4").addClass("reverseon"):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"))},$scope.order=function(predicate,reverse){$scope.lastPredicate=predicate,$scope.lastReverse=reverse,$scope.libraryHomeList=$filter("orderBy")($scope.libraryHomeList,predicate,reverse)},$scope.resetfilter=function(allmembers){$scope.pageSize=$scope.intialPageSize,$scope.newArr=[],$scope.searchTag=[],$scope.tags=[],$scope.filter={},$scope.statusInclude=[],$scope.adminc=!1,$scope.leadC=!1,$scope.textSearching="",$scope.searchText="",void 0!==this.selectedSearch&&(this.selectedSearch.userStatusFormatted="",this.selectedSearch.hiringRoles=""),$scope.libraryHomeList=angular.copy($scope.libraryHomeList),void 0!==allmembers&&($scope.pageSize=$scope.libraryHomeList.length),angular.element($(".tags").find("input")).scope().newTag.text="",$scope.load=!0,$scope.disabledInfinite=!1,$rootScope.$broadcast("$scrollStart"),$scope.returnMemberList($scope.pageSize);var curr=$(".memberHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")},$scope.updateStatusError=!1,$scope.deleteCompanyLibraryInfo=function(compId){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/learning/library/delete",data:$.param({companyId:compId})}).then(function(response){if("true"===response.Success)$scope.updateStatusError=!1,ngDialog.close("ngdialog1"),$scope.getLibraryHomeList(),sharedProperties.growlMessage("Record deleted successfully");else{$scope.updateStatusError=!0;for(var err in response.error)$scope.updateStatusErrorMsg=response.error[err];ngDialog.close("ngdialog1"),sharedProperties.growlMessage($scope.updateStatusErrorMsg,"<strong> Alert </strong>","glyphicon glyphicon-ban-circle")}}),window.location.reload()},$scope.deleteConfirm=function(deleteId,name){$scope.compId=deleteId,$scope.compName=name,ngDialog.open({template:"/sp/resources/html/sysAdmin/curriculam/deleteCompanyHome.html",scope:$scope})},$scope.createLibraryHomeLink=function(type){null!=type&&"business"===type?window.location="/sp/sysAdmin/learning/curriculam/libraryHomeDetails?cid=business":null!=type&&"individual"===type&&(window.location="/sp/sysAdmin/learning/curriculam/libraryHomeDetails?cid=individual")},$scope.articleWorkFlow=function(reqUrl,key){ajaxService.getAjaxResponse({url:reqUrl,method:"get"}).then(function(response){"true"===response.Success?"articleReload"!==key&&sharedProperties.growlMessage("Request Processed"):null!=response.error&&sharedProperties.ajaxError(response.error)}),"articleReload"===key&&sharedProperties.growlMessage("Request Submitted to Server")},$scope.getReadabilityScore=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/learning/readability",method:"get"}).then(function(response){"true"===response.Success?($scope.score=response.readability.currentScore.toFixed(2),ngDialog.open({template:"/sp/resources/html/sysAdmin/curriculam/readabilityScore.html",scope:$scope})):sharedProperties.growlMessage("There was some error in processing your request.","<strong> Alert </strong>","glyphicon glyphicon-ban-circle")})},function(){$scope.getLibraryHomeList()}()}angular.module("spApp").controller("adminLibraryHomeController",adminLibraryHomeController),adminLibraryHomeController.$inject=["$scope","$q","$element","$attrs","ajaxService","$location","$http","$state","$filter","ngDialog","sharedProperties","$timeout","$rootScope","$localStorage"];