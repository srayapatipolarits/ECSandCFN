angular.module("spApp",["ui.router","ngSanitize","ngTagsInput","checklist-model","ngDialog","angucomplete","mgcrea.ngStrap","angularFileUpload","ngAnimate","infinite-scroll","slick"]);
angular.module("spApp").config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$stateProvider.state("individual",{url:"/individual",templateUrl:"/sp/resources/html/register/register_step2_individual.html"}).state("business",{url:"/business",templateUrl:"/sp/resources/html/register/register_step2_business.html"}).state("hiring",{url:"/hiring",templateUrl:"subscribe-enterprise-page.html"}).state("login",{url:"/login",templateUrl:"login-page.html"}).state("signup_individual",{url:"/signup_individual",templateUrl:"/sp/resources/html/register/register.html"}).state("thankYou",{url:"/thankYou",templateUrl:"/sp/resources/html/register/thankyou.html"}).state("resetConfirmation",{url:"/resetConfirmation",templateUrl:"/sp/resources/html/reset/reset-confirm.html"}).state("reset",{url:"/reset",templateUrl:"/sp/resources/html/reset/reset.html"}).state("browser",{url:"/browser",templateUrl:"/sp/resources/html/browser/browser.html"}).state("group",{url:"/group",templateUrl:"/sp/resources/html/admin/member/groupHome.html"}).state("member",{url:"/member",templateUrl:"/sp/resources/html/admin/member/membersHome.html"}).state("profile",{url:"/profile",templateUrl:"/sp/resources/html/admin/member/profile.html"}).state("signup_business",{url:"/signup_business",templateUrl:"/sp/resources/html/register/register_business.html"}).state("single",{url:"/add/single",templateUrl:"/sp/resources/html/admin/member/add-single.html"}).state("member-multiple",{url:"/add/multiple",templateUrl:"/sp/resources/html/admin/member/add-multiple.html"})}]);
angular.module("spApp").run(["$rootScope","$location","ajaxService","sharedProperties","ngDialog","$localStorage","$state",function($rootScope,$location,ajaxService,sharedProperties,ngDialog,$localStorage,$state){"use strict";function hideElement(){$("#loader").find(".spinner").removeClass("selected")}$rootScope.Internationalization=[],$rootScope.inviteReady=!1,$rootScope.formSendNotificationError=!1,$rootScope.messageAreaEmpty=!1,$rootScope.noSelf=null===sharedProperties.getParam("email")?"":sharedProperties.getParam("email"),$rootScope.$watch(function(){return $location.path()},function(a){var pathName=window.location.pathname,additional="";if(("/sp/admin/memberListing/"===pathName||"/sp/admin/memberListing"===pathName)&&(additional="group,member"),("/sp/admin/account/member/details"===pathName||"/sp/dashboardUserAnalysis"===pathName)&&(additional="goals,goalDesc,reviewGoal,feedback,recommendations,bystar,dashboardUserAnalysis,growthListing,feedbackListing,group"),"/sp/admin/member/add/single"===pathName&&(additional="group"),"/sp/admin/member/add/multiple"===pathName&&(additional="group"),"/sp/feedback/themeView"===pathName&&(additional="archiveDetail"),("/sp/feedback"===pathName||"/sp/growth/growthListing"===pathName||"/sp/tools/hiring"===pathName||"/sp/dashboard/groups"===pathName)&&(additional="group"),pathName.match("processToken")&&(additional="growth"),("/sp/resume/resumeDetailsView"===pathName||"/sp/connect/linkedin"===pathName)&&(additional="connect,spResume"),("/sp/profile"===pathName||"/sp/tools/hiring"===pathName||"/sp/sysAdmin/loggedInUser"===pathName||"/sp/sysAdmin/getUserList"===pathName||"/sp/sysAdmin/getCompanyList"===pathName)&&(additional="admin"),$localStorage.isAvailable()&&null!=$localStorage.get("interNationalization"))$rootScope.Internationalization=$localStorage.get("interNationalization"),$rootScope.inviteReady=!0;else{var options={url:"/sp/messages",data:$.param({url:pathName,additionalKeys:additional,localStorage:$localStorage.isAvailable()})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&$localStorage.set("interNationalization",response,function(){$rootScope.Internationalization=response,$rootScope.inviteReady=!0})})}}),$rootScope.pullInterNationalization=function(key,single,mem){return"undefined"!=typeof single&&"custom"===single?mem+"."+key in $rootScope.Internationalization?$rootScope.Internationalization[mem+"."+key]:key:key in $rootScope.Internationalization?$rootScope.Internationalization[key]:key},$rootScope.contains=function(arr,item){if(angular.isArray(arr))for(var i=0;i<arr.length;i++)if(angular.equals(arr[i],item))return!0;return!1},$rootScope.add=function(arr,item){arr=angular.isArray(arr)?arr:[];for(var i=0;i<arr.length;i++)if(angular.equals(arr[i],item))return arr;return arr.push(item),arr},$rootScope.remove=function(arr,item){if(angular.isArray(arr))for(var i=0;i<arr.length;i++)if(angular.equals(arr[i],item)){arr.splice(i,1);break}return arr},$rootScope.callSwitchChange=function(param){sharedProperties.setSwitch(param)},$rootScope.notificationEmailPoP=function(args,type,defaults,params){angular.isArray(args)||(args=args.split(",")),"ASSESSMENT_PENDING"===type||"ASSESSMENT_PROGRESS"===type?type="AssessmentPendingReminder":"PROFILE_INCOMPLETE"===type?type="ProfileIncompleteReminder":"HiringCandidateReminder"===type?type="HiringCandidateReminder":"HiringCandidateProfileAccess"===type&&(type="HiringCandidateProfileAccess"),$rootScope.formSendNotificationError=!1,$rootScope.messageAreaEmpty=!1,sharedProperties.notification(args,type,defaults,params)},$rootScope.notificatationListName=function(notifyMessage){$rootScope.formSendNotificationError=!1,$rootScope.messageAreaEmpty=!1,$rootScope.selectedNotification=notifyMessage;var comment1=$("<div/>").html($.parseHTML($rootScope.pullInterNationalization("admin.group."+notifyMessage+".notification.text"))),subBlock=$.parseHTML($rootScope.pullInterNationalization("admin.group."+notifyMessage+".notification.nosubject"))[0],subBlock1=$(subBlock).text();$("#commentBlock").val($(comment1).html()),$("#subBlock").val(subBlock1)},Array.prototype.unique=function(){for(var a=this.concat(),i=0;i<a.length;++i)for(var j=i+1;j<a.length;++j)a[i]===a[j]&&a.splice(j--,1);return a},function(){if(!window.location.hash){var href=window.location.pathname;"/sp/admin/memberListing"===href?$state.go("member"):"/sp/admin/group"===href&&$state.go("group")}}(),$rootScope.nl2br=function(str,is_xhtml){var breakTag=is_xhtml||"undefined"==typeof is_xhtml?"<br />":"<br>";return(str+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+breakTag+"$2")},$rootScope.$on("httpLoaderStart",function(){$("#loader").find(".spinner").addClass("selected")}),$rootScope.$on("httpLoaderEnd",hideElement),$rootScope.setBoxSizes=function(c1,c2,h){$(c1).each(function(){var boxes=$(this).find(c2),maxHeight=0;boxes.attr("style",""),maxHeight=Math.max.apply(Math,boxes.map(function(){return $(this).outerHeight()}).get()),"full"===h?boxes.attr("style","").css({height:maxHeight}):boxes.attr("style","").css({"min-height":maxHeight})})},Array.prototype.chunk=function(chunkSize){var array=this;return[].concat.apply([],array.map(function(elem,i){return i%chunkSize?[]:[array.slice(i,i+chunkSize)]}))},$rootScope.applyEqualHeights=function(group,itemsPerRow){for(var tallest=0,rows=Math.ceil(group.length/itemsPerRow),rowItems="",i=1;rows+1>i;i++)1===i?(tallest=0,rowItems=group.filter(":lt("+i*itemsPerRow+")")):(tallest=0,rowItems=group.filter(":lt("+i*itemsPerRow+")").filter(":gt("+(i*itemsPerRow-(itemsPerRow+1))+")")),rowItems.each(function(){var thisHeight=$(this).height();thisHeight>tallest&&(tallest=thisHeight)}),rowItems.css({"min-height":tallest})},$rootScope.sendNotification=function(form,list,type,mode){function extractEmails(e){var _list=e,emailList=[],counter=0;return $.each(_list,function(i){emailList.push(_list[i].email),counter++}),counter===_list.length?emailList.toString():void 0}if($rootScope.formSendNotificationError=!1,$rootScope.messageAreaEmpty=!1,"undefined"!=typeof mode&&($("#subBlock").val($rootScope.subBlockNotification),$("#commentBlock").val($rootScope.commentNotification)),"default"===$rootScope.selectedNotification)return $rootScope.formSendNotificationError=!0,!0;if($("#commentBlock").is(":visible")&&""===$("#commentBlock").val())return $rootScope.messageAreaEmpty=!0,!0;if(form.$valid){var notifyForm=$(".getNotificationForm").serialize(),mList=extractEmails(list),param="";param=angular.isObject($rootScope.extra)?notifyForm+"&type="+type+"&memberList="+mList+"&"+$rootScope.extra.key+"="+$rootScope.extra.id:notifyForm+"&type="+type+"&memberList="+mList;var options={url:"/sp/notifications/sendNotificationWithParams",data:param};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success)ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:" Notification sent successfully "});else if(null!==response.error){ngDialog.close("ngdialog1");var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:errorMessage})}})}else $rootScope.formSendNotificationError=!0,$rootScope.messageAreaEmpty=!0,console.log("error")};var i,d=new Date,year=d.getFullYear(),ccYears=[];for(i=0;10>i;i++)ccYears.push(year+i);$rootScope.ccYears=ccYears,$rootScope.footerLinks=function(type,e){e.preventDefault(),"privacy"===type?ngDialog.open({template:"/sp/resources/html/footer/privacy.html"}):"agreement"===type?ngDialog.open({template:"/sp/resources/html/footer/agreement.html"}):"cookies"===type&&ngDialog.open({template:"/sp/resources/html/footer/cookies.html"})},setTimeout(function(){jQuery("body").on("click","a.footer_agreement",function(e){e.preventDefault(),ngDialog.open({template:"/sp/resources/html/footer/agreement.html"})}),jQuery("body").on("click","a.footer_privacy",function(e){e.preventDefault(),ngDialog.open({template:"/sp/resources/html/footer/privacy.html"})}),jQuery("body").on("click","a.footer_cookies",function(e){e.preventDefault(),ngDialog.open({template:"/sp/resources/html/footer/cookies.html"})})},1e3),Array.prototype.filter||(Array.prototype.filter=function(fun){if(void 0===this||null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if("function"!=typeof fun)throw new TypeError;for(var res=[],thisArg=arguments.length>=2?arguments[1]:void 0,i=0;len>i;i++)if(i in t){var val=t[i];fun.call(thisArg,val,i,t)&&res.push(val)}return res}),Array.prototype.swapItems=function(a,b){return this[a]=this.splice(b,1,this[a])[0],this},Array.prototype.move=function(old_index,new_index){if(new_index>=this.length)for(var k=new_index-this.length;k--+1;)this.push(void 0);return this.splice(new_index,0,this.splice(old_index,1)[0]),this}}]);
!function(){function addEventListener(element,event,cb){element.addEventListener?element.addEventListener(event,cb,!0):element.attachEvent(event,cb)}function setInnerText(element,text){if("undefined"==typeof element)return!1;var textProperty="innerText"in element?"innerText":"textContent";try{element[textProperty]=text}catch(anException){element.setAttribute("innerText",text)}}videojs.Youtube=videojs.MediaTechController.extend({init:function(player,options,ready){if(this.player_=player,this.featuresProgressEvents=!1,this.featuresTimeupdateEvents=!1,this.featuresPlaybackRate=!0,videojs.MediaTechController.call(this,player,options,ready),this.isIos=/(iPad|iPhone|iPod)/g.test(navigator.userAgent),this.isAndroid=/(Android)/g.test(navigator.userAgent),this.playVideoIsAllowed=!(this.isIos||this.isAndroid),(this.isIos||this.isAndroid)&&(this.player_.options().autoplay=!1),"undefined"!=typeof options.source)for(var key in options.source)options.source.hasOwnProperty(key)&&(player.options()[key]=options.source[key]);this.userQuality=videojs.Youtube.convertQualityName(player.options().quality),this.playerEl_=document.getElementById(player.id()),this.playerEl_.className+=" vjs-youtube",this.qualityButton=document.createElement("div"),this.qualityButton.setAttribute("class","vjs-quality-button vjs-menu-button vjs-control"),this.qualityButton.setAttribute("tabindex",0);var qualityContent=document.createElement("div");qualityContent.setAttribute("class","vjs-control-content"),this.qualityButton.appendChild(qualityContent),this.qualityTitle=document.createElement("span"),this.qualityTitle.setAttribute("class","vjs-control-text"),qualityContent.appendChild(this.qualityTitle),"undefined"!==player.options().quality&&setInnerText(this.qualityTitle,player.options().quality||"auto");var qualityMenu=document.createElement("div");if(qualityMenu.setAttribute("class","vjs-menu"),qualityContent.appendChild(qualityMenu),this.qualityMenuContent=document.createElement("ul"),this.qualityMenuContent.setAttribute("class","vjs-menu-content"),qualityMenu.appendChild(this.qualityMenuContent),this.id_=this.player_.id()+"_youtube_api",this.el_=videojs.Component.prototype.createEl("iframe",{id:this.id_,className:"vjs-tech",scrolling:"no",marginWidth:0,marginHeight:0,frameBorder:0}),this.el_.setAttribute("allowFullScreen",""),this.playerEl_.insertBefore(this.el_,this.playerEl_.firstChild),/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var ieVersion=Number(RegExp.$1);this.addIframeBlocker(ieVersion)}else/(iPad|iPhone|iPod|Android)/g.test(navigator.userAgent)||(this.el_.className+=" onDesktop",this.addIframeBlocker());this.parseSrc(player.options().src),this.playOnReady=this.player_.options().autoplay&&this.playVideoIsAllowed,this.forceSSL=!("undefined"!=typeof this.player_.options().forceSSL&&this.player_.options().forceSSL!==!0),this.forceHTML5=!("undefined"!=typeof this.player_.options().forceHTML5&&this.player_.options().forceHTML5!==!0),this.updateIframeSrc();var self=this;player.ready(function(){if(self.player_.options().controls){var controlBar=self.playerEl_.querySelectorAll(".vjs-control-bar")[0];controlBar&&controlBar.appendChild(self.qualityButton)}self.playOnReady&&!self.player_.options().ytcontrols&&("undefined"!=typeof self.player_.loadingSpinner&&self.player_.loadingSpinner.show(),"undefined"!=typeof self.player_.bigPlayButton&&self.player_.bigPlayButton.hide()),player.trigger("loadstart")}),this.on("dispose",function(){this.ytplayer&&this.ytplayer.destroy(),this.player_.options().ytcontrols||this.player_.off("waiting",this.bindedWaiting),this.playerEl_.querySelectorAll(".vjs-poster")[0].style.backgroundImage="none",this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),this.qualityButton.parentNode&&this.qualityButton.parentNode.removeChild(this.qualityButton),"undefined"!=typeof this.player_.loadingSpinner&&this.player_.loadingSpinner.hide(),"undefined"!=typeof this.player_.bigPlayButton&&this.player_.bigPlayButton.hide(),this.iframeblocker&&this.playerEl_.removeChild(this.iframeblocker)})}}),videojs.Youtube.prototype.updateIframeSrc=function(){var params={enablejsapi:1,iv_load_policy:3,playerapiid:this.id(),disablekb:1,wmode:"transparent",controls:this.player_.options().ytcontrols?1:0,html5:this.player_.options().forceHTML5?1:null,playsinline:this.player_.options().playsInline?1:0,showinfo:0,rel:0,autoplay:this.playOnReady?1:0,loop:this.player_.options().loop?1:0,list:this.playlistId,vq:this.userQuality,origin:window.location.protocol+"//"+window.location.host},isLocalProtocol="file:"===window.location.protocol||"app:"===window.location.protocol;isLocalProtocol&&delete params.origin;for(var prop in params)!params.hasOwnProperty(prop)||"undefined"!=typeof params[prop]&&null!==params[prop]||delete params[prop];var self=this;if(this.videoId){if(this.el_.src=(this.forceSSL||isLocalProtocol?"https:":window.location.protocol)+"//www.youtube.com/embed/"+this.videoId+"?"+videojs.Youtube.makeQueryString(params),this.player_.options().ytcontrols?this.player_.controls(!1):("undefined"==typeof this.player_.poster()||0===this.player_.poster().length)&&setTimeout(function(){self.player_.poster("https://img.youtube.com/vi/"+self.videoId+"/0.jpg")},100),this.bindedWaiting=function(){self.onWaiting()},this.player_.on("waiting",this.bindedWaiting),videojs.Youtube.apiReady)this.loadYoutube();else if(videojs.Youtube.loadingQueue.push(this),!videojs.Youtube.apiLoading){var tag=document.createElement("script");tag.onerror=function(e){self.onError(e)},tag.src=this.forceSSL||isLocalProtocol?"https://www.youtube.com/iframe_api":"//www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag),videojs.Youtube.apiLoading=!0}}else this.el_.src="about:blank",setTimeout(function(){self.triggerReady()},500)},videojs.Youtube.prototype.onWaiting=function(){"undefined"!=typeof this.player_.bigPlayButton&&this.player_.bigPlayButton.hide()},videojs.Youtube.prototype.addIframeBlocker=function(ieVersion){this.iframeblocker=videojs.Component.prototype.createEl("div"),this.iframeblocker.className="iframeblocker",this.iframeblocker.style.position="absolute",this.iframeblocker.style.left=0,this.iframeblocker.style.right=0,this.iframeblocker.style.top=0,this.iframeblocker.style.bottom=0,ieVersion&&9>ieVersion?this.iframeblocker.style.opacity=.01:this.iframeblocker.style.background="rgba(255, 255, 255, 0.01)";var self=this;addEventListener(this.iframeblocker,"mousemove",function(e){self.player_.userActive()||self.player_.userActive(!0),e.stopPropagation(),e.preventDefault()}),addEventListener(this.iframeblocker,"click",function(){self.paused()?self.play():self.pause()}),this.playerEl_.insertBefore(this.iframeblocker,this.el_.nextSibling)},videojs.Youtube.prototype.parseSrc=function(src){if(this.srcVal=src,src){var regId=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,match=src.match(regId);match&&11===match[2].length?this.videoId=match[2]:this.videoId=null;var regPlaylist=/[?&]list=([^#\&\?]+)/;match=src.match(regPlaylist),null!==match&&match.length>1?this.playlistId=match[1]:this.playlistId&&delete this.playlistId;var regVideoQuality=/[?&]vq=([^#\&\?]+)/;match=src.match(regVideoQuality),null!==match&&match.length>1&&(this.userQuality=match[1],setInnerText(this.qualityTitle,videojs.Youtube.parseQualityName(this.userQuality)))}},videojs.Youtube.prototype.src=function(src){if("undefined"!=typeof src){if(this.parseSrc(src),"about:blank"===this.el_.src)return void this.updateIframeSrc();delete this.defaultQuality,null!==this.videoId&&(this.player_.options().autoplay&&this.playVideoIsAllowed?this.ytplayer.loadVideoById({videoId:this.videoId,suggestedQuality:this.userQuality}):this.ytplayer.cueVideoById({videoId:this.videoId,suggestedQuality:this.userQuality}),this.playerEl_.querySelectorAll(".vjs-poster")[0].style.backgroundImage="url(https://img.youtube.com/vi/"+this.videoId+"/0.jpg)",this.player_.poster("https://img.youtube.com/vi/"+this.videoId+"/0.jpg"))}return this.srcVal},videojs.Youtube.prototype.load=function(){},videojs.Youtube.prototype.play=function(){null!==this.videoId&&(this.player_.options().ytcontrols||this.player_.trigger("waiting"),this.isReady_?(this.ytplayer.setVolume(100*this.player_.volume()),this.volumeVal>0?this.ytplayer.unMute():this.ytplayer.mute(),this.playVideoIsAllowed&&this.ytplayer.playVideo()):this.playOnReady=!0)},videojs.Youtube.prototype.pause=function(){this.ytplayer&&this.ytplayer.pauseVideo()},videojs.Youtube.prototype.paused=function(){return this.ytplayer?this.lastState!==YT.PlayerState.PLAYING&&this.lastState!==YT.PlayerState.BUFFERING:!0},videojs.Youtube.prototype.currentTime=function(){return this.ytplayer&&this.ytplayer.getCurrentTime?this.ytplayer.getCurrentTime():0},videojs.Youtube.prototype.setCurrentTime=function(seconds){this.ytplayer.seekTo(seconds,!0),this.player_.trigger("timeupdate"),this.player_.trigger("seeking"),this.isSeeking=!0},videojs.Youtube.prototype.playbackRate=function(){return this.ytplayer&&this.ytplayer.getPlaybackRate?this.ytplayer.getPlaybackRate():1},videojs.Youtube.prototype.setPlaybackRate=function(suggestedRate){this.ytplayer&&this.ytplayer.setPlaybackRate&&(this.ytplayer.setPlaybackRate(suggestedRate),this.player_.trigger("ratechange"))},videojs.Youtube.prototype.duration=function(){return this.ytplayer&&this.ytplayer.getDuration?this.ytplayer.getDuration():0},videojs.Youtube.prototype.currentSrc=function(){return this.srcVal},videojs.Youtube.prototype.ended=function(){return this.ytplayer?this.lastState===YT.PlayerState.ENDED:!1},videojs.Youtube.prototype.volume=function(){return this.ytplayer&&isNaN(this.volumeVal)&&(this.volumeVal=this.ytplayer.getVolume()/100,this.player_.volume(this.volumeVal)),this.volumeVal},videojs.Youtube.prototype.setVolume=function(percentAsDecimal){"undefined"!=typeof percentAsDecimal&&percentAsDecimal!==this.volumeVal&&(this.ytplayer.setVolume(100*percentAsDecimal),this.volumeVal=percentAsDecimal,this.player_.trigger("volumechange"))},videojs.Youtube.prototype.muted=function(){return this.mutedVal},videojs.Youtube.prototype.setMuted=function(muted){muted?(this.storedVolume=this.volumeVal,this.ytplayer.mute(),this.player_.volume(0)):(this.ytplayer.unMute(),this.player_.volume(this.storedVolume)),this.mutedVal=muted,this.player_.trigger("volumechange")},videojs.Youtube.prototype.buffered=function(){if(this.ytplayer&&this.ytplayer.getVideoBytesLoaded){var loadedBytes=this.ytplayer.getVideoBytesLoaded(),totalBytes=this.ytplayer.getVideoBytesTotal();if(!loadedBytes||!totalBytes)return 0;var duration=this.ytplayer.getDuration(),secondsBuffered=loadedBytes/totalBytes*duration,secondsOffset=this.ytplayer.getVideoStartBytes()/totalBytes*duration;return videojs.createTimeRange(secondsOffset,secondsOffset+secondsBuffered)}return videojs.createTimeRange(0,0)},videojs.Youtube.prototype.supportsFullScreen=function(){return"function"!=typeof this.el_.webkitEnterFullScreen||!/Android/.test(videojs.USER_AGENT)&&/Chrome|Mac OS X 10.5/.test(videojs.USER_AGENT)?!1:!0},videojs.Youtube.isSupported=function(){return!0},videojs.Youtube.canPlaySource=function(srcObj){return"video/youtube"===srcObj.type},videojs.Youtube.canControlVolume=function(){return!0},videojs.Youtube.loadingQueue=[],videojs.Youtube.prototype.loadYoutube=function(){this.ytplayer=new YT.Player(this.id_,{events:{onReady:function(e){e.target.vjsTech.onReady()},onStateChange:function(e){e.target.vjsTech.onStateChange(e.data)},onPlaybackQualityChange:function(e){e.target.vjsTech.onPlaybackQualityChange(e.data)},onError:function(e){e.target.vjsTech.onError(e.data)}}}),this.ytplayer.vjsTech=this},videojs.Youtube.makeQueryString=function(args){var array=["modestbranding=1"];for(var key in args)args.hasOwnProperty(key)&&array.push(key+"="+args[key]);return array.join("&")},window.onYouTubeIframeAPIReady=function(){for(var yt;yt=videojs.Youtube.loadingQueue.shift();)yt.loadYoutube();videojs.Youtube.loadingQueue=[],videojs.Youtube.apiReady=!0},videojs.Youtube.prototype.onReady=function(){this.isReady_=!0,this.triggerReady(),this.player_.trigger("loadedmetadata"),this.player_.trigger("durationchange"),this.player_.trigger("timeupdate"),"undefined"==typeof this.player_.loadingSpinner||this.isIos||this.isAndroid||this.player_.loadingSpinner.hide(),this.player_.options().muted&&this.setMuted(!0),this.playOnReady&&(this.playOnReady=!1,this.play())},videojs.Youtube.prototype.updateQualities=function(){function setupEventListener(el){addEventListener(el,"click",function(){var quality=this.getAttribute("data-val");self.ytplayer.setPlaybackQuality(quality),self.userQuality=quality,setInnerText(self.qualityTitle,videojs.Youtube.parseQualityName(quality));var selected=self.qualityMenuContent.querySelector(".vjs-selected");selected&&videojs.Youtube.removeClass(selected,"vjs-selected"),videojs.Youtube.addClass(this,"vjs-selected")})}var qualities=this.ytplayer.getAvailableQualityLevels(),self=this;if(qualities.indexOf(this.userQuality)<0&&setInnerText(self.qualityTitle,videojs.Youtube.parseQualityName(this.defaultQuality)),0===qualities.length)this.qualityButton.style.display="none";else{for(this.qualityButton.style.display="";this.qualityMenuContent.hasChildNodes();)this.qualityMenuContent.removeChild(this.qualityMenuContent.lastChild);for(var i=0;i<qualities.length;++i){var el=document.createElement("li");el.setAttribute("class","vjs-menu-item"),setInnerText(el,videojs.Youtube.parseQualityName(qualities[i])),el.setAttribute("data-val",qualities[i]),qualities[i]===this.quality&&videojs.Youtube.addClass(el,"vjs-selected"),setupEventListener(el),this.qualityMenuContent.appendChild(el)}}},videojs.Youtube.prototype.onStateChange=function(state){if(state!==this.lastState){switch(state){case-1:this.player_.trigger("durationchange");break;case YT.PlayerState.ENDED:fireAnalyticsEvent(this.videoId,"Watch to End"),this.player_.options().ytcontrols||(this.playerEl_.querySelectorAll(".vjs-poster")[0].style.display="block","undefined"!=typeof this.player_.bigPlayButton&&this.player_.bigPlayButton.show()),this.player_.trigger("ended");break;case YT.PlayerState.PLAYING:(void 0===this.isSeeking||this.isSeeking===!1||2===this.lastState)&&fireAnalyticsEvent(this.videoId,"Play"),this.playerEl_.querySelectorAll(".vjs-poster")[0].style.display="none",this.playVideoIsAllowed=!0,this.updateQualities(),this.player_.trigger("timeupdate"),this.player_.trigger("durationchange"),this.player_.trigger("playing"),this.player_.trigger("play"),this.isSeeking&&(this.player_.trigger("seeked"),this.isSeeking=!1);break;case YT.PlayerState.PAUSED:fireAnalyticsEvent(this.videoId,"Pause"),this.player_.trigger("pause");break;case YT.PlayerState.BUFFERING:this.player_.trigger("timeupdate"),this.player_.options().ytcontrols||this.player_.trigger("waiting");break;case YT.PlayerState.CUED:}this.lastState=state}};var fireAnalyticsEvent=function(videoId,state){var dataLayerName="dataLayer",videoUrl="https://www.youtube.com/watch?v="+videoId,_ga=window.GoogleAnalyticsObject;"undefined"!=typeof window[dataLayerName]?window[dataLayerName].push({event:"youTubeTrack",attributes:{videoUrl:videoUrl,videoAction:state}}):"function"==typeof window[_ga]&&"function"==typeof window[_ga].getAll?window[_ga]("send","event","Videos",state,videoUrl):"undefined"!=typeof window._gaq&&window._gaq.push(["_trackEvent","Videos",state,videoUrl])};videojs.Youtube.convertQualityName=function(name){switch(name){case"144p":return"tiny";case"240p":return"small";case"360p":return"medium";case"480p":return"large";case"720p":return"hd720";case"1080p":return"hd1080"}return"auto"},videojs.Youtube.parseQualityName=function(name){switch(name){case"tiny":return"144p";case"small":return"240p";case"medium":return"360p";case"large":return"480p";case"hd720":return"720p";case"hd1080":return"1080p"}return"auto"},videojs.Youtube.prototype.onPlaybackQualityChange=function(quality){if("undefined"!=typeof this.defaultQuality||(this.defaultQuality=quality,"undefined"==typeof this.userQuality)){switch(this.quality=quality,setInnerText(this.qualityTitle,videojs.Youtube.parseQualityName(quality)),quality){case"medium":this.player_.videoWidth=480,this.player_.videoHeight=360;break;case"large":this.player_.videoWidth=640,this.player_.videoHeight=480;break;case"hd720":this.player_.videoWidth=960,this.player_.videoHeight=720;break;case"hd1080":this.player_.videoWidth=1440,this.player_.videoHeight=1080;break;case"highres":this.player_.videoWidth=1920,this.player_.videoHeight=1080;break;case"small":this.player_.videoWidth=320,this.player_.videoHeight=240;break;case"tiny":this.player_.videoWidth=144,this.player_.videoHeight=108;break;default:this.player_.videoWidth=0,this.player_.videoHeight=0}this.player_.trigger("ratechange")}},videojs.Youtube.prototype.onError=function(error){this.player_.error(error),(100===error||101===error||150===error)&&(this.player_.bigPlayButton.hide(),this.player_.loadingSpinner.hide(),this.player_.posterImage.hide())},videojs.Youtube.addClass=function(element,classToAdd){-1===(" "+element.className+" ").indexOf(" "+classToAdd+" ")&&(element.className=""===element.className?classToAdd:element.className+" "+classToAdd)},videojs.Youtube.removeClass=function(element,classToRemove){var classNames,i;if(-1!==element.className.indexOf(classToRemove)){for(classNames=element.className.split(" "),i=classNames.length-1;i>=0;i--)classNames[i]===classToRemove&&classNames.splice(i,1);element.className=classNames.join(" ")}};var style=document.createElement("style"),def=" .vjs-youtube .vjs-poster { background-size: 100%!important; }.vjs-youtube .vjs-poster, .vjs-youtube .vjs-loading-spinner, .vjs-youtube .vjs-big-play-button, .vjs-youtube .vjs-text-track-display{ pointer-events: none !important; }.vjs-youtube.vjs-user-active .iframeblocker { display: none; }.vjs-youtube.vjs-user-inactive .vjs-tech.onDesktop { pointer-events: none; }.vjs-quality-button > div:first-child > span:first-child { position:relative;top:7px }";style.setAttribute("type","text/css"),document.getElementsByTagName("head")[0].appendChild(style),style.styleSheet?style.styleSheet.cssText=def:style.appendChild(document.createTextNode(def)),Array.prototype.indexOf||(Array.prototype.indexOf=function(elt){var len=this.length>>>0,from=Number(arguments[1])||0;for(from=0>from?Math.ceil(from):Math.floor(from),0>from&&(from+=len);len>from;from++)if(from in this&&this[from]===elt)return from;return-1})}();
function LibraryController($scope,ajaxService,sharedProperties,$timeout,userDataService,$localStorage,ngDialog,$q){$scope.searchKeys=[],$scope.search={},$scope.commentBox={},$scope.loggedInUser={},$scope.commentEditEnabled=!1,$scope.comments={},$scope.commentBoxes={},$scope.videoAvailable=!1,$scope.imageAvailable=!1,$scope.updateBtnDisabled=!1,$scope.newCommentBox={},$scope.topBox={},$scope.pageSize=20,$scope.existingKeys=[],$scope.searchKeywords={},$scope.btn={},$scope.searchPlaceHolderValue="e.g. Listening",$scope.commentsReady=!1,$scope.searchWithKeys={},$scope.newDate={},$scope.newDate.currentDay=new Date,$scope.newDate={year:$scope.newDate.currentDay.getFullYear(),month:$scope.newDate.currentDay.getMonth()+1,day:$scope.newDate.currentDay.getDate()},$scope.dd={},$scope.dd.hideDropDown=!1,$scope.searchTopic={},$scope.tab=0,$scope.showAddToGoalsBtn=!1,$scope.articlePageReady=!1,$scope.thanks=!1,$scope.emailMemberList=[],$scope.searchTag=[],$scope.inputRequired=!1,$scope.shortDescription=null,$scope.shareEnable=!1,$scope.formatDate=function(d){if(null!==d&&"undefined"!==d){var splitDate=d.split("-"),monthData={"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"},month=parseInt(splitDate[1])<=9?"0"+splitDate[1]:splitDate[1],formattedDate=monthData[month.toString()]+" "+parseInt(splitDate[2])+", "+parseInt(splitDate[0]);return formattedDate}},$scope.today=$scope.formatDate($scope.newDate.year+"-"+$scope.newDate.month+"-"+$scope.newDate.day),$scope.isArticleBookmarked=!1,$scope.recommendBtnDisabled=!0,$scope.articleBtnDisabled=!0,$scope.comments={add:function(c,id){if($scope.newCommentBox.submitted=!1,null!==c&&""!==c&&"undefined"!=typeof c){var _o={url:"/sp/trainingLibrary/addComment",data:$.param({comment:c,articleId:id})};ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&($scope.topBox.newComment=null,$scope.getArticle())})}else $scope.newCommentBox.submitted=!0},update:function(i,id){var commentNgModel="commentBox_"+i,errorBox=jQuery("body").find("span.error_msg_"+i),commentTextbox=jQuery("body").find("form[name=commentBoxForm_"+i+"]"),commentbox=jQuery("body").find("p.user-comment[data-comment=cBox_"+i+"]"),editBtns=jQuery("body").find("p.comment-btns[data-btns=cBtns_"+i+"]"),cancelBtns=jQuery("body").find("a[data-cancel=cancelBtn_"+i+"]");if(jQuery(errorBox).hasClass("hide")||jQuery(errorBox).addClass("hide"),"undefined"!=typeof $scope.commentBoxes[commentNgModel]){var _o={url:"/sp/trainingLibrary/updateComment",data:$.param({comment:$scope.commentBoxes[commentNgModel],articleId:id,candidateEmail:$scope.loggedInUser.email,index:i}).replace(/%40/g,"@").replace(/%2C/g,",")};ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&(jQuery(editBtns).removeClass("hide"),jQuery(cancelBtns).removeClass("show").addClass("hide"),jQuery(commentTextbox).addClass("hide"),jQuery(commentbox).removeClass("hide"),$scope.getArticle())})}else jQuery(errorBox).removeClass("hide")},"delete":function(i,id){var commentNgModel="commentBox_"+i,_o={url:"/sp/trainingLibrary/removeComment",data:$.param({comment:$scope.commentBoxes[commentNgModel],articleId:id,commentorEmail:$scope.loggedInUser.email,index:i}).replace(/%40/g,"@").replace(/%2C/g,",")};ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&$scope.getArticle()})},edit:function(i){var commentTextbox=jQuery("body").find("form[name=commentBoxForm_"+i+"]"),commentbox=jQuery("body").find("p.user-comment[data-comment=cBox_"+i+"]"),commentNgModel="commentBox_"+i,textBoxComment=jQuery(commentTextbox).find("textarea").attr("data-comments"),editBtns=jQuery("body").find("p.comment-btns[data-btns=cBtns_"+i+"]"),cancelBtns=jQuery("body").find("a[data-cancel=cancelBtn_"+i+"]");jQuery(editBtns).addClass("hide"),jQuery(cancelBtns).addClass("show"),jQuery(commentTextbox).removeClass("hide"),jQuery(commentbox).addClass("hide"),$scope.commentBoxes[commentNgModel]=textBoxComment,$scope.commentEditEnabled=!0},cancel:function(i){var commentTextbox=jQuery("body").find("form[name=commentBoxForm_"+i+"]"),commentbox=jQuery("body").find("p.user-comment[data-comment=cBox_"+i+"]"),editBtns=jQuery("body").find("p.comment-btns[data-btns=cBtns_"+i+"]"),cancelBtns=jQuery("body").find("a[data-cancel=cancelBtn_"+i+"]");jQuery(editBtns).removeClass("hide"),jQuery(cancelBtns).removeClass("show").addClass("hide"),jQuery(commentTextbox).addClass("hide"),jQuery(commentbox).removeClass("hide"),$scope.commentEditEnabled=!1}},$scope.formattedAuthor=function(a){return"undefined"!=typeof a&&""!==a?a.join(", "):void 0},$scope.fetchSearchData=function(key){if($scope.searchTopic.searchTopicValue=null,$scope.dd.hideDropDown=!0,"Themes"===key?$scope.searchPlaceHolderValue="e.g. Listening":$scope.searchPlaceHolderValue=null,-1===$.inArray(key,$scope.existingKeys))if($scope.existingKeys.push(key),$scope.searchKeywords[key]=[],null===$localStorage.get("getTopics"+key)){var options={url:"/sp/trainingLibrary/getAllTopics",data:$.param({topic:key})};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success){$localStorage.set("getTopics"+key,response),$scope.searchKeys=[],$scope.searchWithKeys[key]=response.topics;var fetchedTopics=response.topics;for(var k in fetchedTopics)fetchedTopics.hasOwnProperty(k)&&$scope.searchKeywords[key].push(fetchedTopics[k]);$scope.searchKeys=$scope.searchKeywords[key].sort()}})}else{var _r=$localStorage.get("getTopics"+key);$scope.searchKeys=[],$scope.searchWithKeys[key]=_r.topics;var fetchedTopics=_r.topics;for(var k in fetchedTopics)fetchedTopics.hasOwnProperty(k)&&$scope.searchKeywords[key].push(fetchedTopics[k]);$scope.searchKeys=$scope.searchKeywords[key].sort()}else $scope.searchKeys=$scope.searchKeywords[key]},$scope.searchResultSelected=function(k){$scope.searchTopic.searchTopicValue=k,$scope.dd.hideDropDown=!0},$scope.startSearch=function(c,ki){var k;for(var key in $scope.searchWithKeys[$scope.search.topicCategory])$scope.searchWithKeys[$scope.search.topicCategory][key]===ki&&(k=key);if($scope.selectCategoryError=!1,"default"!==c){var url="/sp/trainingLibrary/results#topicCategory="+encodeURIComponent(c)+"&topicValue="+("undefined"==typeof k||null===k||""===k?"":encodeURIComponent(k)+":"+encodeURIComponent(ki));window.location=url}else $scope.selectCategoryError=!0},$scope.refreshSearch=function(c,k,p,pageType){var url,urlParams,options,plural,ki;if(p===!0){url=window.location.href,urlParams=url.substring(url.indexOf("#")+1).replace(/\//g,"");var splitParams=urlParams.split("&"),paramCategory=splitParams[0].split("=")[1],paramTopic=splitParams[1].split("=")[1];null!==paramCategory&&""!==paramCategory&&"undefined"!=typeof paramCategory?(c=paramCategory.toString().replace(/\+/g," ").replace(/%20/g," "),plural="Author"===c||"Source"===c?"s":"",$scope.search.topicCategory=c,$scope.fetchSearchData(c),$scope.dd.hideDropDown=!0,$scope.searchTerm="All "+("Themes"===c?"Practice Areas":c)+plural):($scope.search.topicCategory="Themes",$scope.searchTerm="All Practice Areas",$scope.fetchSearchData("All Themes")),null!==paramTopic&&""!==paramTopic&&"undefined"!=typeof paramTopic?(k=paramTopic.toString().split(":")[0].replace(/\+/g," ").replace(/%20/g," "),ki=paramTopic.toString().split(":")[1].replace(/\+/g," ").replace(/%20/g," "),$scope.searchTopic.searchTopicValue=ki,$scope.searchTerm=ki):$scope.searchTopic.searchTopicValue=null}else if(null!==c&&""!==c&&"undefined"!=typeof c?(plural="Author"===c||"Source"===c?"s":"",$scope.search.topicCategory=c,$scope.searchTerm="All "+("Themes"===c?"Practice Areas":c)+plural,"Themes"===c&&$scope.fetchSearchData(c),window.location.hash="topicCategory="+c+"&topicValue="):($scope.search.topicCategory="Themes",$scope.searchTerm="All Themes",$scope.fetchSearchData("All Themes"),window.location.hash="topicCategory=Themes&topicValue="),null!==k&&""!==k&&"undefined"!=typeof k){for(var key in $scope.searchWithKeys[$scope.search.topicCategory])$scope.searchWithKeys[$scope.search.topicCategory][key]===k&&(ki=k,k=key);"Themes"!==$scope.search.topicCategory?($scope.searchTopic.searchTopicValue=k,$scope.searchTerm=k,window.location.hash="topicCategory="+c+"&topicValue="+k):($scope.searchTopic.searchTopicValue=ki,$scope.searchTerm=ki,window.location.hash="topicCategory="+c+"&topicValue="+k+":"+ki)}else $scope.searchTopic.searchTopicValue=null;"bookmark"===pageType?window.location.href="/sp/trainingLibrary/results"+window.location.hash:(options={url:"/sp/trainingLibrary/getResults",data:$.param({topicCategory:c,topicValue:k})},ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success){$scope.trainingSpotlight(k),$scope.searchFilterVal=null,$scope.tab=0,$scope.pageSize=20,$scope.articleResultData=response,$scope.articleResultsBackup=response.articles,$scope.totalArticles=$scope.articleResultsBackup.length,$scope.articleResultsBackup.length>20?($scope.articleResults=$scope.articleResultsBackup,$scope.btn.hideLoadMore=!1):($scope.articleResults=$scope.articleResultsBackup,$scope.btn.hideLoadMore=!0),$scope.articleFilters=[];var searchFilters=[];$.each($scope.articleResultsBackup,function(i,j){searchFilters.push(j.articleTypeFormatted)}),$scope.articleFilters=searchFilters.unique(),jQuery("html, body").animate({scrollTop:0})}}))},$scope.loadMoreResults=function(){$scope.articleResultsBackup.length>$scope.pageSize&&($scope.pageSize+=20,$scope.pageSize>$scope.articleResultsBackup.length&&($scope.disabledInfinite=!0,$scope.pageSize=$scope.articleResultsBackup.length))},$scope.updateArticleLink=function(l){var link=l.split("/"),linkID=link[parseInt(link.length-1)],formattedLink="/sp/trainingLibrary/article?"+linkID;return formattedLink},$scope.trackArticle=function(id){var options={url:"/sp/tracking/trackArticles",data:$.param({articleId:id,trackingType:"ARTICLES"})};ajaxService.getAjaxResponse(options)},$scope.getArticle=function(){var url=window.location.href,urlParams=url.substring(url.indexOf("?")+1).split("&")[0],options={url:"/sp/trainingLibrary/getArticleDetail/"+urlParams,method:"GET"};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success){if($scope.articlePageDetails=response.article,$scope.articlePageDetailsAuthors=response.article.author.join(", "),$scope.articleComments=response.article.comments,$scope.commentList=[],$scope.trainingSpotlight($scope.articlePageDetails.goalIds[0]),$scope.relatedContent=response.relatedArticles,response.article.canAddToUserGoals===!0?$scope.showAddToGoalsBtn=!0:$scope.showAddToGoalsBtn=!1,response.article.articleForUser===!0&&"NOT_STARTED"===response.article.userArticleStatus?$scope.updateBtnDisabled=!1:$scope.updateBtnDisabled=!0,"COMPLETED"===response.article.userArticleStatus?$scope.articleCompletedBtn=!0:$scope.articleCompletedBtn=!1,"undefined"!=typeof response.article.articleBookmarked&&null!==response.article.articleBookmarked&&($scope.isArticleBookmarked=response.article.articleBookmarked),"undefined"!=typeof response.article.imageUrl&&null!==response.article.imageUrl?($scope.imageAvailable=!0,$scope.articleHeroImage=response.article.imageUrl):$scope.imageAvailable=!1,"undefined"!=typeof response.article.videoUrl&&null!==response.article.videoUrl){$scope.videoAvailable=!0,$scope.articleVideo=response.article.videoUrl;var videoType;if(/youtube/g.test(response.article.videoUrl))videoType="youtube";else if(/vimeo/g.test(response.article.videoUrl)){videoType="vimeo";var link=$scope.articleVideo.split("?")[0].split("/");$scope.articleVideo="https://vimeo.com/"+link[parseInt(link.length-1)]}else videoType="html5";setTimeout(function(){videojs(document.getElementById("vid1"),{autoplay:!1,techOrder:[videoType],src:$scope.articleVideo},function(){})},500)}else $scope.videoAvailable=!1;$scope.profileReady===!0&&($scope.loggedInUser=userDataService.retrive(),$scope.loggedInUser.first=$scope.loggedInUser.member.firstName,$scope.loggedInUser.last=$scope.loggedInUser.member.lastName,$scope.loggedInUser.email=$scope.loggedInUser.member.email,$.each($scope.articleComments,function(i,j){var updatedComment=jQuery.extend({},$scope.articleComments[i],{mName:"commentBox_"+i,showOptions:$scope.articleComments[i].by.email===$scope.loggedInUser.email?!0:!1});$scope.commentList.push(updatedComment)}),$timeout(function(){$scope.commentsReady=!0},200)),$scope.articlePageReady=!0,$scope.trackArticle(urlParams);var readabilityData={},readability=response.article.articleReadability,element=document.getElementById("readability");null!==readability&&"undefined"!=typeof readability&&(readabilityData.FleschKincaidReadingEase=readability.fleschKincaidReadingEase,readabilityData.FleschKincaidGradeLevel=readability.fleschKincaidGradeLevel,readabilityData.GunningFogScore=readability.gunningFogScore,readabilityData.ColemanLiauIndex=readability.colemanLiauIndex,readabilityData.SmogIndex=readability.smogIndex,readabilityData.AutomatedReadabilityIndex=readability.automatedReadabilityIndex,readabilityData.Average=readability.average,element.setAttribute("data-readability-values",JSON.stringify(readabilityData)))}})},$scope.filterResults=function(f,i,e){e.preventDefault(),$scope.btn.hideLoadMore=!0,$timeout(function(){$scope.pageSize>$scope.currentArticleCount.length?$scope.btn.hideLoadMore=!0:$scope.btn.hideLoadMore=!1},300),$scope.searchFilterVal=f,$scope.tab=i},$scope.updateDashboard=function(id){if($scope.updateBtnDisabled===!1){var options={url:"/sp/trainingLibrary/udpateArticleToProfile",data:$.param({articleId:id})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&($scope.updateBtnDisabled=!0,$scope.articleHelpFul=!0,$.growl({icon:"glyphicon glyphicon-ok",message:" Dashboard updated successfully"}))})}},$scope.recommendArtice=function(id,doReccomend){$scope.recommendBtnDisabled=!1;var options={url:"/sp/trainingLibrary/recommendArticle",data:$.param({articleId:id,doReccomend:!doReccomend})};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success){$scope.recommendBtnDisabled=!0,$scope.articlePageDetails.articleRecommendedByUser=!$scope.articlePageDetails.articleRecommendedByUser,$scope.articlePageDetails.recommendationCount=response.recommendationCount;var message=$scope.articlePageDetails.articleRecommendedByUser?"Article recommended":" Article recommendation removed";$.growl({icon:"glyphicon glyphicon-ok",message:message})}else if(null!=response.error){$scope.recommendBtnDisabled=!0;var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})},$scope.articleBookmark=function(id){$scope.isArticleBookmarked===!0&&"undefined"!=typeof $scope.isArticleBookmarked?$scope.sendArticleBookmark=!1:$scope.sendArticleBookmark=!0,$scope.articleBtnDisabled=!1;var options={url:"/sp/tracking/bookMarkArticle",data:$.param({articleId:id,trackingType:"ARTICLES",isBookMarked:$scope.sendArticleBookmark})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?($scope.articleBtnDisabled=!0,$scope.sendArticleBookmark===!0?$.growl({icon:"glyphicon glyphicon-ok",message:" Article bookmarked"}):$.growl({icon:"glyphicon glyphicon-ok",message:" Bookmark removed"}),$scope.isArticleBookmarked=!$scope.isArticleBookmarked):$scope.articleBtnDisabled=!0})},$scope.getAllBookmarks=function(){$scope.search.topicCategory="Themes",ajaxService.getAjaxResponse({url:"/sp/tracking/getAllBookMarkedArticles",method:"get"}).then(function(response){if("true"===response.Success){$scope.recentBookmarkList=response.articles,$scope.articleFilters=[];var searchFilters=[];$.each($scope.recentBookmarkList,function(i,j){searchFilters.push(j.articleTypeFormatted)}),$scope.articleFilters=searchFilters.unique()}})},$scope.getAllBookmarksWithTrainingSpotlight=function(){$scope.search.topicCategory="Themes",ajaxService.getAjaxResponse({url:"/sp/tracking/getAllBookMarkedArticles",method:"get"}).then(function(response){if("true"===response.Success){$scope.trainingSpotlight(),$scope.recentBookmarkList=response.articles,$scope.articleFilters=[];var searchFilters=[];$.each($scope.recentBookmarkList,function(i,j){searchFilters.push(j.articleTypeFormatted)}),$scope.articleFilters=searchFilters.unique()}})},$scope.trendingTopRatedArticles=function(){if(null===$localStorage.get("tntArticles"))ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/trendingAndTopRated"}).then(function(response){"true"===response.Success&&($localStorage.set("tntArticles",response),$scope.trendingList=response.trendingArticles,$scope.topRatedList=response.topArticles)});else{var _r=$localStorage.get("tntArticles");$scope.trendingList=_r.trendingArticles,$scope.topRatedList=_r.topArticles}},$scope.trainingSpotlight=function(id){ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/trainingSpotlight",data:$.param({goalId:"undefined"!=typeof id?id:""})}).then(function(response){"true"===response.Success&&($scope.trainingSpotlightContent=response.trainingSpotLight)})},$scope.addtoGoals=function(id,search){ajaxService.getAjaxResponse({url:"/sp/goals/addArticleToUserGoals",method:"post",data:$.param({articleId:id})}).then(function(response){"true"===response.Success&&($scope.showAddToGoalsBtn=!1,$scope.updateBtnDisabled=!1,search===!0&&jQuery.each($scope.articleResults,function(i){return $scope.articleResults[i].articleLinkUrl===id?($scope.articleResults[i].canAddToUserGoals=!1,$scope.articleResults[i].userArticleStatus="NOT_STARTED",!1):void 0}),$.growl({icon:"glyphicon glyphicon-ok",message:" Article added successfully"}))})},$scope.shareArticle=function(articleId){$scope.inputRequired=!1,$scope.shareEnable=!0,$scope.shareArticleId=articleId,$scope.searchTag=[],!$scope.emailMemberList.length&&$scope.getMemberList(articleId),null===$scope.shortDescription?ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/getShortDescription",data:$.param({articleId:articleId})}).then(function(response){"true"===response.Success&&($scope.shortDescription=response.shortDescription,ngDialog.open({template:"/sp/trainingLibrary/share",scope:$scope}))}):ngDialog.open({template:"/sp/trainingLibrary/share",scope:$scope})},$scope.articleShared=function(obj){return obj.email.length?void ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/shareArticle",data:$.param({articleId:obj.articleId,comment:obj.comment,toList:obj.email.toString()})}).then(function(response){if("true"===response.Success)ngDialog.close("ngdialog1"),$scope.shareEnable=!1,$.growl({icon:"glyphicon glyphicon-ok",message:" Article shared successfully"});else{ngDialog.close("ngdialog1"),$scope.shareEnable=!1;for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}}):($scope.inputRequired=!0,!0)},$scope.getMemberList=function(articleId){ajaxService.getAjaxResponse({url:"/sp/allUsers"}).then(function(response){if("true"===response.Success)$scope.emailMemberList=response.allMembers;else{for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.loadTags=function(query){var deferred=$q.defer(),result=$scope.emailMemberList.filter(function(e){return-1!==e.name.toLowerCase().indexOf(query.toLowerCase())||-1!==e.email.toLowerCase().indexOf(query.toLowerCase())});return deferred.resolve(result),deferred.promise},$scope.tagAdded=function(tag){$scope.searchTag.push(tag.email),$scope.inputRequired=!1},$scope.tagRemoved=function(tag){$scope.searchTag.splice($scope.searchTag.indexOf(tag.email),1)},$scope.useful=function(obj){ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/usefullArticle",data:$.param({articleId:obj.articleId,isUseFull:obj.isUseFull})}).then(function(response){if("true"===response.Success)$scope.thanks=!0,$timeout(function(){$scope.articleHelpFul=!1,$scope.articleCompletedBtn=!0},3e3);else{for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.closeThis=function(){$scope.shareEnable=!1,this.closeThisDialog()},$scope.trainingLibraryControl=[],$scope.itemPositioned=[],$scope.fn=function(){var $slidesElem=$(".dragZone"),slidesHeight=$slidesElem.find(".inputBox").outerHeight(),slidesWidth=$slidesElem.find(".inputBox").outerWidth();return this.init=function(drag){this.getTrainingLibraryRecords(drag)},this.getTrainingLibraryRecords=function(drag){var storageCheck=$localStorage.get("trainingLibraryRecord");return null!=storageCheck&&storageCheck.Content.length?($scope.trainingLibraryControl=storageCheck,!0):void ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/homeArticles"}).then(function(response){if("true"===response.Success)$scope.trainingLibraryControl=response,$localStorage.set("trainingLibraryRecord",response);else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},this.dragIt=function(){$scope.pckry=$slidesElem.packery({handle:".handleMe",rowHeight:slidesHeight,columnWidth:slidesWidth});var itemElems=$scope.pckry.packery("getItemElements");$scope.initialItem=itemElems;for(var i=0,len=itemElems.length;len>i;i++){var draggie=new Draggabilly(itemElems[i],{axis:"y",containment:$slidesElem,handle:".handle",grid:[0,78]});$scope.pckry.packery("bindDraggabillyEvents",draggie)}$scope.pckry.packery("on","dragItemPositioned",this.orderItems),$scope.pckry.packery("on","layoutComplete",this.orderItems)},this.orderItems=function(){for(var $itemElems=$scope.pckry.packery("getItemElements"),i=0;i<$itemElems.length;i++){var indexToPut=$($itemElems[i]).attr("tabindex");$scope.itemPositioned[i]=indexToPut,$($itemElems[i]).attr("data-module-index",i)}},this.callSaveInLoop=function(form){if(form.$valid)for(var i=0;i<$slidesElem.find(".handleMe").length;i++){var _this=$($slidesElem.find(".handleMe")[i]),_obj={articleId:_this.find(".js_articleId").val(),shortDescription:_this.find(".js_shtDesc").val(),position:_this.attr("data-module-index")};this.saveTheRecord(_obj)}},this.saveTheRecord=function(_obj){ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/admin/add/contentArticles",data:$.param(_obj)}).then(function(response){if("true"===response.Success)$.growl({icon:"glyphicon glyphicon-ok",message:"SAVED"});else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},this},function(){$scope.callTraining=new $scope.fn}()}angular.module("spApp").controller("LibraryController",LibraryController),LibraryController.$inject=["$scope","ajaxService","sharedProperties","$timeout","userDataService","$localStorage","ngDialog","$q"];
function accountDashboardController($scope,$element,$attrs,$http,userDataService,ngDialog,$timeout,sharedProperties,ajaxService,$rootScope,$localStorage){$scope.stateCheck={},$scope.settings={},$scope.companyDetails={},$scope.disableCompanyEditing=!0,$scope.disableProfileEditing=!0,$scope.disableLinkedinEditing=!0,$scope.disableIndividualEditing=!0,$scope.disableUserProfileEditing=!0,$scope.formStatus={},$scope.accountInfo={},$scope.profile={},$scope.userGroupList=[],$scope.userTagList=[],$scope.groupDataSet={},$scope.dataWithFlags=[],$scope.allGroupListCounter=0,$scope.linkeDInFormStatus=!1,$scope.profilePic="",$scope.userInitials="",$scope.assessmentDetails={},$scope.feedbackDetails={},$scope.goalsDetails={},$scope.growthTeamDetails={},$scope.userPermissions={},$scope.profileSetings={},$scope.userPermissions.isAccountAdministrator=!1,$scope.userPermissions.isAdministrator=!1,$scope.userPermissions.isHiringToolAllowed=!1,$scope.userPermissions.isWorkspacePulseAllowed=!1,$scope.userPermissions.isSpectrumAllowed=!1,$scope.profileSetings.is360ProfileAllowed=!1,$scope.profileSetings.isHiringAccessAllowed=!1,$scope.profileToken={},$scope.userGroupListBusiness=[],$scope.dataWithFlagsBusiness=[],$scope.groupDataSetBusiness={},$scope.allGroupListCounterBusiness=0,$scope.updatedEmail="",$scope.dialogStatus={},$scope.accountPermissionOptions={show:!0},$scope.openView=!0,$scope.enableBtns=!1,$scope.serverError=!1,$scope.serverError1=!1,$scope.currentUser={},$scope.currentUser.groupList="default",$scope.glStatusUpdate=!1,$scope.serverError1=!1,$scope.imageEditBox=!1,$scope.priceFormatter=function(p){if("undefined"!=typeof p&&""!==p&&null!==p){var formattedPrice="$"+p.toFixed(2);return formattedPrice}},null!==$localStorage.get("spProfileTab")&&($scope.setTab=!0,$rootScope.callSwitchChange("spProfile")),$scope.apiConfig={urls:{company:{saveUpdate:"/sp/admin/account/updateCompany"},adminView:{saveUpdate:"/sp/admin/user/update/profile"},individual:{saveUpdate:"/sp/updateProfile"},userView:{saveUpdate:"/sp/updateProfile"},businessAccountDetails:"/sp/admin/account/businessAccountDetails",getCompanyDetails:"/sp/admin/account/getCompanyDetails",blockAllMembers:"/sp/admin/account/blockAllMembers",updateCompany:"/sp/admin/account/updateCompany",cancelAccount:"/sp/admin/account/cancel",updateLinkedIn:"/sp/admin/updateLinkedIn"}},$scope.setOptions=function(page){$scope.settings.currentPage=page,$localStorage.set("account_type",page)},$scope.enableEdit=function(f){"company"===f&&($scope.disableCompanyEditing=!1),"profile"===f&&($scope.disableProfileEditing=!1),"linkedin"===f&&($scope.disableLinkedinEditing=!1),"individual"===f&&($scope.disableIndividualEditing=!1),"userProfile"===f&&($scope.disableUserProfileEditing=!1)},$scope.disableEdit=function(f){"company"===f&&($scope.disableCompanyEditing=!0,$scope.getCompanyDetails()),"profile"===f&&($scope.disableProfileEditing=!0,$scope.getUserDetails()),"linkedin"===f&&($scope.disableLinkedinEditing=!0),"individual"===f&&($scope.disableIndividualEditing=!0,$scope.getIndividualUserDetails()),"userProfile"===f&&($scope.disableUserProfileEditing=!0,$scope.getUserDetailsBusiness()),$scope.formStatus.sumbit=!1,$scope.linkeDInFormStatus=!1},$scope.saveAndUpdate=function(formData,formName){var empCountErr;empCountErr="undefined"!=typeof formData.numberOfEmployees&&formData.numberOfEmployees<1?!1:!0;var URL=$scope.apiConfig.urls[$scope.settings.currentPage].saveUpdate,vCount=0;$scope.formStatus.sumbit=!1;for(var k in formData)if("object"==typeof formData[k])for(var l in formData[k])("default"===formData[k][l]||"default1"===formData[k][l])&&vCount++;else("default"===formData[k]||"default1"===formData[k])&&vCount++;this[formName].$valid&&0===vCount&&empCountErr?($scope.disableCompanyEditing=!0,$scope.disableProfileEditing=!0,$scope.disableIndividualEditing=!0,$scope.disableUserProfileEditing=!0,ajaxService.getAjaxResponse({url:URL,data:$.param(formData).replace(/address%5B/g,"").replace(/%5D/g,"").replace(/%2C/g,",")}).then(function(response){"true"===response.Success&&("company"===$scope.settings.currentPage&&$scope.getCompanyDetails(),"adminView"===$scope.settings.currentPage&&$scope.getUserDetails(),"individual"===$scope.settings.currentPage&&($localStorage.remove("loggegdInProfile"),window.location.reload()),"userView"===$scope.settings.currentPage&&($localStorage.remove("loggegdInProfile"),window.location.reload()))})):$scope.formStatus.sumbit=!0},$scope.getCompanyDetails=function(){ajaxService.getAjaxResponse({url:$scope.apiConfig.urls.getCompanyDetails}).then(function(response){"true"===response.Success&&($scope.companyDetail=response.company,$scope.companyDetail.address1=response.company.address.addressLine1,$scope.companyDetail.address2=response.company.address.addressLine2,$scope.companyDetail.zip=response.company.address.zipCode,$scope.stateCheck.forSelectedCountry=response.company.address.country)})},$scope.getAccountInfo=function(){ajaxService.getAjaxResponse({url:$scope.apiConfig.urls.businessAccountDetails}).then(function(response){"true"===response.Success?($scope.accountDetailsServerException=!1,$scope.accountDetailsServerException.message="",$scope.accountInfo=response):($scope.accountDetailsServerException=!0,"undefined"!=typeof response.error.InvalidRequestException?$scope.accountDetailsExceptionMessage=response.error.InvalidRequestException:$scope.accountDetailsExceptionMessage="Error occured on server.")})},$scope.blockAllMembers=function(status,e){var blockStatus,dataParam={};blockStatus=status===!1?!0:!1,dataParam.isBlockAllUsers=blockStatus,ajaxService.getAjaxResponse({url:$scope.apiConfig.urls.blockAllMembers,data:$.param(dataParam)})},$scope.showCancelDialog=function(i){"undefined"!=typeof i&&""!==i&&null!==i&&"individual"===i?$scope.individualCancel=!0:$scope.individualCancel=!1,$scope.dialogStatus.title="Cancel Subscription",$scope.dialogStatus.content="Subscription cancelled successfully.",ngDialog.open({template:"/sp/resources/html/admin/account/cancel-subscription-dialog.html",scope:$scope})},$scope.showDetailsDialog=function(t){"members"===t?($scope.showDetails={title:"Member account details",total:'Total member accounts purchased : <span class="b-700">'+parseInt($scope.accountInfo.account.productInfo.numActive+$scope.accountInfo.account.productInfo.availalbeMemberSubscriptions+$scope.accountInfo.account.productInfo.numDeleted)+"</span>",active:$scope.accountInfo.account.productInfo.numActive,deleted:$scope.accountInfo.account.productInfo.numDeleted,available:$scope.accountInfo.account.productInfo.availalbeMemberSubscriptions},ngDialog.open({template:"/sp/resources/html/admin/account/show-details-dialog.html",scope:$scope})):($scope.showDetails={title:"Candidate account details",total:'Total candidate accounts purchased : <span class="b-700">'+parseInt($scope.accountInfo.account.hiringProduct.availableHiringSubscripitons+$scope.accountInfo.account.hiringProduct.usedHiringSubscriptions)+"</span>",active:$scope.accountInfo.account.hiringProduct.usedHiringSubscriptions,deleted:$scope.accountInfo.account.hiringProduct.availableHiringSubscripitons+$scope.accountInfo.account.hiringProduct.usedHiringSubscriptions-$scope.accountInfo.account.hiringProduct.availableHiringSubscripitons-$scope.accountInfo.account.hiringProduct.usedHiringSubscriptions,available:$scope.accountInfo.account.hiringProduct.availableHiringSubscripitons},ngDialog.open({template:"/sp/resources/html/admin/account/show-details-dialog.html",scope:$scope}))},$scope.cancelSubscription=function(){ajaxService.getAjaxResponse({url:$scope.apiConfig.urls.cancelAccount}).then(function(response){"true"===response.Success?(ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:" Subscription cancelled successfully "}),$timeout(function(){$scope.individualCancel===!0?$scope.getIndividualAccountInfo():$scope.getAccountInfo()},300)):(ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Server </strong> ",message:Error}),$timeout(function(){$scope.individualCancel===!0?$scope.getIndividualAccountInfo():$scope.getAccountInfo()},300))})},$scope.showReactivateDialog=function(i){"undefined"!=typeof i&&""!==i&&null!==i&&"individual"===i?$scope.individualReactivate=!0:$scope.individualReactivate=!1,ajaxService.getAjaxResponse({url:"/sp/admin/account/reActivate"}).then(function(response){"true"===response.Success&&($scope.individualReactivate===!0?$scope.getIndividualAccountInfo():$scope.getAccountInfo(),$.growl({icon:"glyphicon glyphicon-ok",message:" Subscription renewal activated successfully"}))})},$scope.cancelRedirect=function(){"company"===$scope.settings.currentPage&&(window.location="/sp/admin/account/business"),"individual"===$scope.settings.currentPage&&(window.location="/sp/admin/account/individual")},$scope.initBusinessDashboard=function(){$scope.getCompanyDetails(),$scope.getAccountInfo()},$scope.goBack=function(param){window.location.href=param},$scope.getUserDetails=function(){$scope.signedInUser=userDataService.retrive();var _params={userEmail:null!==$localStorage.get("memEmail")?$localStorage.get("memEmail"):$scope.signedInUser.member.email};$scope.updatedEmail=null!==$localStorage.get("memEmail")?$localStorage.get("memEmail"):$scope.signedInUser.member.email,$scope.userGroupList=[],ajaxService.getAjaxResponse({url:"/sp/admin/user",data:$.param(_params).replace(/%40/g,"@")}).then(function(response){"true"===response.Success&&($scope.profile=response.profileForm,$scope.userGroupList=response.groupList,$scope.profilePic=response.userSummary.smallProfileImage,$scope.userInitials=response.userSummary.userInitials,$scope.profile.name=response.userSummary.name,null!==response.tagList&&($scope.userTagList=response.tagList,$scope.existingTags=$scope.userTagList.join()),null!==response.address?($scope.profile.country="USA"===response.address.country?"United States":response.address.country,$scope.stateCheck.forSelectedCountry=response.address.country,$scope.profile.address1=response.address.addressLine1,$scope.profile.address2=response.address.addressLine2,$scope.profile.city=response.address.city,$scope.profile.state=response.address.state,$scope.profile.zip=response.address.zipCode,$timeout(function(){$scope.profile.state=response.address.state},200)):($scope.profile.country="default",$scope.stateCheck.forSelectedCountry="default",$scope.profile.address1=null,$scope.profile.address2=null,$scope.profile.city=null,$scope.profile.state=null,$scope.profile.zip=null),null===$scope.profile.gender&&($scope.profile.gender="default"),0===$scope.profile.year&&($scope.profile.year="default"),0===$scope.profile.month&&($scope.profile.month="default"),0===$scope.profile.day&&($scope.profile.day="default"),null===$scope.profile.linkedInUrl||"undefined"==typeof $scope.profile.linkedInUrl?$scope.disableLinkedinEditing=!1:$scope.disableLinkedinEditing=!0,$scope.goalsDetails.percentage=0,$scope.growthTeamDetails.percentage=0,$scope.permissions=response.roles,$scope.userPermissions.isAccountAdministrator=!1,$scope.userPermissions.isAdministrator=!1,$scope.userPermissions.isHiringToolAllowed=!1,$scope.userPermissions.isWorkspacePulseAllowed=!1,$scope.userPermissions.isSpectrumAllowed=!1,jQuery.each($scope.permissions,function(i,j){"AccountAdministrator"===$scope.permissions[i]&&($scope.userPermissions.isAccountAdministrator=!0),"Administrator"===$scope.permissions[i]&&($scope.userPermissions.isAdministrator=!0),"Hiring"===$scope.permissions[i]&&($scope.userPermissions.isHiringToolAllowed=!0),"Pulse"===$scope.permissions[i]&&($scope.userPermissions.isWorkspacePulseAllowed=!0),"Spectrum"===$scope.permissions[i]&&($scope.userPermissions.isSpectrumAllowed=!0)}),$timeout(function(){$scope.setupAccountAccess($scope.signedInUser.member.email,$scope.signedInUser.member.roles,$scope.profile.email,response.roles)},300),$scope.assessmentStatus=response.userSummary.userStatus)})},$scope.setupAccountAccess=function(lEmail,lRoles,mEmail,mRoles){var currentUserRole,currentMemberRole,loggedEmail=lEmail,memberEmail=mEmail,loggedRoles=lRoles.sort(),memberRoles=mRoles.sort();$.each(loggedRoles,function(i){return"AccountAdministrator"===loggedRoles[i]?(currentUserRole="AccountAdministrator",!1):"Administrator"===loggedRoles[i]?(currentUserRole="Administrator",!1):void 0}),$.each(memberRoles,function(i){return"AccountAdministrator"===memberRoles[i]?(currentMemberRole="AccountAdministrator",!1):"Administrator"===memberRoles[i]?(currentMemberRole="Administrator",!1):"GroupLead"===memberRoles[i]?(currentMemberRole="GroupLead",!1):"User"===memberRoles[i]?(currentMemberRole="User",!1):(currentMemberRole="None",!1)}),"AccountAdministrator"===currentUserRole?loggedEmail!==memberEmail?($scope.accountPermissionOptions.adminAccess=!0,$scope.accountPermissionOptions.show=!0):$scope.accountPermissionOptions.show=!1:"Administrator"===currentUserRole?($scope.accountPermissionOptions.adminAccess=!1,loggedEmail!==memberEmail&&"AccountAdministrator"!==currentMemberRole&&"Administrator"!==currentMemberRole?$scope.accountPermissionOptions.show=!0:$scope.accountPermissionOptions.show=!1):"GroupLead"===currentUserRole?($scope.accountPermissionOptions.adminAccess=!1,$scope.accountPermissionOptions.show=!1):($scope.accountPermissionOptions.adminAccess=!1,$scope.accountPermissionOptions.show=!1)},$scope.getGroupList=function(){$scope.getUserDetails(),$scope.groupsDataReady=!1,ajaxService.getAjaxResponse({url:"/sp/admin/group/all",delay:100,maximum:1500}).then(function(response){if("true"===response.Success){$scope.dataWithFlags=[];var counter=0;$scope.groupDataSet=response.groupInfoList,jQuery.each($scope.groupDataSet,function(i,j){$scope.dataWithFlags.push(jQuery.extend({},$scope.groupDataSet[i],{selectedGroup:!1,selectedGroupLead:!1,alreadyGroupLead:!1}))}),$scope.allGroupListCounter=$scope.dataWithFlags.length,jQuery.each($scope.dataWithFlags,function(i,j){jQuery.each($scope.userGroupList,function(k,l){$scope.dataWithFlags[i].name===$scope.userGroupList[k].name&&($scope.dataWithFlags[i].selectedGroup=!0,$scope.allGroupListCounter-=1,$scope.userGroupList[k].groupLead===!0&&($scope.dataWithFlags[i].alreadyGroupLead=!0,$scope.dataWithFlags[i].selectedGroupLead=!0))}),counter++}),$scope.currentUser.groupList="default",counter===$scope.dataWithFlags.length&&(jQuery("html").hasClass("ie")?$timeout(function(){$scope.groupsDataReady=!0},500):$scope.groupsDataReady=!0)}})},$scope.changeGroup=function(selectedOption){if("default"!==selectedOption)if("createGroupCall_custom"===selectedOption)$scope.errornewEmptyGroup=!1,$scope.errornewGroup=!1,ngDialog.open({template:"/sp/admin/group/createGroup",scope:$scope}),$scope.currentUser.groupList="default";else{var _params={name:$scope.dataWithFlags[selectedOption].name,memberEmail:$scope.profile.email,isGroupLead:$scope.dataWithFlags[selectedOption].alreadyGroupLead};ajaxService.getAjaxResponse({url:"/sp/admin/group/addMember",data:$.param(_params).replace(/%40/g,"@"),delay:100,maximum:1500}).then(function(response){if("true"===response.Success)$scope.serverError=!1,$scope.serverError1=!1,$scope.dataWithFlags[selectedOption].selectedGroup=!0,$scope.allGroupListCounter-=1,$scope.currentUser.groupList="default";else{$scope.currentUser.groupList="default",$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})}},$scope.processRemoveGroup=function(selectedOption){var _params={name:$scope.dataWithFlags[selectedOption].name,memberEmail:$scope.profile.email,isGroupLead:!1};ajaxService.getAjaxResponse({url:"/sp/admin/group/removeMember",data:$.param(_params).replace(/%40/g,"@"),delay:10,maximum:1500}).then(function(response){if("true"===response.Success)$scope.serverError1=!1,$timeout(function(){$scope.dataWithFlags[selectedOption].selectedGroup=!1,$scope.flagCounter+=1},300);else{$scope.serverError1=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.removeGroup=function(selectedOption){"default"!==selectedOption&&($scope.dataWithFlags[selectedOption].alreadyGroupLead===!0?($scope.updateGroupLeadStatus(selectedOption,!1),$scope.glStatusUpdate===!0&&(jQuery("html").hasClass("ie")?$timeout(function(){$scope.processRemoveGroup(selectedOption)},500):$scope.processRemoveGroup(selectedOption))):$scope.processRemoveGroup(selectedOption))},$scope.updateGroupLeadStatus=function(i,status){var _params={name:$scope.dataWithFlags[i].name,memberEmail:$scope.profile.email,isGroupLead:status===!1?!1:!0};ajaxService.getAjaxResponse({url:"/sp/admin/group/addMember",data:$.param(_params).replace(/%40/g,"@"),delay:100,maximum:1500}).then(function(response){if("true"===response.Success)$scope.serverError=!1,$scope.serverError1=!1,$scope.dataWithFlags[i].alreadyGroupLead=!$scope.dataWithFlags[i].alreadyGroupLead,$scope.dataWithFlags[i].alreadyGroupLead===!1&&null!==$scope.dataWithFlags[i].groupLEad&&($scope.dataWithFlags[i].groupLead=null),$scope.glStatusUpdate=!0;else{$scope.serverError=!0,$scope.glStatusUpdate=!1;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.saveNewGroup=function(groupname,groupLeadEmailId){if($scope.errornewEmptyGroup=!1,$scope.errornewGroup=!1,""===groupname||"undefined"==typeof groupname)return $scope.errornewEmptyGroup=!0,!1;var obj={name:groupname},options={url:"/sp/admin/group/create",data:$.param(obj)};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success){ngDialog.close("ngdialog1");var _params={name:groupname,memberEmail:$scope.profile.email,isGroupLead:!1};ajaxService.getAjaxResponse({url:"/sp/admin/group/addMember",data:$.param(_params).replace(/%40/g,"@"),delay:100,maximum:1500}).then(function(response){if("true"===response.Success)$scope.serverError=!1,$scope.serverError1=!1,$scope.dataWithFlags.push({name:groupname,groupLead:null,numOfMembers:1,memberSummaryList:null,selectedGroup:!0,selectedGroupLead:!1,alreadyGroupLead:!1}),$scope.currentUser.groupList="default";else{$scope.currentUser.groupList="default",$scope.errornewGroup=!0,$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})}else null!=response.error&&($scope.errornewGroup=!0)})},$scope.closeGroup=function(){$scope.currentUser.groupList="default",ngDialog.close("ngdialog1")},$scope.updateLinkedURL=function(l,type){var updatedUrl="";if(updatedUrl="individual"===type||"bindividual"===type?"/sp/updateLinkedIn":$scope.apiConfig.urls.updateLinkedIn,this.linkedinUpdate.$valid){$scope.disableLinkedinEditing=!0;var _params=$.extend({},{userEmail:$scope.updatedEmail},l);ajaxService.getAjaxResponse({url:updatedUrl,data:$.param(_params)}).then(function(response){"true"===response.Success&&("individual"===type?$scope.getIndividualUserDetails():"bindividual"===type?$scope.getUserDetailsBusiness():$scope.getUserDetails())})}else $scope.linkeDInFormStatus=!0},$scope.updatePermissions=function(val,type){var _params={userEmail:$scope.profile.email};"admin"===type&&(val===!0?$.extend(_params,{isAdministrator:!1,isAccountAdministrator:!1,isHiringToolAllowed:$scope.userPermissions.isHiringToolAllowed,isWorkspacePulseAllowed:$scope.userPermissions.isWorkspacePulseAllowed,isSpectrumAllowed:$scope.userPermissions.isSpectrumAllowed}):$.extend(_params,{isAdministrator:!0,isAccountAdministrator:$scope.userPermissions.isAccountAdministrator,isHiringToolAllowed:$scope.userPermissions.isHiringToolAllowed,isWorkspacePulseAllowed:$scope.userPermissions.isWorkspacePulseAllowed,isSpectrumAllowed:$scope.userPermissions.isSpectrumAllowed})),"account"===type&&(val===!0?$.extend(_params,{isAdministrator:$scope.userPermissions.isAdministrator,isAccountAdministrator:!1,isHiringToolAllowed:$scope.userPermissions.isHiringToolAllowed,isWorkspacePulseAllowed:$scope.userPermissions.isWorkspacePulseAllowed,isSpectrumAllowed:$scope.userPermissions.isSpectrumAllowed}):$.extend(_params,{isAdministrator:$scope.userPermissions.isAdministrator,isAccountAdministrator:!0,isHiringToolAllowed:!0,isWorkspacePulseAllowed:!0,isSpectrumAllowed:!0})),"hiring"===type&&$.extend(_params,{isAdministrator:$scope.userPermissions.isAdministrator,isAccountAdministrator:$scope.userPermissions.isAccountAdministrator,isHiringToolAllowed:!$scope.userPermissions.isHiringToolAllowed,isWorkspacePulseAllowed:$scope.userPermissions.isWorkspacePulseAllowed,isSpectrumAllowed:$scope.userPermissions.isSpectrumAllowed}),"pulse"===type&&$.extend(_params,{isAdministrator:$scope.userPermissions.isAdministrator,isAccountAdministrator:$scope.userPermissions.isAccountAdministrator,isHiringToolAllowed:$scope.userPermissions.isHiringToolAllowed,isWorkspacePulseAllowed:!$scope.userPermissions.isWorkspacePulseAllowed,isSpectrumAllowed:$scope.userPermissions.isSpectrumAllowed}),"spectrum"===type&&$.extend(_params,{isAdministrator:$scope.userPermissions.isAdministrator,isAccountAdministrator:$scope.userPermissions.isAccountAdministrator,isHiringToolAllowed:$scope.userPermissions.isHiringToolAllowed,isWorkspacePulseAllowed:$scope.userPermissions.isWorkspacePulseAllowed,isSpectrumAllowed:!$scope.userPermissions.isSpectrumAllowed}),ajaxService.getAjaxResponse({url:"/sp/admin/user/updatePermissions",data:$.param(_params)}).then(function(response){"true"===response.Success&&$scope.getUserDetails()})},$scope.initAdminViewDashboard=function(){$scope.getUserDetails(),$timeout(function(){$scope.getGroupList()},200)},window.location.origin?$scope.siteName=window.location.origin+"/sp/":$scope.siteName=window.location.protocol+"//"+window.location.hostname+"/sp/",$scope.getIndividualUserDetails=function(){ajaxService.getAjaxResponse({url:"/sp/admin/user"}).then(function(response){"true"===response.Success&&($scope.profile=response.profileForm,$scope.certificate=response.userCertificate,$scope.certificateNo=parseInt(response.userCertificate.split("SP")[1]),$scope.certificateIssue=response.createdOn,$scope.profilePic=response.userSummary.smallProfileImage,$scope.userInitials=response.userSummary.userInitials,$scope.assessmentStatus=response.userSummary.userStatus,null!==response.address?($scope.profile.country="USA"===response.address.country?"United States":response.address.country,$scope.stateCheck.forSelectedCountry=response.address.country,$scope.profile.address1=response.address.addressLine1,$scope.profile.address2=response.address.addressLine2,$scope.profile.city=response.address.city,$scope.profile.state=response.address.state,$scope.profile.zip=response.address.zipCode):($scope.profile.country="default",$scope.stateCheck.forSelectedCountry="default",$scope.profile.address1=null,$scope.profile.address2=null,$scope.profile.city=null,$scope.profile.state=null,$scope.profile.zip=null),null===$scope.profile.gender&&($scope.profile.gender="default"),0===$scope.profile.year&&($scope.profile.year="default"),0===$scope.profile.month&&($scope.profile.month="default"),0===$scope.profile.day&&($scope.profile.day="default"),null===$scope.profile.linkedInUrl||"undefined"==typeof $scope.profile.linkedInUrl?$scope.disableLinkedinEditing=!1:$scope.disableLinkedinEditing=!0)})},$scope.getIndividualAccountInfo=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/individualAccountDetails"}).then(function(response){"true"===response.Success&&($scope.accountInfo=response,$scope.profileSetings.is360ProfileAllowed=response.profileSettings.is360ProfileAccessAllowed,$scope.profileSetings.isHiringAccessAllowed=response.profileSettings.hiringAccessAllowed,$scope.profileSetings.isCertificateProfilePublicViewAllowed=response.profileSettings.certificateProfilePublicView,$scope.profileToken=response.profileSettings.token)})},$scope.updateProfileSettings=function(val,type){var _params={isHiringAccessAllowed:"h"===type?!$scope.profileSetings.isHiringAccessAllowed:$scope.profileSetings.isHiringAccessAllowed,is360ProfileAllowed:"360"===type?!$scope.profileSetings.is360ProfileAllowed:$scope.profileSetings.is360ProfileAllowed};ajaxService.getAjaxResponse({url:"/sp/admin/account/updateIndividualProfile",data:$.param(_params)}).then(function(response){"true"===response.Success&&$scope.getIndividualUserDetails()})},$scope.spcDate=function(d){if("undefined"!=typeof d){var monthData={January:"01",February:"02",March:"03",April:"04",May:"05",June:"06",July:"07",August:"08",September:"09",October:"10",November:"11",December:"12"},m=monthData[d.split(",")[0].split(" ")[0]],y=d.split(",")[1].split(" ")[1];return y+m}},$scope.updateCertificateAccess=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/updateIndividualProfile/spCertificate",method:"post",data:$.param({isCertificateProfilePublicViewAllowed:!$scope.profileSetings.isCertificateProfilePublicViewAllowed})})},$scope.generateProfileToken=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/individualGenerateToken"}).then(function(response){"true"===response.Success&&($scope.getIndividualAccountInfo(),$.growl({icon:"glyphicon glyphicon-ok",message:"New link is generated successfully"}))})},$scope.initIndividualDashboard=function(){$scope.getIndividualUserDetails(),$scope.getIndividualAccountInfo()},$scope.getUserDetailsBusiness=function(){$scope.userGroupListBusiness=[];var storedUser=$localStorage.get("loggegdInProfile"),storedEmail=storedUser.member.email;ajaxService.getAjaxResponse({url:"/sp/admin/user",data:$.param({userEmail:storedEmail})}).then(function(response){"true"===response.Success&&($scope.profile=response.profileForm,$scope.userGroupListBusiness=response.groupList,$scope.profilePic=response.userSummary.smallProfileImage,$scope.userInitials=response.userSummary.userInitials,$scope.profile.name=response.userSummary.name,null!==response.address?($scope.profile.country="USA"===response.address.country?"United States":response.address.country,$scope.stateCheck.forSelectedCountry=response.address.country,$scope.profile.address1=response.address.addressLine1,$scope.profile.address2=response.address.addressLine2,$scope.profile.city=response.address.city,$scope.profile.state=response.address.state,$scope.profile.zip=response.address.zipCode,$timeout(function(){$scope.profile.state=response.address.state},200)):($scope.profile.country="default",$scope.stateCheck.forSelectedCountry="default",$scope.profile.address1=null,$scope.profile.address2=null,$scope.profile.city=null,$scope.profile.state=null,$scope.profile.zip=null),null===$scope.profile.gender&&($scope.profile.gender="default"),0===$scope.profile.year&&($scope.profile.year="default"),0===$scope.profile.month&&($scope.profile.month="default"),0===$scope.profile.day&&($scope.profile.day="default"),null===$scope.profile.linkedInUrl||"undefined"==typeof $scope.profile.linkedInUrl?$scope.disableLinkedinEditing=!1:$scope.disableLinkedinEditing=!0)})},$scope.initUserViewDashboard=function(){$scope.getUserDetailsBusiness()},"undefined"!=typeof $scope.settings.currentPage?"company"===$scope.settings.currentPage?$scope.initBusinessDashboard():"adminView"===$scope.settings.currentPage?$scope.initAdminViewDashboard():"individual"===$scope.settings.currentPage?$scope.initIndividualDashboard():"userView"===$scope.settings.currentPage&&$scope.initUserViewDashboard():$timeout(function(){"company"===$scope.settings.currentPage?$scope.initBusinessDashboard():"adminView"===$scope.settings.currentPage?$scope.initAdminViewDashboard():"individual"===$scope.settings.currentPage?$scope.initIndividualDashboard():"userView"===$scope.settings.currentPage&&$scope.initUserViewDashboard()},250),$scope.addressFormReset=function(t){"business"===t&&($scope.companyDetail.address1=null,$scope.companyDetail.address2=null,$scope.companyDetail.zip=null,$scope.companyDetail.address.city=null,"United States"!==$scope.stateCheck.forSelectedCountry?$scope.companyDetail.address.state=null:$scope.companyDetail.address.state="default"),("individual"===t||"buser"===t||"member"===t)&&($scope.profile.address1=null,$scope.profile.address2=null,$scope.profile.city=null,$scope.profile.zip=null,"United States"===$scope.stateCheck.forSelectedCountry?$scope.profile.state="default":$scope.profile.state=null)},$scope.uploadPicture=function(){$scope.imageEditBox=!1,$scope.imageType="user",ngDialog.open({template:"/sp/resources/html/admin/account/upload-pic.html",scope:$scope})},$scope.uploadCompanyLogo=function(){$scope.imageEditBox=!1,$scope.imageType="company",ngDialog.open({template:"/sp/resources/html/admin/account/upload-company-pic.html",scope:$scope})},$scope.deleteImageModal=function(imageType){$scope.imageEditBox=!1,$scope.imageType=imageType,ngDialog.open({template:"/sp/resources/html/admin/account/delete-image-modal.html",scope:$scope})},$scope.deleteImage=function(){ajaxService.getAjaxResponse({url:"company"===$scope.imageType?"/sp/admin/company/deleteImage":"/sp/admin/user/deleteImage"}).then(function(response){"true"===response.Success?(ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:" Image Deleted Successfully"}),$timeout(function(){$localStorage.remove("loggegdInProfile"),window.location.reload()},1e3)):$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:"Image upload failed."})})},$scope.openList=function(e,bool){bool?$(e.currentTarget).closest(".profile-cont").find(".js_desk").removeClass("desktopShow"):$(e.currentTarget).closest(".profile-cont").find(".js_desk").addClass("desktopShow")},$scope.resetFlags=function(){$scope.disableEdit("profile")},$scope.resetPwdError=!1,$scope.resetPwdForm={},$scope.resetPwdForm.validationErrors=!1,$scope.resetPwd={},$scope.resetPasswordForm=function(){ngDialog.open({template:"/sp/resources/html/admin/account/resetPassword.html",scope:$scope}),$rootScope.$on("ngDialog.opened",function(e,$dialog){$timeout(function(){$scope.resetPwdError=!1,$scope.resetPwdForm.validationErrors=!1,jQuery("body").find('form[name="resetPwdForm"]')[0].reset()},100)})},$scope.processPasswordReset=function(fData){this.resetPwdForm.validationErrors=!1,$scope.resetPwdError=!1,this.resetPwdForm.$valid?ajaxService.getAjaxResponse({url:"/sp/changePassword",data:$.param({oldPassword:fData.oldPassword,newPassword:fData.newPassword})}).then(function(response){if("true"===response.Success)$scope.resetPwdError=!1,jQuery("body").find('form[name="resetPwdForm"]')[0].reset(),ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:" Password changed successfully"});else{$scope.resetPwdForm.validationErrors=!1,$scope.resetPwdError=!0;for(var key in response.error)$scope.resetPwdErrorMsg=response.error[key]}}):($scope.resetPwdError=!1,this.resetPwdForm.validationErrors=!0)},$scope.showImageEdit=function(){$scope.imageEditBox=!0},$scope.closeImageEdit=function(){$scope.imageEditBox=!1}}angular.module("spApp").controller("accountDashboardController",accountDashboardController),accountDashboardController.$inject=["$scope","$element","$attrs","$http","userDataService","ngDialog","$timeout","sharedProperties","ajaxService","$rootScope","$localStorage"];
function memberListController($scope,$q,ajaxService,$filter,ngDialog,sharedProperties,$timeout,$rootScope,$localStorage,$state){function getMembersData(){var userRoles=null!==$localStorage.get("loggegdInProfile")?$localStorage.get("loggegdInProfile").member.roles:[];vm.iamaccountadmin=-1!==userRoles.indexOf("AccountAdministrator")?!0:!1,ajaxService.getAjaxResponse({url:vm.config.getMembersData}).then(function(response){if("true"===response.Success){vm.masterMemberList=response.memberList.length?response.memberList:[],vm.memberList=angular.copy(vm.masterMemberList),vm.responseRecieved=!0,vm.returnMemberList(vm.pageSetting.pageSize);var mokroles=[];angular.forEach(vm.masterMemberList,function(val,index){vm.allMembersEmailId.push({email:val.email}),null!==val.tagList&&(vm.tagListArray=val.tagList.concat(vm.tagListArray).unique()),null!==val.userStatus&&mokroles.push(val.userStatus)}),vm.tagListArray=vm.autoCompleteType(vm.tagListArray),vm.userStatus=mokroles.unique(),vm.getHiringCandidateList()}else if(null!=response.error){vm.responseRecieved=!0;var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function autoCompleteType(arr){for(var customarray=[],i=0;i<arr.length;i++)customarray.push({text:arr[i]});return customarray}function getHiringCandidateList(){ajaxService.getAjaxResponse({url:vm.config.getHiringCandidateList}).then(function(response){"true"===response.Success&&(vm.newHiresList=response.hiring,vm.newHiresList.length&&(vm.showAddHireList=!0))})}function getGroupsData(){var options={url:"/sp/admin/group/all"};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success&&(vm.mainGroupInfoList=response.groupInfoList,!vm.groupModule.length))for(var i=0;i<response.groupInfoList.length;i++)vm.groupModule.push(response.groupInfoList[i].name)})}function infinteScroll(arg){vm.returnMemberList(arg)}function returnMemberList(pageSize){if(!vm.masterMemberList.length)return!0;var result=vm.masterCopy?vm.masterMemberList:vm.memberList;vm.memberList=result.filter(function(e){return(null!==vm.pageSetting.userStatusSelected&&e.userStatus===vm.pageSetting.userStatusSelected||null===vm.pageSetting.userStatusSelected&&e)&&(vm.pageSetting.statusInclude.length&&intersection(null===e.roles?[]:e.roles,vm.pageSetting.statusInclude).length===vm.pageSetting.statusInclude.length||!vm.pageSetting.statusInclude.length&&e)&&(vm.pageSetting.searchTag.length&&intersection(null===e.tagList?[]:e.tagList,vm.pageSetting.searchTag).length===vm.pageSetting.searchTag.length||!vm.pageSetting.searchTag.length&&e)&&sharedProperties.singleElementSearch(vm.pageSetting.textSearching,e,2)}),vm.pageSetting.pageSize=pageSize,pageSize>=vm.masterMemberList.length&&(vm.pageSetting.disabledInfinite=!0,vm.pageSetting.pageSize=vm.masterMemberList.length),vm.order(vm.pageSetting.lastPredicate,vm.pageSetting.lastReverse),!vm.alltoggle&&(vm.negative=!1,vm.pageSetting.userEmail.email=[]),vm.negative&&vm.checkAll(),vm.masterCopy=!0}function includeCheck(status){var i=$.inArray(status,vm.pageSetting.statusInclude);i>-1?vm.pageSetting.statusInclude.splice(i,1):(vm.pageSetting.statusInclude.push(status),vm.masterCopy=!1),vm.returnMemberList(vm.pageSetting.pageSize)}function userStatusSelected(status){vm.pageSetting.userStatusSelected=status,vm.returnMemberList(vm.pageSetting.pageSize)}function loadTags(query){var deferred=$q.defer(),result=vm.tagListArray.filter(function(e){return-1!==e.text.toLowerCase().indexOf(query.toLowerCase())});return deferred.resolve(result),deferred.promise}function tagAdded(tag){vm.pageSetting.searchTag.push(tag.text),vm.masterCopy=!1,vm.returnMemberList(vm.pageSetting.pageSize)}function tagRemoved(tag){vm.pageSetting.searchTag.splice(vm.pageSetting.searchTag.indexOf(tag.text),1),vm.returnMemberList(vm.pageSetting.pageSize)}function intersection(a,b){var result=[],ai=0,bi=0;for(a.sort(),b.sort();a.length>ai&&b.length>bi;)a[ai]<b[bi]?ai++:a[ai]>b[bi]?bi++:(result.push(a[ai]),ai++,bi++);return result}function order(predicate,reverse){vm.pageSetting.lastPredicate=predicate,vm.pageSetting.lastReverse=reverse,vm.memberList=$filter("orderBy")(vm.memberList,vm.pageSetting.lastPredicate,vm.pageSetting.lastReverse)}function searchTextFilter(search){vm.masterCopy=search.length<vm.pageSetting.textSearching.length,vm.pageSetting.textSearching=search,vm.returnMemberList(vm.pageSetting.pageSize)}function clearSearch(){vm.pageSetting.textSearching.length&&(vm.pageSetting.textSearching="",vm.pageSetting.searchText="",vm.returnMemberList(vm.pageSetting.pageSize))}function active(event,setting){vm.pageSetting.lastPredicate=setting.predicate,vm.pageSetting.lastReverse=setting.reverse,sharedProperties.toggleFilterClick(event,vm.pageSetting.lastPredicate),vm.order(vm.pageSetting.lastPredicate,vm.pageSetting.lastReverse)}function resetfilter(allmembers){vm.pageSetting=angular.copy(vm.originalpageSetting),vm.checkUncheck(),angular.element($(".tags").find("input")).scope().newTag.text="",$rootScope.$broadcast("$scrollStart"),vm.returnMemberList(vm.pageSetting.pageSize);var curr=$(".memberHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")}function checkAll(){vm.checkedAll=!vm.checkedAll,vm.negative?vm.pageSetting.userEmail.email=vm.memberList.map(function(item){return{email:item.email,name:item.name,title:item.title}}):vm.pageSetting.userEmail.email=[]}function checkUncheck(){vm.alltoggle=!1,vm.checkedAll&&(vm.negative=!vm.negative,vm.checkedAll=!vm.checkedAll)}function createGroupCall(ChangeCall){if("createGroupCall_custom"===ChangeCall){$scope.errornewGroup=!1,$scope.errornewEmptyGroup=!1,$scope.savenewGroup=!1;var dialog=ngDialog.open({template:"/sp/admin/group/createGroup",scope:$scope});dialog.closePromise.then(function(data){vm.groupModuleSelected=""})}}function memberTakeAway(email,f){$localStorage.set("memEmail",email),f===!0&&$localStorage.set("spProfileTab",!0),window.location.href="/sp/admin/account/member/details?email="+email}function editGroupSection(email,index){vm.oneTime&&(vm.getGroupsData(),vm.oneTime=!1),vm.setEditMode=!0,vm.EditGroupEmail=email,vm.indexToChange=index,vm.groupEditSection=angular.copy(vm.memberList[index]),vm.groupSelectOption=[];for(var j=0;j<vm.groupEditSection.groupAssociationList.length;j++)vm.groupSelectOption.push(vm.groupEditSection.groupAssociationList[j].name);ngDialog.open({template:"/sp/admin/member/editGroup",scope:$scope})}function isItEnabled(groupName,id){vm.classActivate=[];for(var i=0;i<vm.mainGroupInfoList.length;i++)if(groupName===vm.mainGroupInfoList[i].name&&null!==vm.mainGroupInfoList[i].groupLead&&vm.mainGroupInfoList[i].groupLead.email!==vm.EditGroupEmail){$timeout(function(){$("#mode_"+id).addClass("disabled"),$("#modeprop_"+id).addClass("disabled")},0);break}}function enableLeadDialog(leadValue,index,groupName){for(var i=0;i<vm.mainGroupInfoList.length;i++)if(groupName===vm.mainGroupInfoList[i].name){if(null!==vm.mainGroupInfoList[i].groupLead&&vm.mainGroupInfoList[i].groupLead.email!==vm.EditGroupEmail)return!1;vm.groupEditSection.groupAssociationList[index].groupLead=!leadValue}}function createSelect(modal){if(vm.setEditMode){var returnStatement=!0;return-1!==vm.groupSelectOption.indexOf(modal)&&(returnStatement=!1),returnStatement}return!1}function addGroupToModule(groupName,lead){return vm.selectedGroup=groupName,"default"===groupName?!1:(vm.groupEditSection.groupAssociationList.length&&""===vm.groupEditSection.groupAssociationList[0].name&&vm.groupEditSection.groupAssociationList.splice(0,1),vm.groupEditSection.groupAssociationList.push({name:groupName,groupLead:!1}),vm.groupSelectOption.push(groupName),void(vm.memberGroup="default"))}function saveGroupToModule(groupName){for(var newArr="",i=0;i<vm.groupEditSection.groupAssociationList.length;i++)if(newArr.length)newArr=newArr+","+vm.groupEditSection.groupAssociationList[i].name+":"+vm.groupEditSection.groupAssociationList[i].groupLead;else{if(""===vm.groupEditSection.groupAssociationList[i].name)return ngDialog.close("ngdialog1"),!1;newArr=vm.groupEditSection.groupAssociationList[i].name+":"+vm.groupEditSection.groupAssociationList[i].groupLead}var options={url:vm.config.saveGroupToModule,data:$.param({groupAssociationList:newArr,memberEmail:vm.groupEditSection.email})};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success){vm.groupEditSection.groupAssociationList.length?vm.memberList[vm.indexToChange]=vm.groupEditSection:(vm.groupEditSection.groupAssociationList.push({name:"",groupLead:!1}),vm.memberList[vm.indexToChange]=vm.groupEditSection);for(var i=0;i<vm.masterMemberList.length;i++)vm.masterMemberList[i].email===vm.memberList[vm.indexToChange].email&&(vm.masterMemberList[i]=vm.groupEditSection);vm.getGroupsData(),ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:" Group status updated successfully"})}else if(null!=response.error){ngDialog.close("ngdialog1");var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:errorMessage})}})}function removeGroupDialog(event,groupName){for(var _this=event.target,current=($(_this).closest(".blockGroup").remove(),""),i=0;i<vm.groupEditSection.groupAssociationList.length;i++)vm.groupEditSection.groupAssociationList[i].name===groupName.name&&(vm.groupEditSection.groupAssociationList.splice(i,1),current=i);vm.groupSelectOption.splice(current,1)}function confirmDelete(event,email){email=email;var eve=angular.element(event.currentTarget),options={url:vm.config.confirmDelete,data:$.param({memberEmail:email})};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success)sharedProperties.spilceIndexWithBreak(vm.masterMemberList,"email",email),sharedProperties.spilceIndexWithBreak(vm.memberList,"email",email),eve.scope().moreadvance=!eve.scope().moreadvance,!vm.alltoggle&&(vm.negative=!1,vm.pageSetting.userEmail.email=[]),vm.negative&&vm.checkAll(),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.member.deleteMessage")});else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function converToMember(f,l,e,c){vm.showHiringList=!1;var newHireDetails={firstName:f,lastName:l,email:e,candidateId:c};$localStorage.set("newHireDetails",newHireDetails).set("newHireCheck",!0),$timeout(function(){window.location.href=vm.config.addSingle},100)}function removeFromList(id){ajaxService.getAjaxResponse({url:vm.config.updateHiredAndMovedToMember,data:$.param({candidateId:vm.hiringCandidateId})}).then(function(response){"true"===response.Success&&(ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:"Candidate Removed"}),vm.showHiringList=!1,$timeout(function(){vm.getHiringCandidateList()},0))})}function showRemoveDialog(id){vm.hiringCandidateId=id,ngDialog.open({template:"/sp/resources/html/admin/member/deleteHiringConfirmation.html",scope:$scope})}function toggleAddNewHiresList(){vm.showHiringList=!vm.showHiringList}var vm=this;vm.memberList=[],vm.masterMemberList=[],vm.filterationRequired=!1,vm.showHiringList=!1,vm.tagListArray=[],vm.userStatus=[],vm.allMembersEmailId=[],vm.newHiresList=[],vm.checkedAll=!1,vm.negative=!1,vm.oneTime=!0,vm.updateGroup=!1,vm.groupModule=[],vm.mainGroupInfoList=[],vm.EditGroupEmail="",vm.setEditMode=!1,vm.showAddHireList=!1,vm.iamaccountadmin=!1,vm.masterCopy=!0,vm.responseRecieved=!1,vm.config={getMembersData:"/sp/admin/member",getHiringCandidateList:"/sp/admin/membersWithHired",getGroupsData:"/sp/admin/group/all",saveNewGroup:"/sp/admin/group/create",saveGroupToModule:"/sp/admin/group/memberGroupUpdate",confirmDelete:"/sp/admin/member/delete",updateHiredAndMovedToMember:"/sp/admin/member/updateHiredAndMovedToMember",addSingle:"/sp/admin/member/add/single"},vm.pageSetting={pageSize:10,intialPageSize:10,searchTag:[],filter:{},tags:[],userEmail:{email:[]},checkBox:[],statusInclude:[],userStatusSelected:null,lastPredicate:"name",lastReverse:!1,textSearching:"",disabledInfinite:!1,adminc:!1,leadC:!1},vm.originalpageSetting=angular.copy(vm.pageSetting),vm.getMembersData=getMembersData,vm.returnMemberList=returnMemberList,vm.autoCompleteType=autoCompleteType,vm.getHiringCandidateList=getHiringCandidateList,vm.getGroupsData=getGroupsData,vm.loadTags=loadTags,vm.tagAdded=tagAdded,vm.tagRemoved=tagRemoved,vm.includeCheck=includeCheck,vm.userStatusSelected=userStatusSelected,vm.infinteScroll=infinteScroll,vm.order=order,vm.searchTextFilter=searchTextFilter,vm.clearSearch=clearSearch,vm.active=active,vm.resetfilter=resetfilter,vm.checkAll=checkAll,vm.checkUncheck=checkUncheck,vm.createGroupCall=createGroupCall,vm.memberTakeAway=memberTakeAway,vm.editGroupSection=editGroupSection,vm.isItEnabled=isItEnabled,vm.enableLeadDialog=enableLeadDialog,vm.createSelect=createSelect,vm.addGroupToModule=addGroupToModule,vm.saveGroupToModule=saveGroupToModule,vm.removeGroupDialog=removeGroupDialog,vm.confirmDelete=confirmDelete,vm.converToMember=converToMember,vm.showRemoveDialog=showRemoveDialog,vm.removeFromList=removeFromList,vm.toggleAddNewHiresList=toggleAddNewHiresList,function(){var growlNotification=$localStorage.get("gNotify");null!==growlNotification&&$.growl({icon:"glyphicon glyphicon-ok",title:"single"===growlNotification?"<strong> Member</strong>":"<strong> Members</strong>",message:" added successfully"}),$localStorage.remove("newHireDetails","newHireCheck","gNotify","spProfileTab")}(),$scope.saveNewGroup=function(groupname,groupLeadEmailId){return $scope.errornewGroup=!1,$scope.errornewEmptyGroup=!1,$scope.savenewGroup=!1,""===groupname||"undefined"==typeof groupname?($scope.errornewEmptyGroup=!0,!1):void ajaxService.getAjaxResponse({url:vm.config.saveNewGroup,data:$.param({name:groupname})}).then(function(response){"true"===response.Success?(vm.mainGroupInfoList.push(response.groupInfo),vm.groupModule.push(response.groupInfo.name),$timeout(function(){vm.groupModuleSelected=response.groupInfo.name},0),ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.group.saveMessage")})):null!==response.error&&($scope.errornewGroup=!0,$timeout(function(){vm.groupModuleSelected=""},0))})},$scope.closeGroup=function(){ngDialog.close("ngdialog1")}}angular.module("spApp").controller("memberListController",memberListController),memberListController.$inject=["$scope","$q","ajaxService","$filter","ngDialog","sharedProperties","$timeout","$rootScope","$localStorage","$state"];
function addMemberController($scope,$http,$element,$attrs,ngDialog,ajaxService,$timeout,$localStorage){$scope.subscriptionStatus=0,$scope.subscriptionStatus.error=!1,$scope.groupDataSet={},$scope.groupDataSetBackup={},$scope.previousGroup=[],$scope.dataWithFlags=[],$scope.dataWithOrder=[],$scope.tagList=[],$scope.flagCounter=0,$scope.addMemberStatus={},$scope.addMemberStatus.serverError=!1,$scope.subscriptionStatus.error=!1,$scope.addMemberStatus.existingEmailError=!1,$scope.addMemberStatus.exceedEmailError=!1,$scope.addMemberEmailCount=0,$scope.emailCountError=!1,$scope.newOrderFlag=0,$scope.failedEmailList=[],$scope.failedEmailFlag=!1,$scope.addMemberStatus.inValidEmailError=!1,$scope.addMemberStatus.requiredError=!1,$scope.member={},$scope.newHireCheck=!1,$scope.errornewGroup=!1;var storedProfile=$localStorage.get("loggegdInProfile"),userRoles=storedProfile.member.roles.sort();if($scope.isAccountAdmin=0===jQuery.inArray("AccountAdministrator",userRoles)?!0:!1,null!==$localStorage.get("newHireDetails")){var newHireDetails=$localStorage.get("newHireDetails");$scope.member.firstName=newHireDetails.firstName,$scope.member.lastName=newHireDetails.lastName}null!==$localStorage.get("newHireCheck")?$scope.newHireCheck=!0:$scope.newHireCheck=!1,$scope.getSubscriptionStatus=function(){ajaxService.getAjaxResponse({url:"/sp/admin/member/availalbeMemberSubscriptions"}).then(function(response){if("true"===response.Success)$scope.subscriptionStatus=response.availalbeMemberSubscriptions,0===$scope.subscriptionStatus&&($scope.subscriptionStatusError=!0);else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.getSubscriptionStatus(),$scope.getGroupList=function(){ajaxService.getAjaxResponse({url:"/sp/admin/group/all"}).then(function(response){if("true"===response.Success)$scope.groupDataSet=response.groupInfoList,$scope.groupDataSetBackup=response.groupInfoList,jQuery.each($scope.groupDataSet,function(i,j){$scope.dataWithFlags.push(jQuery.extend({},$scope.groupDataSet[i],{selectedFlag:!1,isGroupLead:!1}))}),$scope.flagCounter=$scope.dataWithFlags.length;else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.getGroupList(),$scope.callCancel=function(){window.location="/sp/admin/memberListing#/member"},$scope.callRedirect=function(go){go===!0&&(window.location="/sp/admin/memberListing#/member")},$scope.updateTagList=function(single,multiple){$scope.member.groupAssociationList=null,$scope.tagList=[],jQuery.each($scope.dataWithFlags,function(i,j){$scope.dataWithFlags[i].selectedFlag===!0&&multiple===!0?$scope.tagList.push($scope.dataWithFlags[i].name):$scope.dataWithFlags[i].selectedFlag===!0&&single===!0&&($scope.dataWithFlags[i].isGroupLead===!0?$scope.tagList.push($scope.dataWithFlags[i].name+":true"):$scope.tagList.push($scope.dataWithFlags[i].name+":false")),$scope.member.groupAssociationList=$scope.tagList.join()})},$scope.updateGroupLeadStatus=function(i,email,single,multiple){"undefined"!=typeof $scope.dataWithFlags[i]&&null===email&&($scope.dataWithFlags[i].isGroupLead===!0?$scope.dataWithFlags[i].isGroupLead=!1:$scope.dataWithFlags[i].isGroupLead=!0,$scope.updateTagList(single,multiple))},$scope.changeGroup=function(flag,single,multiple){"default"!==flag&&("createGroupCall_custom"===flag?($scope.params={p1:single,p2:multiple},$scope.errornewEmptyGroup=!1,$scope.errornewGroup=!1,ngDialog.open({template:"/sp/admin/group/createGroup",scope:$scope}),$scope.member.gList="default"):($scope.dataWithFlags[flag].selectedFlag=!0,$scope.flagCounter-=1,$scope.updateTagList(single,multiple),$scope.member.gList="default",$scope.dataWithFlags[flag].newOrder=$scope.newOrderFlag++,$scope.dataWithFlags[flag].originalIndex=flag))},$scope.removeGroup=function(flag,single,multiple){"default"!==flag&&($scope.dataWithFlags[flag].selectedFlag=!1,$scope.dataWithFlags[flag].isGroupLead=!1,$scope.flagCounter+=1,$scope.updateTagList(single,multiple))},$scope.addSingleMember=function(fData){$scope.addMember.submitted=!1,$scope.addMemberStatus={},$scope.addMember.$valid?ajaxService.getAjaxResponse({url:"/sp/admin/member/addSingle",data:$.param(fData).replace(/%2C/g,",")}).then(function(response){"true"===response.Success?($scope.addMemberStatus=response,$scope.addMemberStatus.title="Add Member",$localStorage.remove("newHireDetails","newHireCheck"),$localStorage.set("gNotify","single"),setTimeout(function(){window.location="/sp/admin/memberListing#/member"},100)):($scope.addMemberStatus.serverError=!0,$scope.addMemberStatus.content=response.error)}):$scope.addMember.submitted=!0},$scope.highlightTags=function(list){var tagContainer=jQuery("body").find(".add-member").find("p.emailTags").find(".tagsinput"),emailList=list;jQuery.each(jQuery(tagContainer).find("span.tag"),function(i,j){var tagEmail=jQuery(this).find("span").attr("data-email"),existingEmail=jQuery.inArray(tagEmail,emailList);-1!==existingEmail&&jQuery(j).addClass("error-email")})},$scope.searchExistingEmailList=function(fData){$scope.addMemberStatus.requiredError=!1;var updatedEmailList=fData.memberList.split(",").unique(),_param={memberList:updatedEmailList.toString()};"undefined"!=typeof fData.memberList?ajaxService.getAjaxResponse({url:"/sp/signup/validateEmails",data:$.param(_param).replace(/%2C/g,",").replace(/%40/g,"@")}).then(function(response){if("true"===response.Success&&0===response.failureList.length)$scope.failedEmailList=[],$scope.failedEmailFlag=!1,$scope.addMemberStatus.existingEmailError=!1,$scope.addMultipleMembers(fData);else if("true"===response.Success&&response.failureList.length>0)$scope.addMemberStatus.existingEmailError=!0,$scope.failedEmailList=response.failureList,$scope.failedEmailFlag=!0,$scope.highlightTags($scope.failedEmailList);else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}}):$scope.addMemberStatus.requiredError=!0},$scope.addMultipleMembers=function(fData){var updatedEmailList=fData.memberList.split(",").unique();fData.memberList=updatedEmailList.toString(),$scope.addMember.submitted=!1,$scope.emailCountError=!1,$scope.getSubscriptionStatus(),$scope.addMemberEmailCount>$scope.subscriptionStatus?$scope.emailCountError=!0:$scope.addMember.$valid?ajaxService.getAjaxResponse({url:"/sp/admin/member/addMultiple",data:$.param(fData).replace(/%2C/g,",").replace(/%40/g,"@")}).then(function(response){if($scope.addMemberStatus=response,$scope.addMemberStatus.title="Add members","true"===response.Success&&0===response.failureList.length)$localStorage.set("gNotify","multiple"),setTimeout(function(){window.location="/sp/admin/memberListing#/member"},100);else if("true"===response.Success&&response.failureList.length>0)$scope.serverError=!0,$scope.errorMessage="Server exception: Failed to add "+response.failureList.join(", ");else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}}):$scope.addMember.submitted=!0},$scope.saveNewGroup=function(groupname,groupLeadEmailId){if($scope.errornewEmptyGroup=!1,$scope.errornewGroup=!1,""===groupname||"undefined"==typeof groupname)return $scope.errornewEmptyGroup=!0,!1;var obj={name:groupname},options={url:"/sp/admin/group/create",data:$.param(obj)};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?(ngDialog.close("ngdialog1"),$scope.dataWithFlags.push({name:groupname,groupLead:null,numOfMembers:0,memberSummaryList:null,selectedFlag:!0,originalIndex:$scope.dataWithFlags.length,newOrder:$scope.newOrderFlag}),$scope.flagCounter-=1,$scope.member.gList="default",$scope.newOrderFlag+=1,$scope.updateTagList($scope.params.p1,$scope.params.p2)):null!=response.error&&($scope.member.gList="default",$scope.errornewGroup=!0)})},$scope.closeGroup=function(){$scope.member.gList="default",ngDialog.close("ngdialog1")}}angular.module("spApp").controller("addMemberController",addMemberController),addMemberController.$inject=["$scope","$http","$element","$attrs","ngDialog","ajaxService","$timeout","$localStorage"];
function adminLibraryHomeController($scope,$q,$element,$attrs,ajaxService,$location,$http,$state,$filter,ngDialog,sharedProperties,$timeout,$rootScope,$localStorage){$scope.libraryHomeList=[],$scope.getAllError=!1,$scope.searchTag=[],$scope.pageSize=10,$scope.statusInclude=[],$scope.textSearching="",$scope.intialPageSize=10,$scope.load=!0,$scope.getLibraryHomeList=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/library/getAll"}).then(function(response){if("true"===response.Success)$scope.getAllError=!1,$scope.libraryHomeList=response.company,$scope.returnMemberList($scope.pageSize),$localStorage.set("companyLibraryHomeList",$scope.libraryHomeList);else{$scope.getAllError=!0;for(var err in response.error)$scope.getAllErrorMsg=response.error[err]}})},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.returnMemberList($scope.pageSize)},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize))},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.returnMemberList=function(pageSize){if($scope.searchTag.length&&!$scope.statusInclude.length&&($scope.libraryHomeList=angular.copy($scope.newArr)),$scope.searchTag.length&&$scope.statusInclude.length){$scope.combineArray=[];for(var i=0;i<$scope.newArr.length;i++)for(var j=0;j<$scope.checkBox.length;j++)$scope.newArr[i].email===$scope.checkBox[j].email&&$scope.combineArray.push($scope.newArr[i]);$scope.libraryHomeList=angular.copy($scope.combineArray)}!$scope.searchTag.length&&$scope.statusInclude.length&&($scope.libraryHomeList=angular.copy($scope.checkBox)),$scope.searchTag.length||$scope.statusInclude.length||($scope.libraryHomeList=angular.copy($scope.libraryHomeList)),$scope.pageSize=pageSize,pageSize>=$scope.libraryHomeList.length&&($scope.disabledInfinite=!0,$scope.pageSize=$scope.libraryHomeList.length),$scope.load&&($scope.lastPredicate="name",$scope.lastReverse=!1,$scope.loadBtnCLicked=!1,$scope.load=!1),$scope.loadBtnCLicked&&($scope.loadBtnCLicked=!1),$scope.order($scope.lastPredicate,$scope.lastReverse),$scope.libraryHomeList=$scope.libraryHomeList},$scope.active=function(event){var currentElem=$(event.currentTarget);currentElem.find("h4").hasClass("on")?currentElem.find("h4").hasClass("reverseon")?currentElem.find("h4").removeClass("reverseon"):currentElem.find("h4").addClass("reverseon"):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"))},$scope.order=function(predicate,reverse){$scope.lastPredicate=predicate,$scope.lastReverse=reverse,$scope.libraryHomeList=$filter("orderBy")($scope.libraryHomeList,predicate,reverse)},$scope.resetfilter=function(allmembers){$scope.pageSize=$scope.intialPageSize,$scope.newArr=[],$scope.searchTag=[],$scope.tags=[],$scope.filter={},$scope.statusInclude=[],$scope.adminc=!1,$scope.leadC=!1,$scope.textSearching="",$scope.searchText="","undefined"!=typeof this.selectedSearch&&(this.selectedSearch.userStatusFormatted="",this.selectedSearch.hiringRoles=""),$scope.libraryHomeList=angular.copy($scope.libraryHomeList),"undefined"!=typeof allmembers&&($scope.pageSize=$scope.libraryHomeList.length),angular.element($(".tags").find("input")).scope().newTag.text="",$scope.load=!0,$scope.disabledInfinite=!1,$rootScope.$broadcast("$scrollStart"),$scope.returnMemberList($scope.pageSize);var curr=$(".memberHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")},$scope.updateStatusError=!1,$scope.deleteCompanyLibraryInfo=function(compId){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/library/delete",data:$.param({companyId:compId})}).then(function(response){if("true"===response.Success)$scope.updateStatusError=!1,ngDialog.close("ngdialog1"),$scope.getLibraryHomeList(),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Record</strong>",message:" deleted successfully"});else{$scope.updateStatusError=!0;for(var err in response.error)$scope.updateStatusErrorMsg=response.error[err];ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.updateStatusErrorMsg})}}),window.location.reload()},$scope.deleteConfirm=function(deleteId,name){$scope.compId=deleteId,$scope.compName=name,ngDialog.open({template:"/sp/resources/html/sysAdmin/curriculam/deleteCompanyHome.html",scope:$scope})},$scope.createLibraryHomeLink=function(type){null!=type&&"business"===type?window.location="/sp/sysAdmin/curriculam/libraryHomeDetails?cid=business":null!=type&&"individual"===type&&(window.location="/sp/sysAdmin/curriculam/libraryHomeDetails?cid=individual")},$scope.articleWorkFlow=function(reqUrl,key){ajaxService.getAjaxResponse({url:reqUrl,method:"get"}).then(function(response){if("true"===response.Success)"articleReload"!==key&&$.growl({icon:"glyphicon glyphicon-ok",message:"Request Processed"});else if(null!=response.error){for(var err in response.error)$scope.errorMessage=response.error[err];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}}),"articleReload"===key&&$.growl({icon:"glyphicon glyphicon-ok",message:"Request Submitted to Server"})},$scope.getReadabilityScore=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/readability",method:"get"}).then(function(response){"true"===response.Success?($scope.score=response.readability.currentScore.toFixed(2),ngDialog.open({template:"/sp/resources/html/sysAdmin/curriculam/readabilityScore.html",scope:$scope})):$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:"There was some error in processing your request."})})},function(){$scope.getLibraryHomeList()}()}angular.module("spApp").controller("adminLibraryHomeController",adminLibraryHomeController),adminLibraryHomeController.$inject=["$scope","$q","$element","$attrs","ajaxService","$location","$http","$state","$filter","ngDialog","sharedProperties","$timeout","$rootScope","$localStorage"];
function adminMediaController($scope,ajaxService,$localStorage,ngDialog,sharedProperties,filterFilter,$filter,$rootScope,$timeout,$element){function uploadMediaFile(formData){formData.tags=self.tags;var _params={};if(self.uploadFormSubmitted=!1,self.uploadMediaForm.$valid&&null!==self.imageData){_params=$.extend({},{image:self.imageData},formData);var options={url:self.serviceApis.uploadImage,data:$.param(_params)};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?($.growl({icon:"glyphicon glyphicon-ok",message:" Media uploaded Successfully"}),"upload"===$rootScope.mediaView?($localStorage.set("mediaData",response.mediaInfo),delete $rootScope.mediaView,ngDialog.close()):$timeout(function(){window.location.href="/sp/media/listPage"},500)):$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:"Image upload failed."})})}else self.uploadFormSubmitted=!0}function cancelRedirect(){window.location.href="/sp/media/listPage"}function switchView(type){$rootScope.mediaView=type}var self=this;self.serviceApis={uploadImage:"/sp/media/save"},self.media={},self.hasValidationErrors=!1,self.uploadFormSubmitted=!1,self.imageData=null,self.media.mediaType="IMAGE",self.tags="",self.cancelRedirect=cancelRedirect,self.uploadMediaFile=uploadMediaFile,self.switchView=switchView,jQuery(".select-image-btn").on("click",function(e){e.preventDefault();var fileInput=jQuery("input:file");fileInput.click(),$scope.$apply()}),jQuery("input:file").change(function(){var preview=document.querySelector("img.image-preview"),fr=new FileReader;fr.onload=function(){var img=new Image;img.onload=function(){self.media.width=img.width,self.media.height=img.height,self.imageData=img.src},img.src=fr.result,preview.src=fr.result},fr.readAsDataURL(this.files[0])})}function adminMediaUpdateController($scope,ajaxService,$localStorage,ngDialog,sharedProperties,filterFilter,$filter,$rootScope,$timeout,$element){function cancelRedirect(){window.location.href="/sp/media/listPage"}function updateImage(formData){formData.tags=self.tags;var _params={};if(self.uploadFormSubmitted=!1,self.uploadMediaForm.$valid){_params=formData;var options={url:self.serviceApis.updateImage,data:$.param(_params)};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?($.growl({icon:"glyphicon glyphicon-ok",message:" Media updated Successfully"}),$timeout(function(){window.location.href="/sp/media/listPage"},500)):$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:"Image update failed."})})}else self.uploadFormSubmitted=!0}var self=this;self.serviceApis={getImage:"/sp/media/get",updateImage:"/sp/media/update"},self.media={},self.hasValidationErrors=!1,self.uploadFormSubmitted=!1,self.updateImage=updateImage,self.cancelRedirect=cancelRedirect,self.tags="";var getParameter=function(val){for(var query=window.location.search.substring(1),vars=query.split("&"),pair=[],i=0;i<vars.length;i++)return pair=vars[i].split("="),pair[0]===val?pair[1]:null},getImage=function(id){ajaxService.getAjaxResponse({url:self.serviceApis.getImage,data:$.param({id:id}),method:"POST"}).then(function(response){if("true"===response.Success)self.media=response.mediaInfo,0===self.media.tags.length?self.tags="":self.tags=self.media.tags.length>1?self.media.tags.join(","):self.media.tags[0];else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})};!function(){var param=getParameter("id");null!==param?getImage(param):window.location.href="/sp/media/uploadPage"}()}angular.module("spApp").controller("adminMediaController",adminMediaController),angular.module("spApp").controller("adminMediaUpdateController",adminMediaUpdateController),adminMediaController.$inject=["$scope","ajaxService","$localStorage","ngDialog","sharedProperties","filterFilter","$filter","$rootScope","$timeout","$element"],adminMediaUpdateController.$inject=["$scope","ajaxService","$localStorage","ngDialog","sharedProperties","filterFilter","$filter","$rootScope","$timeout","$element"];
function adminMediaListingController($scope,ajaxService,$localStorage,ngDialog,sharedProperties,filterFilter,$filter,$rootScope){function deleteImageModal(deleteId,imagePath){$scope.deleteId=deleteId,$scope.imagePath=imagePath,ngDialog.open({template:"/sp/resources/html/sysAdmin/media/delete-modal.html",scope:$scope})}function deleteImage(id,path){ajaxService.getAjaxResponse({url:self.serviceApis.deleteImage,data:$.param({imageId:id,imagePath:path})}).then(function(response){if("true"===response.Success)sharedProperties.spilceIndexWithBreak(self.masterImageList,"id",id),self.imageList=angular.copy(self.masterImageList),ngDialog.close(),$.growl({icon:"glyphicon glyphicon-ok",message:"Media Deleted Successfully"});else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function previewImage(imageUrl,name){$scope.mediaUrl=imageUrl,$scope.mediaName=name,ngDialog.open({template:"/sp/resources/html/sysAdmin/media/view-modal.html",scope:$scope})}function filterResults(){var filtered=[];""!==self.searchText?(filtered=filterFilter(self.masterImageList,self.searchText),self.showClearSearchIcon=!0):(filtered=self.masterImageList,self.showClearSearchIcon=!1),self.imageList=filtered,filtered=[]}function clearSearch(){""!==self.searchText&&(self.showClearSearchIcon=!1,self.searchText=""),self.filterResults()}function active(event,setting){self.lastPredicate=setting.predicate,self.lastReverse=setting.reverse,sharedProperties.toggleFilterClick(event,self.lastPredicate),self.sortResults(self.lastPredicate,self.lastReverse)}function sortResults(predicate,reverse){self.lastPredicate=predicate,self.lastReverse=reverse,self.imageList=$filter("orderBy")(self.imageList,predicate,reverse)}function selectImageModal(){sharedProperties.openMediaModal()}var self=this;self.serviceApis={getAllImages:"/sp/media/getAll",deleteImage:"/sp/media/delete"},self.media={},self.masterImageList=[],self.imageList=[],self.responseAvailable=!1,self.imageId="",self.showClearSearchIcon=!1,self.searchText="",self.lastPredicate="name",self.lastReverse=!1,self.viewType="Grid",self.getAllImages=getAllImages,self.deleteImage=deleteImage,self.deleteImageModal=deleteImageModal,self.previewImage=previewImage,self.filterResults=filterResults,self.active=active,self.sortResults=sortResults,self.clearSearch=clearSearch,self.selectImageModal=selectImageModal;var getAllImages=function(){ajaxService.getAjaxResponse({url:self.serviceApis.getAllImages,method:"GET"}).then(function(response){if("true"===response.Success)self.responseAvailable=!0,self.masterImageList=response.mediaList,self.imageList=angular.copy(self.masterImageList);else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})};!function(){getAllImages()}()}angular.module("spApp").controller("adminMediaListingController",adminMediaListingController),adminMediaListingController.$inject=["$scope","ajaxService","$localStorage","ngDialog","sharedProperties","filterFilter","$filter","$rootScope"];
function affiliateCodeDetailsController($scope,$element,$attrs,ngDialog,$timeout,sharedProperties,ajaxService,$rootScope,$localStorage){$scope.affiliateCodeDetailsEdit={},$scope.affiliateCodeDetailsEdit.status=!0,$scope.affliliateCode={},$scope.createAffiliateCode={},$scope.createAffiliateCode.validationError=!1,$scope.createCodeError=!1,$scope.updateAffiliateCode=function(fData){var formattedDate=function(d){if("object"==typeof d){var _dm="undefined"!=typeof d?d.getMonth()+1:0,_dd="undefined"!=typeof d?d.getDate():0,_dy="undefined"!=typeof d?d.getFullYear():0,_dDate=(10>_dm?"0"+_dm:_dm)+"/"+(10>_dd?"0"+_dd:_dd)+"/"+_dy;return _dDate}return"string"==typeof d?d:void 0}(fData.endDate);if(fData.endDate=formattedDate,fData.code=$scope.existingPromoDetails.code,fData.promotionId=$scope.existingPromoDetails.id,$scope.productsError===!1){$scope.createAffiliateCode.validationError=!1;var vCount=0;for(var k in fData)("default"===fData[k]||"default1"===fData[k])&&vCount++;$scope.createAffiliateCode.$valid&&0===vCount&&fData.unitPrice>0?ajaxService.getAjaxResponse({url:"/sp/sysAdmin/promotions/update",data:$.param(fData).replace(/%2F/g,"/")}).then(function(response){if("true"===response.Success)$scope.createCodeError=!1,$scope.affiliateCodeDetailsEdit.status=!0,"undefined"!==$scope.urlPromoId&&$scope.urlPromoId!==!1&&$scope.getPromoDetails($scope.urlPromoId),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Details</strong>",message:" updated successfully"});else{$scope.createCodeError=!0;for(var key in response.error)$scope.createCodeErrorMsg=response.error[key]}}):$scope.createAffiliateCode.validationError=!0}},$scope.productsError=!1,$scope.getAvailableProducts=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/promotions/getProducts"}).then(function(response){if("true"===response.Success)$scope.productsError=!1,$scope.productList=response.product;else{$scope.productsError=!0;for(var key in response.error)$scope.productsErrorMsg=response.error[key]}})},$scope.getDetailsError=!1,$scope.existingTags=null,$scope.getPromoDetails=function(pid){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/promotions/getDetails",data:$.param({promotionId:pid})}).then(function(response){if("true"===response.Success)$scope.getDetailsError=!1,$scope.existingPromoDetails=response.promotion,$scope.affliliateCode.productList=$scope.existingPromoDetails.productList[0].id,$scope.affliliateCode.promotionType=$scope.existingPromoDetails.promotionType,$scope.affliliateCode.unitPrice=$scope.existingPromoDetails.unitPrice,$scope.affliliateCode.endDate=($scope.existingPromoDetails.endDate.monthValue<10?"0"+$scope.existingPromoDetails.endDate.monthValue:$scope.existingPromoDetails.endDate.monthValue)+"/"+($scope.existingPromoDetails.endDate.dayOfMonth<10?"0"+$scope.existingPromoDetails.endDate.dayOfMonth:$scope.existingPromoDetails.endDate.dayOfMonth)+"/"+$scope.existingPromoDetails.endDate.year,"undefined"!=typeof $scope.existingPromoDetails.count&&($scope.affliliateCode.count=$scope.existingPromoDetails.count),$scope.existingPromoDetails.tags.length>0?$scope.existingTags=$scope.existingPromoDetails.tags.length>1?$scope.existingPromoDetails.tags.join(","):$scope.existingPromoDetails.tags[0]:$scope.existingTags=null,$scope.affliliateCode.message=$scope.existingPromoDetails.message,$scope.affliliateCode.status=$scope.existingPromoDetails.status;else{$scope.getDetailsError=!0;for(var key in response.error)$scope.getDetailsErrorMsg=response.error[key]}})},$scope.searchInAccounts=null,$scope.clearSearch=function(){$scope.searchInAccounts=null},$scope.enableEdit=function(){$scope.affiliateCodeDetailsEdit.status=!1},$scope.disableEdit=function(){$scope.affiliateCodeDetailsEdit.status=!0,"undefined"!==$scope.urlPromoId&&$scope.urlPromoId!==!1&&$scope.getPromoDetails($scope.urlPromoId)},$scope.getURLPromoId=function(){var url=window.location.href,splitUrl=url.split("?")[1];"undefined"!=typeof splitUrl?$scope.urlPromoId=splitUrl.split("=")[1]:$scope.urlPromoId=null},$scope.getAccountsError=!1,$scope.getAccountDetails=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/promotions/accounts",data:$.param({promotionId:$scope.urlPromoId})}).then(function(response){if("true"===response.Success)$scope.getAccountsError=!1,$scope.accountsList=response.account;else{$scope.getAccountsError=!0;for(var key in response.error)$scope.getAccountsErrorMsg=response.error[key]}})},function(){$scope.getURLPromoId(),$scope.getAvailableProducts(),"undefined"!==$scope.urlPromoId&&$scope.urlPromoId!==!1&&($scope.getPromoDetails($scope.urlPromoId),$scope.getAccountDetails())}()}angular.module("spApp").controller("affiliateCodeDetailsController",affiliateCodeDetailsController),affiliateCodeDetailsController.$inject=["$scope","$element","$attrs","ngDialog","$timeout","sharedProperties","ajaxService","$rootScope","$localStorage"];
function affiliateCodeListingController($scope,$q,$element,$attrs,ajaxService,$location,$http,$state,$filter,ngDialog,sharedProperties,$timeout,$rootScope,$localStorage){$scope.affiliateCodeListMaster=[],$scope.getAllError=!1,$scope.searchTag=[],$scope.pageSize=10,$scope.statusInclude=[],$scope.textSearching="",$scope.intialPageSize=10,$scope.load=!0,$scope.formatMonth=function(d){if(null!==d&&"undefined"!=typeof d){var splitDate=d.split(" "),formatMonth=splitDate[0].substr(0,3).toUpperCase(),formattedDate=formatMonth+" "+splitDate[1]+" "+splitDate[2];return formattedDate}},$scope.getAllAffiliateCodes=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/promotions/getAll"}).then(function(response){if("true"===response.Success)$scope.getAllError=!1,$scope.affiliateCodeListMaster=response.promotion,$scope.returnMemberList($scope.pageSize);else{$scope.getAllError=!0;for(var key in response.error)$scope.getAllErrorMsg=response.error[key]}})},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.returnMemberList($scope.pageSize)},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize))},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.returnMemberList=function(pageSize){if(!$scope.affiliateCodeListMaster.length)return!0;if($scope.searchTag.length&&!$scope.statusInclude.length&&($scope.affiliateCodeList=angular.copy($scope.newArr)),$scope.searchTag.length&&$scope.statusInclude.length){$scope.combineArray=[];for(var i=0;i<$scope.newArr.length;i++)for(var j=0;j<$scope.checkBox.length;j++)$scope.newArr[i].email===$scope.checkBox[j].email&&$scope.combineArray.push($scope.newArr[i]);$scope.affiliateCodeList=angular.copy($scope.combineArray)}!$scope.searchTag.length&&$scope.statusInclude.length&&($scope.affiliateCodeList=angular.copy($scope.checkBox)),$scope.searchTag.length||$scope.statusInclude.length||($scope.affiliateCodeList=angular.copy($scope.affiliateCodeListMaster)),$scope.pageSize=pageSize,pageSize>=$scope.affiliateCodeListMaster.length&&($scope.disabledInfinite=!0,$scope.pageSize=$scope.affiliateCodeListMaster.length),$scope.load&&($scope.lastPredicate="code",$scope.lastReverse=!0,$scope.loadBtnCLicked=!1,$scope.load=!1),$scope.loadBtnCLicked&&($scope.loadBtnCLicked=!1),$scope.order($scope.lastPredicate,$scope.lastReverse),$scope.affiliateCodeList=$scope.affiliateCodeList},$scope.active=function(event){var currentElem=$(event.currentTarget);currentElem.find("h4").hasClass("on")?currentElem.find("h4").hasClass("reverseon")?currentElem.find("h4").removeClass("reverseon"):currentElem.find("h4").addClass("reverseon"):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"))},$scope.order=function(predicate,reverse){$scope.lastPredicate=predicate,$scope.lastReverse=reverse,$scope.affiliateCodeList=$filter("orderBy")($scope.affiliateCodeList,predicate,reverse)},$scope.resetfilter=function(allmembers){$scope.pageSize=$scope.intialPageSize,$scope.newArr=[],$scope.searchTag=[],$scope.tags=[],$scope.filter={},$scope.statusInclude=[],$scope.adminc=!1,$scope.leadC=!1,$scope.textSearching="",$scope.searchText="","undefined"!=typeof this.selectedSearch&&(this.selectedSearch.userStatusFormatted="",this.selectedSearch.hiringRoles=""),$scope.affiliateCodeList=angular.copy($scope.affiliateCodeListMaster),"undefined"!=typeof allmembers&&($scope.pageSize=$scope.affiliateCodeListMaster.length),angular.element($(".tags").find("input")).scope().newTag.text="",$scope.load=!0,$scope.disabledInfinite=!1,$rootScope.$broadcast("$scrollStart"),$scope.returnMemberList($scope.pageSize);var curr=$(".memberHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")},$scope.updateStatusError=!1,$scope.updateAffiliateCodeStatus=function(status,pid){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/promotions/updateStatus",data:$.param({promotionId:pid,promotionStatus:status})}).then(function(response){if("true"===response.Success)$scope.updateStatusError=!1,ngDialog.close("ngdialog1"),$scope.getAllAffiliateCodes(),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Status</strong>",message:" updated successfully"});else{$scope.updateStatusError=!0;for(var key in response.error)$scope.updateStatusErrorMsg=response.error[key];ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.updateStatusErrorMsg})}})},$scope.deleteConfirm=function(d){$scope.afid=d,ngDialog.open({template:"/sp/resources/html/sysAdmin/affiliateCode/deleteConfirmation.html",scope:$scope})},function(){var growlNotification=$localStorage.get("gNotify");null!==growlNotification&&"undefined"!=typeof growlNotification&&("AddCode"===growlNotification&&$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Code</strong>",message:" generated successfully"}),setTimeout(function(){$localStorage.remove("gNotify")},1e3)),$scope.getAllAffiliateCodes()}()}angular.module("spApp").controller("affiliateCodeListingController",affiliateCodeListingController),affiliateCodeListingController.$inject=["$scope","$q","$element","$attrs","ajaxService","$location","$http","$state","$filter","ngDialog","sharedProperties","$timeout","$rootScope","$localStorage"];
function alternateBilling($scope,$element,ajaxService,$filter,ngDialog,sharedProperties,$timeout,$rootScope,$localStorage){$scope.abMasterList=[],$scope.getAllError=!1,$scope.searchTag=[],$scope.pageSize=10,$scope.statusInclude=[],$scope.textSearching="",$scope.intialPageSize=10,$scope.load=!0,$scope.updateStatusError=!1,$scope.accountDetails=null,$scope.submitted=!1,$scope.accountList={},$scope.currentId=null,$scope.signup={},$scope.imports={},$timeout(function(){$scope.imports.cpt=-1,$scope.signup.paymentAgreement=-1,$scope.signup.paymentType=-1},0),$scope.imports.camount=null,$scope.ptype=!1,$scope.errorMessage=!1;var config={getAllAccount:"/sp/sysAdmin/alternateBilling/getAllAccounts",fetchAccountDetails:"/sp/sysAdmin/alternateBilling/account/businessAccountDetails",fetchAccountDetailsIndividual:"/sp/sysAdmin/alternateBilling/account/individualAccountDetails"};$scope.formatMonth=function(d){if(null!==d&&"undefined"!=typeof d){var splitDate=d.split(" "),formatMonth=splitDate[0].substr(0,3).toUpperCase(),formattedDate=formatMonth+" "+splitDate[1]+" "+splitDate[2];return formattedDate}},$scope.getResponse=function(type,existingAccount){$scope.mode=type,ajaxService.getAjaxResponse({url:config.getAllAccount,data:$.param({accountType:type,isExistingAccount:existingAccount})}).then(function(response){if("true"===response.Success)$scope.getAllError=!1,$scope.abMasterList=response.accountDetails,$scope.abMasterList.length&&!existingAccount&&$scope.returnMemberList($scope.pageSize);else{$scope.getAllError=!0;for(var key in response.error)$scope.getAllErrorMsg=response.error[key]}})},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.returnMemberList($scope.pageSize)},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize))},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.returnMemberList=function(pageSize){return $scope.abMasterList.length?($scope.pageSize=pageSize,pageSize>=$scope.abMasterList.length&&($scope.disabledInfinite=!0,$scope.pageSize=$scope.abMasterList.length),$scope.load&&($scope.lastPredicate="Individual"===$scope.mode?"memberName":"companyName",$scope.lastReverse=!1,$scope.load=!1),$scope.abList=$scope.abMasterList,void $scope.order($scope.lastPredicate,$scope.lastReverse)):!0},$scope.active=function(event){var currentElem=$(event.currentTarget);currentElem.find("h4").hasClass("on")?currentElem.find("h4").hasClass("reverseon")?currentElem.find("h4").removeClass("reverseon"):currentElem.find("h4").addClass("reverseon"):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"))},$scope.order=function(predicate,reverse){$scope.lastPredicate=predicate,$scope.lastReverse=reverse,$scope.abList=$filter("orderBy")($scope.abList,predicate,reverse)},$scope.resetfilter=function(allmembers){$scope.pageSize=$scope.intialPageSize,$scope.newArr=[],$scope.searchTag=[],$scope.tags=[],$scope.filter={},$scope.statusInclude=[],$scope.adminc=!1,$scope.leadC=!1,$scope.textSearching="",$scope.searchText="","undefined"!=typeof $scope.selectedSearch&&($scope.selectedSearch.userStatusFormatted="",$scope.selectedSearch.hiringRoles=""),$scope.abList=angular.copy($scope.abMasterList),"undefined"!=typeof allmembers&&($scope.pageSize=$scope.abMasterList.length),$scope.load=!0,$scope.disabledInfinite=!1,$rootScope.$broadcast("$scrollStart"),$scope.returnMemberList($scope.pageSize);var curr=$(".memberHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")},$scope.activateAccount=function(pid,status){var url="/sp/sysAdmin/alternateBilling/account/reActivateAccount",mode=!1;"INACTIVE"===status&&(url="/sp/sysAdmin/alternateBilling/account/deactivateAccount",mode=!0),ajaxService.getAjaxResponse({url:url,data:$.param({accountId:pid})}).then(function(response){if("true"===response.Success){for(var i=0;i<$scope.abMasterList.length;i++)if($scope.abMasterList[i].id===pid){$scope.abMasterList[i].deactivated=mode;break}$scope.returnMemberList($scope.pageSize),ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Status</strong>",message:" updated successfully"})}else{ngDialog.close("ngdialog1"),$scope.updateStatusError=!0;for(var key in response.error)$scope.updateStatusErrorMsg=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.updateStatusErrorMsg})}})},$scope.deleteConfirm=function(d){$scope.afid=d,ngDialog.open({template:"/sp/resources/html/sysAdmin/alternateBilling/deleteConfirmation.html",scope:$scope})},$scope.fetchAccountDetails=function(accountId,accountDetails){return $scope.currentId===accountId?!0:($scope.currentId=accountId,$scope.submitted=!1,$scope.detailModule=accountDetails,void ajaxService.getAjaxResponse({url:"b"===accountDetails.mode?config.fetchAccountDetails:config.fetchAccountDetailsIndividual,data:$.param({accountId:accountId})}).then(function(response){if("true"===response.Success)$scope.accountDetails=null,$scope.accountDetails=response,$scope.errorMessage=!1,$scope.signup.paymentAgreement=response.account.agreementterm||1,$scope.signup.paymentType=0,$timeout(function(){$scope.imports.cpt=-1},0),$scope.imports.camount=null,$scope.imports.ccomment=null;else{for(var key in response.error)$scope.updateStatusErrorMsg=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.updateStatusErrorMsg})}}))},$scope.validateSendResponse=function(){if($scope.submitted=!1,$scope.errorMessage=!1,$scope.ptype=!1,null===$scope.accountDetails)return $scope.errorMessage=!0,!0;if(this.importAccount.$valid&&-1!==parseInt(this.imports.cpt)){var obj={chargeAmount:this.imports.camount,isTrial:"TRIAL"===this.imports.cpt?!0:!1,paymentType:this.imports.cpt,comment:this.imports.ccomment,accountId:this.accountDetails.account.id},options={url:"/sp/sysAdmin/alternateBilling/account/importExisting",data:$.param(obj)};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success){$.growl({icon:"glyphicon glyphicon-ok",message:" Account imported successfully"});for(var i=0;i<$scope.abMasterList.length;i++)if($scope.abMasterList[i].id===$scope.accountDetails.account.id){$scope.abMasterList.splice(i,1),$("html,body").animate({scrollTop:$(".bgWhiteBord").offset().top-20},300);break}$scope.accountDetails=null,$scope.accountList.search=null,$scope.currentId=null,$timeout(function(){$scope.imports.cpt=-1,$scope.signup.paymentAgreement=-1,$scope.signup.paymentType=-1},0),$scope.imports.camount=null,$scope.imports.ccomment=null}else null!==response.error&&($scope.failure=response.error,$scope.sfailure=!0)})}else{$scope.submitted=!0,-1===parseInt(this.imports.cpt)&&($scope.ptype=!0);var elem=angular.element($element);$(elem).find("form .ng-invalid:first").length&&$("html,body").animate({scrollTop:$(elem).find("form .ng-invalid:first").offset().top-20},300)}},$scope.backToDefault=function(){$scope.accountDetails=null,$scope.accountList.search=null,$scope.currentId=null,$timeout(function(){$scope.imports.cpt=-1,$scope.signup.paymentAgreement=-1,$scope.signup.paymentType=-1},0),$scope.imports.camount=null,$scope.imports.ccomment=null,$scope.errorMessage=!1,$scope.ptype=!1,$scope.submitted=!1,$("html,body").animate({scrollTop:$(".bgWhiteBord").offset().top-20},300)},$scope.removeError=function(val){-1!==val&&($scope.ptype=!1)}}function accountViewDetail($scope,ajaxService,$localStorage,sharedProperties,ngDialog,$timeout){$scope.disableCompanyEditing=!0,$scope.disableIndividualEditing=!0,$scope.formStatus={},$scope.dialogStatus={};var localStore=$localStorage.get("creditted");localStore===!0&&($localStorage.remove("creditted"),$.growl({icon:"glyphicon glyphicon-ok",message:"Amount Creditted"}));var config={getAllAccountDetails:"/sp/sysAdmin/alternateBilling/account/businessAccountDetails",getAllAccountIndividualDetails:"/sp/sysAdmin/alternateBilling/account/individualAccountDetails",updateCompany:"/sp/sysAdmin/alternateBilling/account/updateCompany",updateIndividualProfile:"/sp/sysAdmin/alternateBilling/account/updateIndividualProfile",deactivateRenewal:"/sp/sysAdmin/alternateBilling/account/cancel",deactivateAccount:"/sp/sysAdmin/alternateBilling/account/deactivateAccount"};$scope.getAccountValue=function(type){ajaxService.getAjaxResponse({url:"undefined"==typeof type?config.getAllAccountDetails:config.getAllAccountIndividualDetails,data:$.param({accountId:sharedProperties.getParam("accountId")})}).then(function(response){if("true"===response.Success)"undefined"==typeof type?($scope.accountInfo=response,$scope.companyDetail=response.company,$scope.companyDetail.companyId=response.company.id,$scope.companyDetail.address.address1=response.company.address.addressLine1,$scope.companyDetail.address.address2=response.company.address.addressLine2,$scope.companyDetail.address.zip=response.company.address.zipCode,$scope.stateCheck.forSelectedCountry=response.company.address.country,$scope.accountDetails=response.account,$scope.memberList=response.accountUsers,$scope.masterCompanyDetail=angular.copy($scope.companyDetail)):($scope.accountInfo=response,$scope.accountDetails=response.account,$scope.userDetail=response.profileForm,$scope.userDetail.userId=response.userSummary.id,$scope.userDetail.address1=response.address.addressLine1,$scope.userDetail.address2=response.address.addressLine2,$scope.userDetail.zip=response.address.zipCode,$scope.userDetail.city=response.address.city,$scope.userDetail.state=response.address.state,$scope.userDetail.country=response.address.country,$scope.masterUserDetail=angular.copy($scope.userDetail));else{$scope.getAllError=!0;for(var key in response.error)$scope.getAllErrorMsg=response.error[key]}})},$scope.saveAndUpdate=function(formData,formName){$scope.formStatus.sumbit=!1;var empCountErr;empCountErr="undefined"!=typeof formData.numberOfEmployees&&formData.numberOfEmployees<1?!1:!0;var URL="companyDetails"===formName?config.updateCompany:config.updateIndividualProfile,vCount=0;for(var k in formData)if("object"==typeof formData[k])for(var l in formData[k])("default"===formData[k][l]||"default1"===formData[k][l])&&vCount++;else("default"===formData[k]||"default1"===formData[k])&&vCount++;this[formName].$valid&&0===vCount&&empCountErr?ajaxService.getAjaxResponse({url:URL,data:$.param(formData).replace(/address%5B/g,"").replace(/%5D/g,"").replace(/%2C/g,",")}).then(function(response){if("true"===response.Success)$scope.masterCompanyDetail=angular.copy($scope.companyDetail),$scope.disableCompanyEditing=!0,$scope.masterUserDetail=angular.copy($scope.userDetail),$scope.disableIndividualEditing=!0;else if(null!==response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}}):$scope.formStatus.sumbit=!0},$scope.disableEdit=function(){$scope.formStatus.sumbit=!1,$scope.disableCompanyEditing=!0,$scope.companyDetail=angular.copy($scope.masterCompanyDetail),$scope.disableIndividualEditing=!0,$scope.userDetail=angular.copy($scope.masterUserDetail)},$scope.showDetailsDialog=function(t){"members"===t?($scope.showDetails={title:"Member account details",total:'Total member accounts purchased : <span class="b-700">'+parseInt($scope.accountDetails.productInfo.numActive+$scope.accountDetails.productInfo.availalbeMemberSubscriptions+$scope.accountDetails.productInfo.numDeleted)+"</span>",active:$scope.accountDetails.productInfo.numActive,deleted:$scope.accountDetails.productInfo.numDeleted,available:$scope.accountDetails.productInfo.availalbeMemberSubscriptions},ngDialog.open({template:"/sp/resources/html/admin/account/show-details-dialog.html",scope:$scope})):($scope.accountDetails.hiringProduct.availableHiringSubscripitons,$scope.showDetails={title:"Candidate account details",total:'Total candidate accounts purchased : <span class="b-700">'+parseInt($scope.accountDetails.hiringProduct.availableHiringSubscripitons+$scope.accountDetails.hiringProduct.usedHiringSubscriptions)+"</span>",active:$scope.accountDetails.hiringProduct.usedHiringSubscriptions,deleted:$scope.accountDetails.hiringProduct.availableHiringSubscripitons+$scope.accountDetails.hiringProduct.usedHiringSubscriptions-$scope.accountDetails.hiringProduct.availableHiringSubscripitons-$scope.accountDetails.hiringProduct.usedHiringSubscriptions,available:$scope.accountDetails.hiringProduct.availableHiringSubscripitons},ngDialog.open({template:"/sp/resources/html/admin/account/show-details-dialog.html",scope:$scope}))},$scope.showReactivateDialog=function(i){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/alternateBilling/account/reActivate",data:$.param({accountId:sharedProperties.getParam("accountId")})}).then(function(response){"true"===response.Success&&($scope.getAccountValue(i),$.growl({icon:"glyphicon glyphicon-ok",message:" Subscription renewal activated successfully"}))})},$scope.showReactivateAccount=function(i){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/alternateBilling/account/reActivateAccount",data:$.param({accountId:sharedProperties.getParam("accountId")})}).then(function(response){"true"===response.Success&&($scope.getAccountValue(i),$.growl({icon:"glyphicon glyphicon-ok",message:" Account activated successfully"}))})},$scope.showCancelDialog=function(i){$scope.showCancelType=i,$scope.dialogStatus.title="Cancel Subscription",$scope.dialogStatus.content="Subscription cancelled successfully.",ngDialog.open({template:"/sp/resources/html/admin/account/cancel-subscription-dialog.html",scope:$scope})},$scope.showCancelAccountDialog=function(i){$scope.showCancelType=i,$scope.dialogStatus.title="Cancel Subscription",$scope.dialogStatus.content="Account deactivated successfully.",ngDialog.open({template:"/sp/resources/html/admin/account/cancel-subscription-account-dialog.html",scope:$scope})},$scope.showDetailsDialog=function(t){"members"===t?($scope.showDetails={title:"Member account details",total:'Total member accounts purchased : <span class="b-700">'+parseInt($scope.accountInfo.account.productInfo.numActive+$scope.accountInfo.account.productInfo.availalbeMemberSubscriptions+$scope.accountInfo.account.productInfo.numDeleted)+"</span>",active:$scope.accountInfo.account.productInfo.numActive,deleted:$scope.accountInfo.account.productInfo.numDeleted,available:$scope.accountInfo.account.productInfo.availalbeMemberSubscriptions},ngDialog.open({template:"/sp/resources/html/admin/account/show-details-dialog.html",scope:$scope})):($scope.accountInfo.account.hiringProduct.availableHiringSubscripitons,$scope.showDetails={title:"Candidate account details",total:'Total candidate accounts purchased : <span class="b-700">'+parseInt($scope.accountInfo.account.hiringProduct.availableHiringSubscripitons+$scope.accountInfo.account.hiringProduct.usedHiringSubscriptions)+"</span>",active:$scope.accountInfo.account.hiringProduct.usedHiringSubscriptions,deleted:$scope.accountInfo.account.hiringProduct.availableHiringSubscripitons+$scope.accountInfo.account.hiringProduct.usedHiringSubscriptions-$scope.accountInfo.account.hiringProduct.availableHiringSubscripitons-$scope.accountInfo.account.hiringProduct.usedHiringSubscriptions,available:$scope.accountInfo.account.hiringProduct.availableHiringSubscripitons},ngDialog.open({template:"/sp/resources/html/admin/account/show-details-dialog.html",scope:$scope}))},$scope.cancelSubscription=function(mode){ajaxService.getAjaxResponse({url:config.deactivateRenewal,data:$.param({accountId:sharedProperties.getParam("accountId")})}).then(function(response){"true"===response.Success?(ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:" Subscription cancelled successfully "}),$timeout(function(){$scope.getAccountValue(mode)},300)):(ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Server </strong> ",message:Error}),$timeout(function(){$scope.getAccountValue(mode)},300))})},$scope.cancelAccountSubscription=function(mode){ajaxService.getAjaxResponse({url:config.deactivateAccount,data:$.param({accountId:sharedProperties.getParam("accountId")})}).then(function(response){"true"===response.Success?(ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:"Account deactivated successfully "}),$timeout(function(){$scope.getAccountValue(mode)},300)):(ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Server </strong> ",message:Error}),$timeout(function(){$scope.getAccountValue(mode)},300))})}}angular.module("spApp").controller("alternateBilling",alternateBilling),alternateBilling.$inject=["$scope","$element","ajaxService","$filter","ngDialog","sharedProperties","$timeout","$rootScope","$localStorage"],angular.module("spApp").controller("accountViewDetail",accountViewDetail),accountViewDetail.$inject=["$scope","ajaxService","$localStorage","sharedProperties","ngDialog","$localStorage","$timeout"];
function archiveListingController($scope,$q,$element,$attrs,ajaxService,$location,$state,$filter,ngDialog,sharedProperties,$timeout,$rootScope,$localStorage){$scope.memberList=[],$scope.masterMemberList=[],$scope.showfilter=!1,$scope.pageSize=20,$scope.intialPageSize=20,$scope.searchTag=[],$scope.hiringRoles=[],$scope.alldisplay=!1,$scope.filter={},$scope.tags=[],$scope.userEmail={email:[]},$scope.checkBox=[],$scope.allMembersEmailId=[],$scope.statusInclude=[],$scope.setEditMode=!1,$scope.userStatus=[],$scope.groupModule=[],$scope.masterGroupModule=[],$scope.textSearching="",$scope.mainGroupInfoList=[],$scope.checkedAll=!1,$scope.deleteUser=!1,$scope.deleteUserError=!1,$scope.updateGroup=!1,$scope.updateGroupError=!1,$scope.updateError="",$scope.EditGroupEmail="",$scope.archiveDialog={},$scope.archiveDialog.addHiring=!1,$scope.load=!0,$scope.formatDate=function(d){if(null!==d&&"undefined"!=typeof d){var splitDate=d.split("-"),monthData={"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"},formattedDate=monthData[splitDate[1].toString()]+" "+parseInt(splitDate[2])+", "+parseInt(splitDate[0]);return formattedDate}},$scope.getMembersData=function(){var options={url:"/sp/hiring/getAllArchivedCandidates"};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&($localStorage.remove("isCandidateArchived","archiveCandidateId","candidateEmail","candidateID"),$scope.masterMemberList=response["hiring-archived"].length?response["hiring-archived"]:[],$scope.returnMemberList($scope.pageSize),$scope.tagListArray=[],$scope.mokroles=[],$scope.userRoles=[],angular.forEach(response["hiring-archived"],function(val,index){$scope.allMembersEmailId.push(val.email),null!=val.tagList&&($scope.tagListArray=val.tagList.concat($scope.tagListArray).unique()),null!=val.userStatusFormatted&&$scope.mokroles.push(val.userStatusFormatted),null!==val.hiringRoles&&($scope.userRoles=val.hiringRoles.concat($scope.userRoles).unique())}),$scope.tagListArray=$scope.autoCompleteType($scope.tagListArray),$scope.userStatus=$scope.mokroles.unique().sort(),$scope.hiringRoles=$scope.userRoles.unique(),$scope.alistLoaded=!0)})},$scope.intersection=function(a,b){var result=[],ai=0,bi=0;for(a.sort(),b.sort();a.length>ai&&b.length>bi;)a[ai]<b[bi]?ai++:a[ai]>b[bi]?bi++:(result.push(a[ai]),ai++,bi++);return result},$scope.enableAdvanceSection=function(event){$(event.currentTarget).closest(".complete-profile").find(".editable-section").show()},$scope.autoCompleteType=function(arr){for(var customarray=[],i=0;i<arr.length;i++)customarray.push({text:arr[i]});return customarray},$scope.order=function(predicate,reverse){$scope.memberList=$filter("orderBy")($scope.memberList,predicate,reverse)},$scope.loadTags=function(query){var deferred=$q.defer();return deferred.resolve($scope.getLoadSuggestion(query)),deferred.promise},$scope.getLoadSuggestion=function(query){for(var copyArray=[],i=0;i<$scope.tagListArray.length;i++)angular.lowercase($scope.tagListArray[i].text).indexOf(angular.lowercase(query))>-1&&copyArray.push($scope.tagListArray[i]);return copyArray.slice(0,5)},$scope.tagAdded=function(tag){$scope.searchTag.push(tag.text),$scope.refineSearch($scope.searchTag)},$scope.tagRemoved=function(tag){$scope.searchTag.splice($scope.searchTag.indexOf(tag.text),1),$scope.refineSearch($scope.searchTag)},$scope.refineSearch=function(list){$scope.newArr=[],angular.forEach($scope.masterMemberList,function(val,key){null!=val.tagList&&$scope.intersection(val.tagList,list).length===list.length&&$scope.newArr.push(val)}),$scope.checkboxFilter()},$scope.includeCheck=function(status){var i=$.inArray(status,$scope.statusInclude);i>-1?$scope.statusInclude.splice(i,1):$scope.statusInclude.push(status),$scope.checkboxFilter()},$scope.checkboxFilter=function(status){$scope.statusInclude.length>0&&($scope.checkBox=[],angular.forEach($scope.masterMemberList,function(val,index){for(var i=0;i<$scope.statusInclude.length;i++)for(var j=0;j<val.roles[i].length;j++)val.roles[j]===$scope.statusInclude[i]&&$scope.checkBox.push(val)})),$scope.returnMemberList($scope.pageSize)},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.returnMemberList($scope.pageSize)},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize))},$scope.active=function(event){var currentElem=$(event.currentTarget);currentElem.find("h4").hasClass("on")?currentElem.find("h4").hasClass("reverseon")?currentElem.find("h4").removeClass("reverseon"):currentElem.find("h4").addClass("reverseon"):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"))},$scope.returnMemberList=function(pageSize){if($scope.searchTag.length&&!$scope.statusInclude.length&&($scope.memberList=angular.copy($scope.newArr)),$scope.searchTag.length&&$scope.statusInclude.length){$scope.combineArray=[];for(var i=0;i<$scope.newArr.length;i++)for(var j=0;j<$scope.checkBox.length;j++)$scope.newArr[i].email===$scope.checkBox[j].email&&$scope.combineArray.push($scope.newArr[i]);$scope.memberList=angular.copy($scope.combineArray)}!$scope.searchTag.length&&$scope.statusInclude.length&&($scope.memberList=angular.copy($scope.checkBox)),$scope.searchTag.length||$scope.statusInclude.length||($scope.memberList=angular.copy($scope.masterMemberList)),$scope.memberList=sharedProperties.searchModule($scope.textSearching,$scope.memberList,2),pageSize>=$scope.memberList.length?$scope.alldisplay=!0:$scope.alldisplay=!1,$scope.pageSize=pageSize,$scope.memberList=$scope.memberList.slice(0,pageSize),$scope.load&&($scope.order("name","false"),$scope.load=!1)},$scope.checkAll=function(){$scope.checkedAll=!$scope.checkedAll,$scope.negative?$scope.userEmail.email=$scope.masterMemberList.map(function(item){return{email:item.email,name:item.name}}):$scope.userEmail.email=[]},$scope.resetfilter=function(allmembers){$scope.pageSize=$scope.intialPageSize,$scope.newArr=[],$scope.searchTag=[],$scope.tags=[],$scope.filter={},$scope.userEmail.email=[],$scope.statusInclude=[],$scope.adminc=!1,$scope.leadC=!1,$scope.textSearching="",$scope.searchText="","undefined"!=typeof $scope.selectedSearch&&($scope.selectedSearch.userStatusFormatted="",$scope.selectedSearch.hiringRoles=""),$scope.memberList=angular.copy($scope.masterMemberList),"undefined"!=typeof allmembers&&($scope.pageSize=$scope.masterMemberList.length),$scope.returnMemberList($scope.pageSize),$scope.order("name","false");var curr=$(".memberHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")},$scope.certainDelete=function(){ngDialog.open({template:"/sp/resources/html/tools/hiring/deleteConfirmation.html",scope:$scope})},$scope.deleteButton=function(){},$scope.confirmDelete=function(event){var email=$(event.target).closest(".complete-profile").find(".email").html(),options=(angular.element(event.currentTarget),{url:"/sp/hiring/deleteArchiveCandidate",data:$.param({candidateEmail:email})});ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?($scope.getMembersData(),$.growl({icon:"glyphicon glyphicon-ok",message:"Candidate(s) deleted successfully"})):$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:"Server Error"})})},$scope.deleteUsers=function(emails){var emailList=[];jQuery.each(emails,function(i,j){emailList.push(emails[i].email)});var options={url:"/sp/hiring/deleteArchiveCandidate",data:$.param({candidateEmail:emailList.toString()})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&($scope.userEmail.email=[],$scope.alltoggle=!1,$scope.checkedAll&&($scope.negative=!$scope.negative),ngDialog.close("ngdialog1"),$scope.getMembersData(),$.growl({icon:"glyphicon glyphicon-ok",message:"Candidate(s) deleted successfully"}))})},$scope.addClassActive=function(){$scope.dropUp=!$scope.dropUp},$scope.notificationEmail=function(emails){emails.length&&(sharedProperties.setEmail(emails),sharedProperties.setObject($scope.memberList),ngDialog.open({template:"return-visitor.html"}))},$scope.profileRoute=function(event){var groupname=$(event.currentTarget).data("routeparam");$localStorage.set("groupname",groupname),window.location.href="/sp/admin/group/#profile"},$scope.showFullList=function(){$scope.resetfilter("full")},$scope.editGroupSection=function(index){$scope.EditGroupEmail=this.memberList.email;for(var currentEmail=this.memberList.email,i=0;i<$scope.memberList.length;i++)currentEmail===$scope.memberList[i].email&&(index=i);$scope.setEditMode=!0,$scope.indexToChange=index,$scope.groupEditSection=angular.copy($scope.memberList[index]),$scope.groupSelectOption=[];for(var j=0;j<$scope.groupEditSection.groupAssociationList.length;j++)$scope.groupSelectOption.push($scope.groupEditSection.groupAssociationList[j].name);ngDialog.open({template:"/sp/admin/member/editGroup",scope:$scope})},$scope.enableLeadDialog=function(leadValue,index,groupName){for(var i=0;i<$scope.mainGroupInfoList.length;i++)if(groupName===$scope.mainGroupInfoList[i].name){if(null!==$scope.mainGroupInfoList[i].groupLead&&$scope.mainGroupInfoList[i].groupLead.email!==$scope.EditGroupEmail)return!1;$scope.groupEditSection.groupAssociationList[index].groupLead=!leadValue}},$scope.setStyle=function(lead){return $scope.viewMode(),lead===!0?!0:!1},$scope.isItEnabled=function(groupName,id){$scope.classActivate=[];for(var i=0;i<$scope.mainGroupInfoList.length;i++)groupName===$scope.mainGroupInfoList[i].name&&null!==$scope.mainGroupInfoList[i].groupLead&&$scope.mainGroupInfoList[i].groupLead.email!==$scope.EditGroupEmail&&($scope.classActivate.push("#mode_"+id),$scope.classActivate.push("#modeprop_"+id))},$scope.viewMode=function(){if($scope.classActivate.length)for(var i=0;i<$scope.classActivate.length;i++)$($scope.classActivate[i]).addClass("disabled")},$scope.addGroupToModule=function(groupName,lead){return $scope.selectedGroup=groupName,"default"===groupName?!1:(""===$scope.groupEditSection.groupAssociationList[0].name&&$scope.groupEditSection.groupAssociationList.splice(0,1),$scope.groupEditSection.groupAssociationList.push({name:groupName,groupLead:!1}),void $scope.groupSelectOption.push(groupName))},$scope.addGroupMember=function(names){return""===names?!1:!0},$scope.removeGroupDialog=function(event,groupName){for(var _this=event.target,current=($(_this).closest(".blockGroup").remove(),""),i=0;i<$scope.groupEditSection.groupAssociationList.length;i++)$scope.groupEditSection.groupAssociationList[i].name===groupName.name&&($scope.groupEditSection.groupAssociationList.splice(i,1),current=i);$scope.groupSelectOption.splice(current,1)},$scope.saveGroupToModule=function(groupName){for(var newArr="",i=0;i<$scope.groupEditSection.groupAssociationList.length;i++)newArr=newArr.length?newArr+","+$scope.groupEditSection.groupAssociationList[i].name+":"+$scope.groupEditSection.groupAssociationList[i].groupLead:$scope.groupEditSection.groupAssociationList[i].name+":"+$scope.groupEditSection.groupAssociationList[i].groupLead;var options={url:"/sp/admin/group/memberGroupUpdate",data:$.param({groupAssociationList:newArr,memberEmail:$scope.groupEditSection.email})};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success){$scope.groupEditSection.groupAssociationList.length?$scope.memberList[$scope.indexToChange]=$scope.groupEditSection:($scope.groupEditSection.groupAssociationList.push({name:"",groupLead:!1}),$scope.memberList[$scope.indexToChange]=$scope.groupEditSection);for(var i=0;i<$scope.masterMemberList.length;i++)$scope.masterMemberList[i].email===$scope.memberList[$scope.indexToChange].email&&($scope.masterMemberList[i]=$scope.groupEditSection);ngDialog.close("ngdialog1"),ngDialog.open({template:"/sp/admin/member/confirmation"})}else ngDialog.close("ngdialog1"),ngDialog.open({template:"/sp/admin/member/errorGroup"})})},$scope.memberTakeAway=function(email,id){$localStorage.set("archiveCandidateId",id).set("isCandidateArchived",!0),window.location.href="/sp/tools/hiring/profile?cemail="+email},$scope.calltoAction=function(select){return""===select?!1:void(window.location.href=select)},$scope.archiveDialog=function(e,n,r){$scope.archiveCandidate={name:n,email:e,roles:r},ngDialog.open({template:"/sp/resources/html/tools/hiring/archive-candidate.html",scope:$scope})},$scope.moveAllCandidate=function(cEmail){var emailList=[];jQuery.each(cEmail,function(i,j){emailList.push(cEmail[i].email)});var options={url:"/sp/hiring/moveToCandidate",data:$.param({candidateEmail:emailList.toString()})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&(ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Candidate</strong>",message:" archived successfully"}),$scope.getMembersData())})},$scope.moveToCandidateList=function(email){var options={url:"/sp/hiring/moveToCandidate",data:$.param({candidateEmail:email})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&($.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Candidate</strong>",message:" added to list successfully"}),$scope.getMembersData())})},$scope.formatName=function(n){if(null!==n||"undefined"!==n){var slpitName=n.split(", "),formatName=slpitName[1]+" "+slpitName[0];return formatName}},$scope.moveAllDialog=function(emails){$scope.archiveCandidateAll={emails:emails},ngDialog.open({template:"/sp/resources/html/tools/hiring/move-candidate-list.html",scope:$scope})},$scope.sendViewProfileRequest=function(e,n){$scope.profileRequest={email:e,name:n,heading:"Request Access"},ngDialog.open({template:"/sp/resources/html/tools/hiring/send-profile-invite.html",scope:$scope}),$scope.sendRequest=function(e){var options={url:"/sp/notifications/sendNotification",data:$.param({memberEmail:e,type:""}).replace(/%40/g,"@")};ajaxService.getAjaxResponse(options).then(function(response){"true"!==response.Success&&$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:"Not able to send invite"})})}},$scope.sendReminder=function(e,n){$scope.profileRequest={email:e,name:n,heading:"Reminder"},ngDialog.open({template:"/sp/resources/html/tools/hiring/send-profile-invite.html",scope:$scope}),$scope.sendRequest=function(e){var options={url:"/sp/notifications/sendNotification",data:$.param({memberEmail:e,type:""}).replace(/%40/g,"@")};ajaxService.getAjaxResponse(options).then(function(response){"true"!==response.Success&&$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:"Not able to send invite"})})}}}function notification($scope,sharedProperties){$scope.name=[];var memberList=sharedProperties.getObject(),emails=sharedProperties.getEmail();$scope.emailId=emails,angular.forEach(memberList,function(val,index){for(var i=0;i<emails.length;i++)emails[i]===val.email&&$scope.name.push(val.name)})}angular.module("spApp").controller("archiveListingController",archiveListingController),angular.module("spApp").controller("notification",notification),archiveListingController.$inject=["$scope","$q","$element","$attrs","ajaxService","$location","$state","$filter","ngDialog","sharedProperties","$timeout","$rootScope","$localStorage"],notification.$inject=["$scope","sharedProperties"];
function assessmentCompleted($scope,$q,$element,$attrs,ajaxService,$location,$state,$filter,ngDialog,sharedProperties,$timeout,$rootScope,userDataService,$localStorage){$scope.isProfileLoaded=!1,$scope.getUserRole=function(){ajaxService.getAjaxResponse({url:"/sp/signedIn/getProfile"}).then(function(response){if("true"===response.Success){var roles=response.member.roles.sort();$scope.isProfileLoaded=!0,$scope.isIndividualUser=-1===jQuery.inArray("IndividualAccountAdministrator",roles)?!1:!0}})},$scope.getUserRole()}angular.module("spApp").controller("assessmentCompleted",assessmentCompleted),assessmentCompleted.$inject=["$scope","$q","$element","$attrs","ajaxService","$location","$state","$filter","ngDialog","sharedProperties","$timeout","$rootScope","userDataService","$localStorage"];
function assessmentController($scope,ajaxService,$timeout,$rootScope,$localStorage){function configServices(page){if("assessment360"===page){var getLink=window.location.href.split("/"),id=getLink[getLink.length-1];_this.services={start:"/sp/assessment360/start/"+id,next:"/sp/assessment360/process/"+id,previous:"/sp/assessment360/previous/"+id,redirect:"/sp/external/thankyou"},_this.startAssessment()}else"hiringUser"===page?(_this.services={start:"/sp/assessment/start",next:"/sp/assessment/process",previous:"/sp/assessment/previous",redirect:"/sp/candidateThankYou"},_this.startAssessment()):(_this.services={start:"/sp/assessment/start",next:"/sp/assessment/process",previous:"/sp/assessment/previous",redirect:"/sp/assessment/completed"},_this.startAssessment())}function resetBtnFlags(){$scope.nextBtn={enable:!1,isClickable:!1},$scope.prevBtn={enable:!0,isClickable:!1,visible:!0}}function progress(sectionNo,questionNo){var currentSection=sectionNo,totalSections=_this.totalCategories,currentQuestion=questionNo,totalQuestions=_this.totalQuestions,categoriesList=_this.categoriesList,completedQuestions=0,precentageCompleted=0;if(currentSection>0&&totalSections>currentSection)for(var j=0;currentSection>j;j++)completedQuestions+=categoriesList[j].totalQuestions;completedQuestions+=currentQuestion+1,0===currentQuestion&&0===currentSection?precentageCompleted=0:(precentageCompleted=completedQuestions/totalQuestions*100,99.5===precentageCompleted&&(precentageCompleted=99),100===precentageCompleted?$scope.nextBtnText="Finish":$scope.nextBtnText="Next"),_this.progressDetails=precentageCompleted.toFixed()}function startAssessment(){$localStorage.flush(),_this.assessmentLoaded=!1,resetBtnFlags(),ajaxService.getAjaxResponse({url:_this.services.start,delay:600,maximum:1200}).then(function(response){if("true"===response.Success)if(_this.serverError=!1,"undefined"!=typeof response.question){var _r=response;_this.assessmentData=response,_this.sectionDetails={number:_r.question.categoryNumber,total:_r.categories.totalCategories,instruction:_r.categories.categoriesList[_r.question.categoryNumber].instruction,totalQuestions:_r.categories.categoriesList[_r.question.categoryNumber].totalQuestions,currentNo:_r.question.categoryNumber+1,nextNo:_r.question.categoryNumber+2},_this.questionDetails={number:_r.question.number,type:_r.question.type,description:_r.question.description,optionList:_r.question.optionsList},$scope.userParams={c:_r.question.categoryNumber,q:_r.question.number},_this.totalCategories=_r.categories.totalCategories;for(var i=0;i<_this.totalCategories;i++)_this.totalQuestions+=_r.categories.categoriesList[i].totalQuestions;_this.categoriesList=_r.categories.categoriesList,progress(_r.question.categoryNumber,_r.question.number),"MultipleChoice"===_r.question.type?$timeout(function(){0===_r.question.number&&0===_r.question.categoryNumber?($scope.prevBtn.enable=!1,$scope.prevBtn.visible=!1):($scope.prevBtn.enable=!0,$scope.prevBtn.visible=!0),$scope.disableOptionSelection=!1},100):$timeout(function(){$scope.isDragTemplateLoaded=loadDragTemplate(_r,"next")},100),$timeout(function(){_this.assessmentLoaded=!0},100)}else window.location=_this.services.redirect;else _this.serverError=!0,_this.errorMessage=$rootScope.pullInterNationalization("assessment.refreshError")})}function nextQuestion(){$scope.nextBtn.isClickable===!0&&($scope.isDragTemplateLoaded=!1,"undefined"!=typeof sortable&&null!==sortable.el&&sortable.destroy(),_this.prevAnswer=-1,resetBtnFlags(),$scope.disableOptionSelection===!1&&($scope.disableOptionSelection=!0),ajaxService.getAjaxResponse({url:_this.services.next,delay:600,maximum:1200,data:$.param($scope.userParams).replace(/%2C/g,",")}).then(function(response){if("true"===response.Success)if("undefined"!=typeof response.question){var _r=response;_this.questionDetails={number:_r.question.number,type:_r.question.type,description:_r.question.description,optionList:_r.question.optionsList},_this.sectionDetails={number:_r.question.categoryNumber,instruction:_this.assessmentData.categories.categoriesList[_r.question.categoryNumber].instruction},_r.question.categoryNumber+1<=_this.totalCategories&&(_this.sectionDetails.currentNo=_r.question.categoryNumber+1,9===_this.sectionDetails.currentNo?_this.sectionDetails.nextNo="":_this.sectionDetails.nextNo=_r.question.categoryNumber+2),progress(_r.question.categoryNumber,_r.question.number),$scope.userParams={c:_r.question.categoryNumber,q:_r.question.number},"MultipleChoice"===_r.question.type?$timeout(function(){0===_r.question.number&&0===_r.question.categoryNumber?($scope.prevBtn.enable=!1,$scope.prevBtn.visible=!1):($scope.prevBtn.enable=!0,$scope.prevBtn.visible=!0),$scope.disableOptionSelection=!1},100):$timeout(function(){$scope.isDragTemplateLoaded=loadDragTemplate(_r,"next")},100)}else window.location=_this.services.redirect;else _this.serverError=!0,_this.errorMessage=$rootScope.pullInterNationalization("assessment.refreshError")}))}function previousQuestion(){$scope.prevBtn.isClickable===!1&&($scope.isDragTemplateLoaded=!1,"undefined"!=typeof sortable&&null!==sortable.el&&sortable.destroy(),resetBtnFlags(),$scope.prevBtn.enable=!1,$scope.prevBtn.isClickable=!0,$scope.disableOptionSelection===!1&&($scope.disableOptionSelection=!0),ajaxService.getAjaxResponse({url:_this.services.previous,delay:600,maximum:1200}).then(function(response){if("true"===response.Success)if("undefined"!=typeof response.question){var _r=response;"MultipleChoice"===_r.question.type?_this.prevAnswer=_r.lastAnswer[0]:_this.prevAnswer=_r.lastAnswer,_this.questionDetails={number:_r.question.number,type:_r.question.type,description:_r.question.description,optionList:_r.question.optionsList},_this.sectionDetails={number:_r.question.categoryNumber,instruction:_this.assessmentData.categories.categoriesList[_r.question.categoryNumber].instruction},_r.question.categoryNumber+1<=_this.totalCategories&&(_this.sectionDetails.currentNo=_r.question.categoryNumber+1,9===_this.sectionDetails.currentNo?_this.sectionDetails.nextNo="":_this.sectionDetails.nextNo=_r.question.categoryNumber+2),progress(_r.question.categoryNumber,_r.question.number),$scope.userParams={c:_r.question.categoryNumber,q:_r.question.number,a:_r.lastAnswer},"MultipleChoice"===_r.question.type?$timeout(function(){0===_r.question.number&&0===_r.question.categoryNumber?($scope.prevBtn.enable=!1,$scope.prevBtn.visible=!1):($scope.prevBtn.enable=!1,$scope.prevBtn.visible=!0),$scope.disableOptionSelection=!1},100):$timeout(function(){$scope.isDragTemplateLoaded=loadDragTemplate(_r,"previous")},100)}else window.location=_this.services.redirect;else _this.serverError=!0,_this.errorMessage=$rootScope.pullInterNationalization("assessment.refreshError")}))}var _this=this;_this.assessmentLoaded=!1,_this.serverError=!1,_this.totalCategories=0,_this.totalQuestions=0,_this.prevAnswer=-1,_this.configServices=configServices,_this.startAssessment=startAssessment,_this.nextQuestion=nextQuestion,_this.previousQuestion=previousQuestion,_this.services={},_this.sectionDetails={},_this.progressDetails={},_this.questionDetails={},_this.assessmentData={},$scope.nextBtn={enable:!1,isClickable:!1},$scope.prevBtn={enable:!1,isClickable:!1,visible:!0},$scope.userParams={},$scope.nextBtnText="Next",$scope.disableOptionSelection=!1,$scope.isDragTemplateLoaded=!1}function loadDragTemplate(r,d){jQuery("#drag-list").html("");var counter,previousAns,oList=r.question.optionsList,type=(r.question.number,r.question.type),oListLength=r.question.optionsList.length,isTemplateLoaded=!1;if("next"===d)counter=0,jQuery.each(oList,function(i){jQuery("#drag-list").append('<div data-opt="option-'+i+'" class="draggable-wrapper"><p><span>'+oList[i]+"</span></p></div>"),counter++});else if("previous"===d)if(previousAns=r.lastAnswer,"PersonalityRating"!==type)counter=0,jQuery.each(previousAns,function(i){var _index=previousAns[i];jQuery("#drag-list").append('<div data-opt="option-'+_index+'" class="draggable-wrapper"><p><span>'+oList[parseInt(_index)]+"</span></p></div>"),counter++});else{var indexArray=[0,1,2,3],missingAns=[];jQuery.each(indexArray,function(i,j){var ansIndex=jQuery.inArray(indexArray[i],previousAns);0>ansIndex&&missingAns.push(i)}),jQuery("#drag-list").append('<div data-opt="option-'+previousAns[0]+'" class="draggable-wrapper"><p><span>'+oList[parseInt(previousAns[0])]+"</span></p></div>"),jQuery("#drag-list").append('<div data-opt="option-'+missingAns[0]+'" class="draggable-wrapper"><p><span>'+oList[parseInt(missingAns[0])]+"</span></p></div>"),jQuery("#drag-list").append('<div data-opt="option-'+missingAns[1]+'" class="draggable-wrapper"><p><span>'+oList[parseInt(missingAns[1])]+"</span></p></div>"),jQuery("#drag-list").append('<div data-opt="option-'+previousAns[1]+'" class="draggable-wrapper"><p><span>'+oList[parseInt(previousAns[1])]+"</span></p></div>"),counter=4}return counter===oListLength?isTemplateLoaded=!0:void 0}function optionSelection($rootScope,$timeout){return{restrict:"A",link:function($scope,$element,$attrs){var optionSelectionEvent=function(){jQuery("#assessmentTemplate1").find(".assessment-opts").removeClass("red-shadow"),jQuery("#assessmentTemplate1").off("click").on("click",".answer-options",function(){if($scope.disableOptionSelection!==!1)return!1;var i=jQuery(this).attr("data-option");jQuery("#assessmentTemplate1").find(".assessment-opts").removeClass("red-shadow"),jQuery(this).find(".assessment-opts").addClass("red-shadow"),$scope.userParams.a=i,$scope.nextBtn.enable=!0,$scope.nextBtn.isClickable=!0,$scope.$apply()}),-1!==parseInt(jQuery("#assessmentTemplate1").attr("data-prev"))&&$timeout(function(){var i=parseInt(jQuery("#assessmentTemplate1").attr("data-prev"));jQuery("#assessmentTemplate1").find(".answer-options").eq(i).trigger("click")},100)};$scope.$last===!0&&optionSelectionEvent(),$scope.$watch(function(){return $attrs.question},function(){$scope.$last===!0&&optionSelectionEvent()})}}}function setupLayout(){var maxHeight,maxWidth,dragSlidesHeights=[],dragSlidesWidths=[],labelCont=jQuery("#drag-list").prev(),draggableCont=jQuery("#drag-list"),backLabels=jQuery("#drag-list").next();jQuery.each(draggableCont.find("div"),function(i,j){dragSlidesHeights.push(jQuery(this).outerHeight()),dragSlidesWidths.push(jQuery(this).outerWidth()),jQuery(this).attr("style","").removeClass("active")}),maxHeight=Math.max.apply(Math,dragSlidesHeights),maxWidth=Math.max.apply(Math,dragSlidesWidths),jQuery.each(draggableCont.find("div"),function(i,j){jQuery(this).find("p").css({height:maxHeight})}),jQuery.each(labelCont.find("div"),function(i,j){jQuery(this).attr("style","").removeClass("active"),jQuery(this).css({height:maxHeight}),jQuery(this).find("p").css({height:maxHeight})}),jQuery.each(backLabels.find("div.assessment-opts"),function(i,j){jQuery(this).attr("style",""),jQuery(this).css({height:maxHeight})})}function draggableSortableTemplate($rootScope,$timeout){return{restrict:"A",link:function($scope,$element,$attrs){var trackListOrder=function(){var updatedListOrder=[],list=jQuery("#drag-list").find("div"),counter=0;$scope.nextBtn.enable=!1,$scope.nextBtn.isClickable=!1,$scope.prevBtn.enable=!1,$scope.prevBtn.isClickable=!0,$scope.$apply(),jQuery.each(list,function(i,j){"undefined"!=typeof jQuery(this).attr("data-opt").split("-")[1]&&(updatedListOrder.push(jQuery(this).attr("data-opt").split("-")[1]),counter++)}),counter===list.length&&("personalityrating"===jQuery("#drag-list").attr("data-type").toLowerCase()?$scope.userParams.a=updatedListOrder[0]+","+updatedListOrder[3]:$scope.userParams.a=updatedListOrder.join(),$timeout(function(){-1===parseInt(jQuery("#drag-list").attr("data-prev"))?($scope.prevBtn.enable=!0,$scope.prevBtn.isClickable=!1):($scope.prevBtn.enable=!1,$scope.prevBtn.isClickable=!0),$scope.nextBtn.enable=!0,$scope.nextBtn.isClickable=!0,$scope.$apply()},300))},initSortable=function(){var el=document.getElementById("drag-list");sortable=Sortable.create(el,{ghostClass:"is-dragging",onStart:function(){$scope.nextBtn.enable=!1,$scope.nextBtn.isClickable=!1,$scope.prevBtn.enable=!1,$scope.prevBtn.isClickable=!0,$scope.$apply()},onEnd:function(evt){$timeout(function(){trackListOrder()},300)}})};$scope.isDragTemplateLoaded&&($timeout.cancel(),$timeout(function(){trackListOrder(),setupLayout(),initSortable()},300)),$scope.$watch(function(){return $attrs.tmpl},function(){$timeout.cancel(),$scope.isDragTemplateLoaded&&$timeout(function(){trackListOrder(),setupLayout(),initSortable()},300)})}}}function assessmentVideoCtrl($scope,$timeout,$rootScope,ngDialog){function videoPopUp(url){_this.videoUrl=url,ngDialog.open({template:"/sp/support/videoPopUp",scope:$scope})}var _this=this;_this.videoPopUp=videoPopUp,$scope.videoCall=function(){var videoType,videoSrc=_this.videoUrl;if(/youtube/g.test(videoSrc))videoType="youtube";else if(/vimeo/g.test(videoSrc)){videoType="vimeo";var link=videoSrc.split("?")[0].split("/");videoSrc="https://vimeo.com/"+link[parseInt(link.length-1)]}else videoType="html5";setTimeout(function(){videojs(document.getElementById("vid1"),{autoplay:!1,techOrder:[videoType],src:videoSrc},function(){$scope.videoReady=!0,this.on("ended",function(){var vid=this;vid.trigger("loadstart"),$timeout(function(){vid.posterImage.show()},500)}),this.on("timeupdate",function(){var ct=this.currentTime(),timeLeft=this.remainingTime();ct>0&&this.bigPlayButton.hide(),0===timeLeft&&this.bigPlayButton.show()})})},500)}}angular.module("spApp").controller("assessmentController",assessmentController);var sortable;assessmentController.$inject=["$scope","ajaxService","$timeout","$rootScope","$localStorage"],angular.module("spApp").directive("optionSelection",optionSelection),optionSelection.$inject=["$rootScope","$timeout"],angular.module("spApp").directive("draggableSortableTemplate",draggableSortableTemplate),draggableSortableTemplate.$inject=["$rootScope","$timeout"],angular.module("spApp").controller("assessmentVideoCtrl",assessmentVideoCtrl),assessmentVideoCtrl.$inject=["$scope","$timeout","$rootScope","ngDialog"];
function auditLogController($scope,$q,ajaxService,$filter,ngDialog,sharedProperties,$timeout,$rootScope,$localStorage){var self=this;self.auditFilteredList=[],self.masterAuditList=[],self.urls={getAuditHome:"/sp/sysAdmin/audit/getAuditHome",getAllServices:"/sp/sysAdmin/audit/getAllServices"};var d=new Date;self.filterDialog=null,self.allServices=[],self.pageSetting={pageSize:10,intialPageSize:10,filter:{},userEmail:{email:[]},checkBox:[],statusInclude:["online","offline"],userTypeSelected:"",userServiceSelected:"",lastPredicate:"name",lastReverse:!1,loadBtnCLicked:!1,load:!0,textSearching:"",disabledInfinite:!1,onlineC:!0,offlineC:!0,selectedActivity:"",time:"WEEK",maxDate:d.setMonth(d.getMonth()-3)},self.originalpageSetting=angular.copy(self.pageSetting),self.getAuditHomeData=function(){ajaxService.getAjaxResponse({url:self.urls.getAuditHome}).then(function(response){self.masterAuditList=response.auditLogHome,self.auditFilteredList=angular.copy(self.masterAuditList),self.getAuditFilteredList(self.pageSetting.pageSize)})},self.advancedFilterDialog=function(){self.filterDialog=ngDialog.open({template:"/sp/sysAdmin/audit/advancedFilterPopup",scope:$scope})},self.advanceSearch=function(fromDate,endDate){var month=(1+fromDate.getMonth()).toString();month=month.length>1?month:"0"+month;var day=(1+fromDate.getDate()).toString();day=day.length>1?day:"0"+day;var fromDateFormatted=month+"/"+day+"/"+fromDate.getUTCFullYear(),endmonth=(1+endDate.getMonth()).toString(),endday=(1+endDate.getDate()).toString();endday=endday.length>1?endday:"0"+endday,endmonth=endmonth.length>1?endmonth:"0"+endmonth;var endDateFormatted=endmonth+"/"+endday+"/"+endDate.getUTCFullYear();ajaxService.getAjaxResponse({url:self.urls.getAuditHome,data:$.param({fromDate:fromDateFormatted,endDate:endDateFormatted})}).then(function(response){self.masterAuditList=response.auditLogHome,self.auditFilteredList=angular.copy(self.masterAuditList),self.getAuditFilteredList(self.pageSetting.pageSize),self.filterDialog.close()})},self.getAllServices=function(){ajaxService.getAjaxResponse({url:self.urls.getAllServices}).then(function(response){self.allServices=response.services})},self.resetfilter=function(){self.pageSetting=angular.copy(self.originalpageSetting),self.getAuditFilteredList(self.pageSetting.pageSize)},self.filterByService=function(status){self.getAuditFilteredList(self.pageSetting.pageSize)},self.includeCheck=function(status){self.getAuditFilteredList(self.pageSetting.pageSize)},self.infiniteScroll=function(arg){self.pageSetting.loadBtnCLicked=!0,self.getAuditFilteredList(arg)},self.searchTextFilter=function(search){self.pageSetting.textSearching=search},self.clearSearch=function(){self.pageSetting.textSearching.length&&(self.pageSetting.textSearching="",self.searchText="")},self.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},self.getAuditFilteredList=function(pageSize){if(!self.masterAuditList.length)return!0;var result=self.masterAuditList;self.auditFilteredList=result.filter(function(e){var userTypeFlag=null!=self.pageSetting.userTypeSelected&&self.pageSetting.userTypeSelected===e.accountType||""===self.pageSetting.userTypeSelected&&e.accountType,activityFlag=null!=self.pageSetting.selectedActivity&&self.pageSetting.selectedActivity===e.activityType||""===self.pageSetting.selectedActivity&&e.activityType,serviceFlag=null!=self.pageSetting.userServiceSelected&&$.inArray(self.pageSetting.userServiceSelected,e.serviceType)>-1||""===self.pageSetting.userServiceSelected&&e.serviceType,onlineFlag=self.pageSetting.onlineC===e.online,offlineFlag=self.pageSetting.offlineC===e.offline,timeFilterFlag=!1;return $.inArray(self.pageSetting.time,e.timeFilters)>-1&&(timeFilterFlag=!0),userTypeFlag&&activityFlag&&serviceFlag&&(onlineFlag||offlineFlag)&&timeFilterFlag}),console.log("Search "+self.auditFilteredList.length),self.pageSetting.pageSize=pageSize,pageSize>=self.masterAuditList.length&&(self.pageSetting.disabledInfinite=!0,self.pageSetting.pageSize=self.masterAuditList.length),self.pageSetting.load&&(self.pageSetting.lastPredicate="name",self.pageSetting.lastReverse=!1,self.pageSetting.loadBtnCLicked=!1,self.pageSetting.load=!1)}}function auditLogDetailController($scope,$q,ajaxService,$filter,ngDialog,sharedProperties,$timeout,$rootScope,$localStorage){var self=this;self.auditFilteredList=[],self.masterAuditList=[],self.userDetail=null,self.urls={getAuditDetail:"/sp/sysAdmin/audit/getAuditDetail",getAllServices:"/sp/sysAdmin/audit/getAllServices"};var d=new Date;self.allServices=[],self.pageSetting={pageSize:10,intialPageSize:10,filter:{},userEmail:{email:[]},checkBox:[],statusInclude:["online","offline"],userTypeSelected:"",userServiceSelected:"",lastPredicate:"name",lastReverse:!1,loadBtnCLicked:!1,load:!0,textSearching:"",disabledInfinite:!1,onlineC:!0,offlineC:!0,time:"WEEK",maxDate:d.setMonth(d.getMonth()-3)},self.originalpageSetting=angular.copy(self.pageSetting),self.getAuditDetailData=function(){ajaxService.getAjaxResponse({url:self.urls.getAuditDetail,data:$.param({email:sharedProperties.getParam("email")})}).then(function(response){self.masterAuditList=response.auditDetails,self.userDetail=response.userDetails,self.auditFilteredList=angular.copy(self.masterAuditList)})},self.resetfilter=function(){self.pageSetting=angular.copy(self.originalpageSetting),self.getAuditFilteredList(self.pageSetting.pageSize)},self.getAllServices=function(){ajaxService.getAjaxResponse({url:self.urls.getAllServices}).then(function(response){self.allServices=response.services})},self.advancedFilterDialog=function(){self.filterDialog=ngDialog.open({template:"/sp/sysAdmin/audit/advancedFilterPopup",scope:$scope})},self.advanceSearch=function(fromDate,endDate){var month=(1+fromDate.getMonth()).toString();month=month.length>1?month:"0"+month;var day=(1+fromDate.getDate()).toString();day=day.length>1?day:"0"+day;var fromDateFormatted=month+"/"+day+"/"+fromDate.getUTCFullYear(),endmonth=(1+endDate.getMonth()).toString(),endday=(1+endDate.getDate()).toString();endday=endday.length>1?endday:"0"+endday,endmonth=endmonth.length>1?endmonth:"0"+endmonth;var endDateFormatted=endmonth+"/"+endday+"/"+endDate.getUTCFullYear();ajaxService.getAjaxResponse({url:self.urls.getAuditDetail,data:$.param({email:sharedProperties.getParam("email"),fromDate:fromDateFormatted,endDate:endDateFormatted})}).then(function(response){self.masterAuditList=response.auditDetails,self.userDetail=response.userDetails,self.auditFilteredList=angular.copy(self.masterAuditList),self.filterDialog.close()})},self.searchTextFilter=function(search){self.pageSetting.textSearching=search},self.clearSearch=function(){self.pageSetting.textSearching.length&&(self.pageSetting.textSearching="",self.searchText="")},self.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},self.filterByService=function(status){self.getAuditFilteredList(self.pageSetting.pageSize)},self.includeCheck=function(status){self.getAuditFilteredList(self.pageSetting.pageSize)},self.infiniteScroll=function(arg){self.pageSetting.loadBtnCLicked=!0,self.getAuditFilteredList(arg)},self.getAuditFilteredList=function(pageSize){if(!self.masterAuditList.length)return!0;var result=self.masterAuditList;self.auditFilteredList=result.filter(function(e){var serviceFlag=null!=self.pageSetting.userServiceSelected&&self.pageSetting.userServiceSelected===e.serviceType||""===self.pageSetting.userServiceSelected&&e.serviceType,timeFilterFlag=!1;return $.inArray(self.pageSetting.time,e.timeFilter)>-1&&(timeFilterFlag=!0),serviceFlag&&timeFilterFlag}),console.log("Search "+self.auditFilteredList.length),self.pageSetting.pageSize=pageSize,pageSize>=self.masterAuditList.length&&(self.pageSetting.disabledInfinite=!0,self.pageSetting.pageSize=self.masterAuditList.length),self.pageSetting.load&&(self.pageSetting.lastPredicate="name",self.pageSetting.lastReverse=!1,self.pageSetting.loadBtnCLicked=!1,self.pageSetting.load=!1)}}angular.module("spApp").controller("auditLogListController",auditLogController),angular.module("spApp").controller("auditLogDetailController",auditLogDetailController),auditLogController.$inject=["$scope","$q","ajaxService","$filter","ngDialog","sharedProperties","$timeout","$rootScope","$localStorage"],auditLogDetailController.$inject=["$scope","$q","ajaxService","$filter","ngDialog","sharedProperties","$timeout","$rootScope","$localStorage"];
function candidateAccountsController($scope,$element,$attrs,$http,ngDialog,$timeout,ajaxService,sharedProperties){$scope.hiringProductDetails={},$scope.updatedPromoDetails={},$scope.ccDetails={},$scope.candidate={},$scope.candidate.numBatches=1,$scope.finalAmount=0,$scope.promoApplied=!1,$scope.promoFormSubmitted=!1,$scope.promoDetails={},$scope.promoError={},$scope.promoError.error=!1,$scope.promo={},$scope.dialogStatus={},$scope.timeout=0,$scope.ccEdit=!1,$scope.updateCC1={},$scope.ccDetails1={},$scope.zeroError=!1,$scope.submitDisabled=!1,$scope.serverError=!1,$scope.getAccountInfo=function(){var option="user"===$scope.accType?{url:"/sp/admin/account/businessAccountDetails"}:{url:"/sp/sysAdmin/alternateBilling/account/businessAccountDetails",data:$.param({accountId:sharedProperties.getParam("accountId")})};ajaxService.getAjaxResponse(option).then(function(response){"true"===response.Success?($scope.account=response,$scope.ccDetails=response.account.paymentInstrument,$scope.getProductInfo()):($scope.serverError=!0,$scope.serverErrorMsg=response.error)})},$scope.getProductInfo=function(){var option="user"===$scope.accType?{url:"/sp/admin/account/getHiringProduct"}:{url:"/sp/sysAdmin/alternateBilling/account/getCurrentProductInfo",data:$.param({accountId:sharedProperties.getParam("accountId"),productType:$scope.mode})};ajaxService.getAjaxResponse(option).then(function(response){"true"===response.Success?($scope.productInfoError=!1,$scope.submitDisabled=!1,$scope.hiringProductDetails=response.product,$scope.hiringProductDetails.minEmp=response.product.minEmployee,$scope.hiringProductDetails.bundleSize=parseInt(response.product.minEmployee),$scope.hiringProductDetails.serverUnitPrice=parseFloat(response.product.unitPrice).toFixed(2),"undefined"!=typeof response.promotion&&"undefined"!=typeof response.promotion.unitPrice?($scope.promoApplied=!0,$scope.updatedPromoDetails=response.promotion,$scope.hiringProductDetails.updatedUnitPrice=parseFloat(response.promotion.unitPrice).toFixed(2),$scope.finalAmount=parseFloat($scope.hiringProductDetails.updatedUnitPrice*$scope.candidate.numBatches).toFixed(2)):($scope.promoApplied=!1,$scope.updatedPromoDetails=null,$scope.hiringProductDetails.updatedUnitPrice=parseFloat(response.product.unitPrice).toFixed(2),$scope.finalAmount=parseFloat($scope.hiringProductDetails.updatedUnitPrice*$scope.candidate.numBatches).toFixed(2)),$scope.creditCheck()):($scope.productInfoError=!0,$scope.submitDisabled=!0)})},$scope.clearCcDetails=function(){$scope.updateCC1.submitted=!1,$scope.ccDetails1.nameOnCard=null,$scope.ccDetails1.cardNumber=null,$scope.ccDetails1.month="default",$scope.ccDetails1.year="default",$scope.ccDetails1.cvv=null,$scope.ccDetails1.country="default",$scope.ccDetails1.zip=null},$scope.updateCCdetails=function(ccData,emp){if($scope.serverError=!1,$scope.submitDisabled===!1)if(emp>0)if($scope.ccEdit===!0){$scope.updateCC1.submitted=!1;var vCount=0;for(var k in ccData)("default"===ccData[k]||"default1"===ccData[k])&&vCount++;$scope.updateCC1.$valid&&0===vCount?$scope.addCandidateAccountWithPI(emp,ccData):$scope.updateCC1.submitted=!0}else $scope.addCandidateAccount(emp);else $scope.zeroError=!0,jQuery("html, body").animate({scrollTop:0})},$scope.addCandidateAccount=function(bno){var _params={};$scope.promoApplied===!1?(_params={numBatches:bno,productId:$scope.hiringProductDetails.id},"user"===$scope.accType?_params:_params.accountId=$scope.account.account.id):(_params={numBatches:bno,productId:$scope.hiringProductDetails.id,promotionId:$scope.updatedPromoDetails.id},"user"===$scope.accType?_params:_params.accountId=$scope.account.account.id),ajaxService.getAjaxResponse({url:"user"===$scope.accType?"/sp/admin/account/addHiringCandidates":"/sp/sysAdmin/alternateBilling/account/addHiringCandidates",data:$.param(_params)}).then(function(response){"true"===response.Success?($scope.serverError=!1,$scope.dialogStatus.title="Add Candidate Account(s)",$scope.dialogStatus.content="Candidate(s) added successfully.",ngDialog.open({template:"/sp/resources/html/admin/account/success-dialog.html",scope:$scope})):($scope.serverError=!0,$scope.serverErrorMsg=response.error,jQuery("html, body").animate({scrollTop:0}))})},$scope.addCandidateAccountWithPI=function(bno,cc){var _params={};_params=$scope.promoApplied===!1?$.extend({},{numBatches:bno,productId:$scope.hiringProductDetails.id},cc):$.extend({},{numBatches:bno,productId:$scope.hiringProductDetails.id,promotionId:$scope.updatedPromoDetails.id},cc),ajaxService.getAjaxResponse({url:"user"===$scope.accType?"/sp/admin/account/addHiringCandidatesPI":"/sp/sysAdmin/alternateBilling/account/addHiringCandidatesPI",data:$.param(_params)}).then(function(response){"true"===response.Success?($scope.serverError=!1,$scope.dialogStatus.title="Add Candidate Account(s)",$scope.dialogStatus.content="Candidate(s) added successfully.",ngDialog.open({template:"/sp/resources/html/admin/account/success-dialog.html",scope:$scope})):($scope.serverError=!0,$scope.serverErrorMsg=response.error,jQuery("html, body").animate({scrollTop:0}))})},$scope.paymentCalculator=function(noBatches,action,e){$scope.zeroError=!1;var currentBatch=parseInt(noBatches),updatedBatchNo=0;"undefined"==typeof e?noBatches>=1&&"add"===action?(updatedBatchNo=parseInt(currentBatch+1),$scope.candidate.numBatches=updatedBatchNo,$scope.hiringProductDetails.minEmp=parseInt($scope.hiringProductDetails.minEmp+$scope.hiringProductDetails.bundleSize),$scope.finalAmount=parseFloat($scope.hiringProductDetails.updatedUnitPrice*updatedBatchNo).toFixed(2)):noBatches>1&&"remove"===action&&(updatedBatchNo=parseInt(currentBatch-1),$scope.candidate.numBatches=updatedBatchNo,$scope.finalAmount=parseFloat($scope.hiringProductDetails.updatedUnitPrice*updatedBatchNo).toFixed(2),$scope.hiringProductDetails.minEmp=parseInt($scope.hiringProductDetails.minEmp-$scope.hiringProductDetails.bundleSize)):/^[0-9\b]+$/g.test(noBatches)&&noBatches>0?($scope.candidate.numBatches=noBatches,$scope.hiringProductDetails.minEmp=parseInt($scope.hiringProductDetails.bundleSize*noBatches),$scope.finalAmount=parseFloat($scope.hiringProductDetails.updatedUnitPrice*$scope.candidate.numBatches).toFixed(2),$timeout.cancel($scope.timeout)):($timeout.cancel($scope.timeout),$scope.timeout=$timeout(function(){$scope.candidate.numBatches=1,$scope.hiringProductDetails.minEmp=$scope.hiringProductDetails.bundleSize,$scope.finalAmount=parseFloat($scope.hiringProductDetails.updatedUnitPrice*$scope.candidate.numBatches).toFixed(2)},1500)),$scope.creditCheck()},$scope.activatePromo=function(promoCode){if($scope.promoDetails.$valid){$scope.promoError.error=!1;var _params={code:promoCode.toUpperCase(),productId:$scope.hiringProductDetails.id};ajaxService.getAjaxResponse({url:"/sp/signup/promotion",data:$.param(_params)}).then(function(response){if("true"===response.Success)$scope.updatedPromoDetails=response.promotion,$scope.hiringProductDetails.updatedUnitPrice=parseFloat(response.promotion.unitPrice).toFixed(2),$scope.promoApplied=!0,$scope.finalAmount=parseFloat($scope.hiringProductDetails.updatedUnitPrice*$scope.candidate.numBatches).toFixed(2),$scope.creditCheck();else{$scope.promoError.error=!0;for(var key in response.error)$scope.promoError.msg=response.error[key]}})}else $scope.promoFormSubmitted=!0},$scope.deactivatePromo=function(){$scope.hiringProductDetails.updatedUnitPrice=parseFloat($scope.hiringProductDetails.unitPrice).toFixed(2),$scope.finalAmount=parseFloat($scope.hiringProductDetails.updatedUnitPrice*$scope.candidate.numBatches).toFixed(2),$scope.promoApplied=!1,$scope.promo.code=null,$scope.updatedPromoDetails=null,$scope.creditCheck()},$scope.creditCheck=function(){null!==$scope.ccDetails.paymentType&&"CREDIT_CARD"!==$scope.ccDetails.paymentType&&$scope.finalAmount>$scope.ccDetails.creditBalance?$scope.submitDisabled=!0:$scope.submitDisabled=!1},$scope.cancelRedirect=function(){window.location="user"===$scope.accType?"/sp/admin/account/business":"/sp/sysAdmin/alternateBilling/viewDetailAccount?accountId="+$scope.account.account.id},$scope.initAddMemberAccoutns=function(mode,type){$scope.mode=mode,$scope.accType=type,$scope.getAccountInfo()}}angular.module("spApp").controller("candidateAccountsController",candidateAccountsController),candidateAccountsController.$inject=["$scope","$element","$attrs","$http","ngDialog","$timeout","ajaxService","sharedProperties"];
function candidateAdvisorController($scope,$element,$attrs,$http,$timeout,ajaxService,$rootScope,$localStorage,sharedProperties,ngDialog){$scope.selectedCandidate={},$scope.memberMasterList={},$scope.validMemberList=[],$scope.candidateMasterList={},$scope.validCandidateList=[],$scope.selectedMemberDetails={},$scope.candidateProfileDetails={},$scope.memberProfileDetails={},$scope.candidateAdvise={},$scope.memberAdvise={},$scope.candidateAvoidFormatted=[],$scope.resultTabs={},$scope.personalityFlags=[],$scope.cachedAdvisorData=[],$scope.showMemberListingWidget=!1,$scope.memberSelected=!1,$scope.showContent=!1,$scope.resultTabs.leftSelected=0,$scope.resultTabs.rightSelected=0,$scope.mobileControls={},$scope.mobileControls.display=!1,$scope.viewMode={list:!0,chart:!1},$scope.switchToUser1=!0,$scope.cachedUSerEmails=null,$scope.winWidth=jQuery(window).width(),$scope.sResizeFlag=0,$scope.lResizeFlag=0,jQuery(window).resize(function(){$scope.winWidth=jQuery(window).width()}),$scope.returnBack=function(){window.history.back()},$scope.getSelectedCandidateDetails=function(){$scope.selectedCandidateEmailAddress=sharedProperties.getParam("c");var _o={url:"/sp/hiring/getProfileDetails",data:$.param({candidateEmail:$scope.selectedCandidateEmailAddress}).replace(/%40/g,"@")};ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&($scope.selectedCandidate=response.userProfileForm,$scope.selectedCandidate.hiringRoles=response.hiring.hiringRoles,$scope.selectedCandidate.profilePic=response.hiring.smallProfileImage,$scope.selectedCandidate.userInitials=response.hiring.userInitials,$scope.candidateSelected=!0,$scope.winWidth<768&&$timeout(function(){$rootScope.setBoxSizes("#dd-wrap",".dd","full")},300))})},$scope.getAllCandidateDetails=function(){var _o={url:"/sp/hiring/getAllCandidates"};ajaxService.getAjaxResponse(_o).then(function(response){if("true"===response.Success){var counter=0,newList=[];$scope.candidateMasterList=response.hiring,jQuery.each($scope.candidateMasterList,function(i,j){"VALID"===$scope.candidateMasterList[i].userStatus&&(null===$scope.candidateMasterList[i].spUserId?(newList=jQuery.extend({},$scope.candidateMasterList[i],{selectedCandidateFromList:!1}),$scope.validCandidateList.push(newList)):$scope.candidateMasterList[i].profileSettings.hiringAccessAllowed===!0&&(newList=jQuery.extend({},$scope.candidateMasterList[i],{selectedCandidateFromList:!1}),$scope.validCandidateList.push(newList))),counter++}),counter===$scope.candidateMasterList.length&&$.each($scope.validCandidateList,function(i){$scope.validCandidateList[i].email===sharedProperties.getParam("c")&&($scope.validCandidateList[i].selectedCandidateFromList=!0)})}})},$scope.getAllMemberDetails=function(){var _o={url:"/sp/relationship/getMembers",data:$.param({candidateEmail:sharedProperties.getParam("c")}).replace(/%40/g,"@")};ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&($scope.memberMasterList=response.memberList,jQuery.each($scope.memberMasterList,function(i,j){var newList=jQuery.extend({},$scope.memberMasterList[i],{selectedMember:!1});$scope.validMemberList.push(newList)}))})},$scope.showDropdownWidget=function(side){"right"===side?($scope.showMemberListingWidget=!$scope.showMemberListingWidget,$scope.showCandidateListingWidget=!1):($scope.showCandidateListingWidget=!$scope.showCandidateListingWidget,$scope.showMemberListingWidget=!1)},$scope.compareToolReset=function(){$scope.cachedUSerEmails=null,$scope.resultTabs={},$scope.personalityFlags=[],$scope.cachedAdvisorData=[],$scope.resultTabs.leftSelected=0,$scope.resultTabs.rightSelected=0,$scope.showContent=!1,$scope.showMemberListingWidget=!1,$scope.memberSelected=!1,$scope.showCandidateListingWidget=!1,$scope.candidateSelected=!1,$scope.selectedCandidateEmailAddress=null,$scope.selectedMemberEmailAddress=null,jQuery.each($scope.validMemberList,function(j){$scope.validMemberList[j].selectedMember=!1}),jQuery.each($scope.validCandidateList,function(j){$scope.validCandidateList[j].selectedCandidateFromList=!1}),$scope.mobileControls.display=!1,$scope.viewMode={list:!0,chart:!1},$scope.switchToUser1=!0},$scope.updateCompareMember=function(i){$scope.cachedUSerEmails=null,$scope.showMemberListingWidget=!1,$scope.personalityFlags=[],$scope.cachedAdvisorData=[],$scope.resultTabs.leftSelected=0,$scope.resultTabs.rightSelected=0,jQuery.each($scope.validMemberList,function(j){$scope.validMemberList[j].selectedMember=!1}),jQuery.each($scope.validMemberList,function(j){return $scope.validMemberList[j].email===i?($scope.validMemberList[j].selectedMember=!0,$scope.memberSelected=!0,$scope.selectedMemberDetails=$scope.validMemberList[parseInt(j)],$scope.selectedMemberEmailAddress=$scope.validMemberList[parseInt(j)].email,void($scope.viewMode.list===!0?$scope.compareCandidate($scope.selectedCandidateEmailAddress,$scope.selectedMemberEmailAddress,{candidatePersonalityType:"Primary",memberPersonalityType:"Primary"}):$scope.getCompareCharts($scope.selectedCandidateEmailAddress,$scope.selectedMemberEmailAddress))):void 0})},$scope.updateCompareCandidate=function(i){$scope.cachedUSerEmails=null,$scope.showCandidateListingWidget=!1,$scope.personalityFlags=[],$scope.cachedAdvisorData=[],$scope.resultTabs.leftSelected=0,$scope.resultTabs.rightSelected=0,jQuery.each($scope.validCandidateList,function(j){$scope.validCandidateList[j].selectedCandidateFromList=!1}),jQuery.each($scope.validCandidateList,function(j){$scope.validCandidateList[j].email===i&&($scope.validCandidateList[parseInt(j)].selectedCandidateFromList=!0,$scope.candidateSelected=!0,$scope.selectedCandidate=$scope.validCandidateList[parseInt(j)],$scope.selectedCandidateEmailAddress=$scope.validCandidateList[parseInt(j)].email,$scope.viewMode.list===!0?$scope.compareCandidate($scope.selectedCandidateEmailAddress,$scope.selectedMemberEmailAddress,{candidatePersonalityType:"Primary",memberPersonalityType:"Primary"}):$scope.getCompareCharts($scope.selectedCandidateEmailAddress,$scope.selectedMemberEmailAddress))}),$scope.winWidth<768&&$timeout(function(){$rootScope.setBoxSizes("#dd-wrap",".dd","full")},300)},$scope.getCompareCharts=function(c,m){if($scope.candidateSelected&&$scope.memberSelected&&null===$scope.cachedUSerEmails){var _o={url:"/sp/hiring/compareProfile",data:$.param({candidateEmail:c,memberEmail:m}).replace(/%40/g,"@")};$scope.cachedUSerEmails=c+m,ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&($scope.compareProfileData=response,$scope.candidateProfileDetails=response.candidateAnalysis,$scope.memberProfileDetails=response.memberAnalysis,$scope.cacheCompareResponse=response,$scope.winWidth>767?($scope.showContent=!0,$scope.mobileControls.display=!1,$scope.cachedUSerEmails=null):($scope.showContent=!1,$scope.mobileControls.display=!0,$scope.switchToUser1=!0,setTimeout(function(){$rootScope.setBoxSizes(".mobile-tabs",".mtabs")},200)),$scope.personalityFormatted={candidate:{primary:$rootScope.pullInterNationalization("profileKeys."+$scope.candidateProfileDetails.personality.Primary.personalityType.trim()),pressure:$rootScope.pullInterNationalization("profileKeys."+$scope.candidateProfileDetails.personality.UnderPressure.personalityType.trim())},member:{primary:$rootScope.pullInterNationalization("profileKeys."+$scope.memberProfileDetails.personality.Primary.personalityType.trim()),pressure:$rootScope.pullInterNationalization("profileKeys."+$scope.memberProfileDetails.personality.UnderPressure.personalityType.trim())}},$timeout(function(){$scope.dataAvailablity=!0},300))})}},$scope.changeViewMode=function(v){$scope.showMemberListingWidget=!1,$scope.showCandidateListingWidget=!1,"list"===v?($scope.viewMode.list=!0,$scope.viewMode.chart=!1,$scope.compareCandidate($scope.selectedCandidateEmailAddress,$scope.selectedMemberEmailAddress,{candidatePersonalityType:"Primary",memberPersonalityType:"Primary"})):($scope.viewMode.list=!1,$scope.viewMode.chart=!0,$scope.getCompareCharts($scope.selectedCandidateEmailAddress,$scope.selectedMemberEmailAddress))},$scope.compareCandidate=function(c,m,pTypes){if($scope.candidateSelected&&$scope.memberSelected){var data=$.extend({},{candidateEmail:c,memberEmail:m},pTypes),_o={url:"/sp/hiring/compareRelation",data:$.param(data).replace(/%40/g,"@")};ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&($scope.cacheResults(data,response),$scope.winWidth>767?($scope.showContent=!0,$scope.mobileControls.display=!1,$scope.cachedUSerEmails=null):($scope.showContent=!1,$scope.mobileControls.display=!0,$scope.switchToUser1=!0,setTimeout(function(){$rootScope.setBoxSizes(".mobile-tabs",".mtabs")},200)),setTimeout(function(){$rootScope.setBoxSizes(".results-wrapper",".results-content")},500))})}},$scope.cacheResults=function(p,r){var pType=p.candidatePersonalityType.charAt(0)+p.memberPersonalityType.charAt(0),existingFlag=$.inArray(pType,$scope.personalityFlags);-1===existingFlag&&($scope.personalityFlags.push(pType),$scope.cachedAdvisorData[pType]=r,$scope.candidateAdvise=$scope.cachedAdvisorData[pType].primary,$scope.memberAdvise=$scope.cachedAdvisorData[pType].secondary)},$scope.formatList=function(list){if("undefined"!=typeof list){var rawList=list.split("</p>"),listHTML="",counter=0;if(jQuery.each(rawList,function(i){"undefined"!=typeof rawList[i].split("<p>")[1]&&(listHTML+="<li>"+rawList[i].split("<p>")[1]+"</li>"),counter++}),counter===rawList.length)return listHTML}},$scope.changeContentTabs=function(s,i){"left"===s?$scope.resultTabs.leftSelected=parseInt(i):$scope.resultTabs.rightSelected=parseInt(i);var u1PType=0===$scope.resultTabs.leftSelected?"Primary":"UnderPressure",u2PType=0===$scope.resultTabs.rightSelected?"Primary":"UnderPressure",pFlag=u1PType.charAt(0)+u2PType.charAt(0),existingFlag=$.inArray(pFlag,$scope.personalityFlags);-1===existingFlag?$timeout(function(){$scope.compareCandidate($scope.selectedCandidateEmailAddress,$scope.selectedMemberEmailAddress,{candidatePersonalityType:u1PType,memberPersonalityType:u2PType})},100):($scope.candidateAdvise=$scope.cachedAdvisorData[pFlag].primary,$scope.memberAdvise=$scope.cachedAdvisorData[pFlag].secondary)},$scope.initCandiateCompare=function(){$scope.getSelectedCandidateDetails(),$scope.getAllMemberDetails(),$scope.getAllCandidateDetails()},$scope.printPage=function(f){f===!0&&setTimeout(function(){window.print()},500)},$scope.getMobileReport=function(v){$scope.winScreenHeight=jQuery(window).height()+"px",v===!0?ngDialog.open({template:"/sp/resources/html/tools/hiring/mobile-report.html",scope:$scope}):ngDialog.open({template:"/sp/resources/html/tools/hiring/mobile-charts.html",scope:$scope})},jQuery(window).resize(function(){$scope.winWidth<768?($scope.candidateSelected&&$scope.memberSelected&&0===$scope.sResizeFlag&&$scope.mobileControls.display===!1&&($scope.showContent=!1,$timeout(function(){$scope.mobileControls.display=!0},500),$scope.sResizeFlag=1,$scope.lResizeFlag=0),$rootScope.setBoxSizes("#dd-wrap",".dd","full")):($scope.candidateSelected&&$scope.memberSelected&&0===$scope.lResizeFlag&&($timeout(function(){$scope.mobileControls.display=!1,$scope.showContent=!0},500),$scope.sResizeFlag=0,$scope.lResizeFlag=1),ngDialog.close("ngdialog1"),jQuery("body").find("#dd-wrap").find(".dd").removeAttr("style"))}),$scope.initCandiateCompare()}angular.module("spApp").controller("candidateAdvisorController",candidateAdvisorController),candidateAdvisorController.$inject=["$scope","$element","$attrs","$http","$timeout","ajaxService","$rootScope","$localStorage","sharedProperties","ngDialog"];
function candidateCompareController($scope,$element,$attrs,$http,$timeout,ajaxService,$rootScope,ProfileDataService,$localStorage){$scope.selectedCandidate={},$scope.memberMasterList={},$scope.validMemberList=[],$scope.candidateMasterList={},$scope.validCandidateList=[],$scope.selectedMemberDetails={},$scope.candidateProfileDetails={},$scope.memberProfileDetails={},$scope.showMemberListingWidget=!1,$scope.memberSelected=!1,$scope.returnBack=function(){window.history.back()},$scope.getSelectedCandidateDetails=function(){$scope.selectedCandidateEmailAddress=$localStorage.get("candidateEmail");var _o={url:"/sp/hiring/getProfileDetails",data:$.param({candidateEmail:$scope.selectedCandidateEmailAddress}).replace(/%40/g,"@")};ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&($scope.selectedCandidate=response.userProfileForm,$scope.selectedCandidate.hiringRoles=response.hiring.hiringRoles,$scope.selectedCandidate.profilePic=response.hiring.smallProfileImage,$scope.selectedCandidate.userInitials=response.hiring.userInitials,$scope.candidateSelected=!0)})},$scope.getAllMemberDetails=function(){var _o={url:"/sp/relationship/getMembers",data:$.param({candidateEmail:$localStorage.get("candidateEmail")}).replace(/%40/g,"@")};ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&($scope.memberMasterList=response.memberList,jQuery.each($scope.memberMasterList,function(i,j){var newList=jQuery.extend({},$scope.memberMasterList[i],{selectedMember:!1});$scope.validMemberList.push(newList)}))})},$scope.getAllCandidateDetails=function(){var _o={url:"/sp/hiring/getAllCandidates"};ajaxService.getAjaxResponse(_o).then(function(response){if("true"===response.Success){var counter=0;$scope.candidateMasterList=response.hiring,jQuery.each($scope.candidateMasterList,function(i,j){var newList;"VALID"===$scope.candidateMasterList[i].userStatus&&(null===$scope.candidateMasterList[i].spUserId?(newList=jQuery.extend({},$scope.candidateMasterList[i],{selectedCandidateFromList:!1}),$scope.validCandidateList.push(newList)):$scope.candidateMasterList[i].profileSettings.hiringAccessAllowed===!0&&(newList=jQuery.extend({},$scope.candidateMasterList[i],{selectedCandidateFromList:!1}),$scope.validCandidateList.push(newList))),counter++}),counter===$scope.candidateMasterList.length&&$.each($scope.validCandidateList,function(i){$scope.validCandidateList[i].email===$localStorage.get("candidateEmail")&&($scope.validCandidateList[i].selectedCandidateFromList=!0)})}})},$scope.showDropdownWidget=function(side){"right"===side?($scope.showMemberListingWidget=!$scope.showMemberListingWidget,$scope.showCandidateListingWidget=!1):($scope.showCandidateListingWidget=!$scope.showCandidateListingWidget,$scope.showMemberListingWidget=!1)},$scope.compareToolReset=function(){$scope.showContent=!1,$scope.showMemberListingWidget=!1,$scope.memberSelected=!1,$scope.showCandidateListingWidget=!1,$scope.candidateSelected=!1,$scope.selectedCandidateEmailAddress=null,$scope.selectedMemberEmailAddress=null,jQuery.each($scope.validMemberList,function(j){$scope.validMemberList[j].selectedMember=!1}),jQuery.each($scope.validCandidateList,function(j){$scope.validCandidateList[j].selectedCandidateFromList=!1})},$scope.updateCompareMember=function(i){$scope.showMemberListingWidget=!1,jQuery.each($scope.validMemberList,function(j){$scope.validMemberList[j].selectedMember=!1}),jQuery.each($scope.validMemberList,function(j){return $scope.validMemberList[j].email===i?($scope.validMemberList[j].selectedMember=!0,$scope.memberSelected=!0,$scope.selectedMemberDetails=$scope.validMemberList[parseInt(j)],$scope.selectedMemberEmailAddress=$scope.validMemberList[parseInt(j)].email,void $scope.compareCandidate($scope.selectedCandidateEmailAddress,$scope.selectedMemberEmailAddress)):void 0})},$scope.updateCompareCandidate=function(i){$scope.showCandidateListingWidget=!1,jQuery.each($scope.validCandidateList,function(j){$scope.validCandidateList[j].selectedCandidateFromList=!1}),jQuery.each($scope.validCandidateList,function(j){$scope.validCandidateList[j].email===i&&($scope.validCandidateList[parseInt(j)].selectedCandidateFromList=!0,$scope.candidateSelected=!0,$scope.selectedCandidate=$scope.validCandidateList[parseInt(j)],$scope.selectedCandidateEmailAddress=$scope.validCandidateList[parseInt(j)].email,$scope.compareCandidate($scope.selectedCandidateEmailAddress,$scope.selectedMemberEmailAddress))})},$scope.compareCandidate=function(c,m){if($scope.candidateSelected&&$scope.memberSelected){var _o={url:"/sp/hiring/compareProfile",data:$.param({candidateEmail:c,memberEmail:m}).replace(/%40/g,"@")};ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&($scope.compareProfileData=response,$scope.candidateProfileDetails=response.candidateAnalysis,$scope.memberProfileDetails=response.memberAnalysis,$scope.personalityFormatted={candidate:{primary:$rootScope.pullInterNationalization("profileKeys."+$scope.candidateProfileDetails.personality.Primary.personalityType.trim()),pressure:$rootScope.pullInterNationalization("profileKeys."+$scope.candidateProfileDetails.personality.UnderPressure.personalityType.trim())},member:{primary:$rootScope.pullInterNationalization("profileKeys."+$scope.memberProfileDetails.personality.Primary.personalityType.trim()),pressure:$rootScope.pullInterNationalization("profileKeys."+$scope.memberProfileDetails.personality.UnderPressure.personalityType.trim())}},ProfileDataService.saveCandidate(response),ProfileDataService.saveMember(response),$timeout(function(){$scope.dataAvailablity=!0},300))})}},$scope.initCandiateCompare=function(){$scope.getSelectedCandidateDetails(),$scope.getAllMemberDetails(),$scope.getAllCandidateDetails()},$scope.printPage=function(f){f===!0&&setTimeout(function(){window.print()},500)},$scope.initCandiateCompare()}angular.module("spApp").controller("candidateCompareController",candidateCompareController),candidateCompareController.$inject=["$scope","$element","$attrs","$http","$timeout","ajaxService","$rootScope","ProfileDataService","$localStorage"];
function candidateIncompleteProfile($scope,$http,$element,$attrs,ajaxService,$localStorage){$scope.candidateProfile={},$scope.candidateProfileDetails={},$scope.processCandidateProfile=function(fData){if($scope.candidateProfileDetails.submitted=!1,$scope.candidateProfileDetails.$valid){var _o={url:"/sp/hiring/updateProfile",data:$.param(fData).replace(/%40/g,"@").replace(/%2C/g,",")};ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&window.location.reload()})}else $scope.candidateProfileDetails.submitted=!0},$scope.initCandidateProfile=function(){var _o={url:"/sp/hiring/getProfileDetails",data:$.param({candidateEmail:$localStorage.get("candidateEmail")}).replace(/%40/g,"@")};ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&($scope.candidateProfile=response.userProfileForm,0===$scope.candidateProfile.month&&($scope.candidateProfile.month="default"),0===$scope.candidateProfile.day&&($scope.candidateProfile.day="default"),0===$scope.candidateProfile.year&&($scope.candidateProfile.year="default"),("undefined"==typeof $scope.candidateProfile.address||null===$scope.candidateProfile.address)&&($scope.candidateProfile.country="default",$scope.candidateProfile.state=null))})},$scope.initCandidateProfile()}angular.module("spApp").controller("candidateIncompleteProfile",candidateIncompleteProfile),candidateIncompleteProfile.$inject=["$scope","$http","$element","$attrs","ajaxService","$localStorage"];
function candidateListingController($scope,$q,$element,$attrs,ajaxService,$location,$http,$state,$filter,ngDialog,sharedProperties,$timeout,$rootScope,$localStorage){$scope.memberList=[],$scope.masterMemberList=[],$scope.backupMasterMemberList=[],$scope.showfilter=!1,$scope.pageSize=10,$scope.intialPageSize=10,$scope.searchTag=[],$scope.hiringRoles=[],$scope.alldisplay=!1,$scope.filter={},$scope.tags=[],$scope.userEmail={email:[]},$scope.checkBox=[],$scope.allMembersEmailId=[],$scope.statusInclude=[],$scope.setEditMode=!1,$scope.userStatus=[],$scope.groupModule=[],$scope.masterGroupModule=[],$scope.textSearching="",$scope.mainGroupInfoList=[],$scope.checkedAll=!1,$scope.deleteUser=!1,$scope.deleteUserError=!1,$scope.updateGroup=!1,$scope.updateGroupError=!1,$scope.updateError="",$scope.EditGroupEmail="",$scope.archiveDialog={},$scope.archiveDialog.addHiring=!1,$scope.showArchive=!1,$scope.load=!0,$scope.showIntro=!1,$scope.member={},$scope.dataWithFlags=[],$scope.memCountCheck=!1,$scope.newOrderFlag=0,$scope.addNewMember={},$scope.addNewMember.submitted=!1;var storedProfile=$localStorage.get("loggegdInProfile"),userRoles=storedProfile.member.roles.sort();$scope.isAccountAdmin=0===jQuery.inArray("AccountAdministrator",userRoles)?!0:!1,$scope.isAdmin=0===jQuery.inArray("Administrator",userRoles)?!0:!1,$localStorage.remove("showProfileTab"),$scope.formatDate=function(d){if(null!==d&&"undefined"!=typeof d){var splitDate=d.split("-"),monthData={"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"},formattedDate=monthData[splitDate[1].toString()]+" "+parseInt(splitDate[2])+", "+parseInt(splitDate[0]);return formattedDate}},$scope.formatName=function(n){if(null!==n||"undefined"!==n){var slpitName=n.split(", "),formatName=slpitName[1]+" "+slpitName[0];return formatName}},$scope.getMembersData=function(){var growlNotification=$localStorage.get("gNotify");null!==growlNotification&&"undefined"!=typeof growlNotification&&("AddSingle"===growlNotification&&$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Candidate</strong>",message:" added successfully"}),"AddHire"===growlNotification&&$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Member</strong>",message:" added successfully"}),"import"===growlNotification&&$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Candidate(s)</strong>",message:" imported successfully"}),"moved"===growlNotification&&$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Candidate</strong>",message:" added to list successfully"}),"deleted"===growlNotification&&$.growl({icon:"glyphicon glyphicon-ok",message:"Candidate deleted successfully"}),"profileError"===growlNotification&&$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$localStorage.get("profileError")}),setTimeout(function(){$localStorage.remove("gNotify"),$localStorage.remove("profileError")},300));var options={url:"/sp/hiring/getAllCandidates"};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success){$scope.getArchiveCandidateList(),$localStorage.remove("isCandidateArchived","archiveCandidateId","candidateEmail","candidateID");var btnFlags,counter=0;$scope.backupMasterMemberList=response.hiring.length?response.hiring:[],$scope.newList=[],$scope.backupMasterMemberList.length>0?$scope.showIntro=!1:$scope.showIntro=!0,$.each($scope.backupMasterMemberList,function(i){"VALID"===$scope.backupMasterMemberList[i].userStatus?null===$scope.backupMasterMemberList[i].spUserId?(btnFlags=$.extend({},$scope.backupMasterMemberList[i],{btnFlags:{sendReminder:!1,archiveBtn:!0,SendInvite:!1,viewProfile:!0,viewCompare:!0,viewAdvisor:!0,requestAccess:!1}}),$scope.newList.push(btnFlags)):$scope.backupMasterMemberList[i].profileSettings.hiringAccessAllowed===!0?(btnFlags=$.extend({},$scope.backupMasterMemberList[i],{btnFlags:{sendReminder:!1,archiveBtn:!0,SendInvite:!1,viewProfile:!0,viewCompare:!0,viewAdvisor:!0,requestAccess:!1}}),$scope.newList.push(btnFlags)):(btnFlags=$.extend({},$scope.backupMasterMemberList[i],{btnFlags:{sendReminder:!1,archiveBtn:!0,SendInvite:!1,viewProfile:!1,viewCompare:!1,viewAdvisor:!1,requestAccess:!0}}),$scope.newList.push(btnFlags)):"INVITATION_SENT"===$scope.backupMasterMemberList[i].userStatus||"ASSESSMENT_PROGRESS"===$scope.backupMasterMemberList[i].userStatus||"ASSESSMENT_PENDING"===$scope.backupMasterMemberList[i].userStatus||"ADD_REFERENCES"===$scope.backupMasterMemberList[i].userStatus||"PROFILE_INCOMPLETE"===$scope.backupMasterMemberList[i].userStatus?(btnFlags=$.extend({},$scope.backupMasterMemberList[i],{btnFlags:{sendReminder:!0,archiveBtn:!1,SendInvite:!1,viewProfile:!1,viewCompare:!1,viewAdvisor:!1,requestAccess:!1}}),$scope.newList.push(btnFlags)):("INVITATION_NOT_SENT"===$scope.backupMasterMemberList[i].userStatus||"INVITATION_EXPIRED"===$scope.backupMasterMemberList[i].userStatus)&&(btnFlags=$.extend({},$scope.backupMasterMemberList[i],{btnFlags:{sendReminder:!1,archiveBtn:!1,SendInvite:!0,viewProfile:!1,viewCompare:!1,viewAdvisor:!1,requestAccess:!1}}),$scope.newList.push(btnFlags)),counter++}),counter===$scope.backupMasterMemberList.length&&($scope.masterMemberList=$scope.newList,$scope.returnMemberList($scope.pageSize),$scope.tagListArray=[],$scope.mokroles=[],$scope.userRoles=[],angular.forEach($scope.backupMasterMemberList,function(val,index){$scope.allMembersEmailId.push(val.email),null!=val.tagList&&($scope.tagListArray=val.tagList.concat($scope.tagListArray).unique()),null!=val.userStatusFormatted&&$scope.mokroles.push(val.userStatusFormatted),null!==val.hiringRoles&&($scope.userRoles=val.hiringRoles.concat($scope.userRoles).unique())}),$scope.tagListArray=$scope.autoCompleteType($scope.tagListArray),$scope.userStatus=$scope.mokroles.unique().sort(),$scope.hiringRoles=$scope.userRoles.unique(),$scope.listLoaded=!0)}})},$scope.intersection=function(a,b){var result=[],ai=0,bi=0;for(a.sort(),b.sort();a.length>ai&&b.length>bi;)a[ai]<b[bi]?ai++:a[ai]>b[bi]?bi++:(result.push(a[ai]),ai++,bi++);return result},$scope.enableAdvanceSection=function(event){$(event.currentTarget).closest(".complete-profile").find(".editable-section").show()},$scope.autoCompleteType=function(arr){for(var customarray=[],i=0;i<arr.length;i++)customarray.push({text:arr[i]});return customarray},$scope.order=function(predicate,reverse){$scope.lastPredicate=predicate,$scope.lastReverse=reverse,$scope.memberList=$filter("orderBy")($scope.memberList,predicate,reverse)},$scope.loadTags=function(query){var deferred=$q.defer();return deferred.resolve($scope.getLoadSuggestion(query)),deferred.promise},$scope.getLoadSuggestion=function(query){for(var copyArray=[],i=0;i<$scope.tagListArray.length;i++)angular.lowercase($scope.tagListArray[i].text).indexOf(angular.lowercase(query))>-1&&copyArray.push($scope.tagListArray[i]);return copyArray.slice(0,5)},$scope.tagAdded=function(tag){$scope.searchTag.push(tag.text),$scope.refineSearch($scope.searchTag)},$scope.tagRemoved=function(tag){$scope.searchTag.splice($scope.searchTag.indexOf(tag.text),1),$scope.refineSearch($scope.searchTag)},$scope.refineSearch=function(list){$scope.newArr=[],angular.forEach($scope.masterMemberList,function(val,key){null!=val.tagList&&$scope.intersection(val.tagList,list).length===list.length&&$scope.newArr.push(val)}),$scope.checkboxFilter()},$scope.includeCheck=function(status){var i=$.inArray(status,$scope.statusInclude);i>-1?$scope.statusInclude.splice(i,1):$scope.statusInclude.push(status),$scope.checkboxFilter()},$scope.checkboxFilter=function(status){$scope.statusInclude.length>0&&($scope.checkBox=[],angular.forEach($scope.masterMemberList,function(val,index){for(var i=0;i<$scope.statusInclude.length;i++)for(var j=0;j<val.roles[i].length;j++)val.roles[j]===$scope.statusInclude[i]&&$scope.checkBox.push(val)})),$scope.returnMemberList($scope.pageSize)},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.returnMemberList($scope.pageSize)},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize))},$scope.active=function(event){var currentElem=$(event.currentTarget);currentElem.find("h4").hasClass("on")?currentElem.find("h4").hasClass("reverseon")?currentElem.find("h4").removeClass("reverseon"):currentElem.find("h4").addClass("reverseon"):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"))},$scope.returnMemberList=function(pageSize){if($scope.searchTag.length&&!$scope.statusInclude.length&&($scope.memberList=angular.copy($scope.newArr)),$scope.searchTag.length&&$scope.statusInclude.length){$scope.combineArray=[];for(var i=0;i<$scope.newArr.length;i++)for(var j=0;j<$scope.checkBox.length;j++)$scope.newArr[i].email===$scope.checkBox[j].email&&$scope.combineArray.push($scope.newArr[i]);$scope.memberList=angular.copy($scope.combineArray)}!$scope.searchTag.length&&$scope.statusInclude.length&&($scope.memberList=angular.copy($scope.checkBox)),$scope.searchTag.length||$scope.statusInclude.length||($scope.memberList=angular.copy($scope.masterMemberList)),$scope.memberList=sharedProperties.searchModule($scope.textSearching,$scope.memberList,2),$scope.pageSize=pageSize,pageSize>=$scope.masterMemberList.length&&($scope.disabledInfinite=!0,$scope.pageSize=$scope.masterMemberList.length),$scope.load&&($scope.lastPredicate="name",$scope.lastReverse=!1,$scope.loadBtnCLicked=!1,$scope.load=!1),$scope.loadBtnCLicked&&($scope.loadBtnCLicked=!1),$scope.order($scope.lastPredicate,$scope.lastReverse),$scope.memberList=$scope.memberList},$scope.checkAll=function(){$scope.checkedAll=!$scope.checkedAll,this.negative?$scope.userEmail.email=$scope.masterMemberList.map(function(item){return{email:item.email,name:item.name}}):$scope.userEmail.email=[]},$scope.checkUncheck=function(){$scope.alltoggle=!1,$scope.checkedAll&&($scope.negative=!$scope.negative,$scope.checkedAll=!$scope.checkedAll)},$scope.resetfilter=function(allmembers){$scope.pageSize=$scope.intialPageSize,$scope.newArr=[],$scope.searchTag=[],$scope.tags=[],$scope.filter={},$scope.userEmail.email=[],$scope.statusInclude=[],$scope.adminc=!1,$scope.leadC=!1,$scope.textSearching="",$scope.searchText="","undefined"!=typeof this.selectedSearch&&(this.selectedSearch.userStatusFormatted="",this.selectedSearch.hiringRoles=""),$scope.memberList=angular.copy($scope.masterMemberList),"undefined"!=typeof allmembers&&($scope.pageSize=$scope.masterMemberList.length),$scope.checkUncheck(),angular.element($(".tags").find("input")).scope().newTag.text="",$scope.load=!0,$scope.disabledInfinite=!1,$rootScope.$broadcast("$scrollStart"),$scope.returnMemberList($scope.pageSize);var curr=$(".memberHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")},$scope.confirmDelete=function(event){var email=$(event.target).closest(".complete-profile").find(".email").html(),options=(angular.element(event.currentTarget),{url:"/sp/hiring/deleteCandidate",data:$.param({candidateEmail:email})});ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?($scope.getMembersData(),$scope.userEmail.email=[],$scope.alltoggle=!1,$scope.checkedAll&&($scope.negative=!$scope.negative),$.growl({icon:"glyphicon glyphicon-ok",message:"Candidate(s) deleted successfully"})):$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:"Server Error"})})},$scope.certainDelete=function(){ngDialog.open({template:"/sp/resources/html/tools/hiring/deleteConfirmation.html",scope:$scope})},$scope.deleteUsers=function(emails){var emailList=[];jQuery.each(emails,function(i,j){emailList.push(emails[i].email)});var options={url:"/sp/hiring/deleteCandidate",data:$.param({candidateEmail:emailList.toString()})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&($scope.getMembersData(),$scope.userEmail.email=[],$scope.alltoggle=!1,$scope.checkedAll&&($scope.negative=!$scope.negative),ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:"Candidate(s) deleted successfully"}))})},$scope.addClassActive=function(){$scope.dropUp=!$scope.dropUp},$scope.notificationEmail=function(emails){emails.length&&(sharedProperties.setEmail(emails),sharedProperties.setObject($scope.memberList),ngDialog.open({template:"return-visitor.html"}))},$scope.profileRoute=function(event){var groupname=$(event.currentTarget).data("routeparam");$localStorage.set("groupname",groupname),window.location.href="/sp/admin/group/#profile"},$scope.showFullList=function(){$scope.resetfilter("full")},$scope.editGroupSection=function(index){$scope.EditGroupEmail=this.memberList.email;for(var currentEmail=this.memberList.email,i=0;i<$scope.memberList.length;i++)currentEmail===$scope.memberList[i].email&&(index=i);$scope.setEditMode=!0,$scope.indexToChange=index,$scope.groupEditSection=angular.copy($scope.memberList[index]),$scope.groupSelectOption=[];for(var j=0;j<$scope.groupEditSection.groupAssociationList.length;j++)$scope.groupSelectOption.push($scope.groupEditSection.groupAssociationList[j].name);ngDialog.open({template:"/sp/admin/member/editGroup",scope:$scope})},$scope.enableLeadDialog=function(leadValue,index,groupName){for(var i=0;i<$scope.mainGroupInfoList.length;i++)if(groupName===$scope.mainGroupInfoList[i].name){if(null!==$scope.mainGroupInfoList[i].groupLead&&$scope.mainGroupInfoList[i].groupLead.email!==$scope.EditGroupEmail)return!1;$scope.groupEditSection.groupAssociationList[index].groupLead=!leadValue}},$scope.setStyle=function(lead){return $scope.viewMode(),lead===!0?!0:!1},$scope.isItEnabled=function(groupName,id){$scope.classActivate=[];for(var i=0;i<$scope.mainGroupInfoList.length;i++)groupName===$scope.mainGroupInfoList[i].name&&null!==$scope.mainGroupInfoList[i].groupLead&&$scope.mainGroupInfoList[i].groupLead.email!==$scope.EditGroupEmail&&($scope.classActivate.push("#mode_"+id),$scope.classActivate.push("#modeprop_"+id))},$scope.viewMode=function(){if($scope.classActivate.length)for(var i=0;i<$scope.classActivate.length;i++)$($scope.classActivate[i]).addClass("disabled")},$scope.addGroupToModule=function(groupName,lead){return $scope.selectedGroup=groupName,"default"===groupName?!1:(""===$scope.groupEditSection.groupAssociationList[0].name&&$scope.groupEditSection.groupAssociationList.splice(0,1),$scope.groupEditSection.groupAssociationList.push({name:groupName,groupLead:!1}),void $scope.groupSelectOption.push(groupName))},$scope.addGroupMember=function(names){return""===names?!1:!0},$scope.removeGroupDialog=function(event,groupName){for(var _this=event.target,current=($(_this).closest(".blockGroup").remove(),""),i=0;i<$scope.groupEditSection.groupAssociationList.length;i++)$scope.groupEditSection.groupAssociationList[i].name===groupName.name&&($scope.groupEditSection.groupAssociationList.splice(i,1),current=i);$scope.groupSelectOption.splice(current,1)},$scope.saveGroupToModule=function(groupName){for(var newArr="",i=0;i<$scope.groupEditSection.groupAssociationList.length;i++)newArr=newArr.length?newArr+","+$scope.groupEditSection.groupAssociationList[i].name+":"+$scope.groupEditSection.groupAssociationList[i].groupLead:$scope.groupEditSection.groupAssociationList[i].name+":"+$scope.groupEditSection.groupAssociationList[i].groupLead;var options={url:"/sp/admin/group/memberGroupUpdate",data:$.param({groupAssociationList:newArr,memberEmail:$scope.groupEditSection.email})};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success){$scope.groupEditSection.groupAssociationList.length?$scope.memberList[$scope.indexToChange]=$scope.groupEditSection:($scope.groupEditSection.groupAssociationList.push({name:"",groupLead:!1}),$scope.memberList[$scope.indexToChange]=$scope.groupEditSection);for(var i=0;i<$scope.masterMemberList.length;i++)$scope.masterMemberList[i].email===$scope.memberList[$scope.indexToChange].email&&($scope.masterMemberList[i]=$scope.groupEditSection);ngDialog.close("ngdialog1"),ngDialog.open({template:"/sp/admin/member/confirmation"})}else ngDialog.close("ngdialog1"),ngDialog.open({template:"/sp/admin/member/errorGroup"})})},$scope.memberTakeAway=function(email,id,spProfile){$localStorage.set("candidateEmail",email).set("candidateID",id),spProfile===!0&&$localStorage.set("showProfileTab",!0),window.location.href="/sp/tools/hiring/profile?cemail="+email},$scope.candidateCompare=function(email,id){$localStorage.set("candidateEmail",email).set("candidateID",id),window.location.href="/sp/tools/hiring/compare"},$scope.candidateAdvisor=function(email,id){$localStorage.set("candidateEmail",email).set("candidateID",id),window.location.href="/sp/tools/hiring/advisor?c="+email},$scope.calltoAction=function(select){return""===select?!1:void(window.location.href=select)},$scope.archiveDialog=function(e,n,r){$scope.archiveCandidate={name:n,email:e,roles:r},ngDialog.open({template:"/sp/resources/html/tools/hiring/archive-candidate.html",scope:$scope})},$scope.archiveAllCandidate=function(cEmail,isHired,single){var emailList=[];single!==!0?jQuery.each(cEmail,function(i,j){emailList.push(cEmail[i].email)}):emailList=cEmail;var options={url:"/sp/hiring/archiveCandidate",data:$.param({candidateEmail:emailList.toString(),isHired:!1})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&(ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Candidate(s)</strong>",message:" archived successfully"}),$scope.getMembersData(),$scope.negative=!$scope.negative,$scope.archiveDialog.addHiring=!1)})},$scope.archiveAllDialog=function(emails){emails.length>0&&($scope.archiveCandidateAll={emails:emails},ngDialog.open({template:"/sp/resources/html/tools/hiring/archive-candidate-list.html",scope:$scope}),$scope.userEmail.email=[],$scope.alltoggle=!1,$scope.checkedAll&&($scope.negative=!$scope.negative))},$scope.sendViewProfileRequest=function(e,n){$scope.profileRequest={email:e,name:n,heading:"Request Access"},ngDialog.open({template:"/sp/resources/html/tools/hiring/send-profile-invite.html",scope:$scope}),$scope.sendRequest=function(e){var options={url:"/sp/notifications/sendNotification",data:$.param({memberEmail:e,type:""}).replace(/%40/g,"@")};ajaxService.getAjaxResponse(options).then(function(response){"true"!==response.Success&&$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:"Not able to send invite"})})}},$scope.getArchiveCandidateList=function(){var options={url:"/sp/hiring/getAllArchivedCandidates"};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&(response["hiring-archived"].length>0?$scope.showArchive=!0:$scope.showArchive=!1)})},$scope.sendReminder=function(e,n){$scope.profileRequest={email:e,name:n,heading:"Reminder"},ngDialog.open({template:"/sp/resources/html/tools/hiring/send-profile-invite.html",scope:$scope}),$scope.sendRequest=function(e){var options={url:"/sp/notifications/sendNotification",data:$.param({memberEmail:e,type:""}).replace(/%40/g,"@")};ajaxService.getAjaxResponse(options).then(function(response){"true"!==response.Success&&$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:"Not able to send invite"})})}},$scope.hireCandidate=function(e,n,r){$scope.hireCandidateDetails={name:n,email:e,roles:r},$scope.member={},$scope.member.firstName=$scope.hireCandidateDetails.name.split(" ")[0],$scope.member.lastName=$scope.hireCandidateDetails.name.split(" ")[1],$scope.isAdmin||$scope.isAccountAdmin?ajaxService.getAjaxResponse({url:"/sp/admin/member/availalbeMemberSubscriptions"}).then(function(response){"true"===response.Success&&($scope.memberAccountsCount=response.availalbeMemberSubscriptions,$scope.memberAccountsCount>0?($scope.getGroupList(),ngDialog.open({template:"/sp/resources/html/tools/hiring/hire-candidate.html",scope:$scope})):ngDialog.open({template:"/sp/resources/html/tools/hiring/hire-candidate-no-members.html",scope:$scope}))}):ngDialog.open({template:"/sp/resources/html/tools/hiring/hire-candidate-not-admin.html",scope:$scope}),$scope.hireCandidateArchive=function(){ajaxService.getAjaxResponse({url:"/sp/hiring/archiveCandidate",data:$.param({candidateEmail:$scope.hireCandidateDetails.email,isHired:!0})}).then(function(response){if("true"===response.Success)$scope.getMembersData(),ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Candidate</strong>",message:" status changed to 'Hired' and archived successfully"});else{for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.addMember=function(fData){this.addNewMember.submitted=!1,this.addNewMember.$valid?ajaxService.getAjaxResponse({url:"/sp/admin/member/addSingle",data:$.param(fData).replace(/%2C/g,",")}).then(function(response){if("true"===response.Success)ajaxService.getAjaxResponse({url:"/sp/hiring/archiveCandidate",data:$.param({candidateEmail:$scope.hireCandidateDetails.email,isHired:!0})}).then(function(response){if("true"===response.Success)$scope.getMembersData(),ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Member</strong>",message:" added successfully"});else{ngDialog.close("ngdialog1");for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}});else{ngDialog.close("ngdialog1");for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}}):this.addNewMember.submitted=!0}},$scope.getGroupList=function(){$scope.groupDataSet=[],$scope.groupDataSetBackup=[],$scope.dataWithFlags=[],ajaxService.getAjaxResponse({url:"/sp/admin/group/all"}).then(function(response){if("true"===response.Success)$scope.groupDataSet=response.groupInfoList,$scope.groupDataSetBackup=response.groupInfoList,jQuery.each($scope.groupDataSet,function(i,j){$scope.dataWithFlags.push(jQuery.extend({},$scope.groupDataSet[i],{selectedFlag:!1,isGroupLead:!1}))}),$scope.flagCounter=$scope.dataWithFlags.length;else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.updateTagList=function(single,multiple){$scope.member.groupAssociationList=null,$scope.tagList=[],jQuery.each($scope.dataWithFlags,function(i,j){$scope.dataWithFlags[i].selectedFlag===!0&&multiple===!0?$scope.tagList.push($scope.dataWithFlags[i].name):$scope.dataWithFlags[i].selectedFlag===!0&&single===!0&&($scope.dataWithFlags[i].isGroupLead===!0?$scope.tagList.push($scope.dataWithFlags[i].name+":true"):$scope.tagList.push($scope.dataWithFlags[i].name+":false")),$scope.member.groupAssociationList=$scope.tagList.join()})},$scope.updateGroupLeadStatus=function(i,email,single,multiple,j){var _a=jQuery("body").find("a#gl_"+j);"undefined"!=typeof $scope.dataWithFlags[i]&&null===email&&($scope.dataWithFlags[i].isGroupLead===!0?($scope.dataWithFlags[i].isGroupLead=!1,_a.removeClass("on")):($scope.dataWithFlags[i].isGroupLead=!0,_a.addClass("on")),$scope.updateTagList(single,multiple))},$scope.changeGroup=function(flag,single,multiple){"default"!==flag&&("createGroupCall_custom"===flag?($scope.params={p1:single,p2:multiple},$scope.errornewEmptyGroup=!1,$scope.errornewGroup=!1,ngDialog.open({template:"/sp/admin/group/createGroup",scope:$scope}),$scope.member.gList="default"):($scope.dataWithFlags[flag].selectedFlag=!0,$scope.flagCounter-=1,$scope.updateTagList(single,multiple),$scope.member.gList="default",$scope.dataWithFlags[flag].newOrder=$scope.newOrderFlag++,$scope.dataWithFlags[flag].originalIndex=flag))},$scope.removeGroup=function(flag,single,multiple){"default"!==flag&&($scope.dataWithFlags[flag].selectedFlag=!1,$scope.dataWithFlags[flag].isGroupLead=!1,$scope.flagCounter+=1,$scope.updateTagList(single,multiple))},$scope.saveNewGroup=function(groupname,groupLeadEmailId){var $this=this;if($scope.errornewEmptyGroup=!1,$scope.errornewGroup=!1,""===groupname||"undefined"==typeof groupname)return $scope.errornewEmptyGroup=!0,!1;var obj={name:groupname},options={url:"/sp/admin/group/create",data:$.param(obj)};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?($this.closeThisDialog(),$scope.dataWithFlags.push({name:groupname,groupLead:null,numOfMembers:0,memberSummaryList:null,selectedFlag:!0,originalIndex:$scope.dataWithFlags.length,newOrder:$scope.newOrderFlag}),$scope.flagCounter-=1,$scope.member.gList="default",$scope.newOrderFlag+=1,$scope.updateTagList($scope.params.p1,$scope.params.p2)):null!=response.error&&($scope.member.gList="default",$scope.errornewGroup=!0)})},$scope.closeGroup=function(){$scope.member.gList="default",this.closeThisDialog()}}function notification($scope,sharedProperties){$scope.name=[];var memberList=sharedProperties.getObject(),emails=sharedProperties.getEmail();$scope.emailId=emails,angular.forEach(memberList,function(val,index){for(var i=0;i<emails.length;i++)emails[i]===val.email&&$scope.name.push(val.name)})}angular.module("spApp").controller("candidateListingController",candidateListingController),angular.module("spApp").controller("notification",notification),candidateListingController.$inject=["$scope","$q","$element","$attrs","ajaxService","$location","$http","$state","$filter","ngDialog","sharedProperties","$timeout","$rootScope","$localStorage"],notification.$inject=["$scope","sharedProperties"];
function candidateProfileDetails($scope,$element,$attrs,$http,userDataService,ngDialog,$timeout,sharedProperties,ajaxService,$rootScope,$localStorage){$scope.formStatus={},$scope.profile={},$scope.linkedinUpdate={},$scope.profileCommentswithFlags=[],$scope.commentBoxes={},$scope.newDate={},$scope.loggedInUser={},$scope.disableLinkedinEditing=!0,$scope.disableUserProfileEditing=!0,$scope.linkeDInFormStatus=!1,$scope.commentEditEnabled=!1,$scope.loggedInUser.first="",$scope.loggedInUser.last="",$scope.url={},$scope.userProfile={},$scope.comments={},$scope.stateCheck={},$scope.member={},$scope.dataWithFlags=[],$scope.memCountCheck=!1,$scope.newOrderFlag=0,$scope.addNewMember={},$scope.addNewMember.submitted=!1,$scope.emailFromParam=sharedProperties.getParam("cemail"),$scope.commentSection={};var storedProfile=$localStorage.get("loggegdInProfile"),userRoles=storedProfile.member.roles.sort();$scope.isAccountAdmin=0===jQuery.inArray("AccountAdministrator",userRoles)?!0:!1,$scope.isAdmin=0===jQuery.inArray("Administrator",userRoles)?!0:!1;var t=$localStorage.get("showProfileTab");"undefined"!=typeof t&&null!==t?($scope.defaultTab=!1,$timeout(function(){$rootScope.callSwitchChange("spProfile1")},100)):$scope.defaultTab=!0,$scope.newDate.currentDay=new Date,null!==$localStorage.get("isCandidateArchived")&&$localStorage.get("isCandidateArchived")!==!1&&($scope.isCandidateArchived=!0,ajaxService.getAjaxResponse({url:"/sp/hiring/getArchivedUserProfileDetails",data:$.param({candidateId:$localStorage.get("archiveCandidateId")})}).then(function(response){if("true"===response.Success){$scope.profile=response.hiring,$scope.hiringInfo=response.hiring,"VALID"===$scope.hiringInfo.userStatus?null===$scope.hiringInfo.spUserId?$scope.hiringInfo=$.extend({},$scope.hiringInfo,{btnFlags:{viewProfile:!1,viewCompare:!1,viewAdvisor:!1,requestAccess:!1,deleteBtn:!0,moveBtn:!0}}):$scope.hiringInfo.profileSettings.hiringAccessAllowed===!0?$scope.hiringInfo=$.extend({},$scope.hiringInfo,{btnFlags:{viewProfile:!1,viewCompare:!1,viewAdvisor:!1,requestAccess:!1,deleteBtn:!0,moveBtn:!0}}):$scope.hiringInfo=$.extend({},$scope.hiringInfo,{btnFlags:{viewProfile:!1,viewCompare:!1,viewAdvisor:!1,requestAccess:!0,deleteBtn:!0,moveBtn:!0}}):"INVITATION_SENT"===$scope.hiringInfo.userStatus||"ASSESSMENT_PROGRESS"===$scope.hiringInfo.userStatus||"ASSESSMENT_PENDING"===$scope.hiringInfo.userStatus||"ADD_REFERENCES"===$scope.hiringInfo.userStatus?$scope.hiringInfo=$.extend({},$scope.hiringInfo,{btnFlags:{viewProfile:!1,viewCompare:!1,viewAdvisor:!1,requestAccess:!1,deleteBtn:!0,moveBtn:!0}}):("INVITATION_NOT_SENT"===$scope.hiringInfo.userStatus||"INVITATION_EXPIRED"===$scope.hiringInfo.userStatus)&&($scope.hiringInfo=$.extend({},$scope.hiringInfo,{btnFlags:{viewProfile:!1,viewCompare:!1,viewAdvisor:!1,requestAccess:!1,deleteBtn:!0,moveBtn:!0}})),null!==response.address?($scope.profile.address1=response.address.addressLine1,$scope.profile.address2=response.address.addressLine2,$scope.profile.city=response.address.city,$scope.profile.state=response.address.state,$scope.profile.country=response.address.country,$scope.profile.zip=response.address.zipCode):($scope.profile.address1=null,$scope.profile.address2=null,$scope.profile.city=null,$scope.profile.state="default",$scope.profile.country="default",$scope.profile.zip=null),null===$scope.profile.gender&&($scope.profile.gender="default"),0===$scope.profile.dob.monthValue?$scope.profile.month="default":$scope.profile.month=$scope.profile.dob.monthValue,0===$scope.profile.dob.dayOfMonth?$scope.profile.day="default":$scope.profile.day=$scope.profile.dob.dayOfMonth,0===$scope.profile.dob.year?$scope.profile.year="default":$scope.profile.year=$scope.profile.dob.year,$scope.profile.phone=$scope.profile.phoneNumber,$scope.profilePic=response.hiring.smallProfileImage,$scope.userInitials=response.hiring.userInitials,$scope.profilePicSmall=response.hiring.smallProfileImage,"undefined"!=typeof response.hiring.tagList&&null!==response.hiring.tagList?$scope.existingCandidateTags=response.hiring.tagList.join():$scope.existingCandidateTags="","undefined"!=typeof response.hiring.hiringRoles||null!==response.hiring.hiringRoles?$scope.existingCandidateRoles=response.hiring.hiringRoles.join(", "):$scope.existingCandidateRoles="",$scope.totalComments=response.hiring.comments.length,$scope.userStatus=response.hiring.userStatusFormatted,$scope.assessmentStatus=response.hiring.userStatus,$scope.profileCommentswithFlags=[];var getComments=response.hiring.comments;jQuery.each(getComments,function(i,j){var updatedComment=jQuery.extend({},getComments[i],{mName:"commentBox_"+i,showOptions:!1});$scope.profileCommentswithFlags.push(updatedComment)}),$scope.referencesDetails=response.hiring.referencesDetails,null!==$scope.hiringInfo.linkedInUrl&&"undefined"!=typeof $scope.hiringInfo.linkedInUrl?$scope.url.linkedInUrl=$scope.hiringInfo.linkedInUrl:null!==$scope.hiringInfo.url&&"undefined"!=typeof $scope.hiringInfo.url&&($scope.url.linkedInUrl=$scope.hiringInfo.url)}})),$scope.newDate={year:$scope.newDate.currentDay.getFullYear(),month:$scope.newDate.currentDay.getMonth()+1,day:$scope.newDate.currentDay.getDate()},$scope.addressFormReset=function(t){$scope.profile.address1=null,$scope.profile.address2=null,$scope.profile.city=null,$scope.profile.zip=null,"United States"===$scope.stateCheck.forSelectedCountry?$scope.profile.state="default":$scope.profile.state=null},$scope.enableEdit=function(f){"linkedin"===f&&($scope.disableLinkedinEditing=!1),"userProfile"===f&&($scope.disableUserProfileEditing=!1)},$scope.disableEdit=function(f){"linkedin"===f&&($scope.disableLinkedinEditing=!0),"userProfile"===f&&($scope.disableUserProfileEditing=!0,$scope.getProfileDetails()),$scope.formStatus.sumbit=!1,$scope.linkeDInFormStatus=!1},$scope.formatDate=function(d){if(null!==d&&"undefined"!=typeof d){var splitDate=d.split("-"),monthData={"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"},month=parseInt(splitDate[1])<9?"0"+splitDate[1]:splitDate[1],formattedDate=monthData[month.toString()]+" "+parseInt(splitDate[2])+", "+parseInt(splitDate[0]);return formattedDate}},$scope.today=$scope.formatDate($scope.newDate.year+"-"+$scope.newDate.month+"-"+$scope.newDate.day),$scope.getProfileDetails=function(){var _o={url:"/sp/hiring/getProfileDetails",data:$.param({candidateEmail:$scope.emailFromParam}).replace(/%40/g,"@")};ajaxService.getAjaxResponse(_o).then(function(response){if("true"===response.Success){$scope.profile=response.userProfileForm,$scope.hiringInfo=response.hiring,$localStorage.set("candidateEmail",$scope.emailFromParam).set("candidateID",response.hiring.id),"VALID"===$scope.hiringInfo.userStatus?null===$scope.hiringInfo.spUserId?$scope.hiringInfo=$.extend({},$scope.hiringInfo,{btnFlags:{viewProfile:!0,viewCompare:!0,viewAdvisor:!0,requestAccess:!1,archiveBtn:!0}}):$scope.hiringInfo.profileSettings.hiringAccessAllowed===!0?$scope.hiringInfo=$.extend({},$scope.hiringInfo,{btnFlags:{viewProfile:!0,viewCompare:!0,viewAdvisor:!0,requestAccess:!1,archiveBtn:!0}}):$scope.hiringInfo=$.extend({},$scope.hiringInfo,{btnFlags:{viewProfile:!1,viewCompare:!1,viewAdvisor:!1,requestAccess:!0,archiveBtn:!0}}):"INVITATION_SENT"===$scope.hiringInfo.userStatus||"ASSESSMENT_PROGRESS"===$scope.hiringInfo.userStatus||"ASSESSMENT_PENDING"===$scope.hiringInfo.userStatus||"ADD_REFERENCES"===$scope.hiringInfo.userStatus?$scope.hiringInfo=$.extend({},$scope.hiringInfo,{btnFlags:{viewProfile:!1,viewCompare:!1,viewAdvisor:!1,requestAccess:!1,archiveBtn:!1}}):("INVITATION_NOT_SENT"===$scope.hiringInfo.userStatus||"INVITATION_EXPIRED"===$scope.hiringInfo.userStatus)&&($scope.hiringInfo=$.extend({},$scope.hiringInfo,{btnFlags:{viewProfile:!1,viewCompare:!1,viewAdvisor:!1,requestAccess:!1,archiveBtn:!1}})),null!==response.address?($scope.profile.address1=response.address.addressLine1,$scope.profile.address2=response.address.addressLine2,$scope.profile.city=response.address.city,$scope.profile.state=response.address.state,$scope.profile.country=response.address.country,$scope.profile.zip=response.address.zipCode):($scope.profile.address1=null,$scope.profile.address2=null,$scope.profile.city=null,$scope.profile.state="default",$scope.profile.country="default",$scope.profile.zip=null),null===$scope.profile.gender&&($scope.profile.gender="default"),0===$scope.profile.month&&($scope.profile.month="default"),0===$scope.profile.day&&($scope.profile.day="default"),0===$scope.profile.year&&($scope.profile.year="default"),$scope.profilePic=response.hiring.smallProfileImage,$scope.userInitials=response.hiring.userInitials,$scope.profilePicSmall=response.hiring.smallProfileImage,"undefined"!=typeof response.hiring.tagList&&null!==response.hiring.tagList?$scope.existingCandidateTags=response.hiring.tagList.join():$scope.existingCandidateTags="","undefined"!=typeof response.hiring.hiringRoles||null!==response.hiring.hiringRoles?$scope.existingCandidateRoles=response.hiring.hiringRoles.join(", "):$scope.existingCandidateRoles="",$scope.totalComments=response.hiring.comments.length,$scope.userStatus=response.hiring.userStatusFormatted,$scope.assessmentStatus=response.hiring.userStatus,$scope.profileCommentswithFlags=[];var getComments=response.hiring.comments;jQuery.each(getComments,function(i,j){var updatedComment=jQuery.extend({},getComments[i],{mName:"commentBox_"+i,showOptions:getComments[i].by.email===$scope.loggedInUser.email?!0:!1});$scope.profileCommentswithFlags.push(updatedComment)}),$scope.referencesDetails=response.hiring.referencesDetails,null!==$scope.hiringInfo.linkedInUrl&&"undefined"!=typeof $scope.hiringInfo.linkedInUrl?($scope.url.linkedInUrl=$scope.hiringInfo.linkedInUrl,$scope.disableLinkedinEditing=!0,$scope.linkedinIcon=!0):null!==$scope.hiringInfo.url&&"undefined"!=typeof $scope.hiringInfo.url?($scope.hiringInfo.linkedInUrl=$scope.hiringInfo.url,$scope.url.linkedInUrl=$scope.hiringInfo.url,$scope.disableLinkedinEditing=!0,$scope.linkedinIcon=!1):$scope.disableLinkedinEditing=!1}else{$localStorage.remove("candidateEmail","candidateID");for(var key in response.error)$scope.errorMessage=response.error[key];$localStorage.set("gNotify","profileError"),$localStorage.set("profileError",$scope.errorMessage),setTimeout(function(){window.location="/sp/tools/hiring/"},100)}})},"undefined"==typeof userDataService.retrive()?$timeout(function(){$scope.loggedInUser=userDataService.retrive(),$scope.loggedInUser.first=$scope.loggedInUser.member.firstName,$scope.loggedInUser.last=$scope.loggedInUser.member.lastName,$scope.loggedInUser.email=$scope.loggedInUser.member.email},500):($scope.loggedInUser=userDataService.retrive(),$scope.loggedInUser.first=$scope.loggedInUser.member.firstName,$scope.loggedInUser.last=$scope.loggedInUser.member.lastName,$scope.loggedInUser.email=$scope.loggedInUser.member.email),$scope.saveAndUpdate=function(formData,formName){var _o={url:"/sp/hiring/updateProfile",data:$.param({firstName:formData.firstName,lastName:formData.lastName,title:formData.title,email:formData.email,gender:formData.gender,day:formData.day,month:formData.month,year:formData.year,phone:formData.phone,address1:formData.address1,address2:formData.address2,city:formData.city,state:formData.state,country:formData.country,zip:formData.zip}).replace(/%2C/g,",").replace(/%40/g,"@")},vCount=0;$scope.formStatus.sumbit=!1;for(var k in formData)("default"===formData[k]||"default1"===formData[k])&&vCount++;this.userProfile.$valid&&0===vCount?($scope.disableUserProfileEditing=!0,ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&$scope.getProfileDetails()})):$scope.formStatus.sumbit=!0},$scope.comments={add:function(c,fName){if($scope.commentSection.submitted=!1,""!==c&&null!==c&&"undefined"!=typeof c){var _o={url:"/sp/hiring/addComment",data:$.param({candidateEmail:$scope.emailFromParam,comment:c}).replace(/%40/g,"@").replace(/%2C/g,",")};ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&($scope.commentSection.comment=null,jQuery('textarea[name="comment"]').val(null),$scope.getProfileDetails())})}else $scope.commentSection.submitted=!0},update:function(i){var commentNgModel="commentBox_"+i,errorBox=jQuery("body").find("span.error_msg_"+i);if($scope.commentEditEnabled=!1,jQuery(errorBox).hasClass("hide")||jQuery(errorBox).addClass("hide"),"undefined"!=typeof $scope.commentBoxes[commentNgModel]){var _o={url:"/sp/hiring/updateComment",data:$.param({candidateEmail:$scope.emailFromParam,comment:$scope.commentBoxes[commentNgModel],index:i}).replace(/%40/g,"@").replace(/%2C/g,",")};ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&($scope.comment=null,$scope.getProfileDetails())})}else jQuery(errorBox).removeClass("hide")},"delete":function(i){var _o={url:"/sp/hiring/removeComment",data:$.param({candidateEmail:$scope.emailFromParam,index:i}).replace(/%40/g,"@").replace(/%2C/g,",")};ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&($scope.comment=null,$scope.getProfileDetails())})},edit:function(i){var commentTextbox=jQuery("body").find("form[name=commentBoxForm_"+i+"]"),commentbox=jQuery("body").find("p.user-comment[data-comment=cBox_"+i+"]"),commentNgModel="commentBox_"+i,textBoxComment=jQuery(commentTextbox).find("textarea").attr("data-comments"),editBtns=jQuery("body").find("p.comment-btns[data-btns=cBtns_"+i+"]"),cancelBtns=jQuery("body").find("a[data-cancel=cancelBtn_"+i+"]");jQuery(editBtns).addClass("hide"),jQuery(cancelBtns).addClass("show"),jQuery(commentTextbox).removeClass("hide"),jQuery(commentbox).addClass("hide"),$scope.commentBoxes[commentNgModel]=textBoxComment,$scope.commentEditEnabled=!0},cancel:function(i){var commentTextbox=jQuery("body").find("form[name=commentBoxForm_"+i+"]"),commentbox=jQuery("body").find("p.user-comment[data-comment=cBox_"+i+"]"),editBtns=jQuery("body").find("p.comment-btns[data-btns=cBtns_"+i+"]"),cancelBtns=jQuery("body").find("a[data-cancel=cancelBtn_"+i+"]");jQuery(editBtns).removeClass("hide"),jQuery(cancelBtns).removeClass("show").addClass("hide"),jQuery(commentTextbox).addClass("hide"),jQuery(commentbox).removeClass("hide"),$scope.commentEditEnabled=!1}},$scope.archiveDialog=function(e,n,r){$scope.archiveCandidate={name:n,email:e,roles:r},ngDialog.open({template:"/sp/resources/html/tools/hiring/archive-candidate.html",scope:$scope})},$scope.archiveAllCandidate=function(cEmail,isHired,single){var emailList=[];single!==!0?jQuery.each(cEmail,function(i,j){emailList.push(cEmail[i].email)}):emailList=cEmail;var options={url:"/sp/hiring/archiveCandidate",data:$.param({candidateEmail:emailList.toString(),isHired:isHired})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&(ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Candidate</strong>",message:" archived successfully"}),$scope.getProfileDetails(),$scope.negative=!$scope.negative,setTimeout(function(){window.location.href="/sp/tools/hiring"},1e3))})},$scope.moveToCandidateList=function(email){var options={url:"/sp/hiring/moveToCandidate",data:$.param({candidateEmail:email})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&($localStorage.set("gNotify","moved"),setTimeout(function(){window.location="/sp/tools/hiring/"},100))})},$scope.confirmDelete=function(email){var options={url:"/sp/hiring/deleteArchiveCandidate",data:$.param({candidateEmail:email})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?($localStorage.set("gNotify","deleted"),setTimeout(function(){window.location="/sp/tools/hiring/"},100)):$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:"Server Error"})})},$scope.updateLinkedURL=function(l){if($scope.linkeDInFormStatus=!1,this.linkedinUpdate.$valid){var _o={url:"/sp/hiring/updateWebUrl",data:$.param({candidateEmail:$scope.emailFromParam,webUrl:l.linkedInUrl}).replace(/%40/g,"@").replace(/%2C/g,",")};$scope.disableLinkedinEditing=!0,ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&$scope.getProfileDetails()})}else $scope.linkeDInFormStatus=!0},$scope.hireCandidate=function(e,n,r){$scope.hireCandidateDetails={name:n,email:e,roles:r},$scope.member.firstName=$scope.hireCandidateDetails.name.split(" ")[0],$scope.member.lastName=$scope.hireCandidateDetails.name.split(" ")[1],$scope.isAdmin||$scope.isAccountAdmin?ajaxService.getAjaxResponse({url:"/sp/admin/member/availalbeMemberSubscriptions"}).then(function(response){"true"===response.Success&&($scope.memberAccountsCount=response.availalbeMemberSubscriptions,$scope.memberAccountsCount>0?($scope.getGroupList(),ngDialog.open({template:"/sp/resources/html/tools/hiring/hire-candidate.html",scope:$scope})):ngDialog.open({template:"/sp/resources/html/tools/hiring/hire-candidate-no-members.html",scope:$scope}))}):ngDialog.open({template:"/sp/resources/html/tools/hiring/hire-candidate-not-admin.html",scope:$scope}),$scope.hireCandidateArchive=function(){ajaxService.getAjaxResponse({url:"/sp/hiring/archiveCandidate",data:$.param({candidateEmail:$scope.hireCandidateDetails.email,isHired:!0})}).then(function(response){if("true"===response.Success)ngDialog.close("ngdialog1"),$localStorage.set("gNotify","AddHire"),setTimeout(function(){window.location="/sp/tools/hiring/"},500);else{for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.addMember=function(fData){this.addNewMember.submitted=!1,this.addNewMember.$valid?ajaxService.getAjaxResponse({url:"/sp/admin/member/addSingle",data:$.param(fData).replace(/%2C/g,",")}).then(function(response){if("true"===response.Success)ajaxService.getAjaxResponse({url:"/sp/hiring/archiveCandidate",data:$.param({candidateEmail:$scope.hireCandidateDetails.email,isHired:!0})}).then(function(response){if("true"===response.Success)ngDialog.close("ngdialog1"),$localStorage.set("gNotify","AddHire"),setTimeout(function(){window.location="/sp/tools/hiring/"},500);else{ngDialog.close("ngdialog1");for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}});else{ngDialog.close("ngdialog1");for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}}):this.addNewMember.submitted=!0}},$scope.getGroupList=function(){ajaxService.getAjaxResponse({url:"/sp/admin/group/all"}).then(function(response){if("true"===response.Success)$scope.groupDataSet=response.groupInfoList,$scope.groupDataSetBackup=response.groupInfoList,jQuery.each($scope.groupDataSet,function(i,j){$scope.dataWithFlags.push(jQuery.extend({},$scope.groupDataSet[i],{selectedFlag:!1,isGroupLead:!1}))}),$scope.flagCounter=$scope.dataWithFlags.length;else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.updateTagList=function(single,multiple){$scope.member.groupAssociationList=null,$scope.tagList=[],jQuery.each($scope.dataWithFlags,function(i,j){$scope.dataWithFlags[i].selectedFlag===!0&&multiple===!0?$scope.tagList.push($scope.dataWithFlags[i].name):$scope.dataWithFlags[i].selectedFlag===!0&&single===!0&&($scope.dataWithFlags[i].isGroupLead===!0?$scope.tagList.push($scope.dataWithFlags[i].name+":true"):$scope.tagList.push($scope.dataWithFlags[i].name+":false")),$scope.member.groupAssociationList=$scope.tagList.join()})},$scope.updateGroupLeadStatus=function(i,email,single,multiple,j){var _a=jQuery("body").find("a#gl_"+j);"undefined"!=typeof $scope.dataWithFlags[i]&&null===email&&($scope.dataWithFlags[i].isGroupLead===!0?($scope.dataWithFlags[i].isGroupLead=!1,_a.removeClass("on")):($scope.dataWithFlags[i].isGroupLead=!0,_a.addClass("on")),$scope.updateTagList(single,multiple))},$scope.changeGroup=function(flag,single,multiple){"default"!==flag&&("createGroupCall_custom"===flag?($scope.params={p1:single,p2:multiple},ngDialog.open({template:"/sp/admin/group/createGroup",scope:$scope})):($scope.dataWithFlags[flag].selectedFlag=!0,$scope.flagCounter-=1,$scope.updateTagList(single,multiple),$scope.member.gList="default",$scope.dataWithFlags[flag].newOrder=$scope.newOrderFlag++,$scope.dataWithFlags[flag].originalIndex=flag))},$scope.removeGroup=function(flag,single,multiple){"default"!==flag&&($scope.dataWithFlags[flag].selectedFlag=!1,$scope.dataWithFlags[flag].isGroupLead=!1,$scope.flagCounter+=1,$scope.updateTagList(single,multiple))},$scope.saveNewGroup=function(groupname,groupLeadEmailId){if(""===groupname||"undefined"==typeof groupname)return!1;var obj={name:groupname},options={url:"/sp/admin/group/create",data:$.param(obj)};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&(ngDialog.close("ngdialog1"),$scope.dataWithFlags.push({name:groupname,groupLead:null,numOfMembers:0,memberSummaryList:null,selectedFlag:!0,originalIndex:$scope.dataWithFlags.length,newOrder:$scope.newOrderFlag}),$scope.flagCounter-=1,$scope.member.gList="default",$scope.newOrderFlag+=1,$scope.updateTagList($scope.params.p1,$scope.params.p2))})},$scope.initCandidateProfile=function(){$scope.isCandidateArchived!==!0&&$scope.getProfileDetails()},$scope.initCandidateProfile()}angular.module("spApp").controller("candidateProfileDetails",candidateProfileDetails),candidateProfileDetails.$inject=["$scope","$element","$attrs","$http","userDataService","ngDialog","$timeout","sharedProperties","ajaxService","$rootScope","$localStorage"];
function candidateReferenceController($scope,$http,$element,$attrs,ajaxService){$scope.candidateRefList={},$scope.candidateRef={},$scope.uniqueEmailError=!1,$scope.processRefList=function(fData){if($scope.candidateRefList.submitted=!1,$scope.uniqueEmailError=!1,$scope.candidateRefList.$valid){var emails=[],uniqueEmails=[];if(emails[0]=fData.ref0.email,emails[1]=fData.ref1.email,emails[2]=fData.ref2.email,jQuery.each(emails,function(i,j){-1===jQuery.inArray(j,uniqueEmails)&&uniqueEmails.push(j)}),3===uniqueEmails.length){var _o,newData=[];newData[0]=fData.ref0,newData[1]=fData.ref1,newData[2]=fData.ref2,_o={url:"/sp/hiringCandidate/inviteReferences",data:newData,headers:{"Content-Type":"application/json"}},ajaxService.getAjaxResponse(_o).then(function(response){"true"===response.Success&&window.location.reload()})}else $scope.uniqueEmailError=uniqueEmails.length<3?!0:!1,jQuery("html, body").animate({scrollTop:0})}else $scope.candidateRefList.submitted=!0,jQuery("html, body").animate({scrollTop:0})}}angular.module("spApp").controller("candidateReferenceController",candidateReferenceController),candidateReferenceController.$inject=["$scope","$http","$element","$attrs","ajaxService"];
function ccUpdateController($scope,$element,$attrs,$http,ngDialog,ajaxService,sharedProperties){$scope.updateCC={},$scope.updateCC.submitted=!1,$scope.dialogStatus={},$scope.updateCcDetails=function(fData){$scope.updateCC.submitted=!1,$scope.updateCC.$valid?ajaxService.getAjaxResponse({url:"/sp/admin/account/updatePaymentInstrument",data:$.param(fData)}).then(function(response){if("true"===response.Success)$scope.dialogStatus.title="Update Credit Card Details",$scope.dialogStatus.content="Details updated successfully.",ngDialog.open({template:"/sp/resources/html/admin/account/success-dialog.html",scope:$scope});else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}}):$scope.updateCC.submitted=!0},$scope.cancelRedirect=function(){var url=window.location.href,isIndividual=url.substring(url.indexOf("#")+1).replace(/\//g,"").split("?")[1];"i"===isIndividual?window.location="/sp/admin/account/individual":window.location="/sp/admin/account/business"}}angular.module("spApp").controller("ccUpdateController",ccUpdateController),ccUpdateController.$inject=["$scope","$element","$attrs","$http","ngDialog","ajaxService"];
function changeSubscriptionController($scope,$element,$attrs,$http,ngDialog,$timeout,ajaxService){$scope.priceFormatter=function(p){if("undefined"!=typeof p&&""!==p&&null!==p){var formattedPrice="$"+p.toFixed(2);return formattedPrice}},$scope.product={},$scope.promoApplied=!1,$scope.finalAmount=0,$scope.promo={},$scope.updatedPromoDetails={},$scope.updateCC={},$scope.activeMembers=0,$scope.renewBusiness={},$scope.account={},$scope.promoFormSubmitted=!1,$scope.promoError={},$scope.promoError.error=!1,$scope.dialogStatus={},$scope.timeout=0,$scope.submitDisabled=!1,$scope.getMemberCount=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/getActiveMemberCount"}).then(function(response){if("true"===response.Success)$scope.activeMembers=response.activeMembers,$scope.account.numAccounts=response.activeMembers;else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.getAcccountInfo=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/businessAccountDetails"}).then(function(response){if("true"===response.Success)$scope.accountDetails=response,$scope.renewalDate=response.account.productInfo.renewalDate;else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.getPlanInfo=function(){ajaxService.getAjaxResponse({url:"/sp/signup/getProducts",data:$.param({productType:"BUSINESS"})}).then(function(response){if("true"===response.Success)$scope.products=response.products,$.each($scope.products,function(i){"YEARLY"===$scope.products[i].validityType&&($scope.annualProduct=$scope.products[i],$scope.annulUnitPrice=$scope.products[i].unitPrice)});else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.getProductInfo=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/getCurrentBusinessProductInfo"}).then(function(response){if("true"===response.Success){$scope.productInfoError=!1,$scope.submitDisabled=!1,$scope.product=response.product;var multiplier=12;"undefined"!=typeof response.promotion&&"undefined"!=typeof response.promotion.unitPrice?($scope.product.updatedUnitPrice=parseFloat(response.promotion.unitPrice).toFixed(2),$scope.promoApplied=!0,$scope.finalAmount=parseFloat($scope.product.updatedUnitPrice*$scope.activeMembers*multiplier).toFixed(2)):($scope.product.updatedUnitPrice=parseFloat(response.product.unitPrice).toFixed(2),$scope.promoApplied=!1,$scope.finalAmount=parseFloat($scope.product.updatedUnitPrice*$scope.activeMembers*multiplier).toFixed(2))}else $scope.productInfoError=!0,$scope.submitDisabled=!0,jQuery("html, body").animate({scrollTop:0})})},$scope.paymentCalculator=function(empNo,action,type,event){var currentEmpNo=parseInt(empNo),updatedEmpNo=0,multiplier="YEARLY"===type?12:1;"undefined"==typeof event?currentEmpNo>=20&&"add"===action?(updatedEmpNo=parseInt(currentEmpNo+1),$scope.account.numAccounts=updatedEmpNo,$scope.finalAmount=parseFloat($scope.product.updatedUnitPrice*updatedEmpNo*multiplier).toFixed(2)):currentEmpNo>20&&"remove"===action?(updatedEmpNo=parseInt(currentEmpNo-1),$scope.account.numAccounts=updatedEmpNo,$scope.finalAmount=parseFloat($scope.product.updatedUnitPrice*updatedEmpNo*multiplier).toFixed(2)):($scope.account.numAccounts=parseInt($scope.account.minEmployee),$scope.finalAmount=parseFloat($scope.product.updatedUnitPrice*$scope.account.numAccounts*multiplier).toFixed(2)):/^[0-9\b]+$/g.test(empNo)&&empNo>=20?($scope.account.numAccounts=empNo,$scope.finalAmount=parseFloat($scope.product.updatedUnitPrice*$scope.account.numAccounts*multiplier).toFixed(2),$timeout.cancel($scope.timeout)):($timeout.cancel($scope.timeout),$scope.timeout=$timeout(function(){$scope.account.numAccounts=20,$scope.finalAmount=parseFloat(20*$scope.product.updatedUnitPrice*multiplier).toFixed(2)},1500))},$scope.activatePromo=function(promoCode){if("undefined"!=typeof promoCode){var _params={code:promoCode,productId:$scope.product.id};ajaxService.getAjaxResponse({url:"/sp/signup/promotion",data:$.param(_params)}).then(function(response){"true"===response.Success?($scope.updatedPromoDetails=response.promotion,$scope.product.updatedUnitPrice=parseFloat(response.promotion.unitPrice).toFixed(2),$scope.promoApplied=!0,$scope.finalAmount=parseFloat(12*$scope.product.updatedUnitPrice).toFixed(2)):($scope.promoError.error=!0,$scope.promoError.msg=response.error,$scope.promo.code=null,$timeout(function(){$scope.promoError.error=!1},1500))})}else $scope.promoFormSubmitted=!0,$scope.promo.code=null},$scope.renewIndividualSubscription=function(fData){var _paramsUpdated,_params={};_params=$scope.promoApplied===!1?{productId:$scope.product.id}:{productId:$scope.product.id,promotionId:$scope.updatedPromoDetails.id},$scope.updateCC.$valid?(_paramsUpdated=$.extend({},_params,fData),ajaxService.getAjaxResponse({url:"/sp/admin/account/renewAccount",data:$.param(_paramsUpdated)}).then(function(response){if("true"===response.Success)$scope.dialogStatus.title="Subscription Renewal",$scope.dialogStatus.content="Subscription renewed successfully.",ngDialog.open({template:"/sp/resources/html/admin/account/success-dialog.html",scope:$scope});else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})):$scope.updateCC.submitted=!0},$scope.deactivatePromo=function(){$scope.product.updatedUnitPrice=parseFloat($scope.product.unitPrice).toFixed(2),$scope.finalAmount=parseFloat(12*$scope.product.updatedUnitPrice).toFixed(2),$scope.promoApplied=!1,$scope.promo.code=null},$scope.cancelRedirect=function(){window.location="/sp/admin/account/business"},$scope.renewBusinessSubscription=function(fData){var _paramsUpdated,_params={};_params=$scope.promoApplied===!1?{numAccounts:$scope.account.numAccounts,productId:$scope.product.id}:{numAccounts:$scope.account.numAccounts,productId:$scope.product.id,promotionId:$scope.updatedPromoDetails.id},$scope.submitDisabled===!1&&($scope.renewBusiness.$valid?(_paramsUpdated=$.extend({},_params,fData),ajaxService.getAjaxResponse({url:"/sp/admin/account/renewAccount",data:$.param(_paramsUpdated)}).then(function(response){"true"===response.Success?console.log("Success"):($scope.submitException=!0,$scope.submitExceptionMsg="undefined"!=typeof response.error.InvalidRequestException?response.error.InvalidRequestException:"Error occured on server.",jQuery("html, body").animate({scrollTop:0}))})):($scope.renewBusiness.submitted=!0,jQuery("html, body").animate({scrollTop:0})))},$scope.initRenewBusiness=function(){$scope.getMemberCount(),$scope.getProductInfo(),$scope.getAcccountInfo()},$scope.initRenewBusiness()}angular.module("spApp").controller("changeSubscriptionController",changeSubscriptionController),changeSubscriptionController.$inject=["$scope","$element","$attrs","$http","ngDialog","$timeout","ajaxService"];
function createAffiliateCodeController($scope,$element,$attrs,ngDialog,$timeout,sharedProperties,ajaxService,$rootScope,$localStorage){$scope.getCodeError=!1,$scope.generateAffiliateCode=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/promotions/getCode"}).then(function(response){if("true"===response.Success)$scope.getCodeError=!1,$scope.newAffiliateCode=response.promotion;else{$scope.getCodeError=!0;for(var key in response.error)$scope.getCodeErrorMsg=response.error[key]}})},$scope.productsError=!1,$scope.getAvailableProducts=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/promotions/getProducts"}).then(function(response){if("true"===response.Success)$scope.productsError=!1,$scope.productList=response.product;else{$scope.productsError=!0;for(var key in response.error)$scope.productsErrorMsg=response.error[key]}})},$scope.affliliateCode={},$scope.createAffiliateCode={},$scope.createAffiliateCode.validationError=!1,$scope.createCodeError=!1,$scope.setupAffiliateCode=function(fData){if(function(d){if("object"==typeof d){var _dm="undefined"!=typeof d?d.getMonth()+1:0,_dd="undefined"!=typeof d?d.getDate():0,_dy="undefined"!=typeof d?d.getFullYear():0,_dDate=(10>_dm?"0"+_dm:_dm)+"/"+(10>_dd?"0"+_dd:_dd)+"/"+_dy;fData.endDate=_dDate}else fData.endDate=d}(fData.endDate),fData.code=$scope.newAffiliateCode,$scope.productsError===!1&&$scope.getCodeError===!1){$scope.createAffiliateCode.validationError=!1;var vCount=0;for(var k in fData)("default"===fData[k]||"default1"===fData[k])&&vCount++;"COUNT_BASED"!==fData.promotionType?$scope.createAffiliateCode.$valid&&0===vCount&&fData.unitPrice>0?ajaxService.getAjaxResponse({url:"/sp/sysAdmin/promotions/create",data:$.param(fData).replace(/%2F/g,"/")}).then(function(response){if("true"===response.Success)$scope.createCodeError=!1,$localStorage.set("gNotify","AddCode"),setTimeout(function(){window.location="/sp/sysAdmin/promotions/affiliateCodesListing"},100);else{$scope.createCodeError=!0;for(var key in response.error)$scope.createCodeErrorMsg=response.error[key]}}):$scope.createAffiliateCode.validationError=!0:"COUNT_BASED"===fData.promotionType&&(fData.count>0?($scope.createAffiliateCode.validationError=!1,$scope.createAffiliateCode.$valid&&0===vCount&&fData.unitPrice>0?ajaxService.getAjaxResponse({url:"/sp/sysAdmin/promotions/create",data:$.param(fData).replace(/%2F/g,"/")}).then(function(response){if("true"===response.Success)$scope.createCodeError=!1,$localStorage.set("gNotify","AddCode"),setTimeout(function(){window.location="/sp/sysAdmin/promotions/affiliateCodesListing"},100);else{$scope.createCodeError=!0;for(var key in response.error)$scope.createCodeErrorMsg=response.error[key]}}):$scope.createAffiliateCode.validationError=!0):$scope.createAffiliateCode.validationError=!0)}},$scope.getDetailsError=!1,$scope.existingTags=null,$scope.getPromoDetails=function(pid){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/promotions/getDetails",data:$.param({promotionId:pid})}).then(function(response){if("true"===response.Success)$scope.getDetailsError=!1,$scope.existingPromoDetails=response.promotion,$scope.affliliateCode.productList=$scope.existingPromoDetails.productList[0].id,$scope.affliliateCode.promotionType=$scope.existingPromoDetails.promotionType,$scope.affliliateCode.unitPrice=$scope.existingPromoDetails.unitPrice,$scope.affliliateCode.endDate=($scope.existingPromoDetails.endDate.monthValue<10?"0"+$scope.existingPromoDetails.endDate.monthValue:$scope.existingPromoDetails.endDate.monthValue)+"/"+($scope.existingPromoDetails.endDate.dayOfMonth<10?"0"+$scope.existingPromoDetails.endDate.dayOfMonth:$scope.existingPromoDetails.endDate.dayOfMonth)+"/"+$scope.existingPromoDetails.endDate.year,$scope.existingPromoDetails.count>0&&($scope.affliliateCode.count=$scope.existingPromoDetails.count),$scope.existingPromoDetails.tags.length>0?$scope.existingTags=$scope.existingPromoDetails.tags.length>1?$scope.existingPromoDetails.tags.join(","):$scope.existingPromoDetails.tags[0]:$scope.existingTags=null,$scope.affliliateCode.message=$scope.existingPromoDetails.message,$scope.affliliateCode.status=$scope.existingPromoDetails.status;else{$scope.getDetailsError=!0;for(var key in response.error)$scope.getDetailsErrorMsg=response.error[key]}})},$scope.cancelRedirect=function(){window.location="/sp/sysAdmin/promotions/affiliateCodesListing"},function(){$scope.generateAffiliateCode(),$scope.getAvailableProducts(),$scope.affliliateCode.status="Active";var url=window.location.href,splitUrl=url.split("?")[1];"undefined"!=typeof splitUrl&&$scope.getPromoDetails(splitUrl.split("=")[1])}()}angular.module("spApp").controller("createAffiliateCodeController",createAffiliateCodeController),createAffiliateCodeController.$inject=["$scope","$element","$attrs","ngDialog","$timeout","sharedProperties","ajaxService","$rootScope","$localStorage"];
function createLibraryHomeController($scope,$element,$attrs,ngDialog,$timeout,sharedProperties,ajaxService,$rootScope,$localStorage,$filter){$scope.createNewLibraryHome={},$scope.createNewLibraryHome.validationErrors=!1,$scope.accountsListException=!1,$scope.updatedAccountListing=[],$scope.selectedAccountsCount=0,$scope.updatedListingIndex=0,$scope.accountList={},$scope.selectedCompanyIdList=[],$scope.allAccountsIdList=[],$scope.createNewLibraryHomeException=!1,$scope.filteredAccountListing={},$scope.cid="",$scope.newLibraryHome={},$scope.selectedAccountsDisplayList=[],$scope.showAccountsDisplayList=!1,$scope.cid="",$scope.searchKeywords=[],$scope.searchTag=[],$scope.pageSize=100,$scope.statusInclude=[],$scope.textSearching="",$scope.intialPageSize=100,$scope.load=!0,$scope.selectArticlesList=[];var companyFilterListIds=[],localStorageCompanyList=$localStorage.get("companyLibraryHomeList"),defaultImage="/sp/resources/images/image_not_available.jpg";$scope.newLibraryHome.articleImage0=defaultImage,$scope.newLibraryHome.articleImage1=defaultImage,$scope.newLibraryHome.articleImage2=defaultImage,$scope.newLibraryHome.articleImage3=defaultImage,$scope.getAccountList=function(){for(var i=0;i<localStorageCompanyList.length;i++)companyFilterListIds.push(localStorageCompanyList[i].id);ajaxService.getAjaxResponse({url:"/sp/sysAdmin/hk/getCompanyList",method:"GET"}).then(function(response){if("true"===response.Success)$scope.accountsListException=!1,$scope.accountListing=response.companies,jQuery.each($scope.accountListing,function(i,j){-1===jQuery.inArray($scope.accountListing[i].id,companyFilterListIds)&&($scope.updatedAccountListing.push(jQuery.extend({},$scope.accountListing[i],{accountSelectedStatus:!1})),$scope.allAccountsIdList.push($scope.accountListing[i].id))});else{$scope.accountsListException=!0;for(var key in response.error)$scope.accountsListExceptionMsg=response.error[key]}})},$scope.getCompanyId=function(){var url=window.location.href,splitUrl=url.split("?")[1];"undefined"!=typeof splitUrl?$scope.cid=splitUrl.split("=")[1]:$scope.cid=null},$scope.getLibraryHomeDetails=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/library/articles",data:$.param({companyId:$scope.cid})}).then(function(response){if("true"===response.Success)$scope.getDetailsException=!1,$scope.newLibraryHome.articleId0=response.Content[0].articleId,$scope.newLibraryHome.articleDescription0=response.Content[0].shortDescription,$scope.newLibraryHome.articleName0=response.Content[0].articleLinkLabel,null!==response.Content[0].imageUrl&&void 0!==response.Content[0].imageUrl&&($scope.newLibraryHome.articleImage0=response.Content[0].imageUrl+"?width=150"),$scope.newLibraryHome.articleId1=response.Content[1].articleId,$scope.newLibraryHome.articleDescription1=response.Content[1].shortDescription,$scope.newLibraryHome.articleName1=response.Content[1].articleLinkLabel,null!==response.Content[1].imageUrl&&void 0!==response.Content[1].imageUrl&&($scope.newLibraryHome.articleImage1=response.Content[1].imageUrl+"?width=150"),$scope.newLibraryHome.articleId2=response.Content[2].articleId,$scope.newLibraryHome.articleDescription2=response.Content[2].shortDescription,$scope.newLibraryHome.articleName2=response.Content[2].articleLinkLabel,null!==response.Content[2].imageUrl&&void 0!==response.Content[2].imageUrl&&($scope.newLibraryHome.articleImage2=response.Content[2].imageUrl+"?width=150"),$scope.newLibraryHome.articleId3=response.Content[3].articleId,$scope.newLibraryHome.articleDescription3=response.Content[3].shortDescription,$scope.newLibraryHome.articleName3=response.Content[3].articleLinkLabel,null!==response.Content[3].imageUrl&&void 0!==response.Content[3].imageUrl&&($scope.newLibraryHome.articleImage3=response.Content[3].imageUrl+"?width=150");else{$scope.company.name=null,$scope.getDetailsException=!0;for(var key in response.error)$scope.getDetailsExceptionMsg=response.error[key]}})},$scope.addtoSelectedAccounts=function(id){jQuery.each($scope.updatedAccountListing,function(i){return $scope.updatedAccountListing[i].id===id?($scope.updatedAccountListing[i].accountSelectedStatus=!0,$scope.selectedAccountsCount+=1,$scope.selectedCompanyIdList.push($scope.updatedAccountListing[i].id),$scope.updatedAccountListing[i].updatedListingIndex=$scope.updatedListingIndex++,!1):void 0})},$scope.removeFromSelectedAccounts=function(id){jQuery.each($scope.updatedAccountListing,function(i){return $scope.updatedAccountListing[i].id===id?($scope.updatedAccountListing[i].accountSelectedStatus=!1,$scope.selectedAccountsCount-=1,$scope.selectedCompanyIdList.splice($scope.selectedCompanyIdList.indexOf(id),1),!1):void 0})},$scope.addFilteredAccounts=function(){var selectedList=$filter("filter")($scope.updatedAccountListing,$scope.accountList.search);jQuery.each(selectedList,function(i){jQuery.each($scope.updatedAccountListing,function(j){selectedList[i].id===$scope.updatedAccountListing[j].id&&($scope.updatedAccountListing[j].accountSelectedStatus=!0,$scope.selectedAccountsCount+=1,$scope.selectedCompanyIdList.push($scope.updatedAccountListing[j].id),$scope.updatedAccountListing[j].updatedListingIndex=$scope.updatedListingIndex++)})}),$scope.accountList.search=null},$scope.accList=$scope.selectedCompanyIdList,$scope.selectArticleViaModal=function(articleId,articleName,position,articleImage){null===articleImage||void 0===articleImage?articleImage=defaultImage:articleImage+="?width=150",0===position?($scope.newLibraryHome.articleId0=articleId,$scope.newLibraryHome.articleName0=unescape(articleName),$scope.newLibraryHome.articleImage0=articleImage):1===position?($scope.newLibraryHome.articleId1=articleId,$scope.newLibraryHome.articleName1=unescape(articleName),$scope.newLibraryHome.articleImage1=articleImage):2===position?($scope.newLibraryHome.articleId2=articleId,$scope.newLibraryHome.articleName2=unescape(articleName),$scope.newLibraryHome.articleImage2=articleImage):3===position&&($scope.newLibraryHome.articleId3=articleId,$scope.newLibraryHome.articleName3=unescape(articleName),$scope.newLibraryHome.articleImage3=articleImage),ngDialog.close("ngdialog1")},$scope.createLibraryHome=function(fData){var _params=[],companyId=$scope.accList[0];if($scope.createNewLibraryHome.validationErrors=!1,$scope.createNewLibraryHomeException=!1,_params=[{articleId:$scope.newLibraryHome.articleId0,position:0,shortDescription:fData.articleDescription0,companyId:companyId},{articleId:$scope.newLibraryHome.articleId1,position:1,shortDescription:fData.articleDescription1,companyId:companyId},{articleId:$scope.newLibraryHome.articleId2,position:2,shortDescription:fData.articleDescription2,companyId:companyId},{articleId:$scope.newLibraryHome.articleId3,position:3,shortDescription:fData.articleDescription3,companyId:companyId}],void 0!==$scope.newLibraryHome.articleId0&&void 0!==$scope.newLibraryHome.articleId1&&void 0!==$scope.newLibraryHome.articleId2&&void 0!==$scope.newLibraryHome.articleId3&&void 0!==$scope.newLibraryHome.articleDescription0&&void 0!==$scope.newLibraryHome.articleDescription1&&void 0!==$scope.newLibraryHome.articleDescription2&&void 0!==$scope.newLibraryHome.articleDescription3&&""!==$scope.newLibraryHome.articleDescription0&&""!==$scope.newLibraryHome.articleDescription1&&""!==$scope.newLibraryHome.articleDescription2&&""!==$scope.newLibraryHome.articleDescription3&&$scope.accList.length>0){for(var i=0;4>i;i++)ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/admin/add/contentArticles",data:$.param(_params[i])}).then(function(response){if("true"===response.Success)$scope.createNewLibraryHome=!1,$localStorage.set("gNotify","AddNewLibraryHome");else{$scope.createNewLibraryHomeException=!0;for(var key in response.error)$scope.createNewLibraryHomeExceptionMsg=response.error[key]}});$.growl({icon:"glyphicon glyphicon-ok",message:" Articles Added Successfully"}),setTimeout(function(){window.location="/sp/sysAdmin/curriculam/libraryHome"},1e3)}else $.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:"Please fill all the required Fields"}),$scope.createNewLibraryHome.validationErrors=!0},$scope.selectArticle=function(position){$scope.fetchedTopics=[],$scope.selectArticlesList=[],ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/getAllTopics",method:"POST",data:$.param({topic:"Themes"})}).then(function(response){response&&($scope.fetchedTopics=response.topics,$scope.position=position,$scope.getArticlesList=function(themeValue){$scope.selectArticlesList=[],ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/getResults",method:"POST",data:$.param({topicValue:themeValue,topicCategory:"Themes"})}).then(function(response){if("true"===response.Success)response.articles.length>0&&($scope.getAllError=!1,$scope.selectArticlesList=response.articles,$scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize));else{$scope.getAllError=!0;for(var key in response.error)$scope.getAllErrorMsg=response.error[key]}})},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.returnMemberList($scope.pageSize)},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize))},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.returnMemberList=function(pageSize){if($scope.searchTag.length&&!$scope.statusInclude.length&&($scope.selectArticlesList=angular.copy($scope.newArr)),$scope.searchTag.length&&$scope.statusInclude.length){$scope.combineArray=[];for(var i=0;i<$scope.newArr.length;i++)for(var j=0;j<$scope.checkBox.length;j++)$scope.newArr[i].email===$scope.checkBox[j].email&&$scope.combineArray.push($scope.newArr[i]);$scope.selectArticlesList=angular.copy($scope.combineArray)}!$scope.searchTag.length&&$scope.statusInclude.length&&($scope.selectArticlesList=angular.copy($scope.checkBox)),$scope.searchTag.length||$scope.statusInclude.length||($scope.selectArticlesList=angular.copy($scope.selectArticlesList)),$scope.pageSize=pageSize,pageSize>=$scope.selectArticlesList.length&&($scope.pageSize=$scope.selectArticlesList.length),$scope.load&&($scope.lastPredicate="name",$scope.lastReverse=!1,$scope.loadBtnCLicked=!1,$scope.load=!1),$scope.loadBtnCLicked&&($scope.loadBtnCLicked=!1),$scope.order($scope.lastPredicate,$scope.lastReverse),$scope.selectArticlesList=$scope.selectArticlesList},$scope.active=function(event){var currentElem=$(event.currentTarget);currentElem.find("h4").hasClass("on")?currentElem.find("h4").hasClass("reverseon")?currentElem.find("h4").removeClass("reverseon"):currentElem.find("h4").addClass("reverseon"):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"))},$scope.order=function(predicate,reverse){$scope.lastPredicate=predicate,$scope.lastReverse=reverse,$scope.selectArticlesList=$filter("orderBy")($scope.selectArticlesList,predicate,reverse)},ngDialog.open({template:"/sp/resources/html/sysAdmin/curriculam/selectArticleModal.html",scope:$scope}))})},$scope.cancelRedirect=function(){setTimeout(function(){window.location="/sp/sysAdmin/curriculam/libraryHome"},100)},function(){$scope.getAccountList(),-1!==window.location.href.indexOf("?")&&($scope.getCompanyId(),$scope.getLibraryHomeDetails())}()}angular.module("spApp").controller("createLibraryHomeController",createLibraryHomeController),createLibraryHomeController.$inject=["$scope","$element","$attrs","ngDialog","$timeout","sharedProperties","ajaxService","$rootScope","$localStorage","$filter"];
function createPulseController($scope,$element,$attrs,ngDialog,$timeout,sharedProperties,ajaxService,$rootScope,$localStorage,FileUploader,$filter){$scope.createNewPulse={},$scope.newPulse={},$scope.createNewPulse.validationErrors=!1,$scope.fileUploadException=!1,$scope.newPulse.status="Active",$scope.accountsListException=!1,$scope.updatedAccountListing=[],$scope.selectedAccountsCount=0,$scope.updatedListingIndex=0,$scope.accountList={},$scope.selectedCompanyIdList=[],$scope.pulseFileUploadStatus=!1,$scope.allAccountsIdList=[],$scope.createNewPulseException=!1,$scope.filteredAccountListing={},$scope.mapQuestionObject=[],$scope.triggerOpenFile=function(){var fileInput=jQuery("body").find("#selectFile");fileInput.click()},$scope.uploader=new FileUploader({url:"/sp/sysAdmin/pulse/createPulseFile",autoUpload:!0,alias:"pulseQuestionSet",onSuccessItem:function(item,response){if($scope.fileUploadException=!1,$scope.pulseFileUploadStatus=!1,null===response.error)$scope.fileUploadException=!1,$scope.pulseFileUploadStatus=!0,$scope.pulseFileName=item._file.name,$scope.questionList=response.success.pulseQuestion,$scope.questionSet(),$scope.pulseDrop=$scope.questionList.categoryKeys,$timeout(function(){$scope.defaultPulseName=0},0),$scope.noChart($scope.pulseDrop,0);else{$scope.pulseFileName=null,$scope.fileUploadException=!0,$scope.pulseFileUploadStatus=!1;for(var key in response.error)$scope.fileUploadExceptionMessage=response.error[key]}}}),$scope.defaultPulse=function(_this){$scope.noChart($scope.pulseDrop,$scope.defaultPulseName)},$scope.increment=function(){return $scope.defaultPulseName++,!0},$scope.decrement=function(){return $scope.defaultPulseName--,!0},$scope.questionSet=function(){"questions"in $scope.questionList&&($scope.mapQuestionObject=$scope.questionList.questions[$scope.activePulse])},$scope.noChart=function(arrayList,index){arrayList.length&&$scope.noChartPulse(arrayList[index])},$scope.noChartPulse=function(keyName){$scope.activePulse=keyName,$scope.mapQuestionObject=$scope.questionList.questions[keyName]},$scope.getAccountList=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/hk/getCompanyList",method:"GET"}).then(function(response){if("true"===response.Success)$scope.accountsListException=!1,$scope.accountListing=response.companies,jQuery.each($scope.accountListing,function(i,j){$scope.updatedAccountListing.push(jQuery.extend({},$scope.accountListing[i],{accountSelectedStatus:!1})),$scope.allAccountsIdList.push($scope.accountListing[i].id)});else{$scope.accountsListException=!0;for(var key in response.error)$scope.accountsListExceptionMsg=response.error[key]}})},$scope.addtoSelectedAccounts=function(id){jQuery.each($scope.updatedAccountListing,function(i){return $scope.updatedAccountListing[i].id===id?($scope.updatedAccountListing[i].accountSelectedStatus=!0,$scope.selectedAccountsCount+=1,$scope.selectedCompanyIdList.push($scope.updatedAccountListing[i].id),$scope.updatedAccountListing[i].updatedListingIndex=$scope.updatedListingIndex++,!1):void 0})},$scope.removeFromSelectedAccounts=function(id){jQuery.each($scope.updatedAccountListing,function(i){return $scope.updatedAccountListing[i].id===id?($scope.updatedAccountListing[i].accountSelectedStatus=!1,$scope.selectedAccountsCount-=1,$scope.selectedCompanyIdList.splice($scope.selectedCompanyIdList.indexOf(id),1),!1):void 0})},$scope.removeAllSelectedAccounts=function(){jQuery.each($scope.updatedAccountListing,function(i){$scope.updatedAccountListing[i].accountSelectedStatus=!1,$scope.updatedAccountListing[i].updatedListingIndex=null}),$scope.selectedAccountsCount=0,$scope.selectedCompanyIdList=[]},$scope.addFilteredAccounts=function(){var selectedList=$filter("filter")($scope.updatedAccountListing,$scope.accountList.search);jQuery.each(selectedList,function(i){jQuery.each($scope.updatedAccountListing,function(j){selectedList[i].id===$scope.updatedAccountListing[j].id&&($scope.updatedAccountListing[j].accountSelectedStatus=!0,$scope.selectedAccountsCount+=1,$scope.selectedCompanyIdList.push($scope.updatedAccountListing[j].id),$scope.updatedAccountListing[j].updatedListingIndex=$scope.updatedListingIndex++)})}),$scope.accountList.search=null},$scope.generateNewPulse=function(fData){var _params;$scope.createNewPulse.validationErrors=!1,$scope.createNewPulseException=!1,"All"===fData.assignAccounts?($scope.accList=$scope.allAccountsIdList,_params={name:fData.name,questionSetType:fData.questionSetType,status:$scope.newPulse.status,forAll:!0}):($scope.accList=$scope.selectedCompanyIdList,_params={name:fData.name,questionSetType:fData.questionSetType,status:$scope.newPulse.status,companyId:$scope.accList.join(),forAll:!1}),this.createNewPulse.$valid&&$scope.pulseFileUploadStatus===!0&&$scope.accList.length>0?ajaxService.getAjaxResponse({url:"/sp/sysAdmin/pulse/createPulse",data:$.param(_params)}).then(function(response){if("true"===response.Success)$scope.createNewPulseException=!1,$localStorage.set("gNotify","AddPulse"),setTimeout(function(){window.location="/sp/sysAdmin/pulse/pulseListings"},100);else{$scope.createNewPulseException=!0;for(var key in response.error)$scope.createNewPulseExceptionMsg=response.error[key]}}):$scope.createNewPulse.validationErrors=!0},$scope.pulsePreview=function(){ngDialog.open({template:"/sp/resources/html/sysAdmin/pulse/pulse-preview.html",scope:$scope})},$scope.cancelRedirect=function(){setTimeout(function(){window.location="/sp/sysAdmin/pulse/pulseListings"},100)},$scope.clearFileStatus=function(){$scope.pulseFileUploadStatus=!1,$scope.pulseFileName=null},function(){$scope.getAccountList()}()}angular.module("spApp").controller("createPulseController",createPulseController),createPulseController.$inject=["$scope","$element","$attrs","ngDialog","$timeout","sharedProperties","ajaxService","$rootScope","$localStorage","FileUploader","$filter"];
function createThemeController($scope,$element,$attrs,ngDialog,$timeout,sharedProperties,ajaxService,$rootScope,$localStorage,$filter){$scope.accountsListException=!1,$scope.updatedAccountListing=[],$scope.selectedAccountsCount=0,$scope.updatedListingIndex=0,$scope.accountList={},$scope.selectedCompanyIdList=[],$scope.allAccountsIdList=[],$scope.accountList.search=null,$scope.filteredAccountListing={},$scope.newTheme={},$scope.newTheme.validationErrors=!1,$scope.newThemeDetails={},$scope.newThemeDetails.category="Business",$scope.newThemeDetails.isMandatory="true",$scope.newThemeDetails.status="ACTIVE",$scope.newThemeDetails.assignAccounts="All",$scope.createNewThemeException=!1,$scope.getAccountList=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/hk/getCompanyList",method:"GET"}).then(function(response){if("true"===response.Success)$scope.accountsListException=!1,$scope.accountListing=response.companies,jQuery.each($scope.accountListing,function(i,j){$scope.updatedAccountListing.push(jQuery.extend({},$scope.accountListing[i],{accountSelectedStatus:!1})),$scope.allAccountsIdList.push($scope.accountListing[i].id)});else{$scope.accountsListException=!0;for(var key in response.error)$scope.accountsListExceptionMsg=response.error[key]}})},$scope.addtoSelectedAccounts=function(id){jQuery.each($scope.updatedAccountListing,function(i){return $scope.updatedAccountListing[i].id===id?($scope.updatedAccountListing[i].accountSelectedStatus=!0,$scope.selectedAccountsCount+=1,$scope.selectedCompanyIdList.push($scope.updatedAccountListing[i].id),$scope.updatedAccountListing[i].updatedListingIndex=$scope.updatedListingIndex++,!1):void 0})},$scope.removeFromSelectedAccounts=function(id){jQuery.each($scope.updatedAccountListing,function(i){return $scope.updatedAccountListing[i].id===id?($scope.updatedAccountListing[i].accountSelectedStatus=!1,$scope.selectedAccountsCount-=1,$scope.selectedCompanyIdList.splice($scope.selectedCompanyIdList.indexOf(id),1),!1):void 0})},$scope.removeAllSelectedAccounts=function(){jQuery.each($scope.updatedAccountListing,function(i){$scope.updatedAccountListing[i].accountSelectedStatus=!1,$scope.updatedAccountListing[i].updatedListingIndex=null}),$scope.selectedAccountsCount=0,$scope.selectedCompanyIdList=[]},$scope.addFilteredAccounts=function(){var selectedList=$filter("filter")($scope.updatedAccountListing,$scope.accountList.search);jQuery.each(selectedList,function(i){jQuery.each($scope.updatedAccountListing,function(j){selectedList[i].id===$scope.updatedAccountListing[j].id&&($scope.updatedAccountListing[j].accountSelectedStatus=!0,$scope.selectedAccountsCount+=1,$scope.selectedCompanyIdList.push($scope.updatedAccountListing[j].id),$scope.updatedAccountListing[j].updatedListingIndex=$scope.updatedListingIndex++)})}),$scope.accountList.search=null},$scope.cancelRedirect=function(){setTimeout(function(){window.location="/sp/sysAdmin/goals/themeListings"},100)},$scope.createNewTheme=function(fData){var _params;$scope.newTheme.validationErrors=!1,$scope.createNewThemeException=!1,"All"===fData.assignAccounts?($scope.accList=$scope.allAccountsIdList,_params={name:fData.name,description:fData.description,status:fData.status,category:fData.category,isMandatory:fData.isMandatory,allAccounts:!0}):($scope.accList=$scope.selectedCompanyIdList,_params={name:fData.name,description:fData.description,status:fData.status,category:fData.category,isMandatory:fData.isMandatory,accounts:$scope.accList.join(),allAccounts:!1}),this.newTheme.$valid&&$scope.accList.length>0?($scope.newTheme.validationErrors=!1,ajaxService.getAjaxResponse({url:"/sp/sysAdmin/goals/createGoal",data:$.param(_params)}).then(function(response){if("true"===response.Success)$scope.createNewThemeException=!1,$localStorage.set("gNotify","AddTheme"),setTimeout(function(){window.location="/sp/sysAdmin/goals/themeListings"},100);else{$scope.createNewThemeException=!0;for(var key in response.error)$scope.createNewThemeExceptionMsg=response.error[key]}})):$scope.newTheme.validationErrors=!0},function(){$scope.getAccountList()}()}angular.module("spApp").controller("createThemeController",createThemeController),createThemeController.$inject=["$scope","$element","$attrs","ngDialog","$timeout","sharedProperties","ajaxService","$rootScope","$localStorage","$filter"];
function dashBoardController($scope,ajaxService,sharedProperties,$localStorage){function localStorageTaskCheck(){"true"===$localStorage.get("pulseDone")&&$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> ThankYou</strong>",message:" for completing the PULSE."})&&$localStorage.remove("pulseDone")}function getTasks(){ajaxService.getAjaxResponse({url:vm.config.getTasks}).then(function(response){if("true"===response.Success)vm.getTasks="undefined"!=typeof response.tasks?response.tasks:[],createTaskArray(vm.getTasks);else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function createTaskArray(task){for(var i=0;i<task.length;i++)vm.collaborativeTask[task[i].type]={pulseRequestId:task[i].params.pulseRequestId,endDate:task[i].params.endDate}}function getFeedBack(){ajaxService.getAjaxResponse({url:vm.config.getFeedBack,method:"get"}).then(function(response){if("true"===response.Success)vm.feedBackResult=response.feedbackTeam;else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function getGrowth(){ajaxService.getAjaxResponse({url:vm.config.getGrowth}).then(function(response){if("true"===response.Success)vm.growthResult=response.growthTeam,vm.pageSetting.growthAjaxDone=!0;else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function getTopNotesAndFeedback(){ajaxService.getAjaxResponse({url:vm.config.getTopNotesAndFeedback}).then(function(response){if("true"===response.Success)vm.notesAndFeedbackList=response.allNotesFeedback,vm.pageSetting.notesAndFeedbackDone=!0;else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function getNotification(){ajaxService.getAjaxResponse({url:vm.config.getNotification}).then(function(response){if("true"===response.Success)vm.logTypes=response.logType,vm.notifcationMessages=response.notifications,vm.pageSetting.notifcationAjaxDone=!0;else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function getActivites(){ajaxService.getAjaxResponse({url:vm.config.getActivites}).then(function(response){if("true"===response.Success)vm.activitiesMessages=response.activityMessages,vm.pageSetting.activityAjaxDone=!0;else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function getRecentlyVisited(){ajaxService.getAjaxResponse({url:vm.config.getRecentlyVisited,method:"get"}).then(function(response){if("true"===response.Success)vm.recentlyVisited=response.trackingResponse,vm.recentlyVisited.length||(vm.getGoals(),vm.pageSetting.pullRight=!0,$scope.tabSet0=1);else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function getGoals(){ajaxService.getAjaxResponse({url:vm.config.getGoals,method:"get"}).then(function(response){if("true"===response.Success){vm.logName=[],vm.goalResult=response.userGoal;for(var i=0;i<vm.goalResult.length;i++)vm.logName.push(vm.goalResult[i].goal.name);vm.pageSetting.goalAjaxDone=!0,vm.selectSearch(vm.logName[0])}else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function selectSearch(searchKey){for(var i=0;i<vm.goalResult.length;i++)if(vm.goalResult[i].goal.name===searchKey){vm.goalResultModified=vm.goalResult[i];break}}function startPulseLink(){window.location.href="/sp/pulseUser/pulseStartAssessment?pulseRequestId="+vm.getTasks[0].params.pulseRequestId}function moreNotification(type,size){switch(type){case"notification":vm.pageSetting.pageSize=size;break;case"activity":vm.pageSetting.activeSize=size}}function callAjax(check,fn){check||fn()}var vm=this;vm.collaborativeTask={},vm.pageSetting={pageSize:10,activeSize:10,activityAjaxDone:!1,growthAjaxDone:!1,goalAjaxDone:!1,pullRight:!1,pulseInactive:!1,notifcationAjaxDone:!1,notesAndFeedbackDone:!1},vm.config={getTasks:"/sp/dashboard/getTasks",getFeedBack:"/sp/dashboard/feedback/myrequests",getGrowth:"/sp/dashboard/growth/myrequests",getNotification:"/sp/logs/getDashboardNotificationLogs",getActivites:"/sp/logs/getDashboardActivityLogs",getRecentlyVisited:"/sp/tracking/recentVistedArticles",getGoals:"/sp/dashboard/getUserGoals",getTopNotesAndFeedback:"/sp/dashboard/getNotesAndFeedback"},vm.feedBackResult=[],vm.growthResult=[],vm.activitiesMessages=[],vm.logTypes=[],vm.notifcationMessages=[],vm.recentlyVisited=[],vm.goalResult=[],vm.notesAndFeedbackList=[],vm.getTasks=getTasks,vm.getFeedBack=getFeedBack,vm.getGrowth=getGrowth,vm.getNotification=getNotification,vm.getActivites=getActivites,vm.getRecentlyVisited=getRecentlyVisited,vm.getGoals=getGoals,vm.selectSearch=selectSearch,vm.startPulseLink=startPulseLink,vm.moreNotification=moreNotification,vm.getTopNotesAndFeedback=getTopNotesAndFeedback,vm.callAjax=callAjax,function(){localStorageTaskCheck()}()}function dashBoardListing($scope,ajaxService,sharedProperties,ngDialog,$filter,$localStorage){function getMembersData(){var options={url:vm.config.getMembersData};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success)vm.masterMemberList=response.memberList.length?response.memberList:[],vm.groupList=response.groupList,vm.responseRecieved=!0,vm.groupBasedResult(""),angular.forEach(response.memberList,function(val,index){vm.allMembersEmailId.push({email:val.email})});else if(null!==response.error){var errorMessage="";vm.responseRecieved=!0;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function groupBasedResult(selectedSearch){""===selectedSearch||null===selectedSearch?vm.memberList=angular.copy(vm.masterMemberList):vm.memberList=vm.masterMemberList.filter(function(e){return-1!==e.groups.indexOf(selectedSearch)}),!vm.pageSetting.alltoggle&&(vm.pageSetting.negative=!1,vm.pageSetting.userEmail.email=[]),vm.pageSetting.negative&&vm.checkAll(),vm.returnMemberList(vm.pageSetting.pageSize)}function returnMemberList(pageSize){return vm.masterMemberList.length?(vm.pageSetting.pageSize=pageSize,pageSize>=vm.masterMemberList.length&&(vm.pageSetting.disabledInfinite=!0,vm.pageSetting.pageSize=vm.masterMemberList.length),void vm.order(vm.pageSetting.lastPredicate,vm.pageSetting.lastReverse)):!0}function order(predicate,reverse){vm.pageSetting.lastPredicate=predicate,vm.pageSetting.lastReverse=reverse,vm.memberList=$filter("orderBy")(vm.memberList,vm.pageSetting.lastPredicate,vm.pageSetting.lastReverse)}function active(event,setting){vm.pageSetting.lastPredicate=setting.predicate,vm.pageSetting.lastReverse=setting.reverse,sharedProperties.toggleFilterClick(event,vm.pageSetting.lastPredicate),vm.order(vm.pageSetting.lastPredicate,vm.pageSetting.lastReverse)}function checkAll(){vm.pageSetting.checkedAll=!vm.pageSetting.checkedAll,vm.pageSetting.negative?vm.pageSetting.userEmail.email=vm.memberList.map(function(item){return{email:item.email,name:item.name,title:item.title}}):vm.pageSetting.userEmail.email=[]}function checkUncheck(){vm.pageSetting.alltoggle=!1,vm.pageSetting.checkedAll&&(vm.pageSetting.negative=!vm.pageSetting.negative,vm.pageSetting.checkedAll=!vm.pageSetting.checkedAll)}function searchTextFilter(search){vm.pageSetting.textSearching=search}function clearSearch(){vm.pageSetting.textSearching.length&&(vm.pageSetting.textSearching="",vm.pageSetting.searchText="")}function memberTakeAway(email){$localStorage.set("memEmail",email),window.location.href="/sp/dashboardUserAnalysis?email="+email}function resetfilter(){vm.pageSetting=angular.copy(vm.originalpageSetting),vm.groupBasedResult(vm.pageSetting.selectedSearch)}var vm=this;vm.memberList=[],vm.masterMemberList=[],vm.groupList=[],vm.responseRecieved=!1,vm.config={getMembersData:"/sp/groupLead/getMembersAndGroups"},vm.pageSetting={pageSize:10,userEmail:{email:[]},lastPredicate:"name",lastReverse:!1,textSearching:"",disabledInfinite:!1,selectedSearch:"",negative:!1,alltoggle:!1},vm.originalpageSetting=angular.copy(vm.pageSetting),vm.allMembersEmailId=[],vm.getMembersData=getMembersData,vm.groupBasedResult=groupBasedResult,vm.returnMemberList=returnMemberList,vm.order=order,vm.active=active,vm.checkAll=checkAll,vm.searchTextFilter=searchTextFilter,vm.clearSearch=clearSearch,vm.memberTakeAway=memberTakeAway,vm.resetfilter=resetfilter,vm.checkUncheck=checkUncheck}angular.module("spApp").controller("dashBoardController",dashBoardController),angular.module("spApp").controller("dashBoardListing",dashBoardListing),dashBoardController.$inject=["$scope","ajaxService","sharedProperties","$localStorage"],dashBoardListing.$inject=["$scope","ajaxService","sharedProperties","ngDialog","$filter","$localStorage"];
function externalFeedbackController($scope,ajaxService,$localStorage,ngDialog,sharedProperties,filterFilter,$filter){function sendFeedbackRequest(options,isExternal){_this.requestFormSubmitted=!1,_this.sendFeedbackForm.$valid?ajaxService.getAjaxResponse({url:_this.serviceApis.sendFeedbackRequest,data:$.param({feedbackId:options.feedbackId,feedbackResponse:options.feedbackResponse})}).then(function(response){if("true"===response.Success)$localStorage.set("fUserDetails",response),window.location="/sp/goals/feedback/external/complete";else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}}):_this.requestFormSubmitted=!0}function cancelFeedbackRequest(id){ajaxService.getAjaxResponse({url:_this.serviceApis.cancelFeedbackRequest,data:$.param({feedbackId:id,feedbackStatus:"DECLINED"})}).then(function(response){if("true"===response.Success)window.location="/?status=feedbackDecline",console.log(response);else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}$localStorage.flush();var _this=this;_this.requestFormSubmitted=!1,_this.sendFeedbackRequest=sendFeedbackRequest,_this.cancelFeedbackRequest=cancelFeedbackRequest,_this.serviceApis={sendFeedbackRequest:"/sp/goals/feedback/external/response",cancelFeedbackRequest:"/sp/goals/feedback/external/updateStatus"}}function externalFeedbackThankYouCtrl($scope,$localStorage){var _this=this;_this.getData=$localStorage.get("fUserDetails")}angular.module("spApp").controller("externalFeedbackController",externalFeedbackController),externalFeedbackController.$inject=["$scope","ajaxService","$localStorage","ngDialog","sharedProperties","filterFilter","$filter"],angular.module("spApp").controller("externalFeedbackThankYouCtrl",externalFeedbackThankYouCtrl),externalFeedbackThankYouCtrl.$inject=["$scope","$localStorage"];
function feedbackController($scope,ajaxService,$filter,ngDialog,sharedProperties,$rootScope,$timeout){$scope.feedbackTeam=!1,$scope.feedbackGrowth=[],$scope.current=5,$scope.allowAdd=!0,$scope.responseRecieved=!1,$scope.getAllMembersToInvite=[],$scope.masterGetAllMembersToInvite=[],$scope.viewMember=!1,$scope.oldView="",$scope.textSearching="",$scope.listCreaator=[],$scope.getInviteMemberDetail=[],$scope.errorMessage="",$scope.showError=!1,$scope.initSet=!1,$scope.goalUser="",$scope.goals={selected:[]},$scope.inviteError=!1,$scope.dateError=!1,$scope.inviteMemNonMember=!0,$scope.inviteMember=!0,$scope.inviteNonMember=!1,$scope.howDoYouKnow=["Friend","Family","Work Colleague"],$scope.goalUserNon="",$scope.growthName="",$scope.growthTitle="",$scope.hideIt=!0,$scope.id="";var d=new Date;$scope.maxDate=d.setMonth(d.getMonth()+3),$scope.feedback={user:[]},$scope.viewDrop=!1,$scope.nootherequest=!1,$scope.showTheme=!1,$scope.matchCase=[],$scope.sendGrowthdetail=function(name,description){$scope.growthName=name,$scope.growthTitle=description,ngDialog.open({template:"/sp/growth/growthPop",scope:$scope})},$scope.redirectTo=function(change){"default"!==change&&(""===$rootScope.noSelf?window.location.href=change:$rootScope.callSwitchChange("feedArchiveDetail"))},$scope.pageSetup=function(){$scope.getfeedbackTeam()},$scope.getfeedbackTeam=function(){$scope.getAllMembersToInvitefn(),ajaxService.getAjaxResponse({url:"/sp/getFeedbackTeam?groupMemberEmail="+$rootScope.noSelf,method:"get"}).then(function(response){"true"===response.Success?($scope.getfeedbackTeam=response,"undefined"!=typeof response.feedbackTeam?(angular.forEach(response.feedbackTeam,function(value,index){null!=value.email&&$rootScope.add($scope.feedback.user,value.email)}),$scope.showTheme=response.themesPresent,$scope.feedbackGrowth=response.feedbackTeam,$scope.listCreaator=angular.copy($scope.feedbackGrowth),$scope.currentActive=$scope.feedbackGrowth.length,$scope.viewDrop=!0,$scope.formatList("active")):($scope.currentActive=$scope.feedbackGrowth.length,$scope.formatList(),$scope.feedbackTeam=!0)):null!=response.error&&(window.location.href="/sp")})},$scope.nonMemberGrowthCall=function(){ajaxService.getAjaxResponse({url:"/sp/getUserGrowthAreas",data:$.param({groupMemberEmail:$rootScope.noSelf})}).then(function(response){if("true"===response.Success)$scope.goalUserNon=response.goals;else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.formatList=function(newAdd){if($scope.currentActive<$scope.current)for(var push=$scope.current-$scope.listCreaator.length,i=0;push>i;i++)$scope.incrementList();else if($scope.feedbackTeam=!1,$scope.viewMember=!0,$scope.inviteMemberView=!1,"undefined"!=typeof newAdd&&"first"===newAdd){var _this=$("ul.listSection").find("li:eq(0)");$scope.invitedMemberView(_this,_this.find("div").attr("data-email")),$scope.addUserFull=!1,$("ul.listSection").find("div").removeClass("selected"),$("ul.listSection").find("li:eq(0)").find("div").addClass("selected")}if("undefined"!=typeof newAdd&&"first"!==newAdd){$scope.oldView="";var len=$scope.feedbackGrowth.length;$("ul.listSection").find("div").removeClass("selected"),$("ul.listSection").find("li:eq("+len+")").find("div").addClass("selected")}},$scope.callSendArchivePopup=function(getInviteMemberDetail){$scope.archiveMember=getInviteMemberDetail,ngDialog.open({template:"/sp/feedback/archiveMemberScreen",scope:$scope})},$scope.sendToArchive=function(id,email,grouplead){$scope.showError=!1,ajaxService.getAjaxResponse({url:"/sp/archiveFeedback",data:$.param({feedbackUserId:id})}).then(function(response){if("true"===response.Success)sharedProperties.spliceIndex($scope.listCreaator,"id",id),sharedProperties.spliceIndex($scope.feedbackGrowth,"id",id),$rootScope.remove($scope.feedback.user,email),$scope.currentActive=$scope.feedbackGrowth.length,$scope.formatList("active"),$scope.getAllMembersToInvitefn(),$scope.inviteMemberView=!1,"undefined"!=typeof $scope.getAllMembersToInvite.userType?($scope.viewMember=!0,$scope.inviteNonMember=$scope.inviteMember=$scope.hideIt=!1):$scope.viewMember=$scope.inviteNonMember=$scope.inviteMember=!0,ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Member</strong>",message:" archived successfully"});else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage}),ngDialog.close("ngdialog1")}})},$scope.incrementList=function(){$scope.listCreaator.push({email:"invite"})},$scope.isActive=function(index){return index===$scope.currentActive?!0:!1},$scope.filteredFeedback=function(id){return $rootScope.contains($scope.feedback.user,id)?!0:!1},$scope.invitationSended=function(form,email){$scope.inviteError=!1,$scope.dateError=!1,form.$valid?$scope.invitationDirtyCheckClear(email):$scope.inviteError=!0},$scope.invitationDirtyCheckClear=function(email){if(!$scope.allowAdd)return!0;$scope.allowAdd=!1;var form=$("form.imonly").serialize()+"&groupMemberEmail="+$rootScope.noSelf;ajaxService.getAjaxResponse({url:"/sp/submitFeedbackRequest",data:form}).then(function(response){if("true"===response.Success)$scope.feedbackGrowth.push(response.inviteCreated),$scope.listCreaator=angular.copy($scope.feedbackGrowth),$scope.currentActive=$scope.feedbackGrowth.length,sharedProperties.spliceIndex($scope.getAllMembersToInvite.feedbackUsers,"email",email),sharedProperties.spliceIndex($scope.masterGetAllMembersToInvite.feedbackUsers,"email",email),$scope.currentActive>=$scope.current?$scope.formatList("first"):$scope.formatList("active"),window.scrollTo($(".listSection").offset().top,0),$scope.goals.selected=[],ngDialog.close("ngdialog1"),$timeout(function(){$scope.allowAdd=!0},500),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Member </strong> ",message:"invited successfully"});else if(null!=response.error){$scope.allowAdd=!0;for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}})},$scope.getAllMembersToInvitefn=function(){ajaxService.getAjaxResponse({url:"/sp/getAllFeedbackMembers",data:$.param({groupMemberEmail:$rootScope.noSelf})}).then(function(response){if("true"===response.Success)$scope.getAllMembersToInvite=response,$scope.responseRecieved=!0,$scope.masterGetAllMembersToInvite=angular.copy($scope.getAllMembersToInvite);else if(null!=response.error)for(var key in response.error)$scope.errorMessage=response.error[key]})},$scope.callInitMember=function(id,event,email){var _this="";if(!$scope.initSet){_this=$("ul.listSection").find("li:eq("+id+")");var catchEmailed=sharedProperties.getParam("feeddbackMemberId");$scope.matchCase.length||($scope.matchCase=$scope.listCreaator.filter(function(entry){return entry.id===catchEmailed}),null===catchEmailed||$scope.matchCase.length||$.growl({icon:"glyphicon glyphicon-ban-circle",message:$rootScope.pullInterNationalization("feedback.feedbackListing.noUserFound")})),null!==catchEmailed&&$scope.matchCase.length?catchEmailed===email&&($scope.invitedMemberView(_this,email),$scope.initSet=!0,_this.find("div").addClass("selected")):($scope.invitedMemberView(_this,email),$scope.initSet=!0,_this.find("div").addClass("selected"))}},$scope.callViewMember=function(id,event,email){var _this=$(event.currentTarget);if(_this.find("a").data("invite")){if(id!==$scope.currentActive&&!_this.hasClass("active"))return!1;$scope.id="",$scope.feedbackTeam=$scope.inviteMemberView=!1,$scope.viewMember=!0,"undefined"!=typeof $scope.getAllMembersToInvite.userType?$scope.inviteNonMember=$scope.inviteMember=$scope.hideIt=!1:$scope.inviteNonMember=$scope.inviteMember=!0,$scope.inviteMemNonMember&&(_this.hasClass("selected")||(_this.closest(".listSection").find("div").removeClass("selected"),_this.addClass("selected")),$scope.getAllMembersToInvite=angular.copy($scope.masterGetAllMembersToInvite),$scope.searchText="",$scope.oldView=id),$scope.viewDrop=!0}else $scope.invitedMemberView(_this,email)},$scope.invitedMemberView=function(eve,email){return eve.hasClass("selected")||(eve.closest(".listSection").find("div").removeClass("selected"),eve.addClass("selected")),email="undefined"==typeof eve.data("email")?email:eve.attr("data-email"),""!==$scope.id&&$scope.id===email?!1:($scope.id=email,$scope.viewDrop=!0,$scope.feedbackTeam=$scope.inviteMemberView=$scope.viewMember=!1,$scope.oldView="",void ajaxService.getAjaxResponse({url:"/sp/getFeedbackDetails",data:$.param({feadbackUserId:email,groupMemberEmail:$rootScope.noSelf})}).then(function(response){if("true"===response.Success)$scope.getInviteMemberDetail=response,$scope.feedbackEnable=!1,$scope.sendreminderEnable=!1,"undefined"!=typeof response.feedbackGoals?$scope.feedbackEnable=!0:$scope.sendreminderEnable=!0,$scope.inviteMemberView=!0;else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}}))},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.getAllMembersToInvite.feedbackUsers=sharedProperties.searchModule($scope.textSearching,$scope.masterGetAllMembersToInvite.feedbackUsers,2)},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.getAllMembersToInvite.feedbackUsers=angular.copy($scope.masterGetAllMembersToInvite.feedbackUsers))},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.order=function(predicate,reverse){$scope.getAllMembersToInvite.feedbackUsers=$filter("orderBy")($scope.getAllMembersToInvite.feedbackUsers,predicate,reverse)},$scope.callSelect=function(profile,event){return $scope.inviteError=!1,$(event.currentTarget).hasClass("notActive")?!1:($scope.addProfile=profile,void ngDialog.open({template:"/sp/feedback/submitRequest",scope:$scope}))},$scope.invitationSendedNon=function(form){$scope.inviteNonMemberErr=!1,form.$valid?$scope.invitationDirtyCheckClearNon():$scope.inviteNonMemberErr=!0},$scope.invitationDirtyCheckClearNon=function(){var form=$(".inviteNonMember").find("form").serialize()+"&groupMemberEmail="+$rootScope.noSelf;return $scope.nootherequest?!1:($scope.nootherequest=!0,void ajaxService.getAjaxResponse({url:"/sp/submitFeedbackRequest",data:form}).then(function(response){if("true"===response.Success)$scope.nootherequest=!1,$scope.feedbackGrowth.push(response.inviteCreated),$scope.listCreaator=angular.copy($scope.feedbackGrowth),$scope.currentActive=$scope.feedbackGrowth.length,$scope.nonMemFirstName=$scope.nonMemLastName=$scope.nonMemMemberEmail=$scope.selectedDateAsNumber="",$scope.hdu="Friend",$scope.currentActive>=$scope.current?$scope.formatList("first"):$scope.formatList("active"),$(".externalText").val($rootScope.pullInterNationalization("feedback.feedbackListing.growth.comment")),window.scrollTo($(".listSection").offset().top,0),$scope.getAllMembersToInvitefn(),$(".inviteNonMember").find(".squareBox").removeClass("active"),$scope.goals.selected=[],ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Member </strong> ",message:"invited successfully"});else if(null!=response.error){$scope.nootherequest=!1;for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}}))},$scope.clearStuff=function(){$scope.nonMemFirstName=$scope.nonMemLastName=$scope.nonMemMemberEmail=$scope.selectedDateAsNumber="",$scope.hdu="Friend",$scope.inviteNonMemberErr=!1,$scope.dateNonError=!1,$scope.goals.selected=[]},$scope.disableCheck=function(value){var curr=this.$index,_this=$(".growthAreas").find(".style:eq("+curr+")");_this.find("input").attr("disabled",!0)},$scope.active=function(event){sharedProperties.toggleFilterClick(event,$scope.currentPredicate)},$scope.sendReminder=function(member){$scope.reminderDetails=member,ngDialog.open({template:"/sp/reminder/feedsendReminder",scope:$scope})},$scope.sendReminderMailed=function(fulldetail){var form=$("form.sendReminder").serialize()+"&memberList="+fulldetail.email+"&feedbackUserId="+fulldetail.id+"&memberFirstName="+fulldetail.firstName+"&memberLastName="+fulldetail.lastName+"&type=FeedbackReminder";ajaxService.getAjaxResponse({url:"/sp/notifications/sendNotificationWithParams",data:form}).then(function(response){if("true"===response.Success)ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:" Reminder sent successfully "});else if(null!=response.error){ngDialog.close("ngdialog1");for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}})},$scope.goalRemove=function(id,index){ajaxService.getAjaxResponse({url:"/sp/goals/removeUserGoals",data:$.param({goalId:id})}).then(function(response){if("true"===response.Success)$scope.getInviteMemberDetail.feedbackGoals.GrowthAreas[index].goal.alreadyInvited=!1,$.growl({icon:"glyphicon glyphicon-ok",message:" Goal removed successfully "});else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}})},$scope.goalAdd=function(id,index){ajaxService.getAjaxResponse({url:"/sp/goals/addToUserGoals",data:$.param({goalId:id})}).then(function(response){if("true"===response.Success)$scope.getInviteMemberDetail.feedbackGoals.GrowthAreas[index].selected=!0,$.growl({icon:"glyphicon glyphicon-ok",message:" Goal added successfully "});else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}})}}function feedBackarchiveController($scope,ajaxService,$filter,ngDialog,sharedProperties,$rootScope,$localStorage){$scope.archiveMembers=[],$scope.masterarchiveMembers=[],$scope.pageSize=10,$scope.initPageSize=10,$scope.viewArchive=!1,$scope.currentPredicate="name",$scope.lastReverse=!1,$scope.textSearching="",$scope.responseRecieved=!1,$scope.getAllArchiveRequests=function(){ajaxService.getAjaxResponse({url:"/sp/getAllArchiveFeedbacks",method:"get"}).then(function(response){if("true"===response.Success)$scope.masterarchiveMembers=response.feedbackRequest,$scope.archiveFilter=response.feedbackRequestFilter,$scope.loadMore($scope.pageSize),$scope.viewArchive=!0,$scope.responseRecieved=!0;else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}})},$scope.loadMore=function(pageSize){$scope.order($scope.currentPredicate,$scope.lastReverse),$scope.pageSize=pageSize,pageSize>=$scope.masterarchiveMembers.length&&($scope.disabledInfinite=!0,$scope.pageSize=$scope.masterarchiveMembers.length),""!==$scope.textSearching?$scope.searchTextFilter($scope.textSearching):$scope.archiveMembers=angular.copy($scope.masterarchiveMembers)},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",this.searchText="",$scope.pageSize=$scope.pageStateSearch,$scope.archiveMembers=angular.copy($scope.masterarchiveMembers))},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.pageStateSearch=$scope.pageSize,$scope.archiveMembers=sharedProperties.searchModule($scope.textSearching,$scope.masterarchiveMembers,2,"feedbackUser")},$scope.order=function(predicate,reverse){$scope.currentPredicate=predicate,$scope.lastReverse=reverse,$scope.archiveMembers=$filter("orderBy")($scope.archiveMembers,predicate,reverse)},$scope.active=function(event){sharedProperties.toggleFilterClick(event,$scope.currentPredicate)},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.viewDetail=function(id,self){$localStorage.set("feedbackarchiveId",id),""===$rootScope.noSelf?window.location.href="/sp/feedback/archiveDetail":$rootScope.callSwitchChange("feedArchiveDetail")}}function feedbackArchiveDetailController($scope,ajaxService,sharedProperties,$rootScope,$timeout,$localStorage){$scope.memberList=[],$scope.scopeName=window.location.pathname.substring(window.location.pathname.lastIndexOf("/")+1),$scope.myGoals={},$scope.myGoals.addToGoalsFlag=[],$scope.cancelBtnHide=!0,$scope.getArchivedMemberDetail=function(){var ur="",obj="",archiveId="",method="post";if("/sp/feedback/themeView"===window.location.pathname||"/sp/goals/themeView"===window.location.pathname||"feedThemeView"===$rootScope.switchType||"goalThemeView"===$rootScope.switchType){$scope.viewArchive=!1;var optional="false";ur="/sp/goals/getAllGoals",method="get",("/sp/feedback/themeView"===window.location.pathname||"feedThemeView"===$rootScope.switchType)&&(optional="true",ur="/sp/getThemeView?goalTool="+optional+"&groupMemberEmail="+$rootScope.noSelf)}else{if($scope.viewArchive=!0,ur="/sp/feedbackArchive/getRequestDetails",archiveId=$localStorage.get("feedbackarchiveId"),null===archiveId)return window.location.href="/sp/feedback/archive",!0;obj=$.param({feedbackUserArchiveId:archiveId,groupMemberEmail:$rootScope.noSelf})}ajaxService.getAjaxResponse({url:ur,data:obj,method:method}).then(function(response){if("true"===response.Success)$scope.memberList=response,$timeout(function(){jQuery("body").find(".equalsSize").find(".squareBox.active").length>0?($scope.cancelBtnHide=!1,$scope.btnText=$rootScope.pullInterNationalization("goals.themeView.update")):($scope.cancelBtnHide=!0,$scope.btnText=$rootScope.pullInterNationalization("goals.themeView.create"))},200);else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}})},$scope.validateAndAddToMyGoals=function(){$scope.goalsCountError=!1;var checkBoxes=jQuery("body").find(".equalsSize").find(".squareBox.active"),goalsList=[];checkBoxes.length>=3?($scope.goalsCountError=!1,$.each(checkBoxes,function(i){goalsList.push(jQuery(checkBoxes[i]).attr("data-id"))}),ajaxService.getAjaxResponse({url:"/sp/goals/updateUserGoalsSelection",data:$.param({goalId:goalsList.toString()})}).then(function(response){if("true"===response.Success)$localStorage.set("goalsNotify","goalsReview"),$timeout(function(){window.location.href="/sp/goals"},200);else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}})):$scope.goalsCountError=!0},$scope.goBack=function(){""===$rootScope.noSelf?window.location.href="/sp/feedback/archive":$rootScope.callSwitchChange("feedArchive")},$scope.goBackGoal=function(){""===$rootScope.noSelf?window.location.href="/sp/goals":$rootScope.callSwitchChange("spGoals")},$scope.goalRemove=function(id,index,area){ajaxService.getAjaxResponse({url:"/sp/goals/removeUserGoals",data:$.param({goalId:id})}).then(function(response){if("true"===response.Success)"undefined"==typeof area?$scope.getInviteMemberDetail.feedbackGoals.GrowthAreas[index].goal.alreadyInvited=!1:$scope.memberList.userGoal.splice(index,1),$.growl({icon:"glyphicon glyphicon-ok",message:" Goal removed successfully "});else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}})},$scope.goalAdd=function(id,index,area){ajaxService.getAjaxResponse({url:"/sp/goals/addToUserGoals",data:$.param({goalId:id})}).then(function(response){if("true"===response.Success)"undefined"==typeof area?$scope.getInviteMemberDetail.feedbackGoals.GrowthAreas[index].selected=!0:$scope.memberList.userGoal[index].selected=!0,$.growl({icon:"glyphicon glyphicon-ok",message:" Goal added successfully "});else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}})},$scope.redirectTo=function(change){"default"!==change&&(""===$rootScope.noSelf?window.location.href=change:$rootScope.callSwitchChange(change))},$scope.allUnhide=function(_this){var toggle=$(_this.currentTarget).siblings("div.hideUnhide");toggle.is(":visible")?toggle.hide(500):($(".hideUnhide").each(function(index,value){$(this).hide(500)}),toggle.show(500))},$scope.closeIt=function(_this){$(_this.currentTarget).closest("div.hideUnhide").hide(500)}}angular.module("spApp").controller("feedbackController",feedbackController),angular.module("spApp").controller("feedBackarchiveController",feedBackarchiveController),angular.module("spApp").controller("feedbackArchiveDetailController",feedbackArchiveDetailController),feedbackController.$inject=["$scope","ajaxService","$filter","ngDialog","sharedProperties","$rootScope","$timeout"],feedBackarchiveController.$inject=["$scope","ajaxService","$filter","ngDialog","sharedProperties","$rootScope","$localStorage"],feedbackArchiveDetailController.$inject=["$scope","ajaxService","sharedProperties","$rootScope","$timeout","$localStorage"];
function GoalsController($scope,ajaxService,ngDialog,$rootScope,$timeout,userDataService,$localStorage){$scope.articleSize=10,$scope.defaultSize=10,$scope.getGoalsStatus=function(){var growlNotification=$localStorage.get("goalsNotify");null!==growlNotification&&"undefined"!=typeof growlNotification&&("goalsReview"===growlNotification&&$.growl({icon:"glyphicon glyphicon-ok",message:" Goals updated successfully"}),setTimeout(function(){$localStorage.remove("goalsNotify")},300)),ajaxService.getAjaxResponse({url:""===$rootScope.noSelf||null===$rootScope.noSelf||"undefined"==typeof $rootScope.noSelf?"/sp/goals/getUserGoals":"/sp/for/goals/getUserGoals?memberEmail="+$rootScope.noSelf,method:"get"}).then(function(response){if("true"===response.Success)""===$rootScope.noSelf||null===$rootScope.noSelf||"undefined"==typeof $rootScope.noSelf?($scope.showNoGoalsMessage=!1,response.userGoal.length>0?($scope.goalsStatus=response.userGoal,0===$scope.goalsStatus&&($scope.goalsStatus=!0)):window.location.href="/sp/goals/themeView"):0===response.userGoal.length?$scope.showNoGoalsMessage=!0:($scope.goalsStatus=response.userGoal,0===$scope.goalsStatus&&($scope.goalsStatus=!0));else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$rootScope.profileReady===!0?($scope.getLoggedInUserEmail=$localStorage.get("loggegdInProfile"),$scope.defaultEmail=$scope.getLoggedInUserEmail.member.email,$scope.getGoalsStatus()):$timeout(function(){$scope.getLoggedInUserEmail=$localStorage.get("loggegdInProfile"),$scope.defaultEmail=$scope.getLoggedInUserEmail.member.email,$scope.getGoalsStatus()},1e3),$scope.reviewGoals=function(){""===$rootScope.noSelf?window.location.href="/sp/goals/themeView":$rootScope.callSwitchChange("goalThemeView")},$scope.getRecentArtilesList=function(){ajaxService.getAjaxResponse({url:"/sp/tracking/recentVistedArticles",method:"get"}).then(function(response){"true"===response.Success?($scope.showRecentArticles=!0,$scope.recentArticleList=response.trackingResponse):null!=response.error&&($scope.showRecentArticles=!1)})},$scope.getRecentArtilesList(),$scope.getRecentBookmarkList=function(){ajaxService.getAjaxResponse({url:"/sp/tracking/getBookMarkedArticles",method:"get"}).then(function(response){"true"===response.Success?($scope.showBookmarks=!0,$scope.recentBookmarkList=response.articles):null!=response.error&&($scope.showBookmarks=!1)})},$scope.getRecentBookmarkList()}angular.module("spApp").controller("GoalsController",GoalsController),GoalsController.$inject=["$scope","ajaxService","ngDialog","$rootScope","$timeout","userDataService","$localStorage"];
function goalsPersonalityMapping($scope,ajaxService,$timeout,$rootScope,$localStorage){function getPersonalityMap(){ajaxService.getAjaxResponse({url:useServices.pmGetAll}).then(function(response){if("true"===response.Success)_this.storedPersonalityMap=response.pratcieAreas,_this.pMapLoaded=!0;else if(null!==response.error){var errorMessage="";_this.pMapLoaded=!1;for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function getPracticeAreas(){ajaxService.getAjaxResponse({url:useServices.paGetAll}).then(function(response){if("true"===response.Success)_this.storedPracticeAreas=response.pratcieAreas;else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function showPersonalityMapping(id,index){_this.showMapping=!1,_this.editMapping=!1,_this.isSortable=!1,_this.updatedPracticeAreas=[],_this.activePersonality={},_this.updatedGoalIdList=[],angular.forEach(_this.storedPersonalityMap,function(i,j){return i.id===id?(_this.selectedProfileIndex=index,_this.activePersonality=angular.copy(_this.storedPersonalityMap[j]),_this.activePersonalityCopy=angular.copy(_this.storedPersonalityMap[j]),_this.showMapping=!0,!1):void 0})}function generatePaList(){_this.isPaListUpdated=!1,_this.updatedPracticeAreas=[];var count1=0,count2=0,activeGoalIds=[];jQuery.each(_this.activePersonalityCopy.goals,function(i){activeGoalIds.push(_this.activePersonalityCopy.goals[i].id),count1++}),count1===_this.activePersonalityCopy.goals.length&&jQuery.each(_this.storedPracticeAreas,function(i){var id=_this.storedPracticeAreas[i].id,isExisting=jQuery.inArray(id,activeGoalIds);-1===isExisting&&_this.updatedPracticeAreas.push(_this.storedPracticeAreas[i]),count2++}),count2===_this.storedPracticeAreas.length&&(_this.activePersonality=angular.copy(_this.activePersonalityCopy),_this.isPaListUpdated=!0,_this.selectedPa="")}function removePracticeArea(id){jQuery.each(_this.activePersonalityCopy.goals,function(i,j){return _this.activePersonalityCopy.goals[i].id===id?(_this.activePersonalityCopy.goals.splice(i,1),_this.generatePaList(),_this.selectedPa="",!1):void 0})}function addPracticeArea(id){var goalInfo="";jQuery.each(_this.storedPracticeAreas,function(i){return id===_this.storedPracticeAreas[i].id?(goalInfo=angular.copy(_this.storedPracticeAreas[i]),!1):void 0}),"undefined"!=typeof goalInfo&&null!==goalInfo&&(_this.activePersonalityCopy.goals.push({id:goalInfo.id,name:goalInfo.name}),_this.generatePaList(),_this.selectedPa="")}function updatePersonalityMap(){var counter=0;_this.updatedGoalIdList=[],$("#pa-sort-list").find("li").each(function(value,index){_this.updatedGoalIdList.push($(this).attr("data-id")),counter++}),counter===$("#pa-sort-list").find("li").length&&ajaxService.getAjaxResponse({url:useServices.pmUpdate,data:$.param({personalityType:_this.activePersonality.personalityType,goalIds:_this.updatedGoalIdList.join()})}).then(function(response){if("true"===response.Success)$.growl({icon:"glyphicon glyphicon-ok",message:"Mapping updated successfully!"}),_this.updatedGoalIdList=[],_this.getPersonalityMap();else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function initSortable(){var _el=document.getElementById("pa-sort-list");_this.isSortable===!1&&("undefined"==typeof _this.sortable?_this.sortable=new Sortable(_el,{group:"name",animation:150,onEnd:function(e){_this.activePersonalityCopy.goals.move(e.oldIndex,e.newIndex)}}):(_this.sortable.destroy(),$timeout(function(){_this.sortable=new Sortable(_el,{group:"name",animation:150,onEnd:function(e){_this.activePersonalityCopy.goals.move(e.oldIndex,e.newIndex)}})},100)),_this.isSortable=!0)}var _this=this,useServices={pmGetAll:"/sp/sysAdmin/personalityMapping/getAll",paGetAll:"/sp/sysAdmin/practiceArea/getAll",pmUpdate:"/sp/sysAdmin/personalityMapping/update"};_this.pMapLoaded=!1,_this.showMapping=!1,_this.editMapping=!1,_this.isPaListUpdated=!1,_this.selectedPa="",_this.selectedProfileIndex=-1,_this.showGoalsList=!1,_this.isSortable=!1,_this.storedPersonalityMap={},_this.storedPracticeAreas={},_this.activePersonality={},_this.activePersonalityCopy=[],_this.updatedPracticeAreas=[],_this.updatedGoalIdList=[],_this.getPersonalityMap=getPersonalityMap,_this.getPracticeAreas=getPracticeAreas,_this.updatePersonalityMap=updatePersonalityMap,_this.showPersonalityMapping=showPersonalityMapping,_this.removePracticeArea=removePracticeArea,_this.addPracticeArea=addPracticeArea,_this.generatePaList=generatePaList,_this.initSortable=initSortable,function(){_this.getPracticeAreas(),_this.getPersonalityMap()}()}angular.module("spApp").controller("goalsPersonalityMapping",goalsPersonalityMapping),goalsPersonalityMapping.$inject=["$scope","ajaxService","$timeout","$rootScope","$localStorage"];
function groupListController($scope,ajaxService,$filter,$state,ngDialog,$timeout,sharedProperties,$rootScope,$localStorage){function getGroupData(){ajaxService.getAjaxResponse({url:vm.config.getGroupData}).then(function(response){if("true"===response.Success)vm.groupList=response.groupInfoList.length?response.groupInfoList:[],vm.responseRecieved=!0,vm.pageCounter(vm.pageSetting.pageSize);else if(null!=response.error){vm.responseRecieved=!0;var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function pageCounter(pageSize,nosorting){"undefined"==typeof nosorting&&vm.order(vm.pageSetting.currentPredicate,vm.pageSetting.lastReverse),vm.pageSetting.pageSize=pageSize,pageSize>=vm.groupList.length&&(vm.pageSetting.disabledInfinite=!0,vm.pageSetting.pageSize=pageSize)}function order(predicate,reverse){vm.pageSetting.currentPredicate=predicate,vm.pageSetting.lastReverse=reverse,vm.groupList=$filter("orderBy")(vm.groupList,vm.pageSetting.currentPredicate,vm.pageSetting.lastReverse)}function resetCounter(){vm.pageSetting=angular.copy(vm.originalPageSetting),vm.order(vm.pageSetting.currentPredicate,vm.pageSetting.lastReverse);var curr=$(".groupsHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")}function profileRoute(groupname){$localStorage.set("groupname",groupname),$state.go("profile")}function getListMember(){vm.pageSetting.oneTime&&(vm.getAllMembers(),vm.pageSetting.oneTime=!1)}function getAllMembers(){ajaxService.getAjaxResponse({url:vm.config.getAllMembers}).then(function(response){if("true"===response.Success){var allMail=response.memberList;angular.forEach(allMail,function(val,index){""===allMail[index].firstName&&""===allMail[index].lastName&&delete allMail[index]}),allMail=$.grep(allMail,function(n){return n}),vm.allEmails=allMail}})}function createNewGroup(){getListMember(),$scope.errornewGroup=!1,$scope.errornewEmptyGroup=!1,$scope.savenewGroup=!1,ngDialog.open({template:vm.config.createGroup,scope:$scope})}function confirmDelete(groupname){ajaxService.getAjaxResponse({url:vm.config.deleteGroup,data:$.param({name:groupname})}).then(function(response){if("true"===response.Success)sharedProperties.spliceIndex(vm.groupList,"name",groupname),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.group.deleteFullMessage")});else if(null!=response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function removeGroupLead(groupname,groupMemberEmail){ajaxService.getAjaxResponse({url:vm.config.removeMember,data:$.param({name:groupname,memberEmail:groupMemberEmail,isGroupLead:!0})}).then(function(response){if("true"===response.Success){for(var i=0;i<vm.groupList.length;i++)if(vm.groupList[i].name===groupname){vm.groupList[i].groupLead=null,vm.groupList[i].numOfMembers=parseInt(vm.groupList[i].numOfMembers)-parseInt(1);break}$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.group.deleteMessage")})}else if(null!=response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function active(event,setting){vm.pageSetting.currentPredicate=setting.predicate,vm.pageSetting.lastReverse=setting.reverse,sharedProperties.toggleFilterClick(event,vm.pageSetting.currentPredicate),vm.order(vm.pageSetting.currentPredicate,vm.pageSetting.lastReverse)}function callreload(){window.location.reload()}function saveGroupName(savetosave,oldname,event,index){vm.errorNotification.updateGroupNameError=!1,vm.errorNotification.updateGroupEmptyError=!1,vm.errorNotification.saved=!1;var eve=angular.element(event.currentTarget).scope(),idToGo=index;return""===savetosave||"undefined"==typeof savetosave?(vm.errorNotification.updateGroupEmptyError=!0,!1):savetosave===oldname?(eve.editenabled=!1,!1):void ajaxService.getAjaxResponse({url:vm.config.updateName,data:$.param({name:savetosave,oldName:oldname})}).then(function(response){"true"===response.Success?(vm.errorNotification.saved=!0,vm.errorNotification.updateGroupName=!0,vm.groupList[idToGo].name=response.groupInfoList[0].name,eve.editenabled=!1,$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.group.updateGroupName")})):null!=response.error&&(vm.errorNotification.updateGroupNameError=!0)})}function groupNameResult(event){vm.errorNotification.updateGroupNameError=!1,vm.errorNotification.updateGroupEmptyError=!1;var scoper=angular.element(event.currentTarget).scope();scoper.editgroupsave=scoper.groupList.name}var vm=this;vm.groupList=[],vm.responseRecieved=!1,vm.pageSetting={pageSize:10,intialVal:10,lastReverse:!1,saved:!1,oneTime:!0,groupPage:!0,currentPredicate:"name",disabledInfinite:!1},vm.originalPageSetting=angular.copy(vm.pageSetting),vm.errorNotification={updateGroupName:!1,updateGroupNameError:!1,updateGroupEmptyError:!1,errornewGroup:!1,errornewEmptyGroup:!1,savenewGroup:!1},vm.config={getGroupData:"/sp/admin/group/all",getAllMembers:"/sp/admin/member",createGroup:"/sp/admin/group/createGroup",deleteGroup:"/sp/admin/group/delete",removeMember:"/sp/admin/group/removeMember",updateName:"/sp/admin/group/updateName",saveGroup:"/sp/admin/group/create"},vm.allEmails=null,vm.getGroupData=getGroupData,vm.pageCounter=pageCounter,vm.order=order,vm.resetCounter=resetCounter,vm.getListMember=getListMember,vm.confirmDelete=confirmDelete,vm.removeGroupLead=removeGroupLead,vm.active=active,vm.createNewGroup=createNewGroup,vm.profileRoute=profileRoute,vm.saveGroupName=saveGroupName,vm.callreload=callreload,vm.groupNameResult=groupNameResult,vm.getAllMembers=getAllMembers,function(){$localStorage.remove("spProfileTab")}(),$scope.saveNewGroup=function(groupname,groupLeadEmailId){return $scope.errornewGroup=!1,$scope.errornewEmptyGroup=!1,$scope.savenewGroup=!1,""===groupname||"undefined"==typeof groupname?($scope.errornewEmptyGroup=!0,!1):void ajaxService.getAjaxResponse({url:vm.config.saveGroup,data:$.param({name:groupname,groupLead:groupLeadEmailId})}).then(function(response){"true"===response.Success?($scope.savenewGroup=!0,$scope.errornewGroup=!1,$scope.errornewEmptyGroup=!1,vm.groupList.unshift(response.groupInfo),vm.pageCounter(vm.groupList.length,"nosorting"),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.group.saveMessage")}),ngDialog.close("ngdialog1")):null!=response.error&&($scope.errornewGroup=!0)})},$scope.closeGroup=function(){ngDialog.close("ngdialog1")}}angular.module("spApp").controller("groupListController",groupListController),groupListController.$inject=["$scope","ajaxService","$filter","$state","ngDialog","$timeout","sharedProperties","$rootScope","$localStorage"];
function growthController($scope,ajaxService,$filter,ngDialog,$timeout,sharedProperties,$rootScope){$scope.getGrowthTeam="",$scope.growthTeam=!1,$scope.getAllMembersToInvite=[],$scope.masterGetAllMembersToInvite=[],$scope.viewMember=!1,$scope.current=5,$scope.oldView="",$scope.textSearching="",$scope.interateGrowth=[],$scope.listCreaator=[],$scope.getInviteMemberDetail=[],$scope.errorMessage="",$scope.showError=!1,$scope.initSet=!1,$scope.goalUser="",$scope.goals={selected:[]},$scope.inviteError=!1,$scope.dateError=!1,$scope.inviteMemNonMember=!0,$scope.inviteMember=!0,$scope.inviteNonMember=!1,$scope.howDoYouKnow=["Friend","Family","Work Colleague"],$scope.growthName="",$scope.growthTitle="",$scope.hideIt=!0,$scope.id="";var d=new Date;$scope.maxDate=d.setMonth(d.getMonth()+3),$scope.nonMemberGrowthCallStatus=!1,$scope.matchCase=[],$scope.masterExUser={firstName:"",lastName:"",memberEmail:"",hdu:"Friend"},$scope.responseRecieved=!1,$scope.sendGrowthdetail=function(name,description){$scope.growthName=name,$scope.growthTitle=description,ngDialog.open({template:"/sp/growth/growthPop",scope:$scope})},$scope.getGrowthTeam=function(){$scope.getAllMembersToInvitefn(),ajaxService.getAjaxResponse({url:"/sp/getGrowthTeam?groupMemberEmail="+$rootScope.noSelf,method:"get"}).then(function(response){if("true"===response.Success)$scope.getGrowthTeam=response,"undefined"!=typeof response.growthTeam?($scope.interateGrowth=response.growthTeam,$scope.listCreaator=angular.copy($scope.interateGrowth),$scope.currentActive=$scope.interateGrowth.length,$scope.formatList("active")):($scope.currentActive=$scope.interateGrowth.length,$scope.formatList(),$scope.growthTeam=!0);else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.nonMemberGrowth=function(){$scope.step=1,$scope.emailCheckFail=!1,$scope.nonMemberGrowthCallStatus||($scope.nonMemberGrowthCall(),$scope.nonMemberGrowthCallStatus=!0)},$scope.nonMemberGrowthCall=function(){ajaxService.getAjaxResponse({url:"/sp/getUserGrowthAreas",data:$.param({groupMemberEmail:$rootScope.noSelf})}).then(function(response){if("true"===response.Success)$scope.goalUserNon=response.goals;else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.formatList=function(newAdd){if($scope.currentActive<$scope.current){var pushItem=$scope.current-$scope.listCreaator.length;if(0!==pushItem)for(var i=0;pushItem>i;i++)$scope.incrementList();else $scope.incrementList()}else if($scope.growthTeam=!1,$scope.viewMember=!0,$scope.inviteMemberView=!1,"undefined"!=typeof newAdd&&"first"===newAdd){var _this=$("ul.listSection").find("li:eq(0)");$scope.invitedMemberView(_this,_this.find("div").data("email")),$scope.addUserFull=!1,$("ul.listSection").find("div").removeClass("selected"),$("ul.listSection").find("li:eq(0)").find("div").addClass("selected")}if("undefined"!=typeof newAdd&&"first"!==newAdd){$scope.oldView="";var len=$scope.interateGrowth.length;$("ul.listSection").find("div").removeClass("selected"),$("ul.listSection").find("li:eq("+len+")").find("div").addClass("selected")}},$scope.callSendArchivePopup=function(getInviteMemberDetail){$scope.archiveMember=getInviteMemberDetail,ngDialog.open({template:"/sp/growth/archiveMemberScreen",scope:$scope})},$scope.sendToArchive=function(id,email,grouplead){$scope.showError=!1,ajaxService.getAjaxResponse({url:"/sp/archive",data:$.param({growthRequestId:id,memberEmail:email})}).then(function(response){if("true"===response.Success)sharedProperties.spliceIndex($scope.listCreaator,"id",id),sharedProperties.spliceIndex($scope.interateGrowth,"id",id),$scope.currentActive=$scope.interateGrowth.length,$scope.formatList("active"),$scope.getAllMembersToInvitefn(),$scope.inviteMemberView=!1,"undefined"!=typeof $scope.getAllMembersToInvite.userType?($scope.viewMember=!0,$scope.inviteNonMember=$scope.inviteMember=$scope.hideIt=!1):$scope.viewMember=$scope.inviteNonMember=$scope.inviteMember=!0,ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Member</strong>",message:" archived successfully"});else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage}),ngDialog.close("ngdialog1")}})},$scope.incrementList=function(){$scope.listCreaator.push({email:"inviteGrowth"})},$scope.isActive=function(index){return index===$scope.currentActive?!0:!1},$scope.filteredGrowth=function(index,event){$rootScope.contains($scope.goals.selected,index)?($scope.remove($scope.goals.selected,index),$(event.currentTarget).removeClass("active")):($rootScope.add($scope.goals.selected,index),$(event.currentTarget).addClass("active")),$scope.dateError=!1,$scope.dateNonError=!1},$scope.invitationSended=function(form,mode){$scope.inviteError=!1,$scope.dateError=!1,$scope.newArray=$scope.alreadyChecked.concat($scope.goals.selected).unique(),$scope.newArray.length||($scope.dateError=!0),$scope.newArray.sort().join(",")===$scope.alreadyChecked.sort().join(",")&&($scope.dateError=!0),form.$valid&&$scope.newArray.length&&!$scope.dateError?$scope.invitationDirtyCheckClear(form,mode):$scope.inviteError=!0},$scope.invitationDirtyCheckClear=function(form,mode){form=$("form[name="+form.$name+"]").serialize()+"&groupMemberEmail="+$rootScope.noSelf,"external"===mode&&(form=$.param($scope.addProfile)+"&"+form,$scope.previousStep());for(var i=0;i<$scope.goals.selected.length;i++)form=form+"&goal="+encodeURIComponent($scope.goalUser[$scope.goals.selected[i]].id);ajaxService.getAjaxResponse({url:"/sp/inviteMember",data:form}).then(function(response){if("true"===response.Success)$scope.interateGrowth.push(response.inviteCreated),$scope.listCreaator=angular.copy($scope.interateGrowth),$scope.currentActive=$scope.interateGrowth.length,$scope.currentActive>=$scope.current?$scope.formatList("first"):$scope.formatList("active"),$scope.getAllMembersToInvitefn(),window.scrollTo($(".listSection").offset().top,0),ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Member </strong> ",message:"invited successfully"});else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}})},$scope.getAllMembersToInvitefn=function(){ajaxService.getAjaxResponse({url:"/sp/getAllMembersToInvite",data:$.param({groupMemberEmail:$rootScope.noSelf})}).then(function(response){if("true"===response.Success)$scope.getAllMembersToInvite=response,"undefined"!=typeof $scope.getAllMembersToInvite.userType&&$scope.nonMemberGrowth(),$scope.masterGetAllMembersToInvite=angular.copy($scope.getAllMembersToInvite),$scope.responseRecieved=!0;else if(null!=response.error)for(var key in response.error)$scope.errorMessage=response.error[key]})},$scope.callInitMember=function(id,event,email){var _this="";if(!$scope.initSet){_this=$("ul.listSection").find("li:eq("+id+")");var catchEmailed=sharedProperties.getParam("growthMemberId");$scope.matchCase.length||($scope.matchCase=$scope.listCreaator.filter(function(entry){return entry.id===catchEmailed}),null===catchEmailed||$scope.matchCase.length||$.growl({icon:"glyphicon glyphicon-ban-circle",message:$rootScope.pullInterNationalization("growth.growthListing.noUserFound")})),null!==catchEmailed&&$scope.matchCase.length?catchEmailed===email&&($scope.invitedMemberView(_this,email),$scope.initSet=!0,_this.find("div").addClass("selected")):($scope.invitedMemberView(_this,email),$scope.initSet=!0,_this.find("div").addClass("selected"))}},$scope.callViewMember=function(id,event,email){var _this=$(event.currentTarget);if(_this.find("a").data("invite")){if(id!==$scope.currentActive&&!_this.hasClass("active"))return!1;$scope.id="",$scope.growthTeam=$scope.inviteMemberView=!1,$scope.viewMember=!0,"undefined"!=typeof $scope.getAllMembersToInvite.userType?$scope.inviteNonMember=$scope.inviteMember=$scope.hideIt=!1:$scope.inviteNonMember=$scope.inviteMember=!0,$scope.inviteMemNonMember&&(_this.hasClass("selected")||(_this.closest(".listSection").find("div").removeClass("selected"),_this.addClass("selected")),$scope.getAllMembersToInvite=angular.copy($scope.masterGetAllMembersToInvite),$scope.searchText="",$scope.oldView=id)}else $scope.invitedMemberView(_this,email)},$scope.invitedMemberView=function(eve,email){return eve.hasClass("selected")||(eve.closest(".listSection").find("div").removeClass("selected"),eve.addClass("selected")),email="undefined"==typeof eve.data("email")?email:eve.attr("data-email"),""!==$scope.id&&$scope.id===email?!1:($scope.id=email,$scope.growthTeam=$scope.inviteMemberView=$scope.viewMember=!1,$scope.oldView="",void ajaxService.getAjaxResponse({url:"/sp/getInviteMemberDetail",data:$.param({growthRequestId:email})}).then(function(response){if("true"===response.Success)$scope.getInviteMemberDetail=response.inviteMember,$scope.feedbackEnable=!1,$scope.sendreminderEnable=!1,"undefined"!=typeof $scope.getInviteMemberDetail.feedbackIntervals[0]?$scope.feedbackEnable=!0:$scope.sendreminderEnable=!0,$scope.inviteMemberView=!0;else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}}))},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.getAllMembersToInvite.growthUsers=sharedProperties.searchModule($scope.textSearching,$scope.masterGetAllMembersToInvite.growthUsers,2)},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.getAllMembersToInvite.growthUsers=angular.copy($scope.masterGetAllMembersToInvite.growthUsers))},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.order=function(predicate,reverse){$scope.getAllMembersToInvite.growthUsers=$filter("orderBy")($scope.getAllMembersToInvite.growthUsers,predicate,reverse)},$scope.callAdd=function(profile,event,mode){return $(event.currentTarget).hasClass("notActive")?!1:($scope.addProfile=profile,$scope.inviteError=!1,$scope.dateError=!1,$scope.goals.selected=[],void ajaxService.getAjaxResponse({url:"/sp/getUserGrowthAreas",data:$.param({memberEmail:"pop"===mode?profile.email:profile.memberEmail,groupMemberEmail:$rootScope.noSelf})}).then(function(response){if("true"===response.Success){$scope.alreadyChecked=[],$scope.goalUser=response.goals;for(var i=0;i<$scope.goalUser.length;i++)$scope.goalUser[i].alreadyInvited&&$scope.alreadyChecked.push(i);"pop"===mode?ngDialog.open({template:"/sp/growth/addMemberScreen",scope:$scope}):response.allGoalsInvited?$.growl({icon:"glyphicon glyphicon-ban-circle",message:$rootScope.pullInterNationalization("growth.growthListing.allGoalAssigned")}):$scope.step++}else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}}))},$scope.nextStep=function(exuser,event){this.inviteNonMemberForm.$valid?($scope.emailCheckFail=!1,ajaxService.getAjaxResponse({url:"/sp/isValidExternalUserRequest",data:$.param({externalUser:exuser.memberEmail})}).then(function(response){"true"===response.Success?$scope.callAdd(exuser,event,"normal"):null!=response.error&&($scope.emailCheckFail=!0)})):$scope.inviteNonMemberErr=!0},$scope.previousStep=function(){$scope.clearNonMemberData(),$scope.step--},$scope.clearNonMemberData=function(){$scope.inviteNonMemberErr=!1,$scope.exuser=angular.copy($scope.masterExUser)},$scope.disableCheck=function(value){var curr=this.$index,_this=$(".growthAreas").find(".style:eq("+curr+")");_this.find("input").attr("disabled",!0)},$scope.active=function(event){sharedProperties.toggleFilterClick(event,$scope.currentPredicate)},$scope.sendReminder=function(member){$scope.reminderDetails=member,ngDialog.open({template:"/sp/reminder/sendReminder",scope:$scope})},$scope.sendReminderMailed=function(fulldetail){var form=$("form.sendReminder").serialize()+"&memberList="+fulldetail.user.email+"&growthRequestId="+fulldetail.id+"&memberFirstName="+fulldetail.user.firstName+"&memberLastName="+fulldetail.user.lastName+"&type=GrowthFeedbackReminder";ajaxService.getAjaxResponse({url:"/sp/notifications/sendNotificationWithParams",data:form}).then(function(response){if("true"===response.Success)ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:" Reminder sent successfully "});else if(null!=response.error){ngDialog.close("ngdialog1");for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}})}}function requestController($scope,ajaxService,$filter,ngDialog,$timeout,sharedProperties,$rootScope,$localStorage){$scope.requestMemberList=[],$scope.masterRequestMemberList=[],$scope.pageSize=10,$scope.initPageSize=10,$scope.currentPredicate="user.name",$scope.lastReverse=!1,$scope.textSearching="",$scope.responseRecieved=!1,$scope.getAllFeedbackRequests=function(){ajaxService.getAjaxResponse({url:"/sp/getAllFeedbackRequests",method:"get"}).then(function(response){"true"===response.Success?($scope.masterRequestMemberList=response.growthFeedbackRequest,$scope.requestFilter=response.requestStatusFilter,$scope.loadMore($scope.pageSize),$scope.responseRecieved=!0):window.location.href="/sp"})},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.loadMore=function(pageSize){$scope.order($scope.currentPredicate,$scope.lastReverse),$scope.pageSize=pageSize,pageSize>=$scope.masterRequestMemberList.length&&($scope.disabledInfinite=!0,$scope.pageSize=$scope.masterRequestMemberList.length),""!==$scope.textSearching?$scope.searchTextFilter($scope.textSearching):$scope.requestMemberList=angular.copy($scope.masterRequestMemberList)},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",this.searchText="",$scope.pageSize=$scope.pageStateSearch,$scope.requestMemberList=angular.copy($scope.masterRequestMemberList))},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.pageStateSearch=$scope.pageSize,$scope.requestMemberList=sharedProperties.searchModule($scope.textSearching,$scope.masterRequestMemberList,2,"user")},$scope.order=function(predicate,reverse){$scope.currentPredicate=predicate,$scope.lastReverse=reverse,$scope.requestMemberList=$filter("orderBy")($scope.requestMemberList,predicate,reverse)},$scope.active=function(event){sharedProperties.toggleFilterClick(event,$scope.currentPredicate)},$scope.requestDetail=function(fullmember,redirect){$localStorage.set("memberRequestInitiated",fullmember),"initiate"===redirect?window.location.href="/sp/growth/requestDetail":window.location.href="/sp/growth/requestDetailEdit"}}function requestDetailController($scope,ajaxService,ngDialog,$timeout,sharedProperties,$rootScope,$localStorage){$scope.memberList=[],$scope.weekon=!0,$scope.monthon=!1,$scope.currentPredicate="1",$scope.feedBackCycle="",$scope.valueResponse="",$scope.keyResponse="",$scope.indexChange="",$scope.foundCurrent=!1,$scope.foundCurrentClass=!1,$scope.growthName="",$scope.growthTitle="",$scope.internal="internal",$scope.sendGrowthdetail=function(name,description){$scope.growthName=name,$scope.growthTitle=description,ngDialog.open({template:"/sp/growth/growthPop",scope:$scope})},$scope.getAllMemberDetail=function(){$scope.memberList=$localStorage.get("memberRequestInitiated")},$scope.goBack=function(){window.location.href="/sp/growth/request"},$scope.getExternalMembersProfileDetails=function(){var id=null!=$localStorage.get("externalRequestInitiated")?$localStorage.get("externalRequestInitiated").growthRequestId:"";ajaxService.getAjaxResponse({url:"/sp/growth/external/requestDetail",data:$.param({growthRequestId:id})}).then(function(response){"true"===response.Success&&($scope.memberList=response.initiateRequestDate,$scope.type="external",$scope.getAllMemberDetailRequest("type"))})},$scope.getAllMemberDetailRequest=function(type){"undefined"==typeof type&&($scope.memberList=$localStorage.get("memberRequestInitiated")),ajaxService.getAjaxResponse({url:"/sp/getGrowthFeedback",data:$.param({growthRequestId:$scope.memberList.id})}).then(function(response){"true"===response.Success&&($scope.feedBackCycle=response)})},$scope.onClickActivate=function(index,event){var currentElem=$(event.currentTarget);return $scope.currentPredicate===currentElem.data("pick")?!1:(currentElem.parent().find("h4").removeClass("reverseon"),currentElem.find("h4").addClass("reverseon"),void($scope.currentPredicate=currentElem.data("pick")))},$scope.setFeedbackMode=function(){"weekly"===$scope.dropSearch?($scope.weekon=!0,$scope.monthon=!1):($scope.weekon=!1,$scope.monthon=!0)},$scope.feedBackSubmit=function(sub,type){var value=$("form").serialize(),ur="";ur="undefined"==typeof type?"/sp/submitGrowthFeedback":"/sp/growth/external/submitGrowthFeedback",ajaxService.getAjaxResponse({url:ur,data:value}).then(function(response){"true"===response.Success?($scope.feedBackCycle.interval[$scope.keyResponse]=response,$scope.valueResponse=response,$scope.memberList.requestProgressStatus[$scope.indexChange]="true",$localStorage.set("memberRequestInitiated",$scope.memberList),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Feedback </strong> ",message:"submitted successfully"})):$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})})},$scope.callDetail=function(value,key,event,inIndex){$scope.foundCurrent||("current"===value.state?($scope.foundCurrent=!0,$scope.getDetail(value,key,event,inIndex)):$scope.getDetail(value,key,event,inIndex))},$scope.callActive=function(value,index){$scope.foundCurrentClass||"current"===value.state&&($scope.foundCurrentClass=!0)},$scope.getDetail=function(value,key,event,inIndex){var curr=$(event.currentTarget);return $scope.indexChange=inIndex.$index,curr.length||($("ul.listSection").find("span.ic").removeClass("active"),$("ul.listSection").find("li:eq("+$scope.indexChange+")").find("span.ic").addClass("active")),curr.find("span.ic").hasClass("active")?!1:(curr.closest(".listSection").find("span.ic").removeClass("active"),curr.find("span.ic").addClass("active"),$scope.valueResponse=value,$scope.keyResponse=key,void($scope.enableFeedBack=!0))},$scope.quesansfn=function(ques){return"No"===ques?"Yes":"No"},$scope.declineRequest=function(type){var ur="undefined"==typeof type?"/sp/growth/declineRequest":"/sp/growth/declineRequestExternal";ngDialog.open({template:ur,scope:$scope})},$scope.acceptRequest=function(list,type){var obj=($scope.selectedCheckbox,""),ur="undefined"==typeof type?"/sp/acceptRequest":"/sp/growth/external/acceptReject";obj="single"===$scope.selectedCheckbox?{id:list.id,dateRepeatPattern:$scope.selectedCheckbox,accepted:"true",comment:""}:"weekly"===$scope.dropSearch?{id:list.id,dateRepeatPattern:"Weekly",dayOfWeek:$scope.currentPredicate,comment:"",accepted:"true"}:{id:list.id,dateRepeatPattern:"Monthly",dayOfWeek:$scope.dropmSearch,onMonthDay:$scope.dropdSearch,comment:"",accepted:"true"},ajaxService.getAjaxResponse({url:ur,data:$.param(obj)}).then(function(response){if("true"===response.Success)"undefined"==typeof type?window.location.href="/sp/growth/request":window.location.href="/sp/growth/requestDetailEditExternal";else{for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}})},$scope.declined=function(list,type){var ur="undefined"==typeof type?"/sp/acceptRequest":"/sp/growth/external/acceptReject";ajaxService.getAjaxResponse({url:ur,data:$.param({id:list.id,comment:$("#commentBlock").val(),accepted:"false"})}).then(function(response){if("true"===response.Success)"undefined"==typeof type?window.location.href="/sp/growth/request":window.location.href="/?status=growthDecline";else{for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:$scope.errorMessage})}})}}function archiveController($scope,ajaxService,$filter,ngDialog,$timeout,sharedProperties,$rootScope,$localStorage){$scope.archiveMembers=[],$scope.masterarchiveMembers=[],$scope.pageSize=10,$scope.initPageSize=10,$scope.archiveShow=!1,$scope.currentPredicate="user.name",$scope.lastReverse=!1,$scope.textSearching="",$scope.responseRecieved=!1,$scope.getAllArchiveRequests=function(){ajaxService.getAjaxResponse({url:"/sp/allArchivedRequest",method:"get"}).then(function(response){"true"===response.Success?($scope.masterarchiveMembers=response.archivedGrowthRequest,$scope.archiveFilter=response.requestStatusFilter,$scope.archiveShow=!0,$scope.loadMore($scope.pageSize),$scope.responseRecieved=!0):window.location.href="/sp"})},$scope.loadMore=function(pageSize){$scope.order($scope.currentPredicate,$scope.lastReverse),$scope.pageSize=pageSize,pageSize>=$scope.masterarchiveMembers.length&&($scope.disabledInfinite=!0,$scope.pageSize=$scope.masterarchiveMembers.length),""!==$scope.textSearching?$scope.searchTextFilter($scope.textSearching):$scope.archiveMembers=angular.copy($scope.masterarchiveMembers)},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",this.searchText="",$scope.pageSize=$scope.pageStateSearch,$scope.archiveMembers=angular.copy($scope.masterarchiveMembers))},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.pageStateSearch=$scope.pageSize,$scope.archiveMembers=sharedProperties.searchModule($scope.textSearching,$scope.masterarchiveMembers,2,"user")},$scope.order=function(predicate,reverse){$scope.currentPredicate=predicate,$scope.lastReverse=reverse,$scope.archiveMembers=$filter("orderBy")($scope.masterarchiveMembers,predicate,reverse)},$scope.active=function(event){sharedProperties.toggleFilterClick(event,$scope.currentPredicate)},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.viewDetail=function(id){$localStorage.set("archiveId",id),window.location.href="/sp/growth/archiveDetail"}}function archiveDetailController($scope,ajaxService,ngDialog,$timeout,userDataService,sharedProperties,$rootScope,$localStorage){$scope.memberList=[],$scope.userTypeImdi=!1,$scope.getArchivedMemberDetail=function(){var archiveId=$localStorage.get("archiveId");ajaxService.getAjaxResponse({url:"/sp/getArchivedRequest",data:$.param({archivedId:archiveId})}).then(function(response){"true"===response.Success?$scope.memberList=response.inviteMember:$scope.memberList=response.success.inviteMember})},$scope.goBack=function(){window.location.href="/sp/growth/archive"},$scope.sendGrowthdetail=function(name,description){$scope.growthName=name,$scope.growthTitle=description,ngDialog.open({template:"/sp/growth/growthPop",scope:$scope})}}function externalUserFlow($scope,$element,ajaxService,$localStorage){$scope.sfailure=!1,$scope.externalUserInfo=[],$scope.assessment360page=!1,$scope.setOptions=function(){$scope.assessment360page=!0},$scope.initExternalLogin=function(form){if($scope.sfailure=!1,$scope.spExtLogin.submitted=!1,$scope.spExtLogin.$valid)ajaxService.getAjaxResponse({url:$scope.assessment360page===!0?"/sp/feedback/external/confirmProfileDetails":"/sp/growth/external/confirmProfileDetails",data:$("form").serialize()}).then(function(response){"true"===response.Success?$scope.assessment360page?window.location.reload():($localStorage.set("externalRequestInitiated",response),window.location.href="/sp/growth/requestDetailExternal"):($scope.failure=response.error,$scope.sfailure=!0)});else{var elem=angular.element($element);$("html,body").animate({scrollTop:$(elem).find("form .ng-invalid:first").offset().top-20},300),$scope.spExtLogin.submitted=!0}}}angular.module("spApp").controller("growthController",growthController),angular.module("spApp").controller("requestController",requestController),angular.module("spApp").controller("requestDetailController",requestDetailController),angular.module("spApp").controller("archiveController",archiveController),angular.module("spApp").controller("archiveDetailController",archiveDetailController),angular.module("spApp").controller("externalUserFlow",externalUserFlow),growthController.$inject=["$scope","ajaxService","$filter","ngDialog","$timeout","sharedProperties","$rootScope"],requestController.$inject=["$scope","ajaxService","$filter","ngDialog","$timeout","sharedProperties","$rootScope","$localStorage"],requestDetailController.$inject=["$scope","ajaxService","ngDialog","$timeout","sharedProperties","$rootScope","$localStorage"],archiveController.$inject=["$scope","ajaxService","$filter","ngDialog","$timeout","sharedProperties","$rootScope","$localStorage"],archiveDetailController.$inject=["$scope","ajaxService","ngDialog","$timeout","userDataService","sharedProperties","$rootScope","$localStorage"],externalUserFlow.$inject=["$scope","$element","ajaxService","$localStorage"];
function hiringAddSingleController($scope,$element,$attrs,$http,userDataService,ngDialog,$timeout,ajaxService,$localStorage){$scope.addCandidate={},$scope.candidate={},$scope.dialogStatus={},$scope.serverExceptionContent="",$scope.zeroAvailabilityError=!1,$scope.existingSPMember=!1,$scope.showDate=!1,$scope.candidate.sendInvite=!1,$scope.submitDisabled=!1,$scope.addCandidate.submitted=!1,$scope.existingHiring=!1,$scope.existingHiringArchive=!1,$scope.currentCompanyEmp=!1,$scope.memberPublicProfile=!1,$scope.serverException=!1,$scope.emailCheckFlag=!1,$scope.isEmailValidated=!1;var storedProfile=$localStorage.get("loggegdInProfile"),userRoles=storedProfile.member.roles.sort();$scope.isAccountAdmin=0===jQuery.inArray("AccountAdministrator",userRoles)?!0:!1;var d=new Date;$scope.endDate=d.setDate(d.getDate()),$scope.getCandidateAvailability=function(){ajaxService.getAjaxResponse({url:"/sp/hiring/getAvailableSubscriptions"}).then(function(response){if("true"===response.Success)$scope.availableSubscriptions=response.availableHiringSubscripitons,0===$scope.availableSubscriptions?($scope.zeroAvailabilityError=!0,$scope.submitDisabled=!0):($scope.zeroAvailabilityError=!1,$scope.submitDisabled=!1);else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.existingUserCheck=function(email){if($scope.zeroAvailabilityError===!1){$scope.existingSPMember=!1,$scope.existingHiring=!1,$scope.serverException=!1,$scope.existingHiringArchive=!1,$scope.submitDisabled=!1,$scope.candidate.sendInvite=!1,$scope.currentCompanyEmp=!1;var emailPattern=/^[a-z0-9._-]+@[a-z0-9._-]+\.[a-z]{2,4}$/i;emailPattern.test(email)?ajaxService.getAjaxResponse({url:"/sp/hiring/checkCandidate",data:$.param({candidateEmail:email}).replace(/%2C/g,",").replace(/%40/g,"@")}).then(function(response){var archivedCandidate=response["hiring-archived"].length,hiringCandidate=response.hiring.length,companyCandidate=response.company.length,memberCandidate=response.memberList.length;"true"===response.Success?($scope.serverException=!1,$scope.submitDisabled=!1,$scope.serverExceptionContent="",0===archivedCandidate&&0===hiringCandidate&&0===companyCandidate&&0===memberCandidate?($scope.candidate.sendInvite=!0,$scope.existingSPMember=!1,$scope.existingHiring=!1,$scope.existingHiringArchive=!1,$scope.currentCompanyEmp=!1):($scope.existingSPMember=!1,$scope.existingHiring=!1,$scope.existingHiringArchive=!1,$scope.currentCompanyEmp=!1,archivedCandidate>0?($scope.existingHiringArchive=!0,$scope.submitDisabled=!0):hiringCandidate>0?($scope.existingHiring=!0,$scope.submitDisabled=!0):companyCandidate>0?($scope.currentCompanyEmp=!0,$scope.submitDisabled=!0):memberCandidate>0&&($scope.existingSPMember=!0,$scope.submitDisabled=!1,"VALID"===response.memberList[0].userStatus&&response.memberList[0].profileSettings.hiringAccessAllowed===!0?$scope.memberPublicProfile=!0:$scope.memberPublicProfile=!1),$scope.candidate.sendInvite=!1)):($scope.existingSPMember=!1,$scope.existingHiring=!1,$scope.existingHiringArchive=!1,$scope.currentCompanyEmp=!1,$scope.serverException=!0,$scope.submitDisabled=!0,void 0!==typeof response.error.InvalidRequestException&&($scope.serverExceptionContent=response.error.InvalidRequestException),jQuery("html, body").animate({scrollTop:0})),$scope.isEmailValidated=!0}):($scope.isEmailValidated=!0,$scope.addCandidate.submitted=!1)}},$scope.addHiringCandidate=function(fData){if($scope.isEmailValidated===!1&&($scope.existingUserCheck(fData.email),$timeout(function(){$scope.addHiringCandidate(fData)},300)),$scope.addCandidate.submitted=!1,$scope.serverException=!1,$scope.zeroAvailabilityError===!1&&$scope.submitDisabled===!1&&$scope.isEmailValidated===!0)if($scope.addCandidate.$valid){var _params={firstName:fData.firstName,lastName:fData.lastName,email:fData.email,phoneNumber:fData.phoneNumber,webURL:fData.webURL,day:"undefined"!=typeof fData.dueDate?fData.dueDate.getDate():0,month:"undefined"!=typeof fData.dueDate?fData.dueDate.getMonth()+1:0,year:"undefined"!=typeof fData.dueDate?fData.dueDate.getFullYear():0,roles:fData.roles,tags:fData.tags,sendInvite:$scope.candidate.sendInvite};_params.month<10&&(_params.month="0"+_params.month),_params.day<10&&(_params.day="0"+_params.day),ajaxService.getAjaxResponse({url:"/sp/hiring/addCandidate",data:$.param(_params).replace(/%2C/g,",").replace(/%40/g,"@")}).then(function(response){"true"===response.Success?($localStorage.set("gNotify","AddSingle"),setTimeout(function(){window.location="/sp/tools/hiring/"},100)):($scope.serverException=!0,$scope.submitDisabled=!0,void 0!==typeof response.error.InvalidRequestException&&($scope.serverExceptionContent=response.error.InvalidRequestException),jQuery("html, body").animate({scrollTop:0}))})}else $scope.addCandidate.submitted=!0,jQuery("html, body").animate({scrollTop:0})},$scope.cancelRedirect=function(){window.location="/sp/tools/hiring/"},$scope.initHiringAddSingle=function(){$scope.getCandidateAvailability()},$scope.initHiringAddSingle()}angular.module("spApp").controller("hiringAddSingleController",hiringAddSingleController),hiringAddSingleController.$inject=["$scope","$element","$attrs","$http","userDataService","ngDialog","$timeout","ajaxService","$localStorage"];
function importCandidatesController($scope,FileUploader,$element,$attrs,$http,userDataService,ngDialog,$timeout,ajaxService,$localStorage){$scope.zeroAvailabilityError=!1,$scope.submitDisabled=!1,$scope.fileNameList=[],$scope.serverException=!1,$scope.serverExceptionMessage="",$scope.noFilesError=!1,$scope.fileFormatError=!1;var storedProfile=$localStorage.get("loggegdInProfile"),userRoles=storedProfile.member.roles.sort();$scope.isAccountAdmin=0===jQuery.inArray("AccountAdministrator",userRoles)?!0:!1,$scope.openFileUploadModal=function(){var fileInput=jQuery("body").find("#selectFile");$scope.zeroAvailabilityError===!1&&(fileInput.click(),$scope.fileFormatError===!0&&($scope.fileFormatError=!1),$scope.noFilesError===!0&&($scope.noFilesError=!1))},$scope.clearFileInput=function(){if($scope.fileFormatError===!0&&($scope.fileFormatError=!1),$scope.noFilesError===!0&&($scope.noFilesError=!1),jQuery("html").hasClass("ie")){var fileInput=jQuery("body").find('form[name="importCandidates"]');fileInput[0].reset(),$scope.fileFormatError===!0&&($scope.fileFormatError=!1),$scope.noFilesError===!0&&($scope.noFilesError=!1)}};var uploader=$scope.uploader=new FileUploader({url:"/sp/hiring/multiInviteAddFile",alias:"hiringCandidateFile",onAfterAddingFile:function(){$scope.fileFormatError===!0&&($scope.fileFormatError=!1),$scope.noFilesError===!0&&($scope.noFilesError=!1)}});$scope.uploader.filters.push({name:"csvFilter",fn:function(item,options){var type="|"+item.name.slice(item.name.lastIndexOf(".")+1)+"|",x=-1!=="|csv|".indexOf(type);return x?$scope.fileFormatError===!0&&($scope.fileFormatError=!1):($scope.noFilesError===!0&&($scope.noFilesError=!1),$scope.clearFileInput(),$scope.fileFormatError=!0),x}}),$scope.clearCache=function(){ajaxService.getAjaxResponse({url:"/sp/hiring/multi/reset"})},$scope.getCandidateAvailability=function(){ajaxService.getAjaxResponse({url:"/sp/hiring/getAvailableSubscriptions"}).then(function(response){if("true"===response.Success)$scope.availableSubscriptions=response.availableHiringSubscripitons,0===$scope.availableSubscriptions?($scope.zeroAvailabilityError=!0,$scope.submitDisabled=!0):($scope.zeroAvailabilityError=!1,$scope.submitDisabled=!1);else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.validateImportedContacts=function(){if($scope.fileFormatError===!0&&($scope.fileFormatError=!1),$scope.submitDisabled===!1&&$scope.zeroAvailabilityError===!1)if(uploader.queue.length>0){$scope.importFailed=!1,$scope.noFilesError=!1,$scope.serverError=!1;var failedFailList=[],fileCounter=0,successFileList=[];uploader.uploadAll(),uploader.onCompleteItem=function(fileItem,response,status,headers){if(fileCounter+=1,null===response.error)successFileList.push(fileItem._file.name);else for(var key in response.error)failedFailList.push(response.error[key])},uploader.onCompleteAll=function(){fileCounter===uploader.queue.length&&(0===failedFailList.length?($scope.importFailed=!1,$localStorage.set("files",successFileList.join(",")),$timeout(function(){window.location="/sp/tools/hiring/validateList"},200)):(uploader.clearQueue(),$scope.clearCache(),$scope.importFailed=!0,$scope.importFailedMsg=failedFailList.join(", ")))}}else $scope.noFilesError=!0},$scope.cancelRedirect=function(){window.location="/sp/tools/hiring/"},$scope.initImportCandidates=function(){$scope.getCandidateAvailability()},$scope.initImportCandidates()}angular.module("spApp").controller("importCandidatesController",importCandidatesController),importCandidatesController.$inject=["$scope","FileUploader","$element","$attrs","$http","userDataService","ngDialog","$timeout","ajaxService","$localStorage"];
function libraryHomeDetailsController($scope,$q,$element,$attrs,ajaxService,$location,$http,$state,$filter,ngDialog,sharedProperties,$timeout,$rootScope,$localStorage){$scope.accountsListException=!1,$scope.updatedAccountListing=[],$scope.selectedAccountsCount=0,$scope.updatedListingIndex=0,$scope.accountList={},$scope.selectedCompanyIdList=[],$scope.allAccountsIdList=[],$scope.getDetailsException=!1,$scope.createNewLibraryHome={},$scope.newLibraryHome={},$scope.libraryHomeEditing={},$scope.libraryHomeEditing.status=!0,$scope.libraryHomeIdStatus=!1,$scope.selectedAccountsDisplayList=[],$scope.showAccountsDisplayList=!1,$scope.cid="",$scope.searchKeywords=[],$scope.searchTag=[],$scope.pageSize=100,$scope.statusInclude=[],$scope.textSearching="",$scope.intialPageSize=100,$scope.load=!0,$scope.selectArticlesList=[];var defaultImage="/sp/resources/images/image_not_available.jpg";$scope.newLibraryHome.articleImage0=defaultImage,$scope.newLibraryHome.articleImage1=defaultImage,$scope.newLibraryHome.articleImage2=defaultImage,$scope.newLibraryHome.articleImage3=defaultImage,$scope.libraryHomeEnableEdit=function(s){"enable"===s?$scope.libraryHomeEditing.status=!0:($scope.libraryHomeEditing.status=!1,$scope.getLibraryHomeDetails()),$scope.accountList.search=null},$scope.goLibraryHome=function(){window.location="/sp/sysAdmin/curriculam/libraryHome"},$scope.getCompanyId=function(){var url=window.location.href,splitUrl=url.split("?")[1];"undefined"!=typeof splitUrl?$scope.cid=splitUrl.split("=")[1]:$scope.cid=null},$scope.getLibraryHomeDetails=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/library/articles",data:$.param({companyId:$scope.cid})}).then(function(response){if("true"===response.Success)$scope.getDetailsException=!1,$scope.company=response.company,null===response.company&&"business"===$scope.cid?$scope.globalName="Global Home - Business":null===response.company&&"individual"===$scope.cid&&($scope.globalName="Global Home - Individual"),$scope.newLibraryHome.articleId0=response.Content[0].articleId,$scope.newLibraryHome.articleDescription0=response.Content[0].shortDescription,$scope.newLibraryHome.articleName0=response.Content[0].articleLinkLabel,null!==response.Content[0].imageUrl&&void 0!==response.Content[0].imageUrl&&($scope.newLibraryHome.articleImage0=response.Content[0].imageUrl+"?width=150"),$scope.newLibraryHome.articleId1=response.Content[1].articleId,$scope.newLibraryHome.articleDescription1=response.Content[1].shortDescription,$scope.newLibraryHome.articleName1=response.Content[1].articleLinkLabel,null!==response.Content[1].imageUrl&&void 0!==response.Content[1].imageUrl&&($scope.newLibraryHome.articleImage1=response.Content[1].imageUrl+"?width=150"),$scope.newLibraryHome.articleId2=response.Content[2].articleId,$scope.newLibraryHome.articleDescription2=response.Content[2].shortDescription,$scope.newLibraryHome.articleName2=response.Content[2].articleLinkLabel,null!==response.Content[2].imageUrl&&void 0!==response.Content[2].imageUrl&&($scope.newLibraryHome.articleImage2=response.Content[2].imageUrl+"?width=150"),$scope.newLibraryHome.articleId3=response.Content[3].articleId,$scope.newLibraryHome.articleDescription3=response.Content[3].shortDescription,$scope.newLibraryHome.articleName3=response.Content[3].articleLinkLabel,null!==response.Content[3].imageUrl&&void 0!==response.Content[3].imageUrl&&($scope.newLibraryHome.articleImage3=response.Content[3].imageUrl+"?width=150");else{$scope.company.name=null,$scope.getDetailsException=!0;for(var key in response.error)$scope.getDetailsExceptionMsg=response.error[key]}})},$scope.selectArticleViaModal=function(articleId,articleName,position,articleImage){null===articleImage||void 0===articleImage?articleImage=defaultImage:articleImage+="?width=150",0===position?($scope.newLibraryHome.articleId0=articleId,$scope.newLibraryHome.articleName0=unescape(articleName),$scope.newLibraryHome.articleImage0=articleImage):1===position?($scope.newLibraryHome.articleId1=articleId,$scope.newLibraryHome.articleName1=unescape(articleName),$scope.newLibraryHome.articleImage1=articleImage):2===position?($scope.newLibraryHome.articleId2=articleId,$scope.newLibraryHome.articleName2=unescape(articleName),$scope.newLibraryHome.articleImage2=articleImage):3===position&&($scope.newLibraryHome.articleId3=articleId,$scope.newLibraryHome.articleName3=unescape(articleName),$scope.newLibraryHome.articleImage3=articleImage),ngDialog.close("ngdialog1")},$scope.updateLibraryHome=function(fData){var _params=[],companyId="";if(companyId=null===$scope.company&&"business"===$scope.cid?"business":null===$scope.company&&"individual"===$scope.cid?"individual":$scope.company.id,$scope.createNewLibraryHome.validationErrors=!1,$scope.createNewLibraryHomeException=!1,_params=[{articleId:$scope.newLibraryHome.articleId0,position:0,shortDescription:fData.articleDescription0,companyId:companyId},{articleId:$scope.newLibraryHome.articleId1,position:1,shortDescription:fData.articleDescription1,companyId:companyId},{articleId:$scope.newLibraryHome.articleId2,position:2,shortDescription:fData.articleDescription2,companyId:companyId},{articleId:$scope.newLibraryHome.articleId3,position:3,shortDescription:fData.articleDescription3,companyId:companyId}],void 0!==$scope.newLibraryHome.articleId0&&void 0!==$scope.newLibraryHome.articleId1&&void 0!==$scope.newLibraryHome.articleId2&&void 0!==$scope.newLibraryHome.articleId3&&void 0!==$scope.newLibraryHome.articleDescription0&&void 0!==$scope.newLibraryHome.articleDescription1&&void 0!==$scope.newLibraryHome.articleDescription2&&void 0!==$scope.newLibraryHome.articleDescription3&&""!==$scope.newLibraryHome.articleDescription0&&""!==$scope.newLibraryHome.articleDescription1&&""!==$scope.newLibraryHome.articleDescription2&&""!==$scope.newLibraryHome.articleDescription3&&null!==companyId&&""!==companyId){for(var i=0;4>i;i++)ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/admin/add/contentArticles",data:$.param(_params[i])}).then(function(response){if("true"===response.Success)$scope.createNewLibraryHome=!1,$localStorage.set("gNotify","AddNewLibraryHome");else{$scope.createNewLibraryHomeException=!0;for(var key in response.error)$scope.createNewLibraryHomeExceptionMsg=response.error[key]}});$.growl({icon:"glyphicon glyphicon-ok",message:" Articles updated Successfully"}),setTimeout(function(){window.location="/sp/sysAdmin/curriculam/libraryHome"},1e3)}else $.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:"Please fill all the required Fields"}),$scope.createNewLibraryHome.validationErrors=!0},$scope.selectArticle=function(position){$scope.fetchedTopics=[],$scope.selectArticlesList=[],ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/getAllTopics",method:"POST",data:$.param({topic:"Themes"})}).then(function(response){response&&($scope.fetchedTopics=response.topics,$scope.position=position,$scope.getArticlesList=function(themeValue){$scope.selectArticlesList=[],ajaxService.getAjaxResponse({url:"/sp/trainingLibrary/getResults",method:"POST",data:$.param({topicValue:themeValue,topicCategory:"Themes"})}).then(function(response){if("true"===response.Success)response.articles.length>0&&($scope.getAllError=!1,$scope.selectArticlesList=response.articles,$scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize));else{$scope.getAllError=!0;for(var key in response.error)$scope.getAllErrorMsg=response.error[key]}})},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.returnMemberList($scope.pageSize)},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize))},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.returnMemberList=function(pageSize){if($scope.searchTag.length&&!$scope.statusInclude.length&&($scope.selectArticlesList=angular.copy($scope.newArr)),$scope.searchTag.length&&$scope.statusInclude.length){$scope.combineArray=[];for(var i=0;i<$scope.newArr.length;i++)for(var j=0;j<$scope.checkBox.length;j++)$scope.newArr[i].email===$scope.checkBox[j].email&&$scope.combineArray.push($scope.newArr[i]);$scope.selectArticlesList=angular.copy($scope.combineArray)}!$scope.searchTag.length&&$scope.statusInclude.length&&($scope.selectArticlesList=angular.copy($scope.checkBox)),$scope.searchTag.length||$scope.statusInclude.length||($scope.selectArticlesList=angular.copy($scope.selectArticlesList)),$scope.pageSize=pageSize,pageSize>=$scope.selectArticlesList.length&&($scope.pageSize=$scope.selectArticlesList.length),$scope.load&&($scope.lastPredicate="name",$scope.lastReverse=!1,$scope.loadBtnCLicked=!1,$scope.load=!1),$scope.loadBtnCLicked&&($scope.loadBtnCLicked=!1),$scope.order($scope.lastPredicate,$scope.lastReverse),$scope.selectArticlesList=$scope.selectArticlesList},$scope.active=function(event){var currentElem=$(event.currentTarget);currentElem.find("h4").hasClass("on")?currentElem.find("h4").hasClass("reverseon")?currentElem.find("h4").removeClass("reverseon"):currentElem.find("h4").addClass("reverseon"):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"))},$scope.order=function(predicate,reverse){$scope.lastPredicate=predicate,$scope.lastReverse=reverse,$scope.selectArticlesList=$filter("orderBy")($scope.selectArticlesList,predicate,reverse)},ngDialog.open({template:"/sp/resources/html/sysAdmin/curriculam/selectArticleModal.html",scope:$scope}))})},function(){$scope.getCompanyId(),$scope.getLibraryHomeDetails()}()}angular.module("spApp").controller("libraryHomeDetailsController",libraryHomeDetailsController),libraryHomeDetailsController.$inject=["$scope","$q","$element","$attrs","ajaxService","$location","$http","$state","$filter","ngDialog","sharedProperties","$timeout","$rootScope","$localStorage"];
function loginFormController($scope,ajaxService,$state,sharedProperties,$localStorage){$scope.pwd={min:8,max:32,toggle:!1,err:!1,inputType:"password"},$scope.resetPassword={},$scope.formData={},$scope.resetPasswordMessage=!1,$scope.resetPasswordErrorMessage=!1,$scope.changePasswordErrorMessage=!1,$scope.resetPasswordMessageErr=!1,$scope.validateCredentials=function(fData){$scope.formData=fData,$scope.spLogin.submitted=!1,$scope.spLogin.$valid?document.getElementsByTagName("form")[0].submit():$scope.spLogin.submitted=!0},$scope.returnHome=function(){window.location.replace("/sp")},$scope.showPassword=function($event){$event.preventDefault(),$scope.pwd.toggle===!1?($scope.pwd.toggle=!0,$scope.pwd.inputType="text"):($scope.pwd.toggle=!1,$scope.pwd.inputType="password")},$scope.resetCredentials=function(){if($scope.resetPasswordMessage=!1,$scope.resetPasswordErrorMessage=!1,$scope.resetPasswordMessageErr=!1,$scope.resetPassword.$valid){var options={url:"/sp/sendResetEmail",data:$.param({email:$scope.user.email})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?(sharedProperties.setResetEmail(response.email),$state.go("resetConfirmation")):null!=response.error&&($scope.resetPasswordErrorMessage=!0)})}else $scope.resetPasswordMessageErr=!0},$scope.changeCredentials=function(){if($scope.changePasswordErrorMessage=!1,$scope.pwdSubmit=!1,$scope.resetPassword.$valid){var options={url:"/sp/newPassword",data:$.param({password:$scope.user.password})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?window.location.href="/sp/signin":null!=response.error&&($scope.changePasswordErrorMessage=!0)})}else $scope.pwdSubmit=!0},$scope.getPropertyValues=function(){$scope.disResetEmail=sharedProperties.getResetEmail()},$scope.cookieCheck=function(){var cookieEnabled=navigator.cookieEnabled?!0:!1;return"undefined"!=typeof navigator.cookieEnabled||cookieEnabled||(document.cookie="testcookie",cookieEnabled=-1!==document.cookie.indexOf("testcookie")?!0:!1),cookieEnabled?$scope.isLocalStorageNameSupported():$scope.showCookieFail()},$scope.isLocalStorageNameSupported=function(){$scope.clearStorage()},$scope.showCookieFail=function(){window.location.href="/sp/enable/cookie"},$scope.showLocalStorageFail=function(){window.location.href="/?status=privateBrowsing"},$scope.clearStorage=function(){$localStorage.flush()},function(){$scope.cookieCheck()}()}function thankyouController($scope,ajaxService){$scope.redirect=function(){window.location.href="/sp"}}angular.module("spApp").controller("loginFormController",loginFormController),loginFormController.$inject=["$scope","ajaxService","$state","sharedProperties","$localStorage"],angular.module("spApp").controller("thankyouController",thankyouController),thankyouController.$inject=["$scope","ajaxService"];
function mediaManagerController($scope,ajaxService,$localStorage,ngDialog,sharedProperties,filterFilter,$filter,$rootScope){function setMediaData(obj){$localStorage.set("mediaData",obj),ngDialog.close()}function filterMediaResults(){var filtered=[];""!==self.searchMediaText?(filtered=filterFilter(self.masterMediaListModal,self.searchMediaText),self.showClearSearchIcon=!0):(filtered=self.masterMediaListModal,self.showClearSearchIcon=!1),self.mediaListModal=filtered,filtered=[]}function clearMediaSearch(){""!==self.searchMediaText&&(self.showClearSearchIcon=!1,self.searchMediaText=""),self.filterMediaResults()}function switchView(type){$rootScope.mediaView=type}var self=this;self.serviceApis={getAllImages:"/sp/media/getAll"},self.masterMediaListModal=[],self.mediaListModal=[],self.showClearSearchIcon=!1,self.searchMediaText="",self.responseAvailable=!1,self.getAllImages=getAllImages,self.filterMediaResults=filterMediaResults,self.setMediaData=setMediaData,self.clearMediaSearch=clearMediaSearch,self.switchView=switchView;var getAllImages=function(){ajaxService.getAjaxResponse({url:self.serviceApis.getAllImages,method:"GET"}).then(function(response){if("true"===response.Success)self.responseAvailable=!0,self.masterMediaListModal=response.mediaList,self.mediaListModal=angular.copy(self.masterMediaListModal);else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})};!function(){getAllImages()}()}angular.module("spApp").controller("mediaManagerController",mediaManagerController),mediaManagerController.$inject=["$scope","ajaxService","$localStorage","ngDialog","sharedProperties","filterFilter","$filter","$rootScope"];
function memberAccountsController($scope,$element,$attrs,$http,ngDialog,$timeout,ajaxService,sharedProperties){$scope.finalAmount=0,$scope.promoApplied=!1,$scope.account={},$scope.product={},$scope.emp={},$scope.emp.empCount=0,$scope.updatedPromoDetails={},$scope.promoFormSubmitted=!1,$scope.promoError={},$scope.promoError.error=!1,$scope.promo={},$scope.newRenewalAmount=0,$scope.newMemberCount=0,$scope.currentMemberCount=0,$scope.dialogStatus={},$scope.timeout=0,$scope.ccEdit=!1,$scope.updateCC={},$scope.ccDetails={},$scope.zeroError=!1,$scope.submitDisabled=!1,$scope.getMemberCount=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/getActiveMemberCount"}).then(function(response){if("true"===response.Success)$scope.currentMemberCount=response.activeMembers;else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.clearCcDetails=function(){$scope.updateCC.submitted=!1,$scope.ccDetails.nameOnCard=null,$scope.ccDetails.cardNumber=null,$scope.ccDetails.month="default",$scope.ccDetails.year="default",$scope.ccDetails.cvv=null,$scope.ccDetails.country="default",$scope.ccDetails.zip=null},$scope.getAccountInfo=function(){var option="user"===$scope.accType?{url:"/sp/admin/account/businessAccountDetails"}:{url:"/sp/sysAdmin/alternateBilling/account/businessAccountDetails",data:$.param({accountId:sharedProperties.getParam("accountId")})};ajaxService.getAjaxResponse(option).then(function(response){if("true"===response.Success)$scope.account=response,$scope.planType=response.account.productInfo.validityType,$scope.currentMemberCount=parseInt(response.account.productInfo.numActive+response.account.productInfo.availalbeMemberSubscriptions),$scope.getProductInfo();else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.getProductInfo=function(){var option="user"===$scope.accType?{url:"/sp/admin/account/getCurrentBusinessProductInfo"}:{url:"/sp/sysAdmin/alternateBilling/account/getCurrentProductInfo",data:$.param({accountId:sharedProperties.getParam("accountId"),productType:$scope.mode})};ajaxService.getAjaxResponse(option).then(function(response){"true"===response.Success?($scope.productInfoError=!1,$scope.submitDisabled=!1,$scope.product=response.product,"undefined"!=typeof response.promotion&&"undefined"!=typeof response.promotion.unitPrice?($scope.product.updatedUnitPrice=parseFloat(response.promotion.unitPrice).toFixed(2),$scope.promoApplied=!0,$scope.updatedPromoDetails=response.promotion,$scope.finalAmount=$scope.priceUpdater($scope.product.updatedUnitPrice,$scope.emp.empCount,$scope.product.validityType),$scope.updatedPromoDetails=response.promotion):($scope.product.updatedUnitPrice=parseFloat(response.product.unitPrice).toFixed(2),$scope.promoApplied=!1,$scope.updatedPromoDetails=null,$scope.finalAmount=$scope.priceUpdater($scope.product.updatedUnitPrice,$scope.emp.empCount,$scope.product.validityType))):($scope.productInfoError=!0,$scope.submitDisabled=!0,jQuery("html, body").animate({scrollTop:0}))})},$scope.priceUpdater=function(uRate,count,vType){$scope.newMemberCount=0;var proRatedPrice=0,multiplier="YEARLY"===vType?12:1,unitPrice=parseFloat(uRate),memberCount=parseInt(count),remainingDays=$scope.account.account.remainingChargableDays+parseInt(1);return $scope.remainingDaysMonths=$scope.calcRemainingDaysMonths(remainingDays),proRatedPrice=parseFloat((remainingDays>1?remainingDays:1)*(unitPrice/30)*memberCount).toFixed(2),$scope.newMemberCount=parseInt($scope.currentMemberCount+memberCount),$scope.newRenewalAmount=parseFloat($scope.newMemberCount*unitPrice*multiplier),null!==$scope.account.account.paymentType&&"CREDIT_CARD"!==$scope.account.account.paymentType&&proRatedPrice>$scope.account.account.paymentInstrument.creditBalance?$scope.submitDisabled=!0:$scope.submitDisabled=!1,proRatedPrice},$scope.calcRemainingDaysMonths=function(d){var totalDays=d,remainingMonths=Math.floor(parseFloat(totalDays/30)),remainingDays=parseInt(totalDays%30),remainingInText="";return remainingInText=30>totalDays?"("+remainingDays+" days)":"("+remainingMonths+" months "+remainingDays+" days)"},$scope.paymentCalculator=function(empNo,action,type,event){$scope.zeroError=!1;var currentEmpNo=parseInt(empNo),updatedEmpNo=0;"undefined"==typeof event?currentEmpNo>=0&&"add"===action?(updatedEmpNo=parseInt(currentEmpNo+1),$scope.emp.empCount=updatedEmpNo,$scope.finalAmount=$scope.priceUpdater($scope.product.updatedUnitPrice,updatedEmpNo,type)):currentEmpNo>0&&"remove"===action?(updatedEmpNo=parseInt(currentEmpNo-1),$scope.emp.empCount=updatedEmpNo,$scope.finalAmount=$scope.priceUpdater($scope.product.updatedUnitPrice,updatedEmpNo,type)):($scope.emp.empCount=0,$scope.finalAmount=$scope.priceUpdater($scope.product.updatedUnitPrice,updatedEmpNo,type)):/^[0-9\b]+$/g.test(empNo)?($scope.emp.empCount=empNo,$scope.finalAmount=$scope.priceUpdater($scope.product.updatedUnitPrice,$scope.emp.empCount,type),$timeout.cancel($scope.timeout)):($timeout.cancel($scope.timeout),$scope.timeout=$timeout(function(){$scope.emp.empCount=0,$scope.finalAmount=$scope.priceUpdater($scope.product.updatedUnitPrice,$scope.emp.empCount,type)},1500))},$scope.updateCCdetails=function(ccData,emp){if($scope.submitDisabled===!1)if(emp>0)if($scope.ccEdit===!0){$scope.updateCC.submitted=!1;var vCount=0;for(var k in ccData)("default"===ccData[k]||"default1"===ccData[k])&&vCount++;$scope.updateCC.$valid&&0===vCount?$scope.addMemberAccountPI(emp,ccData):$scope.updateCC.submitted=!0}else $scope.addMemberAccount(emp);else $scope.zeroError=!0,jQuery("html, body").animate({scrollTop:0})},$scope.addMemberAccount=function(bno){var _params={};$scope.promoApplied===!1?(_params={numAccounts:"undefined"!=typeof bno?bno:1,productId:$scope.product.id},"user"===$scope.accType?_params:_params.accountId=$scope.account.account.id):(_params={numAccounts:"undefined"!=typeof bno?bno:1,productId:$scope.product.id,promotionId:$scope.updatedPromoDetails.id},"user"===$scope.accType?_params:_params.accountId=$scope.account.account.id),ajaxService.getAjaxResponse({url:"user"===$scope.accType?"/sp/admin/account/addMemberAccounts":"/sp/sysAdmin/alternateBilling/account/addMemberAccounts",data:$.param(_params)}).then(function(response){"true"===response.Success?($scope.dialogStatus.title="Add Member Account(s)",$scope.dialogStatus.content="Member(s) added successfully.",ngDialog.open({template:"/sp/resources/html/admin/account/success-dialog.html",scope:$scope})):($scope.serverError=!0,$scope.serverErrorMsg=response.error,jQuery("html, body").animate({scrollTop:0}))})},$scope.addMemberAccountPI=function(bno,cc){var _params={};_params=$scope.promoApplied===!1?$.extend({},{numAccounts:"undefined"!=typeof bno?bno:1,productId:$scope.product.id},cc):$.extend({},{numAccounts:"undefined"!=typeof bno?bno:1,productId:$scope.product.id,promotionId:$scope.updatedPromoDetails.id},cc),ajaxService.getAjaxResponse({url:"user"===$scope.accType?"/sp/admin/account/addMemberAccountsPI":"/sp/sysAdmin/alternateBilling/account/addMemberAccountsPI",data:$.param(_params)}).then(function(response){"true"===response.Success?($scope.dialogStatus.title="Add Member Account(s)",$scope.dialogStatus.content="Member(s) added successfully.",ngDialog.open({template:"/sp/resources/html/admin/account/success-dialog.html",scope:$scope})):($scope.serverError=!0,$scope.serverErrorMsg=response.error,jQuery("html, body").animate({scrollTop:0}))})},$scope.activatePromo=function(promoCode){if($scope.promoError.error=!1,$scope.promoDetails.$valid){$scope.promoError.error=!1;var _params={code:promoCode.toUpperCase(),productId:$scope.product.id};ajaxService.getAjaxResponse({url:"/sp/signup/promotion",data:$.param(_params)}).then(function(response){if("true"===response.Success)$scope.promoError.error=!1,$scope.updatedPromoDetails=response.promotion,$scope.product.updatedUnitPrice=parseFloat(response.promotion.unitPrice).toFixed(2),$scope.promoApplied=!0,$timeout(function(){$scope.finalAmount=$scope.priceUpdater($scope.product.updatedUnitPrice,$scope.emp.empCount,$scope.account.account.productInfo.validityType)},200);else{$scope.promoError.error=!0;for(var key in response.error)$scope.promoError.msg=response.error[key]}})}else $scope.promoFormSubmitted=!0},$scope.deactivatePromo=function(){$scope.product.updatedUnitPrice=parseFloat($scope.product.unitPrice).toFixed(2),$timeout(function(){$scope.finalAmount=$scope.priceUpdater($scope.product.updatedUnitPrice,$scope.emp.empCount,$scope.account.account.productInfo.validityType)},200),$scope.promoApplied=!1,$scope.promo.code=null},$scope.cancelRedirect=function(){window.location="user"===$scope.accType?"/sp/admin/account/business":"/sp/sysAdmin/alternateBilling/viewDetailAccount?accountId="+$scope.account.account.id},$scope.initAddMemberAccoutns=function(mode,type){$scope.mode=mode,$scope.accType=type,$scope.getAccountInfo()}}function addCreditControler($scope,$element,$attrs,$http,ngDialog,$timeout,ajaxService,sharedProperties,$localStorage){$scope.finalAmount=0,$scope.account={},$scope.currentMemberCount=0,$scope.zeroError=!1,$scope.submitDisabled=!1,$scope.submitted=!1,$scope.signup={},$scope.getAccountInfo=function(){ajaxService.getAjaxResponse({url:"BUSINESS"===$scope.mode?"/sp/sysAdmin/alternateBilling/account/businessAccountDetails":"/sp/sysAdmin/alternateBilling/account/individualAccountDetails",data:$.param({accountId:sharedProperties.getParam("accountId")})}).then(function(response){if("true"===response.Success)$scope.account=response,$scope.planType=response.account.productInfo.validityType,$scope.currentMemberCount=parseInt(response.account.productInfo.numActive+response.account.productInfo.availalbeMemberSubscriptions),$scope.signup.ccomment=$scope.account.account.paymentInstrument.comment,$scope.signup.cpt=$scope.account.account.paymentType,$scope.getProductInfo();else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.getProductInfo=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/alternateBilling/account/getCurrentProductInfo",data:$.param({accountId:$scope.account.account.id,productType:$scope.mode})}).then(function(response){"true"===response.Success&&($scope.product=response,$scope.promotionDiscount="undefined"!=typeof $scope.product.promotion?$scope.product.promotion.unitPrice*$scope.account.account.productInfo.availalbeMemberSubscriptions:0)})},$scope.cancelRedirect=function(mode){window.location="/sp/sysAdmin/alternateBilling/viewDetailAccount"+mode+"?accountId="+$scope.account.account.id},$scope.initAddMemberAccoutns=function(mode){$scope.mode=mode,$scope.getAccountInfo()},$scope.addCredit=function(form,redirect){$scope.submitted=!1,this.spSubscribe.$valid&&"0"!==this.amount?ajaxService.getAjaxResponse({url:"/sp/sysAdmin/alternateBilling/account/addCredit",data:$.param({accountId:$scope.account.account.id,chargeAmount:$scope.amount,paymentType:$scope.signup.cpt,comment:$scope.signup.ccomment})}).then(function(response){if("true"===response.Success)$localStorage.set("creditted",!0),window.location="undefined"==typeof redirect?"/sp/sysAdmin/alternateBilling/viewDetailAccount?accountId="+$scope.account.account.id:"/sp/sysAdmin/alternateBilling/viewDetailAccountIndividual?accountId="+$scope.account.account.id;else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}}):$scope.submitted=!0}}angular.module("spApp").controller("memberAccountsController",memberAccountsController),angular.module("spApp").controller("addCreditControler",addCreditControler),memberAccountsController.$inject=["$scope","$element","$attrs","$http","ngDialog","$timeout","ajaxService","sharedProperties"],addCreditControler.$inject=["$scope","$element","$attrs","$http","ngDialog","$timeout","ajaxService","sharedProperties","$localStorage"];
function notesAndFeedbackController($scope,ajaxService,$localStorage,ngDialog,sharedProperties,filterFilter,$filter,$rootScope){function editEnableToggle(){self.editEnable===!1?(self.noteContentForUpdate=self.notesAndFeedbackInfo.content,self.editEnable=!0):self.editEnable=!1}function toggleNotification(){self.winWidth>767?self.showNotification===!1?self.showNotification=!0:self.showNotification=!1:toggleNotificationResponsive()}function toggleNotificationResponsive(){self.winHeight=$(window).height()+100+"px";ngDialog.open({template:"/sp/resources/html/goals/notesAndFeedback/notificationResponsive.html",className:"ngdialog-lnd-theme",scope:$scope})}function toggleFeedbackOverlay(index){self.winWidth>767?(self.showNotification=!1,self.showFeedbackOverlay===!1?(self.showFeedbackOverlay=!0,self.requestNotificationInfo=self.requestNotificationList[index]):(self.requestNotificationInfo.feedbackResponse="",self.showFeedbackOverlay=!1,self.requestFormSubmitted=!1)):(self.requestNotificationInfo=self.requestNotificationList[index],feedbackOverlayResponsive())}function feedbackOverlayResponsive(){self.winHeight=$(window).height()+100+"px";ngDialog.open({template:"/sp/resources/html/goals/notesAndFeedback/feedbackOverlayResponsive.html",className:"ngdialog-lnd-theme",scope:$scope})}function displayDetailedInfo(index){self.editEnable=!1,self.selectedIndex=index,self.notesAndFeedbackInfo=self.notesAndFeedbackList[index],$("html,body").animate({scrollTop:$(".top-content").offset().top},500),self.winWidth<767&&displayDetailedResponsive()}function displayDetailedResponsive(){self.winHeight=$(window).height()+100+"px";ngDialog.open({template:"/sp/resources/html/goals/notesAndFeedback/notesFeedbackResponsive.html",className:"ngdialog-lnd-theme",scope:$scope})}function sendFeedbackRequest(options){self.requestFormSubmitted=!1,self.sendFeedbackForm.$valid?ajaxService.getAjaxResponse({url:self.serviceApis.sendFeedbackRequest,data:$.param({feedbackId:options.feedbackId,feedbackResponse:options.feedbackResponse})}).then(function(response){if("true"===response.Success)ngDialog.closeAll(),sharedProperties.spilceIndexWithBreak(self.requestNotificationList,"id",options.feedbackId),self.showFeedbackOverlay=!1,$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("notesAndFeedback.ajaxSuccessMessage.sentFeedback")}),0===self.requestNotificationList.length&&(self.requestNotificationList=[]);else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}}):self.requestFormSubmitted=!0}function updateNote(options){self.updateFormSubmitted=!1,self.updateNoteForm.$valid?ajaxService.getAjaxResponse({url:self.serviceApis.updateNote,data:$.param({noteId:options.noteId,desc:options.desc})}).then(function(response){if("true"===response.Success)self.editEnable=!1,$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("notesAndFeedback.ajaxSuccessMessage.notesUpdated")}),getAllNotesAndFeedbackForUserForUpdate(options.noteId);else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}}):self.updateFormSubmitted=!0}function filterResults(val){"note"===val&&(self.types.note===!1?self.types.note=!0:self.types.note=!1),"feedback"===val&&(self.types.feedback===!1?self.types.feedback=!0:self.types.feedback=!1),"pending"===val&&(self.types.pending===!1?self.types.pending=!0:self.types.pending=!1),"declined"===val&&(self.types.declined===!1?self.types.declined=!0:self.types.declined=!1),""!==self.types.search?self.showClearSearchIcon=!0:self.showClearSearchIcon=!1;var resp=$filter("notesAndFeedbackFilter")(self.masterList,self.types,filterFilter);resp=$filter("orderBy")(resp,self.predicate),self.notesAndFeedbackInfo={},self.notesAndFeedbackList=[],self.notesAndFeedbackList=resp,self.editEnable=!1,self.notesAndFeedbackInfo=resp[0],self.selectedIndex=0}function sortResults(){"name"===self.sortVal?self.predicate="practiceAreaDTO.name":self.predicate="";var resp=$filter("orderBy")(self.masterList,self.predicate);resp=$filter("notesAndFeedbackFilter")(resp,self.types,filterFilter),self.notesAndFeedbackList=[],self.notesAndFeedbackList=resp,self.notesAndFeedbackInfo={},self.editEnable=!1,self.notesAndFeedbackInfo=resp[0],self.selectedIndex=0}function clearSearch(){""!==self.types.search&&(self.showClearSearchIcon=!1,self.types.search=""),self.filterResults("search")}function reset(){self.sortVal="date",self.types={note:!1,feedback:!1,pending:!1,declined:!1,search:"",goalCategory:"all"},self.showClearSearchIcon=!1,self.notesAndFeedbackList=[],self.notesAndFeedbackList=angular.copy(self.masterList),self.notesAndFeedbackInfo=self.notesAndFeedbackList[0],sortResults()}function openDeleteModal(deleteId,type){$scope.type=type,$scope.deleteId=deleteId,ngDialog.open({template:"/sp/resources/html/goals/notesAndFeedback/deleteModal.html",scope:$scope})}var self=this;self.serviceApis={updateNote:"/sp/goals/note/update",deleteNote:"/sp/goals/note/delete",deleteFeedbackRequest:"/sp/goals/feedback/delete",getAllFeedbackRequestNotifications:"/sp/goals/feedback/received",sendFeedbackRequest:"/sp/goals/feedback/external/response",declineFeedbackStatus:"/sp/goals/feedback/updateStatus",getAllNotesAndFeedbackForUser:"/sp/goals/notesfeedback/all"},self.masterList=[],self.notesAndFeedbackList=[],self.requestNotificationList=[],self.requestNotificationInfo={},self.notesAndFeedbackInfo={},self.editEnable=!1,self.showNotification=!1,self.showFeedbackOverlay=!1,self.selectedIndex=0,self.notificationIndex=0,self.noteContentForUpdate="",self.showClearSearchIcon=!1,self.types={note:!1,feedback:!1,pending:!1,declined:!1,search:"",goalCategory:"all"},self.updateFormSubmitted=!1,self.requestFormSubmitted=!1,self.sortVal="date",self.predicate="",self.responseAvailable=!1,self.updateNote=updateNote,self.sendFeedbackRequest=sendFeedbackRequest,self.openDeleteModal=openDeleteModal,self.displayDetailedInfo=displayDetailedInfo,self.editEnableToggle=editEnableToggle,self.toggleNotification=toggleNotification,self.toggleFeedbackOverlay=toggleFeedbackOverlay,self.clearSearch=clearSearch,self.filterResults=filterResults,self.sortResults=sortResults,self.getParameter=getParameter,self.findById=findById,self.reset=reset,self.winWidth=$(window).width(),self.winHeight=$(window).height()+100+"px",self.showMobileFilter=self.winWidth<768?!1:!0;var getParameter=function(val){for(var query=window.location.search.substring(1),vars=query.split("&"),pair=[],i=0;i<vars.length;i++)return pair=vars[i].split("="),pair[0]===val?pair[1]:null},findById=function(source,id){var itemFound=!1;if("notesfeedback"===source)for(var i=0;i<self.notesAndFeedbackList.length&&(self.notesAndFeedbackList[i].id===id&&(itemFound=!0,self.notesAndFeedbackInfo=self.notesAndFeedbackList[i],self.selectedIndex=i),!itemFound);i++);else if("notifications"===source)for(var j=0;j<self.requestNotificationList.length&&(self.requestNotificationList[j].id===id&&(itemFound=!0,self.showFeedbackOverlay=!0,self.requestNotificationInfo=self.requestNotificationList[j]),!itemFound);j++);},getAllNotesAndFeedbackForUserForUpdate=function(id){ajaxService.getAjaxResponse({url:self.serviceApis.getAllNotesAndFeedbackForUser,method:"get"}).then(function(response){if("true"===response.Success)response.notesAndFeedbackList.length>0&&(self.masterList=response.notesAndFeedbackList,sortResults(),findById("notesfeedback",id));else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})},getAllNotesAndFeedbackForUser=function(index){ajaxService.getAjaxResponse({url:self.serviceApis.getAllNotesAndFeedbackForUser,method:"get"}).then(function(response){if("true"===response.Success){if(self.responseAvailable=!0,self.masterList=[],self.notesAndFeedbackList=[],response.notesAndFeedbackList.length>0){self.masterList=response.notesAndFeedbackList,self.notesAndFeedbackList=angular.copy(self.masterList),sortResults();var param=getParameter("id");null!==param?findById("notesfeedback",param):(self.notesAndFeedbackInfo=self.notesAndFeedbackList[index],self.selectedIndex=index)}}else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})};$scope.deleteInformation=function(deleteId,type){"NOTE"===type?deleteNote.call(this,deleteId):"FEEDBACK"===type?deleteRequestFeedback.call(this,deleteId):"DECLINE"===type&&declineFeedbackRequest.call(this,deleteId)};var deleteNote=function(id){var _this=this;ajaxService.getAjaxResponse({url:self.serviceApis.deleteNote,data:$.param({noteId:id})}).then(function(response){if("true"===response.Success){if(sharedProperties.spilceIndexWithBreak(self.masterList,"id",id),self.masterList.length>0){var resp=angular.copy(self.masterList);resp=$filter("orderBy")(resp,self.predicate),resp=$filter("notesAndFeedbackFilter")(resp,self.types,filterFilter),self.notesAndFeedbackList=resp,self.notesAndFeedbackInfo=self.notesAndFeedbackList[0],self.selectedIndex=0}else self.notesAndFeedbackList=[],self.notesAndFeedbackInfo={},self.types={note:!1,feedback:!1,pending:!1,declined:!1,search:"",goalCategory:"all"};_this.closeThisDialog(),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("notesAndFeedback.ajaxSuccessMessage.recordDeleted")})}else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})},declineFeedbackRequest=function(id){var _this=this;ajaxService.getAjaxResponse({url:self.serviceApis.declineFeedbackStatus,data:$.param({feedbackId:id,feedbackStatus:"DECLINED"})}).then(function(response){if("true"===response.Success)sharedProperties.spilceIndexWithBreak(self.requestNotificationList,"id",id),self.showNotification=!1,_this.closeThisDialog(),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("notesAndFeedback.ajaxSuccessMessage.requestDeclined")}),0===self.requestNotificationList.length&&(self.requestNotificationList=[]);else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})},deleteRequestFeedback=function(id){var _this=this;ajaxService.getAjaxResponse({url:self.serviceApis.deleteFeedbackRequest,data:$.param({feedbackId:id})}).then(function(response){if("true"===response.Success){if(sharedProperties.spilceIndexWithBreak(self.masterList,"id",id),self.masterList.length>0){var resp=angular.copy(self.masterList);resp=$filter("orderBy")(resp,self.predicate),resp=$filter("notesAndFeedbackFilter")(resp,self.types,filterFilter),self.notesAndFeedbackList=resp,self.notesAndFeedbackInfo=self.notesAndFeedbackList[0],self.selectedIndex=0}else self.notesAndFeedbackList=[],self.notesAndFeedbackInfo={},self.types={note:!1,feedback:!1,pending:!1,declined:!1,search:"",goalCategory:"all"};_this.closeThisDialog(),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("notesAndFeedback.ajaxSuccessMessage.recordDeleted")})}else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})},getAllFeedbackRequestNotifications=function(){ajaxService.getAjaxResponse({url:self.serviceApis.getAllFeedbackRequestNotifications,method:"get"}).then(function(response){if(self.requestNotificationList=[],"true"===response.Success){self.requestNotificationList=response.feedbackRequestList;var param=getParameter("feedbackId");null!==param&&findById("notifications",param)}else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})};!function(){getAllNotesAndFeedbackForUser(0),getAllFeedbackRequestNotifications()}()}angular.module("spApp").controller("notesAndFeedbackController",notesAndFeedbackController),angular.module("spApp").filter("notesAndFeedbackFilter",function(){function filterData(item,types,filtered){types.note===!1&&types.feedback===!1&&types.pending===!1&&types.declined===!1?filtered.push(item):types.note===!0&&"NOTE"===item.type?filtered.push(item):types.feedback===!0&&"FEEDBACK"===item.type&&"COMPLETED"===item.feedbackStatus?filtered.push(item):types.pending===!0&&"FEEDBACK"===item.type&&"NOT_INITIATED"===item.feedbackStatus?filtered.push(item):types.declined===!0&&"FEEDBACK"===item.type&&"DECLINED"===item.feedbackStatus&&filtered.push(item)}return function(items,types,filterFilter){var filtered=[];return angular.forEach(items,function(item){"all"===types.goalCategory?filterData(item,types,filtered):"org"===types.goalCategory&&null!==item.practiceAreaDTO&&"ActionPlan"===item.practiceAreaDTO.category?filterData(item,types,filtered):"ind"===types.goalCategory&&null!==item.practiceAreaDTO&&"GrowthAreas"===item.practiceAreaDTO.category&&filterData(item,types,filtered),""!==types.search&&(filtered=filterFilter(filtered,types.search))}),filtered}}),notesAndFeedbackController.$inject=["$scope","ajaxService","$localStorage","ngDialog","sharedProperties","filterFilter","$filter","$rootScope"];
function orgAdminListingController($scope,ajaxService,ngDialog,$localStorage,sharedProperties,$filter){function getCompanyList(){ajaxService.getAjaxResponse({url:vm.config.getCompanyList}).then(function(response){if("true"===response.Success)vm.masterCompanyList=response.actionPlan,vm.companyList=response.actionPlan,vm.companiesAjax=!0,vm.returnMemberList();else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function selectCompany(){vm.companies.length?openCompanyModal():getCompanies()}function getCompanies(){ajaxService.getAjaxResponse({url:vm.config.fetchCompanies,method:"get"}).then(function(response){if("true"===response.Success)vm.companies=response.companies,openCompanyModal();else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function openCompanyModal(){var dialog=ngDialog.open({template:vm.config.companiesDialog,scope:$scope});dialog.closePromise.then(function(data){vm.pageSetting.companyText=""})}function returnMemberList(pageSize){return vm.masterCompanyList.length?void vm.order(vm.pageSetting.lastPredicate,vm.pageSetting.lastReverse):!0}function order(predicate,reverse){vm.pageSetting.lastPredicate=predicate,vm.pageSetting.lastReverse=reverse,vm.companyList=$filter("orderBy")(vm.companyList,predicate,reverse)}function searchTextFilter(search){vm.pageSetting.textSearching=search,vm.returnMemberList()}function active(event,setting){vm.pageSetting.lastPredicate=setting.predicate,vm.pageSetting.lastReverse=setting.reverse,sharedProperties.toggleFilterClick(event,vm.pageSetting.lastPredicate),vm.order(vm.pageSetting.lastPredicate,vm.pageSetting.lastReverse)}function resetfilter(){vm.pageSetting=angular.copy(vm.originalPageSetting),vm.returnMemberList();var curr=$(".memberHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")}function createOrgPlan(obj){$localStorage.set("companyId",obj),window.location.href="/sp/sysAdmin/createOrgPlan"}function updateOrgPlan(obj){$localStorage.set("companyId",obj),window.location.href="/sp/sysAdmin/updateOrgPlan"}var vm=this;vm.masterCompanyList=[],vm.companyList=[],vm.companiesAjax=!1,vm.companies=[],vm.config={getCompanyList:"/sp/sysAdmin/actionPlan/getAll",fetchCompanies:"/sp/sysAdmin/hk/getCompanyList",companiesDialog:"/sp/sysAdmin/selectCompany"},vm.pageSetting={searchText:"",disabledInfinite:!1,lastPredicate:"name",lastReverse:!1,companyText:""},vm.originalPageSetting=angular.copy(vm.pageSetting),vm.getCompanyList=getCompanyList,vm.searchTextFilter=searchTextFilter,vm.returnMemberList=returnMemberList,vm.active=active,vm.order=order,vm.selectCompany=selectCompany,vm.createOrgPlan=createOrgPlan,vm.updateOrgPlan=updateOrgPlan,vm.resetfilter=resetfilter,function(){vm.getCompanyList(),null!==$localStorage.get("planStatus")&&($.growl({icon:"glyphicon glyphicon-ok",message:$localStorage.get("planStatus")}),$localStorage.remove("planStatus"))}()}function orgAdminCreatePlanController($scope,ajaxService,$localStorage,ngDialog,spJsonFetchAdmin,$rootScope,$timeout,sharedProperties){function initialize(){if(!vm.initializeBool){new Sortable(document.getElementById("sort-me"),{animation:150,ghostClass:"ghost",handle:".dHandle",yAxisOnly:!0,onEnd:function(evt){vm.copYactionPlan.move(evt.oldIndex,evt.newIndex)}});vm.initializeBool=!0}}function childInit(id){idi[id]=new Sortable(document.getElementById("child_"+id),{animation:150,ghostClass:"ghost",handle:".dHandle",yAxisOnly:!0,onEnd:function(evt){vm.endindex=$(evt.item).index();var id=$(this.el).attr("id").split("_")[1];vm.copYactionPlan[id].actionList.move(vm.startIndex,vm.endindex)},onStart:function(evt){vm.startIndex=$(evt.item).index()}})}function startPoint(param){null===$localStorage.get("companyId")?redirectToListing():vm.company=$localStorage.get("companyId"),"update"===param?(vm.mode=param,getDetail()):(vm.mode=param,vm.actionPlan=spJsonFetchAdmin.spOrgJson(),vm.copYactionPlan=vm.actionPlan.practiceAreaList[vm.currentActionPlan].devStrategyActionCategoryList)}function getDetail(){ajaxService.getAjaxResponse({url:vm.config.getDetail,data:$.param({actionPlanId:vm.company.actionPlan})}).then(function(response){if("true"===response.Success)vm.actionPlan=response.actionPlan,vm.copYactionPlan=vm.actionPlan.practiceAreaList[vm.currentActionPlan].devStrategyActionCategoryList,vm.actionPlan.practiceAreaList[vm.currentActionPlan].keyOutcomes.outcomesList.length?vm.singleBox=angular.copy(vm.actionPlan.practiceAreaList[vm.currentActionPlan].keyOutcomes.outcomesList):vm.singleBox=[0],null!==vm.actionPlan.groupList&&prepareGroupList();else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function prepareGroupList(){vm.actionPlan.groupIdList=[];for(var i=0;i<vm.actionPlan.groupList.length;i++)vm.actionPlan.groupIdList.push(vm.actionPlan.groupList[i].id);vm.pageSetting.groupNameHolder=vm.actionPlan.groupList,groupCall()}function prepareGroupPermissions(){if(!vm.actionPlan.forAllUsers){vm.actionPlan.groupPermissionsList=[];for(var i=0;i<vm.pageSetting.groupNameHolder.length;i++)vm.groupPermissions={},vm.groupPermissions.groupId=vm.pageSetting.groupNameHolder[i].id,vm.groupPermissions.excludeGroupLead=vm.pageSetting.groupNameHolder[i].excludeGroupLead,vm.actionPlan.groupPermissionsList.push(vm.groupPermissions)}}function fetchGroup(){!vm.groupList.length&&groupCall()}function converTime(list,hour,min){list.timeInMins=parseInt(void 0===hour?0:60*hour,10)+parseInt(void 0===min?0:min,10)}function clonePlan(){vm.clonecompanies.length?openCompanyModal():getCompanies()}function getCompanies(){ajaxService.getAjaxResponse({url:vm.config.fetchCompanies,method:"get"}).then(function(response){if("true"===response.Success){vm.clonecompanies=[],openCompanyModal(),vm.companiesAjax=!0;var clonedCompany={};response.companies.filter(function(obj){obj.id===vm.company.id?clonedCompany=obj:vm.clonecompanies.push(obj)});vm.clonecompanies.sort(function(a,b){var nameA=a.name.toLowerCase(),nameB=b.name.toLowerCase();return nameB>nameA?-1:nameA>nameB?1:0}),vm.clonecompanies.unshift(clonedCompany)}else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function openCompanyModal(){vm.clonePlanName=vm.actionPlan.name;var dialog=ngDialog.open({template:vm.config.closePlan,scope:$scope});dialog.closePromise.then(function(data){vm.pageSetting.companyText=""})}function groupCall(){void 0===vm.pageSetting.groupNameHolder&&(vm.pageSetting.groupNameHolder=[]),ajaxService.getAjaxResponse({url:vm.config.fetchGroup,data:$.param({companyId:vm.company.id})}).then(function(response){if("true"===response.Success){if(vm.companies=response.groupList,vm.companiesAjax=!0,vm.pageSetting.groupNameHolder.length)for(var i=vm.companies.length-1;i>=0;i--)-1!==vm.actionPlan.groupIdList.indexOf(vm.companies[i].id)&&vm.companies.splice(i,1)}else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function openCloseSiblingContent(event,mode){var $this=$(event.target);if($this.hasClass("filterCheckBox-label"))return!0;var toggleClass=void 0===mode?"show":"noshow",$html=$this.closest(".category"),$upTarget=$html.find(".header-style-content:eq(0)"),$upTargetHeight=$upTarget.outerHeight();$html.find(".border-faq-content:eq(0)").outerHeight();$upTargetHeight>1?$upTarget.css("height",0):$upTarget.css("height","auto"),$html.toggleClass(toggleClass)}function addInputBox(param){for(var i=0;param>i;i++)vm.singleBox.push(vm.singleBox.length)}function removeInputBox(index){vm.singleBox.splice(index,1),vm.actionPlan.practiceAreaList[vm.currentActionPlan].keyOutcomes.outcomesList.splice(index,1)}function addLink(actionData,parent){var bool=void 0===parent?!1:!parent.permissions.Completion;actionData.push({type:null,linkText:null,url:null,imageLink:null,altText:null,permissions:{Completion:bool}})}function singleAction(actionList){actionList.push({title:null,description:null,timeInMins:0,type:"Single",active:!0,actionData:[{type:null,linkText:null,url:null,imageLink:null,altText:null}],permissions:{Completion:!0}})}function groupAction(actionList){actionList.push({title:null,description:null,timeInMins:0,type:"Group",active:!0,actionData:[{title:null,description:null,type:null,linkText:null,url:null,imageLink:null,altText:null,permissions:{Completion:!0}}],permissions:{}})}function deleteActionList(list,index){list.splice(index,1)}function addCategory(param){vm.actionPlan.practiceAreaList[vm.currentActionPlan].devStrategyActionCategoryList.push({title:null,helpText:null,status:"INACTIVE",actionList:[]})}function changeActionPlan(index){vm.actionPlanForm.submitted=!1,vm.actionPlanForm.$valid?(vm.currentActionPlan=index,vm.actionPlan.practiceAreaList[vm.currentActionPlan].keyOutcomes.outcomesList=vm.actionPlan.practiceAreaList[vm.currentActionPlan].keyOutcomes.outcomesList.filter(function(e){return""!==e}),vm.actionPlan.practiceAreaList[vm.currentActionPlan].keyOutcomes.outcomesList.length?vm.singleBox=angular.copy(vm.actionPlan.practiceAreaList[vm.currentActionPlan].keyOutcomes.outcomesList):vm.singleBox=[0]):errorHighlighter()}function startCloning(companyDetail){null!==vm.clonePlanName&&(vm.actionPlan.name=vm.clonePlanName),vm.actionPlan.id=null,vm.actionPlan.groupList=null,vm.actionPlan.active=!1,vm.actionPlan.forAllUsers=!0,vm.company.id=companyDetail.id,vm.company.name=companyDetail.name,vm.pageSetting.groupNameHolder=[],vm.mode="create",vm.actionPlan.practiceAreaList.filter(function(e){e.id=null,e.devStrategyActionCategoryList.filter(function(e1){e1.uid=null,e1.actionList.filter(function(e2){e2.uid=null,e2.actionData.filter(function(e3){e3.uid=null})})})})}function createNewSection(index){vm.actionPlanForm.submitted=!1,vm.actionPlanForm.$valid?(vm.actionPlan.practiceAreaList.push({name:null,description:null,status:"INACTIVE",introVideo:{status:"INACTIVE"},keyOutcomes:{active:!1,outcomesList:[]},devStrategyActionCategoryList:[{title:"Tasks & Exercises",helpText:"Tasks & Exercises",status:"INACTIVE",actionList:[]},{title:"Videos & Resources",helpText:"Videos & Resources",status:"INACTIVE",actionList:[]},{title:"Formal Meetings",helpText:null,status:"INACTIVE",actionList:[]}]}),vm.currentActionPlan=index,vm.singleBox=[0]):errorHighlighter()}function errorHighlighter(){var $category=$(".category");$category.each(function(){$(this).find(".ng-invalid-required").length?$(this).addClass("error-category"):$(this).removeClass("error-category")}),($("body").find(".ng-invalid-required").length||!vm.actionPlanForm.$valid)&&(vm.actionPlanForm.submitted=!0),"ACTIVE"===vm.actionPlan.practiceAreaList[vm.currentActionPlan].status&&!vm.result.length&&(vm.errorCat=!0)}function redirectToListing(){window.location.href="/sp/sysAdmin/adminActionPlan"}function trueCheck(){return vm.result=[],vm.emptyCheck=[],"ACTIVE"!==vm.actionPlan.practiceAreaList[vm.currentActionPlan].status?!0:(vm.actionPlan.practiceAreaList[vm.currentActionPlan].devStrategyActionCategoryList.filter(function(e,i){"ACTIVE"===e.status&&e.actionList.length&&vm.emptyCheck.push(e),"ACTIVE"===e.status&&vm.result.push(e)}),vm.result.length)}function submitObject(){return vm.disabled?!0:(vm.actionPlanForm.submitted=!1,vm.errorCat=!1,vm.disabled=!0,void 0!==vm.actionPlan.groupList&&delete vm.actionPlan.groupList,void 0!==vm.actionPlan.groupIdList&&delete vm.actionPlan.groupIdList,void(trueCheck()&&vm.actionPlanForm.$valid?(vm.actionPlan.practiceAreaList[vm.currentActionPlan].keyOutcomes.outcomesList=vm.actionPlan.practiceAreaList[vm.currentActionPlan].keyOutcomes.outcomesList.filter(function(e){return""!==e}),vm.prepareGroupPermissions(),vm.actionPlan.companyId=vm.company.id,ajaxService.getAjaxResponse({url:"update"===vm.mode?vm.config.editGroup:vm.config.create,data:vm.actionPlan,headers:{"Content-Type":"application/json"}}).then(function(response){if("true"===response.Success){var message="update"===vm.mode?$rootScope.pullInterNationalization("sysAdmin.organization.planUpdated"):$rootScope.pullInterNationalization("sysAdmin.organization.planCreated");$localStorage.set("planStatus",message),"update"!==vm.mode?($localStorage.set("companyId",{id:vm.company.id,name:vm.company.name,actionPlan:response.actionPlanId}),window.location.href="/sp/sysAdmin/updateOrgPlan"):getDetail(),planStatus(),vm.disabled=!1}else if(null!==response.error){errorHighlighter(),vm.disabled=!1;var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})):(vm.disabled=!1,errorHighlighter())))}function addGroup(){var dialog=ngDialog.open({template:vm.config.groupDialog,scope:$scope});dialog.closePromise.then(function(data){vm.pageSetting.groupText=""})}function addedGroup(list){void 0===vm.actionPlan.groupIdList&&(vm.actionPlan.groupIdList=[]),vm.actionPlan.groupIdList.push(list.id),vm.pageSetting.groupNameHolder.push(list);for(var i=0;i<vm.companies.length;i++)if(list.id===vm.companies[i].id){vm.companies.splice(i,1);break}}function removeGroup(list,index){vm.actionPlan.groupIdList.splice(index,1),vm.pageSetting.groupNameHolder.splice(index,1),vm.companies.splice(index,0,list)}function requiredCompletion(list,actionList){if("Group"===actionList.type){if("ACTIVE"===list.status&&actionList.active){var result=actionList.actionData.filter(function(e){return e.permissions.Completion});return result.length?!1:!0}return!1}return!1}function changeCompletion(list,actionList){"Group"===actionList.type&&"ACTIVE"===list.status&&actionList.active&&actionList.actionData.filter(function(e){e.permissions.Completion=!1})}function timeAdjust(convert,type){return convert?"h"===type?Math.floor(convert/60):convert%60:""}function previewVideo(mode,url){if("Video"===mode)videoPopUp(url);else{var win=window.open(url,"_blank");win.focus()}}function previewIntroVideo(url){videoPopUp(url)}function videoPopUp(url,openId){$scope.videoUrl=url;var dialog=ngDialog.open({template:vm.config.videoPopUpDialog,scope:$scope});dialog.closePromise.then(function(data){console.log("close")}),$rootScope.$on("ngDialog.opened",function(e,$dialog){"html5"===$scope.videoType&&$("#mp4_src").attr("src",$scope.videoSrc)})}function planStatus(){null!==$localStorage.get("planStatus")&&($.growl({icon:"glyphicon glyphicon-ok",message:$localStorage.get("planStatus")}),$localStorage.remove("planStatus"))}var vm=this,idi=[];vm.config={fetchGroup:"/sp/sysAdmin/group/getGroupList",create:"/sp/admin/actionPlan/create",groupDialog:"/sp/sysAdmin/selectGroup",editGroup:"/sp/admin/actionPlan/update",getDetail:"/sp/sysAdmin/actionPlan/getDetails",videoPopUpDialog:"/sp/sysAdmin/videoPop",closePlan:"/sp/sysAdmin/clonePlan",fetchCompanies:"/sp/sysAdmin/hk/getCompanyList"},vm.pageSetting={groupText:"",groupNameHolder:[]},vm.currentActionPlan=0,vm.companiesAjax=!1,vm.singleBox=[0],vm.linkType=[{name:"VIDEO IN DIALOG",value:"Video"},{name:"VIDEO IN NEW TAB",value:"VideoTab"},{name:"PPT",value:"PPT"},{name:"PDF",value:"PDF"},{name:"WEB",value:"Web"},{name:"Schedule a meeting",value:"Schedule"}],vm.groupList=[],vm.result=[],vm.emptyCheck=[],vm.clonecompanies=[],vm.pageSetting={disabledInfinite:!1,lastPredicate:"name",lastReverse:!1,companyText:""},vm.clonePlanName=null,vm.actionPlanForm={submitted:!1},vm.originalPageSetting=angular.copy(vm.pageSetting),vm.initializeBool=!1,vm.disabled=!1,vm.pool=[],vm.groupPermissions={},vm.openCloseSiblingContent=openCloseSiblingContent,vm.addInputBox=addInputBox,vm.removeInputBox=removeInputBox,vm.addCategory=addCategory,vm.addLink=addLink,vm.singleAction=singleAction,vm.groupAction=groupAction,vm.deleteActionList=deleteActionList,vm.changeActionPlan=changeActionPlan,vm.createNewSection=createNewSection,vm.fetchGroup=fetchGroup,vm.redirectToListing=redirectToListing,vm.submitObject=submitObject,vm.addGroup=addGroup,vm.addedGroup=addedGroup,vm.removeGroup=removeGroup,vm.trueCheck=trueCheck,vm.converTime=converTime,vm.startPoint=startPoint,vm.requiredCompletion=requiredCompletion,vm.changeCompletion=changeCompletion,vm.timeAdjust=timeAdjust,vm.initialize=initialize,vm.childInit=childInit,vm.previewVideo=previewVideo,vm.previewIntroVideo=previewIntroVideo,vm.clonePlan=clonePlan,vm.startCloning=startCloning,vm.prepareGroupPermissions=prepareGroupPermissions,$scope.videoCall=function(){if($scope.videoSrc=$scope.videoUrl,$scope.videoType="",/youtube/g.test($scope.videoSrc))$scope.videoType="youtube";else if(/vimeo/g.test($scope.videoSrc)){$scope.videoType="vimeo";var link=$scope.videoSrc.split("?")[0].split("/");$scope.videoSrc="https://vimeo.com/"+link[parseInt(link.length-1)]}else $scope.videoType="html5";"html5"!==$scope.videoType&&setTimeout(function(){videojs(document.getElementById("vid1"),{autoplay:!1,techOrder:[$scope.videoType],src:$scope.videoSrc},function(){$scope.videoReady=!0,this.on("ended",function(){var vid=this;vid.trigger("loadstart"),$timeout(function(){vid.posterImage.show()},500)}),this.on("timeupdate",function(){var ct=this.currentTime(),timeLeft=this.remainingTime();ct>0&&this.bigPlayButton.hide(),0===timeLeft&&this.bigPlayButton.show()})})},500)},vm.sourceSelect=function(actionData){sharedProperties.openMediaModal();var destroyRoot=$scope.$on("mediaData",function(e,data){return destroyRoot(),null===data?!0:(actionData.imageLink=data.url,actionData.altText=data.altText,void(actionData.linkText=data.name))})},vm.selectThumbImage=function(videoObj){sharedProperties.openMediaModal();var destroyRoot=$scope.$on("mediaData",function(e,data){return destroyRoot(),null===data?!0:void(videoObj.thumbnailURL=data.url)})}}function spJsonFetchAdmin(){function spOrgJson(){return{companyId:null,active:!1,forAllUsers:!0,name:null,groupIdList:[],groupPermissionsList:[],practiceAreaList:[{name:null,description:null,status:"INACTIVE",introVideo:{status:"INACTIVE"},keyOutcomes:{active:!1,outcomesList:[]},devStrategyActionCategoryList:[{title:"Tasks & Exercises",helpText:"Tasks & Exercises",status:"INACTIVE",actionList:[]},{title:"Videos & Resources",helpText:"Videos & Resources",status:"INACTIVE",actionList:[]},{title:"Formal Meetings",helpText:null,status:"INACTIVE",actionList:[]}]}]}}return{spOrgJson:spOrgJson}}angular.module("spApp").controller("orgAdminListingController",orgAdminListingController),angular.module("spApp").controller("orgAdminCreatePlanController",orgAdminCreatePlanController),angular.module("spApp").service("spJsonFetchAdmin",spJsonFetchAdmin),orgAdminListingController.$inject=["$scope","ajaxService","ngDialog","$localStorage","sharedProperties","$filter"],orgAdminCreatePlanController.$inject=["$scope","ajaxService","$localStorage","ngDialog","spJsonFetchAdmin","$rootScope","$timeout","sharedProperties"];
function organizationAreasController($scope,ajaxService,sharedProperties,$state,$filter,ngDialog,$q,$localStorage,$rootScope,$timeout){function showMobileHomePage(){vm.showRightCol=!1,vm.showMobileDD=!1}function openNgOverlay(page,data){"notification"===page&&(vm.openTabId=-1,vm.getNotesFeedbackForGoal({goalId:vm.currentActive.goalId})),"feedback"===page&&(!vm.emailMemberList.length&&vm.getMemberList(),vm.requestFeedbackArea="",vm.inputRequired=!1,vm.searchTag=[]),"manageStratagies"===page&&vm.manageDevelopmentStartegies(),"undefined"!=typeof data&&(vm.devStrategy={id:data.devStrategyId,desc:data.desc}),vm.winHeight=$(window).height()+100+"px";ngDialog.open({template:vm.pageTempaltes[page],className:"ngdialog-lnd-theme",scope:$scope})}function toggleToolTipMobile(i){vm.winWidth<768&&vm.activeToolTipId!==i?vm.activeToolTipId=i:vm.activeToolTipId=-1}function converTime(totalMin,hour,min){return{min:totalMin%60,hour:Math.floor(totalMin/60)}}function getSelectedActionPlanList(){ajaxService.getAjaxResponse({url:vm.config.selectedActionPlanList,method:"get"}).then(function(response){if("true"===response.Success)if(void 0===response.actionPlan)vm.actionPlanList=response.actionPlanList,vm.state(4);else{vm.actionPlan=response.actionPlan,!vm.actionPlanList.length&&vm.getActionPlans();for(var index=null,i=0;i<response.actionPlan.practiceAreaList.length;i++)if("ACTIVE"===response.actionPlan.practiceAreaList[i].status){index=i;break}if(null===index)return vm.actionPlanSectionDetail=null,vm.currentActive.name=null,vm.currentActive.index=null,vm.state(),!0;vm.getActionPlansSectionDetail({name:vm.actionPlan.practiceAreaList[index].name,index:index,goalId:vm.actionPlan.practiceAreaList[index].id,showRight:!0})}else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function getActionPlans(){ajaxService.getAjaxResponse({url:vm.config.allActionPlans,method:"get"}).then(function(response){if("true"===response.Success)vm.actionPlanList=response.actionPlanList;else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function selectActionPlans(actionPlanId){ajaxService.getAjaxResponse({url:vm.config.selectActionPlan+actionPlanId,method:"get"}).then(function(response){if("true"===response.Success)vm.displayPlanList=!1,vm.getSelectedActionPlanList();else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function getActionPlansSectionDetail(options){return"INACTIVE"===options.status?!0:(vm.currentActive=options,vm.ddSelectedText=vm.currentActive.name,vm.actionPlanSectionDetail=vm.actionPlan.practiceAreaList[vm.currentActive.index],vm.noteTextArea="",vm.feedRequired=!0,vm.state(),vm.showMobileDD&&(vm.showMobileDD=!1),void(vm.winWidth<768&&void 0===options.showRight&&(vm.showRightCol=!0)))}function openChangePlan(){vm.displayPlanList=!vm.displayPlanList}function changeStatus(option,list,mainList,actionList){ajaxService.getAjaxResponse({url:vm.config.completeAction+"?actionPlanId="+option.actionPlanId+"&uid="+option.uid+"&completed="+option.completed,method:"get"}).then(function(response){if("true"===response.Success)if(list.completed=option.completed,option.completed?mainList.completedActions++:mainList.completedActions--,void 0===option.group||option.completed)if(void 0!==option.group&&option.completed){actionList.completedActions++;var result=actionList.actionData.filter(function(e){return e.permissions.Completion&&!e.completed});!result.length&&actionList.permissions.Completion&&changeStatus({parentCall:!0,actionPlanId:vm.actionPlan.id,completed:!0,uid:actionList.uid},actionList,list)}else void 0!==option.parentCall&&(option.completed?list.completedActions++:list.completedActions--);else actionList.completedActions--,actionList.completed&&actionList.permissions.Completion&&changeStatus({parentCall:!0,actionPlanId:vm.actionPlan.id,completed:!1,uid:actionList.uid},actionList,list);else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function stateControl(list){var result=list.actionData.filter(function(e){return e.permissions.Completion&&!e.completed});return result.length?!0:!1}function returnMemberList(pageSize){return vm.actionPlanList.length?void vm.order(vm.pageSetting.lastPredicate,vm.pageSetting.lastReverse):!0}function order(predicate,reverse){vm.pageSetting.lastPredicate=predicate,vm.pageSetting.lastReverse=reverse,vm.actionPlanList=$filter("orderBy")(vm.actionPlanList,predicate,reverse)}function active(event,setting){vm.pageSetting.lastPredicate=setting.predicate,vm.pageSetting.lastReverse=setting.reverse,sharedProperties.toggleFilterClick(event,vm.pageSetting.lastPredicate),vm.order(vm.pageSetting.lastPredicate,vm.pageSetting.lastReverse)}function resetfilter(){vm.pageSetting=angular.copy(vm.originalPageSetting),vm.returnMemberList();var curr=$(".memberHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")}function developmentRedirect(options){vm.devStrategy={id:options.devStrategyId,desc:options.desc},vm.state(options.state)}function getMemberList(){ajaxService.getAjaxResponse({url:"/sp/allUsers"}).then(function(response){if("true"===response.Success){if(vm.emailMemberList=response.allMembers,null!==$localStorage.get("loggegdInProfile"))for(var i=0;i<vm.emailMemberList.length;i++)if(vm.emailMemberList[i].email===$localStorage.get("loggegdInProfile").member.email){vm.emailMemberList.splice(i,1);break}}else{var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function loadTags(query){var deferred=$q.defer(),result=vm.emailMemberList.filter(function(e){return-1!==e.name.toLowerCase().indexOf(query.toLowerCase())||-1!==e.email.toLowerCase().indexOf(query.toLowerCase())});return deferred.resolve(result),deferred.promise}function tagAdded(tag){void 0!==tag.email&&(vm.searchTag.push(tag.email),vm.inputRequired=!1)}function tagRemoved(tag){vm.searchTag.splice(vm.searchTag.indexOf(tag.email),1)}function meetingAdded(tag){void 0!==tag.email&&(vm.schedule.meetingTag.push(tag.email),vm.schedule.meetingRequired=!1)}function meetingRemoved(tag){vm.schedule.meetingTag.splice(vm.schedule.meetingTag.indexOf(tag.email),1)}function requestFeedback(options){return vm.requestFeedback.submitted=!1,vm.inputRequired=!1,!vm.requestFeedbackForm.$valid&&(vm.requestFeedback.submitted=!0),!options.email.length&&(vm.inputRequired=!0),vm.requestFeedback.submitted||vm.inputRequired?!0:void ajaxService.getAjaxResponse({url:vm.config.requestFeedback,data:$.param({goalId:options.goalId,devStrategyId:options.devStrategyId,content:options.contents,feedbackUserEmail:options.email.toString()})}).then(function(response){if("true"===response.Success)vm.state(),vm.feedRequired=!0,ngDialog.close(),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("practiceArea.feedbackrequested")});else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function addNote(options){vm.postANote.submitted=!1,vm.postANoteForm.$valid?ajaxService.getAjaxResponse({url:vm.config.addNote,data:$.param({goalId:options.goalId,devStrategyId:options.devStrategyId,content:options.contents})}).then(function(response){if("true"===response.Success)vm.state(),vm.noteTextArea="",vm.feedRequired=!0,ngDialog.close(),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("practiceArea.notePostedSuccesfully")});else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}}):vm.postANote.submitted=!0}function getNotesFeedbackForGoal(options){ajaxService.getAjaxResponse({url:vm.config.getNotesFeedbackForGoal+options.goalId+"&memberEmail="+$rootScope.noSelf,method:"get"}).then(function(response){if("true"===response.Success)vm.viewDetailsList=null,vm.feedRequired=!1,vm.masterAllNotesFeedbackData=response.notesAndFeedbackList,vm.allNotesFeedbackData=angular.copy(vm.masterAllNotesFeedbackData),vm.allNotesFeedbackData.length&&vm.viewDetails(vm.allNotesFeedbackData[0],vm.allNotesFeedbackData[0].id);else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function searchingStart(search){vm.viewDetailsList=null,vm.allNotesFeedbackData=$filter("filter")(vm.masterAllNotesFeedbackData,search),vm.allNotesFeedbackData.length&&vm.viewDetails(vm.allNotesFeedbackData[0],vm.allNotesFeedbackData[0].id)}function updateModel(content){vm.updateNoteFlag=!0,vm.updateNoteObj.submitted=!1,vm.tempModel=content}function updateNote(options){vm.updateNoteForm.$valid?ajaxService.getAjaxResponse({url:vm.config.updateNote,data:$.param({noteId:options.noteId,desc:options.desc})}).then(function(response){if("true"===response.Success)vm.updateNoteFlag=!1,$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("practiceArea.noteUpdatedSuccesfully")});else if(null!==response.error){vm.viewDetailsList.content=vm.tempModel;var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}}):vm.updateNoteObj.submitted=!0}function deleteActivate(options){ngDialog.closeAll(),"FEEDBACK"===options.type?vm.deleteFeedback(options):vm.deleteNote(options)}function deleteNote(options){ajaxService.getAjaxResponse({url:vm.config.deleteNote,data:$.param({noteId:options.noteId})}).then(function(response){if("true"===response.Success)sharedProperties.spilceIndexWithBreak(vm.masterAllNotesFeedbackData,"id",options.noteId),vm.allNotesFeedbackData=angular.copy(vm.masterAllNotesFeedbackData),vm.viewDetailsList=null,vm.feedRequired=!0,vm.allNotesFeedbackData.length&&vm.viewDetails(vm.allNotesFeedbackData[0],vm.allNotesFeedbackData[0].id),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("practiceArea.deleteNoteSuccessfull")});else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function deletePop(options){vm.saveDeleteOptions=options;var dialog=ngDialog.open({template:vm.config.deleteDialog,scope:$scope});dialog.closePromise.then(function(data){vm.saveDeleteOptions=null})}function viewDetails(notes,index,i){vm.viewDetailsListIndex=index,vm.viewDetailsList=notes,vm.updateNoteFlag=!1,i===vm.openTabId?vm.openTabId=-1:vm.openTabId=i}function deleteFeedback(options){ajaxService.getAjaxResponse({url:vm.config.deleteFeedback,data:$.param({feedbackId:options.noteId})}).then(function(response){if("true"===response.Success)sharedProperties.spilceIndexWithBreak(vm.masterAllNotesFeedbackData,"id",options.noteId),vm.allNotesFeedbackData=angular.copy(vm.masterAllNotesFeedbackData),vm.viewDetailsList=null,vm.feedRequired=!0,vm.allNotesFeedbackData.length&&vm.viewDetails(vm.allNotesFeedbackData[0],vm.allNotesFeedbackData[0].id),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("practiceArea.deleteFeedbackSuccessfull")});else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function previewVideo(mode,url,title){if("Video"===mode)videoPopUp(url);else if("Schedule"===mode){!vm.emailMemberList.length&&vm.getMemberList(),vm.schMeeting.submitted=!1,vm.schMeeting.actionTitle=title;var schedule=ngDialog.open({template:vm.config.scheduleDialog,scope:$scope});schedule.closePromise.then(function(data){vm.schedule=angular.copy(vm.originalSch),vm.schMeeting.actionTitle=null})}else{var win=window.open(url,"_blank");win.focus()}}function videoPopUp(url,openId){$scope.videoUrl=url;var dialog=ngDialog.open({template:vm.config.videoPopUpDialog,scope:$scope});dialog.closePromise.then(function(data){console.log("close")}),$rootScope.$on("ngDialog.opened",function(e,$dialog){"html5"===$scope.videoType&&$("#mp4_src").attr("src",$scope.videoSrc)})}function scheduleMeeting(){vm.schMeeting.submitted=!1,vm.schedule.meetingTag.length||(vm.schedule.meetingRequired=!0),vm.schMeetingForm.$valid&&vm.schedule.meetingTag.length&&timeCheck()?ajaxService.getAjaxResponse({url:vm.config.schedule+"?subject="+vm.schedule.subject+"&agenda="+vm.schedule.agenda+"&location="+vm.schedule.location+"&actionPlanId="+vm.actionPlan.id+"&to="+vm.schedule.meetingTag.toString()+"&startDate="+new Date(vm.schedule.fromDate).toISOString()+"&endDate="+new Date(vm.schedule.endDate).toISOString(),method:"get"}).then(function(response){if("true"===response.Success)ngDialog.close(),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.organization.schduled")});else if(null!==response.error){ngDialog.close();var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}}):vm.schMeeting.submitted=!0}function timeCheck(){var startTime=new Date(vm.schMeetingForm.start.$dateValue),endTime=new Date(vm.schMeetingForm.end.$dateValue);return startTime.getTime()-endTime.getTime()&&endTime-startTime>0?(vm.schedule.invalidTime=!1,!0):(vm.schedule.invalidTime=!0,!1)}function state(count){switch(count){case 1:vm.noteTextArea="",vm.postANote={submitted:!1},$state.go("addNote");break;case 2:!vm.emailMemberList.length&&vm.getMemberList(),vm.requestFeedbackArea="",vm.inputRequired=!1,vm.searchTag=[],$state.go("requestFeedback");break;case 3:vm.searchText="",vm.feedRequired?vm.getNotesFeedbackForGoal({goalId:vm.currentActive.goalId}):(vm.allNotesFeedbackData=angular.copy(vm.masterAllNotesFeedbackData),vm.viewDetails(vm.allNotesFeedbackData[0],vm.allNotesFeedbackData[0].id)),$state.go("notesAndFeedback");break;case 4:$state.go("selectActionPlan");break;default:vm.devStrategy={id:"",desc:null},$state.go("organization")}}var vm=this;vm.pageType="organization",vm.actionPlan=null,vm.actionPlanList=[],vm.actionPlanSectionDetail=null,vm.currentActive={name:"",index:-1,goalId:null},vm.devStrategy={id:"",desc:null},vm.emailMemberList=[],vm.inputRequired=!1,vm.requestFeedback={submitted:!1},vm.feedRequired=!0,vm.postANote={submitted:!1},vm.updateNoteObj={submitted:!1},vm.btnEnable=!0,vm.updateNoteFlag=!1,vm.feedRequired=!0,vm.allNotesFeedbackData=[],vm.masterAllNotesFeedbackData=[],vm.displayPlanList=!1,vm.viewDetailsList=null,vm.viewDetailsListIndex=-1,vm.updateModel=updateModel,vm.searchTag=[],vm.idtopass="",vm.config={allActionPlans:"/sp/actionPlan/getActionPlans",selectedActionPlanList:"/sp/actionPlan/getActionPlan?userEmail="+$rootScope.noSelf,selectActionPlan:"/sp/actionPlan/selectPlan?actionPlanId=",requestFeedback:"/sp/goals/feedback/request",addNote:"/sp/goals/note/add",getNotesFeedbackForGoal:"/sp/goals/notesfeedback?goalId=",updateNote:"/sp/goals/note/update",deleteNote:"/sp/goals/note/delete",updateRequestFeedback:"/sp/updateRequestFeedback",deleteFeedback:"/sp/goals/feedback/delete",deleteDialog:"/sp/resources/html/goals/deleteNoteDialog.html",videoPopUpDialog:"/sp/sysAdmin/videoPop",completeAction:"/sp/actionPlan/completeAction",scheduleDialog:"/sp/schedulePop",schedule:"/sp/actionPlan/sendCalInvite"},vm.pageSetting={searchText:"",disabledInfinite:!1,lastPredicate:"name",lastReverse:!1},vm.schMeeting={};var d=new Date;vm.schMeeting.submitted=!1,vm.schedule={subject:"",location:"",agenda:"",startDate:"",endDate:"",meetingTag:[],meetingRequired:!1,invalidTime:!1},vm.schedule.fromDate=d.setMinutes(d.getMinutes()+60),vm.schedule.endDate=d.setMinutes(d.getMinutes()+60),vm.originalSch=angular.copy(vm.schedule),vm.getActionPlans=getActionPlans,vm.selectActionPlans=selectActionPlans,vm.getSelectedActionPlanList=getSelectedActionPlanList,vm.getActionPlansSectionDetail=getActionPlansSectionDetail,vm.active=active,vm.order=order,vm.resetfilter=resetfilter,vm.returnMemberList=returnMemberList,vm.openChangePlan=openChangePlan,vm.changeStatus=changeStatus,vm.stateControl=stateControl,vm.state=state,vm.getMemberList=getMemberList,vm.tagRemoved=tagRemoved,vm.loadTags=loadTags,vm.tagAdded=tagAdded,vm.requestFeedback=requestFeedback,vm.meetingRemoved=meetingRemoved,vm.meetingAdded=meetingAdded,vm.addNote=addNote,vm.developmentRedirect=developmentRedirect,vm.getNotesFeedbackForGoal=getNotesFeedbackForGoal,vm.updateNote=updateNote,vm.deleteNote=deleteNote,vm.deleteActivate=deleteActivate,vm.deletePop=deletePop,vm.deleteFeedback=deleteFeedback,vm.viewDetails=viewDetails,vm.searchingStart=searchingStart,vm.showMobileHomePage=showMobileHomePage,vm.converTime=converTime,vm.previewVideo=previewVideo,vm.scheduleMeeting=scheduleMeeting,vm.showMobileDD=!1,vm.ddSelectedText,vm.winWidth=$(window).width(),vm.winHeight=$(window).height()+100+"px",vm.showRightCol=!1,vm.changeManageStrategy=!0,vm.openNgOverlay=openNgOverlay,vm.openTabId,vm.activeToolTipId=-1,vm.toggleToolTipMobile=toggleToolTipMobile,vm.pageTempaltes={note:"/sp/resources/html/goals/addNoteResponsive.html",feedback:"/sp/resources/html/goals/requestFeedbackResponsive.html",notification:"/sp/resources/html/goals/notesFeedbackOverlayResponsive.html",articlecomplete:"/sp/resources/html/goals/completedArticleResponsive.html",manageStratagies:"/sp/resources/html/goals/manageStratagiesResponsive.html"},$scope.videoCall=function(){if($scope.videoSrc=$scope.videoUrl,$scope.videoType="",/youtube/g.test($scope.videoSrc))$scope.videoType="youtube";else if(/vimeo/g.test($scope.videoSrc)){$scope.videoType="vimeo";var link=$scope.videoSrc.split("?")[0].split("/");$scope.videoSrc="https://vimeo.com/"+link[parseInt(link.length-1)]}else $scope.videoType="html5";"html5"!==$scope.videoType&&setTimeout(function(){videojs(document.getElementById("vid1"),{autoplay:!1,techOrder:[$scope.videoType],src:$scope.videoSrc},function(){$scope.videoReady=!0,this.on("ended",function(){var vid=this;vid.trigger("loadstart"),$timeout(function(){vid.posterImage.show()},500)}),this.on("timeupdate",function(){var ct=this.currentTime(),timeLeft=this.remainingTime();ct>0&&this.bigPlayButton.hide(),0===timeLeft&&this.bigPlayButton.show()})})},500)},vm.companyLogo=$localStorage.get("loggegdInProfile").company.logoURL,vm.companyName=$localStorage.get("loggegdInProfile").company.name,$("body").click(function(e){$(".lnd-left-style-box").is(e.target)||0!==$(".lnd-left-style-box").has(e.target).length||$(".drag_handle").is(e.target)||vm.displayPlanList&&$scope.$apply(function(){vm.displayPlanList=!1})})}angular.module("spApp").controller("organizationAreasController",organizationAreasController),organizationAreasController.$inject=["$scope","ajaxService","sharedProperties","$state","$filter","ngDialog","$q","$localStorage","$rootScope","$timeout"];
function paymentHistoryController($scope,$element,$attrs,$http,$rootScope,ajaxService){$scope.priceFormatter=function(p){if("undefined"!=typeof p&&""!==p&&null!==p){var formattedPrice="$"+p.toFixed(2);return formattedPrice}},ajaxService.getAjaxResponse({url:"/sp/admin/account/paymentHistory"}).then(function(response){if("true"===response.Success)$scope.paymentDetails=response.paymentHistory;else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}}),$scope.cancelRedirect=function(){var url=window.location.href,isIndividual=url.substring(url.indexOf("#")+1).replace(/\//g,"").split("?")[1];"i"===isIndividual?window.location="/sp/admin/account/individual":window.location="/sp/admin/account/business"}}function paymentHistoryAlternateController($scope,$element,$attrs,$http,$rootScope,ajaxService,sharedProperties){$scope.priceFormatter=function(p){if("undefined"!=typeof p&&""!==p&&null!==p){var formattedPrice="$"+p.toFixed(2);return formattedPrice}},ajaxService.getAjaxResponse({url:"/sp/sysAdmin/alternateBilling/account/paymentHistory",data:$.param({accountId:sharedProperties.getParam("accountId")})}).then(function(response){if("true"===response.Success)$scope.paymentDetails=response.paymentHistory,$scope.accountId=sharedProperties.getParam("accountId");else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}}),$scope.cancelRedirect=function(i){var isIndividual=sharedProperties.getParam("mode");"i"===isIndividual?window.location="/sp/sysAdmin/alternateBilling/viewDetailAccountIndividual?accountId="+sharedProperties.getParam("accountId"):window.location="/sp/sysAdmin/alternateBilling/viewDetailAccount?accountId="+sharedProperties.getParam("accountId")}}angular.module("spApp").controller("paymentHistoryController",paymentHistoryController),angular.module("spApp").controller("paymentHistoryAlternateController",paymentHistoryAlternateController),paymentHistoryController.$inject=["$scope","$element","$attrs","$http","$rootScope","ajaxService"],paymentHistoryAlternateController.$inject=["$scope","$element","$attrs","$http","$rootScope","ajaxService","sharedProperties"];
function practiceAdminController($scope,ajaxService,$localStorage,sharedProperties,$filter,$rootScope,ngDialog,$element){function getPracticeGoal(){ajaxService.getAjaxResponse({url:vm.config.practiceArea}).then(function(response){if("true"===response.Success)null===sharedProperties.getParam("goalId")?(vm.masterpracticeAreaAvailable=response.pratcieAreas,vm.returnMemberList(vm.pageSetting.pageSize)):vm.viewDetail(response.pratcieAreas);else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function viewDetailStart(){null!==$localStorage.get("viewDetailAdmin")?(vm.viewPracticeAreaDetail=$localStorage.get("viewDetailAdmin"),vm.originalViewDetail=angular.copy(vm.viewPracticeAreaDetail)):vm.getPracticeGoal()}function viewDetail(reponse){for(var goalId=sharedProperties.getParam("goalId"),i=0;i<reponse.length;i++)if(reponse[i].id===goalId){vm.viewPracticeAreaDetail=reponse[i];break}vm.originalViewDetail=angular.copy(vm.viewPracticeAreaDetail)}function addStrategy(param){for(var copyArray=vm.viewPracticeAreaDetail.developmentStrategyList,i=0;param>i;i++)copyArray.push({id:vm.viewPracticeAreaDetail.developmentStrategyList.length-parseInt(1,10).toString(),dsDescription:null,videoUrl:null,imageUrl:null,active:!0});vm.viewPracticeAreaDetail.developmentStrategyList=angular.copy(copyArray),vm.viewDetailForm.submitted=!1}function returnMemberList(pageSize){return vm.masterpracticeAreaAvailable.length?(vm.pageSetting.pageSize=pageSize,pageSize>=vm.masterpracticeAreaAvailable.length&&(vm.pageSetting.disabledInfinite=!0,vm.pageSetting.pageSize=vm.masterpracticeAreaAvailable.length),vm.practiceAreaAvailable=sharedProperties.searchModuleName(vm.pageSetting.textSearching,vm.masterpracticeAreaAvailable,2,"name"),void vm.order(vm.pageSetting.lastPredicate,vm.pageSetting.lastReverse)):!0}function order(predicate,reverse){vm.pageSetting.lastPredicate=predicate,vm.pageSetting.lastReverse=reverse,vm.practiceAreaAvailable=$filter("orderBy")(vm.practiceAreaAvailable,predicate,reverse)}function resetfilter(){vm.pageSetting=angular.copy(vm.originalPageSetting),vm.returnMemberList(vm.pageSetting.pageSize);var curr=$(".memberHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")}function searchTextFilter(search){vm.pageSetting.textSearching=search,vm.returnMemberList(vm.pageSetting.pageSize)}function clearSearch(){vm.pageSetting.textSearching.length&&(vm.pageSetting.textSearching="",vm.pageSetting.searchText="",vm.returnMemberList(vm.pageSetting.pageSize))}function active(event,setting){vm.pageSetting.lastPredicate=setting.predicate,vm.pageSetting.lastReverse=setting.reverse,sharedProperties.toggleFilterClick(event,vm.pageSetting.lastPredicate),vm.order(vm.pageSetting.lastPredicate,vm.pageSetting.lastReverse)}function deleteConfirm(id){vm.goalId=id;var dialog=ngDialog.open({template:"/sp/resources/html/sysAdmin/goals/deleteConfirmation.html",scope:$scope});dialog.closePromise.then(function(data){vm.goalId=""})}function accountStatus(goalIds,status){ajaxService.getAjaxResponse({url:vm.config.actdeactivate,data:$.param({practiceAreaId:goalIds,status:status})}).then(function(response){if("true"===response.Success){for(var i=0;i<vm.practiceAreaAvailable.length;i++)if(vm.practiceAreaAvailable[i].id===goalIds){"INACTIVE"===status?vm.practiceAreaAvailable[i].status="INACTIVE":vm.practiceAreaAvailable[i].status="ACTIVE";break}$.growl({icon:"glyphicon glyphicon-ok",message:"INACTIVE"===status?$rootScope.pullInterNationalization("practiceAreaAdmin.deactive"):$rootScope.pullInterNationalization("practiceAreaAdmin.active")}),ngDialog.close("ngdialog1"),vm.goalId=""}else if(null!==response.error){var errorMessage="";ngDialog.close("ngdialog1"),vm.goalId="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function updateViewDetail(){if(vm.viewDetailForm.$valid)ajaxService.getAjaxResponse({url:vm.config.updatePracticeArea,data:$("form").serialize()+"&practiceAreaId="+vm.viewPracticeAreaDetail.id}).then(function(response){if("true"===response.Success)vm.detailsEditing.status=!1,$localStorage.set("practiceAdminArea",$rootScope.pullInterNationalization("practiceAreaAdmin.paUpdated")),vm.returnToListing();else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}});else{vm.viewDetailForm.submitted=!0;var elem=angular.element($element);$("html,body").animate({scrollTop:$(elem).find("form .ng-invalid:first").offset().top-20},300)}}function returnToOldState(){vm.viewPracticeAreaDetail=angular.copy(vm.originalViewDetail),vm.detailsEditing.status=!1,$("html,body").animate({scrollTop:$(".container").offset().top-20},300)}function createViewDetail(){if(vm.viewDetailForm.$valid)ajaxService.getAjaxResponse({url:vm.config.createPracticeArea,data:$("form").serialize()}).then(function(response){if("true"===response.Success)$localStorage.set("practiceAdminArea",$rootScope.pullInterNationalization("practiceAreaAdmin.paUpdated")),vm.returnToListing();else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}});else{vm.viewDetailForm.submitted=!0;var elem=angular.element($element);$("html,body").animate({scrollTop:$(elem).find("form .ng-invalid:first").offset().top-20},300)}}function returnToListing(){window.location.href="/sp/practiceAdminArea"}function localStore(list){$localStorage.set("viewDetailAdmin",list),window.location.href="/sp/practiceAreaViewDetail?goalId="+list.id}function editEnable(){vm.detailsEditing.status=!0,$("html,body").animate({scrollTop:$("form").offset().top-20},300)}function selectImage(action){sharedProperties.openMediaModal();var destroyRoot=$scope.$on("mediaData",function(e,data){return destroyRoot(),null===data?!0:void(action.imageUrl=data.url)})}var vm=this;vm.config={practiceArea:"/sp/sysAdmin/practiceArea/getAll",actdeactivate:"/sp/sysAdmin/practiceArea/activateDeactivate",updatePracticeArea:"/sp/sysAdmin/practiceArea/update",createPracticeArea:"/sp/sysAdmin/practiceArea/create"},vm.practiceAreaAvailable=[],vm.masterpracticeAreaAvailable=[],vm.viewPracticeAreaDetail={developmentStrategyList:[]},vm.resetfilter=resetfilter,vm.pageSetting={searchText:"",textSearching:"",pageSize:20,disabledInfinite:!1,lastPredicate:"name",lastReverse:!1},vm.originalPageSetting=angular.copy(vm.pageSetting),vm.goalId=null,vm.getPracticeGoal=getPracticeGoal,vm.searchTextFilter=searchTextFilter,vm.returnMemberList=returnMemberList,vm.clearSearch=clearSearch,vm.active=active,vm.deleteConfirm=deleteConfirm,vm.accountStatus=accountStatus,vm.order=order,vm.originalViewDetail=null,vm.detailsEditing={status:!1},vm.viewDetailForm={submitted:!1},vm.pat=/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/,vm.viewDetail=viewDetail,vm.addStrategy=addStrategy,vm.updateViewDetail=updateViewDetail,vm.returnToOldState=returnToOldState,vm.createViewDetail=createViewDetail,vm.returnToListing=returnToListing,vm.localStore=localStore,vm.viewDetailStart=viewDetailStart,vm.editEnable=editEnable,vm.selectImage=selectImage,function(){null!==$localStorage.get("practiceAdminArea")&&$.growl({icon:"glyphicon glyphicon-ok",message:$localStorage.get("practiceAdminArea")}),$localStorage.remove("practiceAdminArea")}()}angular.module("spApp").controller("practiceAdminController",practiceAdminController),practiceAdminController.$inject=["$scope","ajaxService","$localStorage","sharedProperties","$filter","$rootScope","ngDialog","$element"];
function practiceAreasController($scope,ajaxService,$localStorage,$state,$q,sharedProperties,$filter,$rootScope,ngDialog,$timeout){function showMobileHomePage(){vm.showRightCol=!1,vm.showMobileDD=!1}function openNgOverlay(page,data){"notification"===page&&(vm.openTabId=-1,vm.getNotesFeedbackForGoal({goalId:vm.currentActive.goalId})),"feedback"===page&&!vm.emailMemberList.length&&vm.getMemberList(),"manageStratagies"===page&&vm.manageDevelopmentStartegies(),"undefined"!=typeof data&&(vm.devStrategy={id:data.devStrategyId,desc:data.desc}),vm.winHeight=$(window).height()+100+"px";ngDialog.open({template:vm.pageTempaltes[page],className:"ngdialog-lnd-theme",scope:$scope})}function getPracticeGoal(){ajaxService.getAjaxResponse({url:""===$rootScope.noSelf?vm.config.goals:vm.config.memberGoals,method:"get"}).then(function(response){if("true"===response.Success){vm.goalAvailable=response.userGoal,vm.autoLearning=response.autoLearning,vm.goalsDetail=response.goalDetail,vm.goalsResources=[],vm.viewDetailsList=null,vm.changeManageStrategy=!0,vm.feedRequired=!0,vm.goalsCompleted=[];for(var i=0;i<vm.goalsDetail.userGoalsDto.userArticlesProgress.length;i++)!vm.goalsDetail.userGoalsDto.userArticlesProgress[i].completed&&vm.goalsResources.push(vm.goalsDetail.userGoalsDto.userArticlesProgress[i]),vm.goalsDetail.userGoalsDto.userArticlesProgress[i].completed&&vm.goalsCompleted.push(vm.goalsDetail.userGoalsDto.userArticlesProgress[i]);for(var j=0;j<vm.goalAvailable.length;j++)if(vm.goalsDetail.userGoalsDto.activeGoalId===vm.goalAvailable[j].id){vm.ddSelectedText=vm.goalAvailable[j].name,vm.currentActive.goalId=vm.goalAvailable[j].id,vm.currentActive.name=vm.goalAvailable[j].name;break}vm.state()}else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function manageDevelopmentStartegies(){ajaxService.getAjaxResponse({url:vm.config.manageDevelopmentStartegies,data:$.param({goalId:vm.currentActive.goalId})}).then(function(response){if("true"===response.Success)vm.manageDevelopmentStartegiesArray=response.mds,vm.changeManageStrategy=!1,vm.originalManageDevelopmentStartegiesArray=angular.copy(vm.manageDevelopmentStartegiesArray);else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function updateAutoLearning(){return vm.btnEnable?(vm.btnEnable=!1,void ajaxService.getAjaxResponse({url:vm.config.updateAutoLearning,data:$.param({autoLearning:!vm.autoLearning})}).then(function(response){if("true"===response.Success){vm.autoLearning=!vm.autoLearning;var messages=vm.autoLearning?$rootScope.pullInterNationalization("practiceArea.autoLearningSettingOn"):$rootScope.pullInterNationalization("practiceArea.autoLearningSettingOff");$.growl({icon:"glyphicon glyphicon-ok",message:messages}),vm.btnEnable=!0}else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})):!0}function updateMDS(options){var list=[],lengthTrue=vm.trues.length;if(3>lengthTrue)return!0;for(var i=0;lengthTrue>i;i++)list.push(vm.trues[i].id);ajaxService.getAjaxResponse({url:vm.config.updateMDS,data:$.param({goalId:vm.currentActive.goalId,activeDsIds:list.toString()})}).then(function(response){if("true"===response.Success)vm.goalsDetail.userGoalsDto.activeDevelopmentStrategyList=angular.copy(vm.trues),vm.originalManageDevelopmentStartegiesArray=angular.copy(vm.manageDevelopmentStartegiesArray),vm.state(),ngDialog.close(),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("practiceArea.mdsUpdated")});else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function submitDisabled(){return vm.trues=$filter("filter")(vm.manageDevelopmentStartegiesArray,{selectedByUser:!0}),vm.trues.length>2?!0:!1}function getPracticeGoalDetail(options){return vm.winWidth>768&&vm.currentActive.goalId===options.goalId?(vm.state(),!0):void ajaxService.getAjaxResponse({url:vm.config.goalDetail,data:$.param({goalId:options.goalId})}).then(function(response){if("true"===response.Success){vm.currentActive=options,vm.goalsDetail=response.goalDetail,vm.goalsResources=[],vm.viewDetailsList=null,vm.changeManageStrategy=!0,vm.feedRequired=!0,vm.goalsCompleted=[];for(var i=0;i<vm.goalsDetail.userGoalsDto.userArticlesProgress.length;i++)!vm.goalsDetail.userGoalsDto.userArticlesProgress[i].completed&&vm.goalsResources.push(vm.goalsDetail.userGoalsDto.userArticlesProgress[i]),vm.goalsDetail.userGoalsDto.userArticlesProgress[i].completed&&vm.goalsCompleted.push(vm.goalsDetail.userGoalsDto.userArticlesProgress[i]);vm.ddSelectedText=vm.currentActive.name,vm.state(),vm.winWidth<768&&(vm.showRightCol=!0)}else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function addNote(options){vm.postANote.submitted=!1,vm.postANoteForm.$valid?ajaxService.getAjaxResponse({url:vm.config.addNote,data:$.param({goalId:options.goalId,devStrategyId:options.devStrategyId,content:options.contents})}).then(function(response){if("true"===response.Success)vm.state(),vm.noteTextArea="",vm.feedRequired=!0,ngDialog.close(),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("practiceArea.notePostedSuccesfully")});else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}}):vm.postANote.submitted=!0}function updateNote(options){vm.updateNoteForm.$valid?ajaxService.getAjaxResponse({url:vm.config.updateNote,data:$.param({noteId:options.noteId,desc:options.desc})}).then(function(response){if("true"===response.Success)vm.updateNoteFlag=!1,$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("practiceArea.noteUpdatedSuccesfully")});else if(null!==response.error){vm.viewDetailsList.content=vm.tempModel;var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}}):vm.updateNoteObj.submitted=!0}function deleteActivate(options){ngDialog.closeAll(),"FEEDBACK"===options.type?vm.deleteFeedback(options):vm.deleteNote(options)}function deleteNote(options){ajaxService.getAjaxResponse({url:vm.config.deleteNote,data:$.param({noteId:options.noteId})}).then(function(response){if("true"===response.Success)sharedProperties.spilceIndexWithBreak(vm.masterAllNotesFeedbackData,"id",options.noteId),vm.allNotesFeedbackData=angular.copy(vm.masterAllNotesFeedbackData),vm.viewDetailsList=null,vm.feedRequired=!0,vm.allNotesFeedbackData.length&&vm.viewDetails(vm.allNotesFeedbackData[0],vm.allNotesFeedbackData[0].id),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("practiceArea.deleteNoteSuccessfull")});else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function deletePop(options){vm.saveDeleteOptions=options;var dialog=ngDialog.open({template:vm.config.deleteDialog,scope:$scope});dialog.closePromise.then(function(data){vm.saveDeleteOptions=null})}function deleteFeedback(options){ajaxService.getAjaxResponse({url:vm.config.deleteFeedback,data:$.param({feedbackId:options.noteId})}).then(function(response){if("true"===response.Success)sharedProperties.spilceIndexWithBreak(vm.masterAllNotesFeedbackData,"id",options.noteId),vm.allNotesFeedbackData=angular.copy(vm.masterAllNotesFeedbackData),vm.viewDetailsList=null,vm.feedRequired=!0,vm.allNotesFeedbackData.length&&vm.viewDetails(vm.allNotesFeedbackData[0],vm.allNotesFeedbackData[0].id),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("practiceArea.deleteFeedbackSuccessfull")});else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function requestFeedback(options){return vm.requestFeedback.submitted=!1,vm.inputRequired=!1,!vm.requestFeedbackForm.$valid&&(vm.requestFeedback.submitted=!0),!options.email.length&&(vm.inputRequired=!0),vm.requestFeedback.submitted||vm.inputRequired?!0:void ajaxService.getAjaxResponse({url:vm.config.requestFeedback,data:$.param({goalId:options.goalId,devStrategyId:options.devStrategyId,content:options.contents,feedbackUserEmail:options.email.toString()})}).then(function(response){if("true"===response.Success)vm.state(),vm.feedRequired=!0,ngDialog.close(),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("practiceArea.feedbackrequested")});else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function getNotesFeedbackForGoal(options){ajaxService.getAjaxResponse({url:vm.config.getNotesFeedbackForGoal+options.goalId+"&memberEmail="+$rootScope.noSelf,method:"get"}).then(function(response){if("true"===response.Success)vm.viewDetailsList=null,vm.feedRequired=!1,vm.masterAllNotesFeedbackData=response.notesAndFeedbackList,vm.allNotesFeedbackData=angular.copy(vm.masterAllNotesFeedbackData),vm.allNotesFeedbackData.length&&vm.viewDetails(vm.allNotesFeedbackData[0],vm.allNotesFeedbackData[0].id);else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function state(count){switch(count){case 1:vm.noteTextArea="",vm.postANote={submitted:!1},$state.go("addNote");break;case 2:!vm.emailMemberList.length&&vm.getMemberList(),vm.requestFeedbackArea="",vm.inputRequired=!1,vm.searchTag=[],$state.go("requestFeedback");break;case 3:vm.searchText="",vm.feedRequired?vm.getNotesFeedbackForGoal({goalId:vm.currentActive.goalId}):(vm.allNotesFeedbackData=angular.copy(vm.masterAllNotesFeedbackData),vm.viewDetails(vm.allNotesFeedbackData[0],vm.allNotesFeedbackData[0].id)),$state.go("notesAndFeedback");break;case 4:$state.go("completedArticle"),$("html,body").animate({scrollTop:$(".lnd-right-sec").offset().top-40},300);break;case 5:vm.changeManageStrategy&&(vm.manageDevelopmentStartegiesArray=[],vm.manageDevelopmentStartegies()),vm.manageDevelopmentStartegiesArray=angular.copy(vm.originalManageDevelopmentStartegiesArray),$state.go("manageArticle"),$("html,body").animate({scrollTop:$(".lnd-right-sec").offset().top-40},300);break;default:vm.devStrategy={id:"",desc:null},$state.go("practice")}}function getMemberList(){ajaxService.getAjaxResponse({url:"/sp/allUsers"}).then(function(response){if("true"===response.Success){if(vm.emailMemberList=response.allMembers,null!==$localStorage.get("loggegdInProfile"))for(var i=0;i<vm.emailMemberList.length;i++)if(vm.emailMemberList[i].email===$localStorage.get("loggegdInProfile").member.email){vm.emailMemberList.splice(i,1);break}}else{var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function loadTags(query){var deferred=$q.defer(),result=vm.emailMemberList.filter(function(e){return-1!==e.name.toLowerCase().indexOf(query.toLowerCase())||-1!==e.email.toLowerCase().indexOf(query.toLowerCase())});return deferred.resolve(result),deferred.promise}function tagAdded(tag){void 0!==tag.email&&(vm.searchTag.push(tag.email),vm.inputRequired=!1)}function tagRemoved(tag){vm.searchTag.splice(vm.searchTag.indexOf(tag.email),1)}function developmentRedirect(options){vm.devStrategy={id:options.devStrategyId,desc:options.desc},vm.state(options.state)}function viewDetails(notes,index,i){vm.viewDetailsListIndex=index,vm.viewDetailsList=notes,vm.updateNoteFlag=!1,i===vm.openTabId?vm.openTabId=-1:vm.openTabId=i}function updateModel(content){vm.updateNoteFlag=!0,vm.updateNoteObj.submitted=!1,vm.tempModel=content}function learningCenter(){window.location.href="/sp/trainingLibrary"}function searchingStart(search){vm.viewDetailsList=null,vm.allNotesFeedbackData=$filter("filter")(vm.masterAllNotesFeedbackData,search),vm.allNotesFeedbackData.length&&vm.viewDetails(vm.allNotesFeedbackData[0],vm.allNotesFeedbackData[0].id)}function videoPopUp(url){$scope.videoUrl=url,ngDialog.open({template:vm.config.videoPopUpDialog,scope:$scope})}function toggleToolTipMobile(i){vm.winWidth<768&&vm.activeToolTipId!==i?vm.activeToolTipId=i:vm.activeToolTipId=-1}var vm=this,randomValue=(new Date).getTime();vm.config={goals:"/sp/goals/getUserGoals?rand="+randomValue,memberGoals:"/sp/for/goals/getUserGoals?memberEmail="+$rootScope.noSelf,goalDetail:"/sp/goals/getGoalDetail?memberEmail="+$rootScope.noSelf,addNote:"/sp/goals/note/add",updateNote:"/sp/goals/note/update",deleteNote:"/sp/goals/note/delete",requestFeedback:"/sp/goals/feedback/request",updateRequestFeedback:"/sp/updateRequestFeedback",deleteFeedback:"/sp/goals/feedback/delete",getNotesFeedbackForGoal:"/sp/goals/notesfeedback?goalId=",manageDevelopmentStartegies:"/sp/goals/getMds",updateMDS:"/sp/goals/updateMds",updateAutoLearning:"/sp/updateAutoLearning",deleteDialog:"/sp/resources/html/goals/deleteNoteDialog.html",videoPopUpDialog:"/sp/support/videoPopUp"},vm.goalAvailable=[],vm.pageType="individual",vm.goalsDetail=[],vm.emailMemberList=[],vm.searchTag=[],vm.allNotesFeedbackData=[],vm.masterAllNotesFeedbackData=[],vm.manageDevelopmentStartegiesArray=[],vm.originalManageDevelopmentStartegiesArray=[],vm.devStrategy={id:"",desc:null},vm.currentActive={name:"",goalId:-1},vm.postANote={submitted:!1},vm.inputRequired=!1,vm.requestFeedback={submitted:!1},vm.updateNoteObj={submitted:!1},vm.btnEnable=!0,vm.updateNoteFlag=!1,vm.feedRequired=!0,vm.viewDetailsList=null,vm.saveDeleteOptions=null,vm.viewDetailsListIndex=-1,vm.trues=[],vm.getPracticeGoal=getPracticeGoal,vm.getPracticeGoalDetail=getPracticeGoalDetail,vm.addNote=addNote,vm.updateNote=updateNote,vm.deleteNote=deleteNote,vm.requestFeedback=requestFeedback,vm.getNotesFeedbackForGoal=getNotesFeedbackForGoal,vm.getMemberList=getMemberList,vm.tagRemoved=tagRemoved,vm.loadTags=loadTags,vm.tagAdded=tagAdded,vm.developmentRedirect=developmentRedirect,vm.viewDetails=viewDetails,vm.deleteFeedback=deleteFeedback,vm.state=state,vm.deleteActivate=deleteActivate,vm.updateModel=updateModel,vm.manageDevelopmentStartegies=manageDevelopmentStartegies,vm.updateMDS=updateMDS,vm.submitDisabled=submitDisabled,vm.updateAutoLearning=updateAutoLearning,vm.learningCenter=learningCenter,vm.searchingStart=searchingStart,vm.deletePop=deletePop,vm.videoPopUp=videoPopUp,vm.showMobileDD=!1,vm.ddSelectedText,vm.winWidth=$(window).width(),vm.winHeight=$(window).height()+100+"px",vm.showRightCol=!1,vm.changeManageStrategy=!0,vm.openNgOverlay=openNgOverlay,vm.openTabId,vm.activeToolTipId=-1,vm.toggleToolTipMobile=toggleToolTipMobile,vm.showMobileHomePage=showMobileHomePage,vm.pageTempaltes={note:"/sp/resources/html/goals/addNoteResponsive.html",feedback:"/sp/resources/html/goals/requestFeedbackResponsive.html",notification:"/sp/resources/html/goals/notesFeedbackOverlayResponsive.html",articlecomplete:"/sp/resources/html/goals/completedArticleResponsive.html",manageStratagies:"/sp/resources/html/goals/manageStratagiesResponsive.html"},$scope.videoCall=function(){$scope.videoSrc=$scope.videoUrl;var videoType;if(/youtube/g.test($scope.videoSrc))videoType="youtube";else if(/vimeo/g.test($scope.videoSrc)){videoType="vimeo";var link=$scope.videoSrc.split("?")[0].split("/");$scope.videoSrc="https://vimeo.com/"+link[parseInt(link.length-1)]}else videoType="html5";setTimeout(function(){videojs(document.getElementById("vid1"),{autoplay:!1,techOrder:[videoType],src:$scope.videoSrc},function(){$scope.videoReady=!0,this.on("ended",function(){var vid=this;vid.trigger("loadstart"),$timeout(function(){vid.posterImage.show()},500)}),this.on("timeupdate",function(){var ct=this.currentTime(),timeLeft=this.remainingTime();ct>0&&this.bigPlayButton.hide(),0===timeLeft&&this.bigPlayButton.show()})})},500)},function(){null!==$localStorage.get("mdsUpdated")&&($.growl({icon:"glyphicon glyphicon-ok",message:$localStorage.get("mdsUpdated")}),$localStorage.remove("mdsUpdated")),vm.getPracticeGoal()}()}function managePracticeArea($scope,ajaxService,$filter,sharedProperties,ngDialog,$rootScope,$localStorage){function getPracticeGoal(){ajaxService.getAjaxResponse({url:vm.config.practiceAreasGoals,method:"get"}).then(function(response){if("true"===response.Success)vm.prismLensExists=response.prismLensExist,vm.masterlistGoals=response.userAllGoal,vm.selectedGoals=response.userSelectedGoal,vm.copYselectedGoals=response.userSelectedGoal,vm.sortList(),vm.selectedGoals.length>=10&&(vm.disableAddButton=!0);else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function sortList(){vm.listGoals=vm.masterlistGoals.filter(function(e){return(""===vm.pageOptions.optionList&&e||null!==e.sourceList&&-1!==Object.keys(e.sourceList).indexOf(vm.pageOptions.optionList)&&e)&&(vm.pageOptions.searchText.length?-1!==angular.lowercase(e.goal.name).indexOf(angular.lowercase(vm.pageOptions.searchText))&&e:e)}),vm.listGoals=$filter("orderBy")(vm.listGoals,[vm.pageOptions.weightOrder,"-goal.name"],!0)}function cancelIt(){window.onbeforeunload=null,window.location.href="/sp/goals#/practice"}function updatePracticeAreasGoals(){window.onbeforeunload=null,vm.unloadFunctionCall=!1,vm.selectedGoals=angular.copy(vm.copYselectedGoals),vm.goalList=[],$(vm.sortable.el).find("li").each(function(value,index){vm.goalList.push($(this).attr("data-id"))}),ajaxService.getAjaxResponse({url:vm.config.updatePracticeAreasGoals,data:$.param({goalId:vm.goalList.toString()})}).then(function(response){if("true"===response.Success)$localStorage.set("mdsUpdated",$rootScope.pullInterNationalization("practiceArea.mdsUpdated")),window.location.href="/sp/goals#/practice";else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong></strong>",message:errorMessage})}})}function addGoal(goals){vm.copYselectedGoals.push(goals),vm.selectedGoals=angular.copy(vm.copYselectedGoals),$.growl({icon:"glyphicon glyphicon-ok",message:10===vm.selectedGoals.length?$rootScope.pullInterNationalization("practiceArea.maxAdded"):$rootScope.pullInterNationalization("practiceArea.addedGoal")}),10===vm.selectedGoals.length?vm.disableAddButton=!0:vm.disableAddButton=!1,confirmWhetherToExit()}function removeGoal(goals){for(var i=0;i<vm.copYselectedGoals.length;i++)if(vm.copYselectedGoals[i].goal.id===goals.goal.id){vm.copYselectedGoals.splice(i,1);break}vm.selectedGoals=angular.copy(vm.copYselectedGoals),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("practiceArea.removeGoal")}),10===vm.selectedGoals.length?vm.disableAddButton=!0:vm.disableAddButton=!1,confirmWhetherToExit()}function paListResponsive(){vm.winHeight=$(window).height()+100+"px";ngDialog.open({template:"/sp/resources/html/goals/managerPaResponsive.html",className:"ngdialog-lnd-theme",scope:$scope})}function initialize(){vm.initializeBool||(vm.el=document.getElementById("sort-me"),vm.winWidth>767?vm.sortable=new Sortable(vm.el,{group:"name",animation:150,ghostClass:"ghost",onEnd:function(evt){vm.copYselectedGoals.move(evt.oldIndex,evt.newIndex),confirmWhetherToExit()}}):vm.sortable=new Sortable(vm.el,{group:"name",animation:150,ghostClass:"ghost",handle:".dHandle",yAxisOnly:!0,onEnd:function(evt){vm.copYselectedGoals.move(evt.oldIndex,evt.newIndex),confirmWhetherToExit()}}),vm.initializeBool=!0)}function changeFilter(value){switch(value){case"all":vm.pageOptions={weightOrder:"allGoalWeight",optionList:"",searchText:""};break;case"prism":vm.pageOptions={weightOrder:"prismWeight",optionList:"Prism",searchText:""};break;case"prismLens":vm.pageOptions={weightOrder:"prismLensWeight",optionList:"PrismLens",searchText:""}}vm.sortList()}function viewDevelopmentStartegy(list,name){vm.viewStrategy=list,vm.viewStrategyName=name,vm.winHeight=$(window).height()+100+"px";ngDialog.open({template:vm.winWidth>767?"/sp/viewDevelopmentStrategy":"/sp/resources/html/goals/viewDevelopmentStartegyResponsive.html",scope:$scope,className:vm.winWidth>767?"ngdialog-theme-default":"ngdialog-lnd-theme"})}var vm=this;vm.config={practiceAreasGoals:"/sp/goals/getAllGoals",updatePracticeAreasGoals:"/sp/goals/updateUserGoalsSelection"},vm.selectedGoals=[],vm.listGoals=[],vm.masterlistGoals=[],vm.goalList=[],vm.selPracticeArea="all",vm.pageOptions={weightOrder:"allGoalWeight",optionList:"",searchText:""},vm.getPracticeGoal=getPracticeGoal,vm.updatePracticeAreasGoals=updatePracticeAreasGoals,vm.addGoal=addGoal,vm.removeGoal=removeGoal,vm.initialize=initialize,vm.changeFilter=changeFilter,vm.cancelIt=cancelIt,vm.viewDevelopmentStartegy=viewDevelopmentStartegy,vm.sortList=sortList,vm.showIt=!1,vm.viewStrategyName="",vm.prismLensExists=!0,vm.initializeBool=!1,vm.unloadFunctionCall=!1,vm.disableAddButton=!1,vm.paListResponsive=paListResponsive,vm.winWidth=$(window).width(),vm.winHeight=$(window).height()+100+"px";var confirmWhetherToExit=function(){vm.unloadFunctionCall||(vm.unloadFunctionCall=!0,window.onbeforeunload=function(e){return $rootScope.pullInterNationalization("practiceArea.unsavedChanges.message")})};!function(){vm.getPracticeGoal()}()}angular.module("spApp").controller("practiceAreasController",practiceAreasController),angular.module("spApp").controller("managePracticeArea",managePracticeArea),practiceAreasController.$inject=["$scope","ajaxService","$localStorage","$state","$q","sharedProperties","$filter","$rootScope","ngDialog","$timeout"],managePracticeArea.$inject=["$scope","ajaxService","$filter","sharedProperties","ngDialog","$rootScope","$localStorage"];
function processPaymentController($scope,$element,$attrs,$http,ngDialog,ajaxService,$localStorage){$scope.updateCC={},$scope.dialogStatus={},$scope.accountType=$localStorage.get("account_type"),$scope.getAccountInfo=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/businessAccountDetails"}).then(function(response){if("true"===response.Success)$scope.accountInfo=response.account;else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.getIndividualAccountInfo=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/individualAccountDetails"}).then(function(response){if("true"===response.Success)$scope.accountInfo=response.account;else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.processPayment=function(fData){$scope.updateCC.submitted=!1,$scope.updateCC.$valid?ajaxService.getAjaxResponse({url:"/sp/admin/account/processPayment",data:$.param(fData)}).then(function(response){if("true"===response.Success)$scope.dialogStatus.title="Process payment",$scope.dialogStatus.content="Payment processed successfully.",ngDialog.open({template:"/sp/resources/html/admin/account/success-dialog.html",scope:$scope});else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}}):$scope.updateCC.submitted=!0},"company"===$scope.accountType?$scope.getAccountInfo():$scope.getIndividualAccountInfo(),$scope.cancelRedirect=function(){window.location="/sp/admin/account/business"}}angular.module("spApp").controller("processPaymentController",processPaymentController),processPaymentController.$inject=["$scope","$element","$attrs","$http","ngDialog","ajaxService","$localStorage"];
function profileMainController($scope,$timeout,ajaxService,$rootScope,sharedProperties,$localStorage,ngDialog){function updateTab(tab,text,profile){_this.selectedTab=tab,_this.selectedTabText=text,_this.activeProfileSummary=profile,_this.activeProfileContent=profile,_this.mobileMenuShow=!1}function getCurrentUserEmail(){var getProfileDetails,getEmail=!1;return $rootScope.profileReady===!0&&(getProfileDetails=$localStorage.get("loggegdInProfile"),getEmail=getProfileDetails.member.email),getEmail}function getTokenDetails(){var _location=window.location.href,_getToken=_location.split("/"),_token=_getToken[_getToken.length-1];return _this.publicToken=_token,_token}function setOptions(o){var memberEmail=sharedProperties.getParam("email"),candidateEmail=sharedProperties.getParam("cemail"),defaultEmail=getCurrentUserEmail(),_options={};if(_this.publicToken=!1,"publicProfile"===o||"spCertificate"===o){var token=getTokenDetails(),updatedUrl="publicProfile"===o?_this.prismServices.publicProfile:_this.prismServices.spCertificate;"undefined"!=typeof token&&null!==token&&(_this.winWidth<768?(_this.selectedTab=0,_this.mobileHelpLink=!0):_this.selectedTab=8,_options={url:updatedUrl+token},profileStoreCheck(_options,token))}else"undefined"!=typeof memberEmail&&null!==memberEmail?(_options={url:_this.prismServices.member,data:$.param({email:memberEmail})},profileStoreCheck(_options,memberEmail)):"undefined"!=typeof candidateEmail&&null!==candidateEmail?(_options={url:_this.prismServices.candidate,data:$.param({userId:$localStorage.get("candidateID",candidateEmail)})},profileStoreCheck(_options,$localStorage.get("candidateID",candidateEmail))):(_options={url:_this.prismServices.member,data:$.param({email:defaultEmail})},profileStoreCheck(_options,defaultEmail))}function profileStoreCheck(options,id){var storedProfile=$localStorage.get(id);_this.isAnalysisLoaded=!1,_this.prismData=null,_this.prismContent=null,"undefined"!=typeof storedProfile&&null!==storedProfile?(_this.prismData=storedProfile.Analysis,_this.prismContent=storedProfile,_this.showSpProfile="undefined"!=typeof storedProfile.Analysis?!0:!1,_this.personalityVideo1=_this.videos[_this.prismContent["profile.analysis.mapped.Primary.personalityType"].replace(/ /g,"").replace(/&/g,"").toLowerCase()],_this.personalityVideo2=_this.videos[_this.prismContent["profile.analysis.mapped.UnderPressure.personalityType"].replace(/ /g,"").replace(/&/g,"").toLowerCase()],"undefined"!=typeof storedProfile.user&&null!==storedProfile.user&&(_this.userDetails=storedProfile.user),$timeout(function(){_this.isAnalysisLoaded=!0},100),_this.winWidth<768&&_this.updateTab(0,"Personality Profile",0)):getPrismAnalysis(options)}function getPrismAnalysis(options){ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success)_this.analysisError=!1,_this.publicToken!==!1?_this.showSpProfile="undefined"!=typeof response.Analysis?!0:!1:$localStorage.set(options.data.split("=")[1].replace(/%40/g,"@"),response),"undefined"!=typeof response.user&&null!==response.user&&(_this.userDetails=response.user),_this.prismData=response.Analysis,_this.prismContent=response,_this.personalityVideo1=_this.videos[_this.prismContent["profile.analysis.mapped.Primary.personalityType"].replace(/ /g,"").replace(/&/g,"").toLowerCase()],_this.personalityVideo2=_this.videos[_this.prismContent["profile.analysis.mapped.UnderPressure.personalityType"].replace(/ /g,"").replace(/&/g,"").toLowerCase()],$timeout(function(){_this.isAnalysisLoaded=!0},100),_this.winWidth<768&&_this.updateTab(0,"Personality Profile",0,!1,!0,!0);else if(null!==response.error)if(_this.isAnalysisLoaded=!1,_this.publicToken!==!1)window.location.href="/?status=404";else{_this.analysisError=!0;for(var key in response.error)_this.analysisErrorContent=response.error[key]}})}function videoPopUp(url){_this.videoUrl=url,ngDialog.open({template:"/sp/support/videoPopUp",scope:$scope})}function showInfoBoxMobile(t,v){$scope.winScreenHeight=jQuery(window).height()+"px",$scope.infoBoxTab=t;var videoType,videoLink=v;if(/youtube/g.test(videoLink))videoType="youtube";else if(/vimeo/g.test(videoLink)){videoType="vimeo";var link=videoLink.split("?")[0].split("/");videoLink="https://vimeo.com/"+link[parseInt(link.length-1)]}else videoType="html5";$scope.setupVideo=function(){setTimeout(function(){videojs(document.getElementById("vid1"),{autoplay:!1,techOrder:[videoType],src:videoLink},function(){$scope.videoReady=!0})},500)},$scope.videoPlayBtn=function(){jQuery("#vid1")[0].player.play()},ngDialog.open({template:"/sp/resources/html/profile/mobile-info-box.html",scope:$scope})}var _this=this;_this.isAnalysisLoaded=!1,_this.analysisError=!1,_this.publicToken=!1,_this.selectedTab=0,_this.mobileMenuHide=!0,_this.activeProfileSummary=0,_this.activeProfileContent=0,_this.showHelpLink=!1,_this.mobileHelpLink=!1,_this.showSpProfile=!1,_this.setOptions=setOptions,_this.showInfoBoxMobile=showInfoBoxMobile,_this.videoPopUp=videoPopUp,_this.updateTab=updateTab,_this.prismData={},_this.prismContent={},_this.personalityVideo1,_this.personalityVideo2,_this.prismServices={publicProfile:"/sp/profilePublic/",spCertificate:"/sp/spCertificate/",member:"/sp/signedIn/getAnalysisFull",candidate:"/sp/hiring/getAnalysisFull"},_this.videos={scientist:"https://www.youtube.com/watch?v=WJrEKUP0Rys&feature=youtu.be",ambassador:"https://www.youtube.com/watch?v=osIJWk6-m_4&feature=youtu.be",pioneer:"https://www.youtube.com/watch?v=MFQHpCjMx5g&feature=youtu.be",peacemaker:"https://www.youtube.com/watch?v=JOs4j017Sxw&feature=youtu.be",influencer:"https://www.youtube.com/watch?v=kn3E93nATro&feature=youtu.be",strategist:"https://www.youtube.com/watch?v=6jB8YzrIdAc&feature=youtu.be",instructor:"https://www.youtube.com/watch?v=bdMLEK8MxGk&feature=youtu.be",catalyst:"https://www.youtube.com/watch?v=mmT8iYVmd_Y&feature=youtu.be",navigator:"https://www.youtube.com/watch?v=-EVhn_BVhFQ&feature=youtu.be",pragmatist:"https://www.youtube.com/watch?v=a6_FbC2RSKw&feature=youtu.be",connector:"https://www.youtube.com/watch?v=lOSV-AN6al8&feature=youtu.be",architect:"https://www.youtube.com/watch?v=pYrRKr6YCts&feature=youtu.be",ally:"https://www.youtube.com/watch?v=owh4bv73_vk&feature=youtu.be",researcher:"https://www.youtube.com/watch?v=wJtx_x_hlUs&feature=youtu.be",toughtender:"https://www.youtube.com/watch?v=EBKYMYVoSjA&feature=youtu.be",visionary:"https://www.youtube.com/watch?v=l6EV0Q_sKhg&feature=youtu.be"},_this.winWidth=jQuery(window).width(),$scope.videoReady=!1,_this.mobileMenuShow=!1,$rootScope.openPdfView=function(url,_this,profileName){$scope.clickedItem=_this,$scope.sp_profileName=profileName,ngDialog.open({template:url,scope:$scope,className:"ngdialog-theme-default ngdialog-clearBg"})};var isIE=jQuery("html").hasClass("ie")?!0:!1,ieTimer=isIE?2500:1e3;$scope.$on("ngDialog.opened",function(e,$dialog){$scope.nameofUser=$localStorage.get("loggegdInProfile"),$scope.sp_name="undefined"==typeof $scope.sp_profileName||null==$scope.sp_profileName?$scope.nameofUser.member.name:$scope.sp_profileName,$timeout(function(){sharedProperties.printPdfProfile({holder:".printVersion",cssName:"sp-profile-pdf.css",url:"/sp/pdf/generatePdf",extraParam:"SP-Profile-"+$scope.sp_name.replace(" ","-"),obj:$scope.clickedItem})},ieTimer)}),$rootScope.$on("pdfGenerated",function(e,opt){return"object"!=typeof opt.obj?!1:(opt.obj.generatingPdf=!1,$scope.urlRedirect=opt.url,$scope.sp_profileName=null,void $(".ngdialog").removeClass("ngdialog-clearBg"))}),$scope.videoCall=function(){var videoType,videoSrc=_this.videoUrl;if(/youtube/g.test(videoSrc))videoType="youtube";else if(/vimeo/g.test(videoSrc)){videoType="vimeo";var link=videoSrc.split("?")[0].split("/");videoSrc="https://vimeo.com/"+link[parseInt(link.length-1)]}else videoType="html5";setTimeout(function(){videojs(document.getElementById("vid1"),{autoplay:!1,techOrder:[videoType],src:videoSrc},function(){$scope.videoReady=!0,this.on("ended",function(){var vid=this;vid.trigger("loadstart"),$timeout(function(){vid.posterImage.show()},500)}),this.on("timeupdate",function(){var ct=this.currentTime(),timeLeft=this.remainingTime();ct>0&&this.bigPlayButton.hide(),0===timeLeft&&this.bigPlayButton.show()})})},500)}}function showInfoBox($timeout,$rootScope,ngDialog){return{restrict:"A",link:function($scope,$element,$attrs){var _this=jQuery($element[0]),id=_this.attr("data-boxid"),infoBox=jQuery('div[data-box="'+id+'"]'),extraHeight="undefined"!=typeof infoBox.attr("data-extraheight")?!0:!1,autoWidth="undefined"!=typeof infoBox.attr("data-width")?!0:!1,infoBoxP=infoBox.parent();_this.off("click").on("click",function(e){e.preventDefault();var iHeight=jQuery(infoBoxP).outerHeight(),iWidth=jQuery(infoBoxP).outerWidth(),colHeight=jQuery("body").find(".chart-box-cols:first-child").outerHeight(),boxHeights=parseInt(jQuery("body").find(".chart-box-cols.right .motivation-wrapper").outerHeight()+jQuery("body").find(".chart-box-cols.right .decision-making-wrapper").outerHeight());infoBox.css({height:jQuery(window).width()>767&&extraHeight?iHeight+parseInt(colHeight-boxHeights):iHeight,width:autoWidth?"auto":iWidth}).addClass("active-info-box").removeClass("hide")}),jQuery(".ibClose").off("click").on("click",function(e){e.preventDefault();var id=jQuery(this).attr("data-boxid");jQuery('div[data-box="'+id+'"]').addClass("hide").removeClass("active-info-box")}),jQuery(window).resize(function(){if(jQuery(window).width()>767){if(jQuery("body").find(".mobile-infoBox-modal").length){var id1=jQuery("body").find(".mobile-infoBox-modal").parent().parent().attr("id");jQuery("#"+id1).length&&ngDialog.closeAll()}if(jQuery(".active-info-box").length>0){var iHeight=jQuery(infoBoxP).outerHeight(),iWidth=jQuery(infoBoxP).outerWidth(),colHeight=jQuery("body").find(".chart-box-cols:first-child").outerHeight(),boxHeights=parseInt(jQuery("body").find(".chart-box-cols.right .motivation-wrapper").outerHeight()+jQuery("body").find(".chart-box-cols.right .decision-making-wrapper").outerHeight());jQuery(".active-info-box").css({height:jQuery(window).width()>767&&extraHeight?iHeight+parseInt(colHeight-boxHeights):iHeight,width:autoWidth?"auto":iWidth})}}else if(jQuery(".active-info-box").length>0&&jQuery(".active-info-box").addClass("hide").removeClass("active-info-box"),jQuery("body").find(".videoPopDialog").length){var id=jQuery("body").find(".videoPopDialog").parent().parent().attr("id");jQuery("#"+id).length&&ngDialog.closeAll()}})}}}function resizeInfoBoxes($timeout,$rootScope){return{restrict:"A",link:function($scope,$element,$attrs){jQuery(window).width()>767?setTimeout(function(){$rootScope.setBoxSizes(".charbox-wrapper",".chart-box-cols")},50):jQuery("body").find(".chart-box-cols").removeAttr("style"),jQuery(window).resize(function(){jQuery(window).width()>767?setTimeout(function(){$rootScope.setBoxSizes(".charbox-wrapper",".chart-box-cols")},50):jQuery("body").find(".chart-box-cols").removeAttr("style")})}}}function mobileDropdown(){return{restrict:"A",link:function($scope,$element,$attrs){$element.bind("click",function(){$scope.$parent.spProfileCtrl.mobileMenuShow===!1?$scope.$apply(function(){$scope.$parent.spProfileCtrl.mobileMenuShow=!0}):$scope.$apply(function(){$scope.$parent.spProfileCtrl.mobileMenuShow=!1})})}}}angular.module("spApp").controller("profileMainController",profileMainController),profileMainController.$inject=["$scope","$timeout","ajaxService","$rootScope","sharedProperties","$localStorage","ngDialog"],angular.module("spApp").directive("showInfoBox",showInfoBox),showInfoBox.$inject=["$timeout","$rootScope","ngDialog"],angular.module("spApp").directive("resizeInfoBoxes",resizeInfoBoxes),resizeInfoBoxes.$inject=["$timeout","$rootScope"],angular.module("spApp").directive("mobileDropdown",mobileDropdown);
function profileListController($scope,ajaxService,$filter,$state,ngDialog,$timeout,sharedProperties,$rootScope,$localStorage){function getProfileData(){ajaxService.getAjaxResponse({url:vm.config.getProfileData,data:$.param({name:$localStorage.get("groupname")})}).then(function(response){if("true"===response.Success)vm.profileList=response.groupInfo||[],vm.responseRecieved=!0,vm.profileList.memberSummaryList.length&&vm.order(vm.pageSetting.lastPredicate,vm.pageSetting.lastReverse);else if(null!=response.error){vm.responseRecieved=!0;var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function order(predicate,reverse){vm.pageSetting.lastPredicate=predicate,vm.pageSetting.lastReverse=reverse,vm.profileList.memberSummaryList=$filter("orderBy")(vm.profileList.memberSummaryList,vm.pageSetting.lastPredicate,vm.pageSetting.lastReverse)}function callGetAllMembers(){vm.pageSetting.oneTime&&(getAllMembers(),vm.pageSetting.oneTime=!1)}function getAllMembers(){ajaxService.getAjaxResponse({url:vm.config.getAllMembers}).then(function(response){if("true"===response.Success){var allMail=response.memberList;angular.forEach(allMail,function(val,index){(""===allMail[index].firstName&&""===allMail[index].lastName||"undefined"!=typeof vm.profileList.groupLead&&null!==vm.profileList.groupLead&&allMail[index].email===vm.profileList.groupLead.email)&&delete allMail[index]}),allMail=$.grep(allMail,function(n){return n}),vm.fullEmailList=angular.copy(allMail),angular.forEach(vm.profileList.memberSummaryList,function(val,index){for(var i=0;i<allMail.length;i++)val.user.email===allMail[i].email&&allMail.splice(i,1)}),vm.allEmails=angular.copy(allMail)}})}function active(event,setting){vm.pageSetting.lastPredicate=setting.predicate,vm.pageSetting.lastReverse=setting.reverse,sharedProperties.toggleFilterClick(event,vm.pageSetting.lastPredicate),vm.order(vm.pageSetting.lastPredicate,vm.pageSetting.lastReverse)}function assignGroupLead(){vm.callGetAllMembers(),vm.errorNotification.selectGroupLead=!1,ngDialog.open({template:vm.config.groupLeadDialog,scope:$scope})}function assignNewGroup(groupname,groupLeadEmailId){return"undefined"==typeof groupLeadEmailId||""===groupLeadEmailId?(vm.errorNotification.selectGroupLead=!0,!0):void ajaxService.getAjaxResponse({url:vm.config.addMember,data:$.param({name:groupname,memberEmail:groupLeadEmailId,isGroupLead:!0})}).then(function(response){if("true"===response.Success){vm.profileList.groupLead=response.member.user;for(var i=0;i<vm.profileList.memberSummaryList.length;i++)if(vm.profileList.memberSummaryList[i].user.email===response.member.user.email){vm.profileList.memberSummaryList.splice(i,1);break}sharedProperties.spilceIndexWithBreak(vm.allEmails,"email",response.member.user.email),!vm.alltoggle&&(vm.negative=!1,vm.pageSetting.userEmail.email=[]),vm.negative&&vm.checkAll(),ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.group.profile.updateMessage")})}else if(null!=response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function removeGroupLead(){ngDialog.open({template:vm.config.removeGroupLeadDialog,scope:$scope})}function removeGL(groupname,groupMemberEmail){var gEmail=groupMemberEmail;ajaxService.getAjaxResponse({url:vm.config.removeGroupLead,data:$.param({name:groupname,groupLeadEmail:gEmail})}).then(function(response){"true"===response.Success?(vm.pageSetting.oneTime=!0,vm.getProfileData(),vm.callGetAllMembers(),ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.group.profile.removeGroupL")})):null!=response.error&&$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.group.profile.removeGroupLError")})})}function memberTakeAway(email,f){$localStorage.set("memEmail",email),f===!0&&$localStorage.set("spProfileTab",!0),window.location.href="/sp/admin/account/member/details?email="+email}function showFocus(event){var current=$(event.currentTarget).closest(".memprofile").find(".addMemberAnchor");$("html, body").animate({scrollTop:$(current).offset().top-50},"slow")}function actionToClear(){!vm.alltoggle&&(vm.negative=!1,vm.pageSetting.userEmail.email=[]),vm.negative&&vm.checkAll(),$rootScope.$broadcast("handleBroadcast")}function confirmDelete(event,member,groupLead){var email=member.email,eve=angular.element(event.currentTarget);groupLead=groupLead,ajaxService.getAjaxResponse({url:vm.config.removeMember,data:$.param({name:vm.profileList.name,memberEmail:email,isGroupLead:groupLead})}).then(function(response){if("true"===response.Success){if(groupLead)vm.allEmails.push(vm.profileList.groupLead),vm.profileList.groupLead=null;else for(var i=0;i<vm.profileList.memberSummaryList.length;i++)if(vm.profileList.memberSummaryList[i].user.email===email){vm.allEmails.push(vm.profileList.memberSummaryList[i].user),vm.profileList.memberSummaryList.splice(i,1);break}eve.scope().moreadvance=!eve.scope().moreadvance,$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.group.profile.deleteMessage")}),!vm.alltoggle&&(vm.negative=!1,vm.pageSetting.userEmail.email=[]),vm.negative&&vm.checkAll()}else if(null!=response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function certainDelete(){vm.callGetAllMembers(),ngDialog.open({template:vm.config.certainDeleteDialog,scope:$scope})}function deleteUsers(emails){var emailList=[];$.each(emails,function(i,j){emailList.push(emails[i].email)});var options={url:vm.config.removeMember,data:$.param({memberEmail:emailList.toString(),name:vm.profileList.name})};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success){if(emails.length){var copyArea=angular.copy(vm.profileList.memberSummaryList);angular.forEach(vm.profileList.memberSummaryList,function(val,index){for(var i=0;i<emails.length;i++)val.user.email===emails[i].email&&(vm.allEmails.push(vm.profileList.memberSummaryList[index].user),delete copyArea[index])}),vm.profileList.memberSummaryList=$.grep(copyArea,function(n){return n}),"undefined"!=typeof vm.profileList.groupLead&&null!==vm.profileList.groupLead&&-1!==emailList.indexOf(vm.profileList.groupLead.email)&&(vm.allEmails.push(vm.profileList.groupLead),vm.profileList.groupLead=null),ngDialog.close("ngdialog1"),vm.pageSetting.userEmail.email=[],!vm.alltoggle&&(vm.negative=!1,vm.pageSetting.userEmail.email=[]),vm.negative&&vm.checkAll(),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.group.profile.deleteMessage")})}}else if(null!=response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function checkAll(){vm.checkedAll=!vm.checkedAll,vm.negative?(vm.pageSetting.userEmail.email=vm.profileList.memberSummaryList.map(function(item){return{email:item.user.email,name:item.user.name,title:item.user.title}}),vm.profileList.groupLead&&vm.pageSetting.userEmail.email.push({email:vm.profileList.groupLead.email,name:vm.profileList.groupLead.name,title:vm.profileList.groupLead.title})):vm.pageSetting.userEmail.email=[]}function countLead(){return vm.profileList.groupLead?1:0}function renamePopup(){vm.errornewGroup=!1,vm.errornewEmptyGroup=!1,ngDialog.open({template:vm.config.renameGroupDialog,scope:$scope}),vm.newGroupSelector=vm.profileList.name}function renameGroup(savetosave,oldname){return""===savetosave?(vm.errornewEmptyGroup=!0,!0):savetosave===oldname?(ngDialog.close("ngdialog1"),!0):void ajaxService.getAjaxResponse({url:vm.config.updateName,data:$.param({name:savetosave,oldName:oldname})}).then(function(response){"true"===response.Success?(vm.profileList.name=savetosave,$localStorage.set("groupname",savetosave),ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.group.profile.updateGroupNameMessage")})):null!=response.error&&(vm.errornewGroup=!0)})}function deletePopup(){ngDialog.open({template:vm.config.deleteGroupDialog,scope:$scope})}function deleteFullGroup(groupname){ajaxService.getAjaxResponse({url:vm.config.deleteGroup,data:$.param({name:groupname})}).then(function(response){if("true"===response.Success)ngDialog.close("ngdialog1"),$localStorage.remove("groupname"),$state.go("group");else if(null!=response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}function allEmailPop(){var mailtoAll=vm.profileList.memberSummaryList.map(function(item){return{email:item.user.email,name:item.user.name,title:item.user.title}});vm.profileList.groupLead&&mailtoAll.push({email:vm.profileList.groupLead.email,name:vm.profileList.groupLead.name,title:vm.profileList.groupLead.title}),mailtoAll.length&&$rootScope.notificationEmailPoP(mailtoAll)}function checkUncheck(){vm.alltoggle=!1,vm.checkedAll&&(vm.negative=!vm.negative,vm.checkedAll=!vm.checkedAll)}function resetCounter(name,value){vm.pageSetting=angular.copy(vm.originalpageSetting);var curr=$(".profileHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")}var vm=this;vm.profileList=[],vm.fullEmailList=[],vm.allEmails=[],vm.checkedAll=!1,vm.negative=!1,vm.alltoggle=!1,vm.responseRecieved=!1,vm.config={getProfileData:"/sp/admin/group/groupDetails",getAllMembers:"/sp/admin/member",addMember:"/sp/admin/group/addMember",groupLeadDialog:"/sp/admin/group/assignGroupLead",removeGroupLeadDialog:"/sp/admin/group/removeGroupLead",removeGroupLead:"/sp/admin/group/removeGroupLead",removeMember:"/sp/admin/group/removeMember",certainDeleteDialog:"/sp/admin/member/deleteConfirmationGrp",renameGroupDialog:"/sp/admin/group/renameGroup",updateName:"/sp/admin/group/updateName",deleteGroupDialog:"/sp/admin/group/deleteGroup",deleteGroup:"/sp/admin/group/delete"},vm.pageSetting={pageSize:10,intialPageSize:10,userEmail:{email:[]},lastPredicate:"user.name",lastReverse:!1,textSearching:"",disabledInfinite:!1,checkedAll:!1,oneTime:!0},vm.originalpageSetting=angular.copy(vm.pageSetting),vm.errorNotification={errornewGroup:!1,errornewEmptyGroup:!1,selectGroupLead:!1},vm.getProfileData=getProfileData,vm.order=order,vm.callGetAllMembers=callGetAllMembers,vm.active=active,vm.assignGroupLead=assignGroupLead,vm.assignNewGroup=assignNewGroup,vm.removeGroupLead=removeGroupLead,vm.removeGL=removeGL,vm.memberTakeAway=memberTakeAway,vm.showFocus=showFocus,vm.confirmDelete=confirmDelete,vm.certainDelete=certainDelete,vm.renamePopup=renamePopup,vm.deletePopup=deletePopup,vm.deleteUsers=deleteUsers,vm.actionToClear=actionToClear,vm.checkAll=checkAll,vm.countLead=countLead,vm.renameGroup=renameGroup,vm.deleteFullGroup=deleteFullGroup,vm.allEmailPop=allEmailPop,vm.checkUncheck=checkUncheck,vm.resetCounter=resetCounter,function(){null!==$localStorage.get("spProfileTab")&&$localStorage.remove("spProfileTab")}()}angular.module("spApp").controller("profileListController",profileListController),profileListController.$inject=["$scope","ajaxService","$filter","$state","ngDialog","$timeout","sharedProperties","$rootScope","$localStorage"];
function pulseDetailsController($scope,$element,$attrs,ngDialog,$timeout,sharedProperties,ajaxService,$rootScope,$localStorage,FileUploader,$filter){$scope.accountsListException=!1,$scope.updatedAccountListing=[],$scope.selectedAccountsCount=0,$scope.updatedListingIndex=0,$scope.accountList={},$scope.selectedCompanyIdList=[],$scope.allAccountsIdList=[],$scope.getDetailsException=!1,$scope.createNewPulse={},$scope.newPulse={},$scope.pulseEditing={},$scope.pulseEditing.status=!1,$scope.pulseIdStatus=!1,$scope.selectedAccountsDisplayList=[],$scope.showAccountsDisplayList=!1,$scope.pulseEnableEdit=function(s){"enable"===s?$scope.pulseEditing.status=!0:($scope.pulseEditing.status=!1,$scope.getPulseDetailsWithId()),$scope.accountList.search=null},$scope.getAccountList=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/hk/getCompanyList",method:"GET"}).then(function(response){if("true"===response.Success)$scope.accountsListException=!1,$scope.accountListing=response.companies,jQuery.each($scope.accountListing,function(i,j){$scope.updatedAccountListing.push(jQuery.extend({},$scope.accountListing[i],{accountSelectedStatus:!1})),$scope.allAccountsIdList.push($scope.accountListing[i].id)});else{$scope.accountsListException=!0;for(var key in response.error)$scope.accountsListExceptionMsg=response.error[key]}})},$scope.addtoSelectedAccounts=function(id){jQuery.each($scope.updatedAccountListing,function(i){return $scope.updatedAccountListing[i].id===id?($scope.updatedAccountListing[i].accountSelectedStatus=!0,$scope.selectedAccountsCount+=1,$scope.selectedCompanyIdList.push($scope.updatedAccountListing[i].id),$scope.updatedAccountListing[i].updatedListingIndex=$scope.updatedListingIndex++,!1):void 0})},$scope.removeFromSelectedAccounts=function(id){jQuery.each($scope.updatedAccountListing,function(i){return $scope.updatedAccountListing[i].id===id?($scope.updatedAccountListing[i].accountSelectedStatus=!1,$scope.selectedAccountsCount-=1,$scope.selectedCompanyIdList.splice($scope.selectedCompanyIdList.indexOf(id),1),!1):void 0})},$scope.removeAllSelectedAccounts=function(){jQuery.each($scope.updatedAccountListing,function(i){$scope.updatedAccountListing[i].accountSelectedStatus=!1,$scope.updatedAccountListing[i].updatedListingIndex=null}),$scope.selectedAccountsCount=0,$scope.selectedCompanyIdList=[]},$scope.addFilteredAccounts=function(){var selectedList=$filter("filter")($scope.updatedAccountListing,$scope.accountList.search);jQuery.each(selectedList,function(i){jQuery.each($scope.updatedAccountListing,function(j){selectedList[i].id===$scope.updatedAccountListing[j].id&&($scope.updatedAccountListing[j].accountSelectedStatus=!0,$scope.selectedAccountsCount+=1,$scope.selectedCompanyIdList.push($scope.updatedAccountListing[j].id),$scope.updatedAccountListing[j].updatedListingIndex=$scope.updatedListingIndex++)})}),$scope.accountList.search=null},$scope.getPulseId=function(){var url=window.location.href,splitUrl=url.split("?")[1];"undefined"!=typeof splitUrl?($scope.urlPulseId=splitUrl.split("=")[1],$timeout(function(){$scope.pulseIdStatus=!0},100)):($scope.urlPulseId=null,$timeout(function(){$scope.pulseIdStatus=!1},100))},$scope.getPulseDetailsWithId=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/pulse/getDetails",data:$.param({pulseQuestionSetId:$scope.urlPulseId})}).then(function(response){if("true"===response.Success){$scope.showAccountsDisplayList=!1,$scope.getDetailsException=!1,$scope.pulseDetails=response.pulseQuestion,$scope.pulseNameDisplay=$scope.pulseDetails.name,$scope.newPulse.name=$scope.pulseNameDisplay,$scope.newPulse.questionSetType=$scope.pulseDetails.questionSetType;var loopCount=0;$scope.pulseDetails.forAll===!1?($scope.selectedAccountsCount=0,$scope.selectedCompanyIdList=[],$scope.selectedAccountsDisplayList=[],$scope.newPulse.assignAccounts="Selected",jQuery.each($scope.pulseDetails.companyId,function(i){jQuery.each($scope.updatedAccountListing,function(j){$scope.pulseDetails.companyId[i]===$scope.updatedAccountListing[j].id&&($scope.updatedAccountListing[j].accountSelectedStatus=!0,$scope.selectedAccountsCount+=1,$scope.selectedCompanyIdList.push($scope.updatedAccountListing[j].id),$scope.updatedAccountListing[j].updatedListingIndex=$scope.updatedListingIndex++,$scope.selectedAccountsDisplayList.push($scope.updatedAccountListing[j]))}),loopCount++}),loopCount===$scope.pulseDetails.companyId.length&&($scope.showAccountsDisplayList=!0)):$scope.newPulse.assignAccounts="All"}else{$scope.pulseNameDisplay=null,$scope.getDetailsException=!0;for(var key in response.error)$scope.getDetailsExceptionMsg=response.error[key]}})},$scope.updateThisPulse=function(fData){var _params;"All"===fData.assignAccounts?($scope.accList=$scope.allAccountsIdList,_params={name:fData.name,pulseQuestionSetId:$scope.urlPulseId,type:fData.questionSetType,isForAll:!0}):($scope.accList=$scope.selectedCompanyIdList,_params={name:fData.name,pulseQuestionSetId:$scope.urlPulseId,type:fData.questionSetType,companyIds:$scope.accList.join(),isForAll:!1}),this.createNewPulse.$valid&&$scope.accList.length>0?ajaxService.getAjaxResponse({url:"/sp/sysAdmin/pulse/update",data:$.param(_params)}).then(function(response){if("true"===response.Success)$scope.updatePulseException=!1,$scope.pulseEnableEdit(),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Details</strong>",message:" updated successfully"});else{$scope.updatePulseException=!1;for(var key in response.error)$scope.updatePulseExceptionMsg=response.error[key]}}):$scope.createNewPulse.validationErrors=!0},$scope.pulseJsonDownload=function(){setTimeout(function(){window.location="/sp/sysAdmin/pulse/downloadJson?pulseQuestionSetId="+$scope.urlPulseId},100)},$scope.defaultPulse=function(_this){$scope.noChart($scope.pulseDrop,$scope.defaultPulseName)},$scope.increment=function(){return $scope.defaultPulseName++,!0},$scope.decrement=function(){return $scope.defaultPulseName--,!0},$scope.questionSet=function(){"questions"in $scope.questionList&&($scope.mapQuestionObject=$scope.questionList.questions[$scope.activePulse])},$scope.noChart=function(arrayList,index){arrayList.length&&$scope.noChartPulse(arrayList[index])},$scope.noChartPulse=function(keyName){$scope.activePulse=keyName,$scope.mapQuestionObject=$scope.questionList.questions[keyName]},$scope.pulsePreview=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/pulse/previewJson?pulseQuestionSetId="+$scope.urlPulseId,method:"GET"}).then(function(response){response&&($scope.questionList=response.pulseQuestionSetPreview,$scope.questionSet(),$scope.pulseDrop=$scope.questionList.categoryKeys,$timeout(function(){$scope.defaultPulseName=0},0),$scope.noChart($scope.pulseDrop,0),ngDialog.open({template:"/sp/resources/html/sysAdmin/pulse/pulse-preview.html",scope:$scope}))})},function(){$scope.getPulseId(),$scope.getAccountList(),$scope.getPulseDetailsWithId()}()}angular.module("spApp").controller("pulseDetailsController",pulseDetailsController),pulseDetailsController.$inject=["$scope","$element","$attrs","ngDialog","$timeout","sharedProperties","ajaxService","$rootScope","$localStorage","FileUploader","$filter"];
function pulseListingController($scope,$q,$element,$attrs,ajaxService,$location,$http,$state,$filter,ngDialog,sharedProperties,$timeout,$rootScope,$localStorage){$scope.pulseMasterList=[],$scope.getAllError=!1,$scope.searchTag=[],$scope.pageSize=10,$scope.statusInclude=[],$scope.textSearching="",$scope.intialPageSize=10,$scope.load=!0,$scope.formatMonth=function(d){if(null!==d&&"undefined"!=typeof d){var splitDate=d.split(" "),formatMonth=splitDate[0].substr(0,3).toUpperCase(),formattedDate=formatMonth+" "+splitDate[1]+" "+splitDate[2];return formattedDate}},$scope.getNewPulseList=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/pulse/getAll"}).then(function(response){if("true"===response.Success)$scope.getAllError=!1,$scope.pulseMasterList=response.pulseQuestion,$scope.returnMemberList($scope.pageSize);else{$scope.getAllError=!0;for(var key in response.error)$scope.getAllErrorMsg=response.error[key]}})},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.returnMemberList($scope.pageSize)},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize))},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.returnMemberList=function(pageSize){if(!$scope.pulseMasterList.length)return!0;if($scope.searchTag.length&&!$scope.statusInclude.length&&($scope.pulseList=angular.copy($scope.newArr)),$scope.searchTag.length&&$scope.statusInclude.length){$scope.combineArray=[];for(var i=0;i<$scope.newArr.length;i++)for(var j=0;j<$scope.checkBox.length;j++)$scope.newArr[i].email===$scope.checkBox[j].email&&$scope.combineArray.push($scope.newArr[i]);$scope.pulseList=angular.copy($scope.combineArray)}!$scope.searchTag.length&&$scope.statusInclude.length&&($scope.pulseList=angular.copy($scope.checkBox)),$scope.searchTag.length||$scope.statusInclude.length||($scope.pulseList=angular.copy($scope.pulseMasterList)),$scope.pageSize=pageSize,pageSize>=$scope.pulseMasterList.length&&($scope.disabledInfinite=!0,$scope.pageSize=$scope.pulseMasterList.length),$scope.load&&($scope.lastPredicate="name",$scope.lastReverse=!1,$scope.loadBtnCLicked=!1,$scope.load=!1),$scope.loadBtnCLicked&&($scope.loadBtnCLicked=!1),$scope.order($scope.lastPredicate,$scope.lastReverse),$scope.pulseList=$scope.pulseList},$scope.active=function(event){var currentElem=$(event.currentTarget);currentElem.find("h4").hasClass("on")?currentElem.find("h4").hasClass("reverseon")?currentElem.find("h4").removeClass("reverseon"):currentElem.find("h4").addClass("reverseon"):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"))},$scope.order=function(predicate,reverse){$scope.lastPredicate=predicate,$scope.lastReverse=reverse,$scope.pulseList=$filter("orderBy")($scope.pulseList,predicate,reverse)},$scope.resetfilter=function(allmembers){$scope.pageSize=$scope.intialPageSize,$scope.newArr=[],$scope.searchTag=[],$scope.tags=[],$scope.filter={},$scope.statusInclude=[],$scope.adminc=!1,$scope.leadC=!1,$scope.textSearching="",$scope.searchText="","undefined"!=typeof this.selectedSearch&&(this.selectedSearch.userStatusFormatted="",this.selectedSearch.hiringRoles=""),$scope.pulseList=angular.copy($scope.pulseMasterList),"undefined"!=typeof allmembers&&($scope.pageSize=$scope.pulseMasterList.length),angular.element($(".tags").find("input")).scope().newTag.text="",$scope.load=!0,$scope.disabledInfinite=!1,$rootScope.$broadcast("$scrollStart"),$scope.returnMemberList($scope.pageSize);var curr=$(".memberHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")},$scope.updateStatusError=!1,$scope.updatePulseStatus=function(status,pid){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/pulse/updateStatus",data:$.param({pulseQuestionSetId:pid,status:status})}).then(function(response){if("true"===response.Success)$scope.updateStatusError=!1,ngDialog.close("ngdialog1"),$scope.getNewPulseList(),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Status</strong>",message:" updated successfully"});else{$scope.updateStatusError=!0;for(var key in response.error)$scope.updateStatusErrorMsg=response.error[key];ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.updateStatusErrorMsg})}})},$scope.deleteConfirm=function(d){$scope.afid=d,ngDialog.open({template:"/sp/resources/html/sysAdmin/pulse/deleteConfirmation.html",scope:$scope})},function(){var growlNotification=$localStorage.get("gNotify");null!==growlNotification&&"undefined"!=typeof growlNotification&&("AddPulse"===growlNotification&&$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Pulse</strong>",message:" created successfully"}),setTimeout(function(){$localStorage.remove("gNotify")},1e3)),$scope.getNewPulseList()}()}angular.module("spApp").controller("pulseListingController",pulseListingController),pulseListingController.$inject=["$scope","$q","$element","$attrs","ajaxService","$location","$http","$state","$filter","ngDialog","sharedProperties","$timeout","$rootScope","$localStorage"];
function pulseController($scope,ajaxService,ngDialog,sharedProperties,$rootScope,$localStorage,$timeout){function getPulseRequest(pulseResultId){ajaxService.getAjaxResponse({url:vm.config.getPulseRequest}).then(function(response){if("true"===response.Success)if(vm.getPulseRequestResponse=response.pulseResults,vm.pulseNameIdMap=response.question,vm.showDefault=vm.getPulseRequestResponse.length?!0:!1,vm.showDefault){for(var i=0;i<vm.getPulseRequestResponse.length;i++)for(var j=0;j<vm.pulseNameIdMap.length;j++)if(vm.pulseNameIdMap[j].id===vm.getPulseRequestResponse[i].pulseQuestionSetId){var index=vm.executingPulseDropDown.indexOf(vm.pulseNameIdMap[j].name);-1!==index?vm.pulseRequestResponse[vm.pulseNameIdMap[j].name].push(vm.getPulseRequestResponse[i]):(vm.executingPulseDropDown.push(vm.pulseNameIdMap[j].name),vm.pulseRequestResponse[vm.pulseNameIdMap[j].name]=[],vm.pulseRequestResponse[vm.pulseNameIdMap[j].name].push(vm.getPulseRequestResponse[i])),!vm.startingPointFound&&vm.getPulseRequestResponse[i].inProgress&&(vm.startingPointFound=!0,vm.objectIndex=vm.pulseNameIdMap[j].name,vm.inProgressObject.push(vm.objectIndex),vm.inProgressObject.push(vm.getPulseRequestResponse[i].id))}if(!vm.objectIndex)for(var z=0;z<vm.pulseNameIdMap.length;z++)vm.pulseNameIdMap[z].id===vm.getPulseRequestResponse[0].pulseQuestionSetId&&(vm.objectIndex=vm.pulseNameIdMap[z].name);vm.questionSetStackquestionSetStack=vm.objectIndex,vm.defaultQuestionSetSelected(vm.objectIndex),createDateDropDown(),vm.getGroupData(),createSubsetRecord(vm.objectIndex,"false")}else vm.getQuestionsSet(createNewPulseQuestionSet);else if(null!=response.error){for(var key in response.error)vm.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:vm.errorMessage})}})}function createDateDropDown(){vm.dateList=[],vm.storeAllIndex=[];for(var i=0;i<vm.pulseRequestResponse[vm.objectIndex].length;i++)vm.dateList.push(vm.pulseRequestResponse[vm.objectIndex][i]),vm.storeAllIndex.push(vm.pulseRequestResponse[vm.objectIndex][i].id);$timeout(function(){vm.groupCollector=0,vm.selectedDate=vm.dateList[0].id},0)}function getGroupData(){return vm.groupName.length?!0:void ajaxService.getAjaxResponse({url:vm.config.getGroupData}).then(function(response){"true"===response.Success&&(vm.groupName=response.groupInfoList.length?vm.createGroupName(response.groupInfoList):["All Groups"])})}function createSubsetRecord(index,result){var groupName="";0!==vm.groupIndex&&(groupName=vm.groupName[vm.groupIndex]),"undefined"!=typeof result&&"false"===result?(vm.subsetRecord=null===vm.pulseRequestResponse[index][vm.dateIndex].pulseScore?vm.fetchResult(vm.pulseRequestResponse[index][vm.dateIndex].id,groupName,index):vm.pulseRequestResponse[index][vm.dateIndex].pulseScore,null!=vm.subsetRecord&&getMapResult(vm.subsetRecord,0)):"undefined"!=typeof result&&"true"===result&&(vm.subsetRecord=vm.fetchResult(vm.pulseRequestResponse[index][vm.dateIndex].id,groupName,index))}function getQuestionsSet(fn){ajaxService.getAjaxResponse({url:vm.config.getQuestionsSet}).then(function(response){if("true"===response.Success)vm.questionSetStack=response.pulseQuestion,null!==fn&&"function"==typeof fn&&fn();else if(null!=response.error){for(var key in response.error)vm.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:vm.errorMessage})}})}function fetchResult(pulseResultId,groupName,index){ajaxService.getAjaxResponse({url:vm.config.fetchResult,data:$.param({pulseResultId:pulseResultId,groupName:"All Groups"===groupName?"":groupName})}).then(function(response){if("true"===response.Success){if(""!==groupName)for(var i=0;i<vm.pulseRequestResponse[index].length;i++)vm.dateIndex!==i&&(vm.pulseRequestResponse[index][i].pulseScore=null);vm.pulseRequestResponse[index][vm.dateIndex].pulseScore=response.pulseResults.pulseScore,vm.pulseRequestResponse[index][vm.dateIndex].numberOfRespondents=response.pulseResults.numberOfRespondents,vm.pulseRequestResponse[index][vm.dateIndex].numberOfMembers=response.pulseResults.numberOfMembers,vm.subsetRecord=vm.pulseRequestResponse[index][vm.dateIndex].pulseScore,getMapResult(vm.subsetRecord,0)}else if(null!=response.error){for(var key in response.error)vm.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:vm.errorMessage})}})}function createNewPulseQuestionSet(){vm.questionSetStackquestionSetStack=vm.questionSetStack[0].name,vm.defaultQuestionSetSelected(vm.questionSetStackquestionSetStack)}function resetToInProgress(){vm.dateIndex=0,vm.groupIndex=0,vm.objectIndex=vm.inProgressObject[0],vm.questionSetStackquestionSetStack=vm.objectIndex,vm.defaultQuestionSetSelected(vm.objectIndex),createDateDropDown(),vm.getGroupData(),createSubsetRecord(vm.objectIndex,"false")}function preChangeMode(){vm.questionSetStack.length?changeMode():vm.getQuestionsSet(changeMode)}function changeMode(){vm.showDefault=!1,vm.defaultQuestionSetSelected(vm.questionSetStack[0].id),vm.questionSetStackquestionSetStack=vm.questionSetStack[0],vm.defaultDropIndex=0,vm.inviteError=!1}function resultMode(){vm.showDefault=!0,vm.questionSetStackquestionSetStack=vm.objectIndex,vm.questionDropChanged()}function createGroupName(list){vm.groupName=["All Groups"];for(var i=0;i<list.length;i++)vm.groupName.push(list[i].name);return vm.groupName}function defaultQuestionSetSelected(questionSet,index){if(vm.getQuestions(questionSet),"undefined"!=typeof index)for(var i=0;i<vm.questionSetStack.length;i++)if(vm.questionSetStack[i].id===questionSet.id){vm.defaultDropIndex=i;break}}function getQuestions(parameter){vm.questionList=[];var param=vm.showDefault===!0?vm.pulseRequestResponse[vm.objectIndex][vm.dateIndex].pulseQuestionSetId:parameter.id;ajaxService.getAjaxResponse({url:vm.config.getQuestions,data:$.param({pulseQuestionSetId:param})}).then(function(response){if("true"===response.Success)vm.questionList=response.pulseQuestion,vm.questionSet(),vm.showDefault||(vm.pulseDrop=vm.questionList.categoryKeys,$timeout(function(){vm.defaultPulseName=0},0),noChart(vm.pulseDrop,0));else if(null!=response.error){for(var key in response.error)vm.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:vm.errorMessage})}})}function noChart(arrayList,index){arrayList.length&&(vm.activePulse=arrayList[index],vm.mapQuestionObject=vm.questionList.questions[arrayList[index]])}function increment(){return vm.defaultPulseName++,!0}function decrement(){return vm.defaultPulseName--,!0}function defaultPulse(_this){noChart(vm.pulseDrop,vm.defaultPulseName)}function questionSet(){"questions"in vm.questionList&&(vm.mapQuestionObject=vm.questionList.questions[vm.activePulse])}function getMapResult(arrayList,index){vm.kyz=Object.keys(arrayList),vm.kyz.length&&vm.mapResponse(vm.kyz[index])}function mapResponse(keyName,index){keyName in vm.subsetRecord&&(vm.activePulse=keyName,vm.mapResponseObject=vm.subsetRecord[keyName]);var obj=$(".overall-score-list").find("li:eq("+index+")");$(".overall-score-list").find("li").removeClass("active"),obj.length?$(".overall-score-list").find("li:eq("+index+")").addClass("active"):$(".overall-score-list").find("li:eq(0)").addClass("active"),vm.questionSet()}function dateChanged(_this){vm.dateIndex=vm.storeAllIndex.indexOf(this.selectedDate),createSubsetRecord(vm.objectIndex,"false")}function groupChanged(_this){vm.groupIndex=this.groupCollector,createSubsetRecord(vm.objectIndex,"true")}function questionSetChanged(){vm.objectIndex=vm.questionSetStackquestionSetStack,vm.questionDropChanged()}function questionDropChanged(){vm.dateIndex=0,vm.groupIndex=0,vm.defaultQuestionSetSelected(vm.objectIndex),createDateDropDown(),vm.getGroupData(),createSubsetRecord(vm.objectIndex,"false")}function notSorted(obj){return obj?Object.keys(obj):[]}function startNewPulsePop(){ngDialog.open({template:vm.config.startNewPulsePopDialog,scope:$scope})}function startPulseFormSubmit(form){form.$valid?ajaxService.getAjaxResponse({url:vm.config.startPulseFormSubmit,data:$.param({pulseQuestionSetId:form.pulse_category_questionsSet.$viewValue.id,startDate:form.startDate.$viewValue,endDate:form.endDate.$viewValue})}).then(function(response){if("true"===response.Success)window.location.reload();else if(null!=response.error){for(var key in response.error)vm.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:vm.errorMessage})}}):vm.inviteError=!0}function cancelPulse(pulseRequestId,save){ajaxService.getAjaxResponse({url:vm.config.cancelPulse,data:$.param({pulseRequestId:pulseRequestId,saveResults:save})}).then(function(response){if("true"===response.Success)window.location.reload();else if(null!=response.error){ngDialog.close("ngdialog1");for(var key in response.error)vm.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:vm.errorMessage})}})}function sendReminderPop(idToPass){vm.idToPass=idToPass,ngDialog.open({template:vm.config.pulseReminderDialog,scope:$scope})}function cancelPop(idToCancel){vm.idToCancel=idToCancel,ngDialog.open({template:vm.config.cancelSpDilaog,scope:$scope})}function pulseSendReminder(pulseRequestId){ajaxService.getAjaxResponse({url:vm.config.pulseSendReminder,data:$.param({pulseRequestId:pulseRequestId})}).then(function(response){if("true"===response.Success)ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ban-circle",message:"Sent Successfully"});else if(null!=response.error){ngDialog.close("ngdialog1");for(var key in response.error)vm.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:vm.errorMessage})}})}function seletedPulseName(){for(var i=0;i<vm.questionSetStack.length;i++)if(vm.questionSetStack[i].id===vm.questionSetStackquestionSetStack)return vm.questionSetStack[i].name}var vm=this;vm.getPulseRequestResponse=[],vm.dateList=[],vm.kyz=[],vm.mapQuestionObject=[],vm.subsetRecord="",vm.activePulse="",vm.lastGroup="",vm.dateIndex=0,vm.groupIndex=0,vm.objectIndex=0,vm.groupName=[],vm.inviteError=!1,vm.hideStart=!1,vm.questionSetStack=[],vm.selectedDate="",vm.groupCollector="";var d=new Date;vm.fromDate=new Date,vm.endDate=d.setDate(d.getDate()+1),vm.maxDate=d.setDate(d.getDate()+14),vm.executingPulseDropDown=[],vm.startingPointFound=!1,vm.pulseRequestResponse={},vm.defaultDropIndex=0,vm.inProgressObject=[],vm.config={getPulseRequest:"/sp/pulse/getRequests",getGroupData:"/sp/admin/group/all",getQuestionsSet:"/sp/pulse/getQuestionSets",fetchResult:"/sp/pulse/getScore",getQuestions:"/sp/pulse/getQuestions",startNewPulsePopDialog:"/sp/pulse/startNewPulse",startPulseFormSubmit:"/sp/pulse/start",cancelPulse:"/sp/pulse/cancelPulse",pulseReminderDialog:"/sp/pulse/pulseReminder",cancelSpDilaog:"/sp/pulse/cancelSP",pulseSendReminder:"/sp/pulse/sendReminder"},vm.getPulseRequest=getPulseRequest,vm.getGroupData=getGroupData,vm.getQuestionsSet=getQuestionsSet,vm.fetchResult=fetchResult,vm.resetToInProgress=resetToInProgress,vm.preChangeMode=preChangeMode,vm.resultMode=resultMode,vm.createGroupName=createGroupName,vm.defaultQuestionSetSelected=defaultQuestionSetSelected,vm.getQuestions=getQuestions,vm.increment=increment,vm.decrement=decrement,vm.defaultPulse=defaultPulse,vm.questionSet=questionSet,vm.mapResponse=mapResponse,vm.dateChanged=dateChanged,vm.groupChanged=groupChanged,vm.questionSetChanged=questionSetChanged,vm.questionDropChanged=questionDropChanged,vm.notSorted=notSorted,vm.startNewPulsePop=startNewPulsePop,vm.startPulseFormSubmit=startPulseFormSubmit,vm.cancelPulse=cancelPulse,vm.sendReminderPop=sendReminderPop,vm.cancelPop=cancelPop,vm.pulseSendReminder=pulseSendReminder,vm.seletedPulseName=seletedPulseName}function pulseQuestionController($scope,ajaxService,sharedProperties,$localStorage){function startQuestion(){ajaxService.getAjaxResponse({url:vm.config.startQuestion,data:$.param({pulseRequestId:sharedProperties.getParam("pulseRequestId")})}).then(function(response){"true"===response.Success?(vm.getQuestion=response.pulseQuestion,vm.categoryQuestion=Object.keys(vm.getQuestion.questions),vm.createQuestionSet()):null!=response.error&&(window.location.href="/sp/linkExpired")})}function createQuestionSet(){vm.questionSet=vm.getAllQuestionSet(vm.getQuestion.questions),vm.createSetsToDisplay(vm.questionSet,vm.getQuestion.questions)}function getAllQuestionSet(arrayList){return Object.keys(arrayList)}function createSetsToDisplay(keyName,arrayList){vm.createSubset=[];for(var i=0;i<keyName.length;i++)if(keyName[i]in arrayList)if(arrayList[keyName[i]].length>vm.questionMaxSize)vm.spliceArray(arrayList[keyName[i]],vm.questionMaxSize,keyName[i]);else{var ans=vm.createAnswerSheet(arrayList[keyName[i]].length);vm.createSubset.push({name:keyName[i],result:arrayList[keyName[i]],answer:ans,sectionNumber:vm.categoryQuestion.indexOf(keyName[i])+1,lengthQuestion:""}),vm.keyNameToPrint.push(keyName[i])}vm.startRepeat=angular.copy(vm.createSubset)}function createAnswerSheet(size){for(var tempArray=[],i=0;size>i;i++)tempArray.push(null);return tempArray}function inputStyleCheck(searchIndex,answerValue,answerIndex){if(vm.startRepeat[searchIndex].answer[answerIndex]=answerValue,"undefined"!=typeof vm.errorScope&&vm.errorScope.length)for(var _this=$(".pulse-question-list"),i=0;i<vm.errorScope.length;i++)null!=vm.startRepeat[vm.currentIndex].answer[vm.errorScope[i]]&&_this.find("li.realState:eq("+vm.errorScope[i]+")").removeClass("showError")}function spliceArray(arrayList,spliceIndex,keyName){for(var i=0;i<arrayList.length;i+=spliceIndex){vm.temparray=arrayList.slice(i,i+spliceIndex);var ans=vm.createAnswerSheet(vm.temparray.length);vm.createSubset.push({name:keyName,lengthQuestion:"",result:vm.temparray,answer:ans,sectionNumber:vm.categoryQuestion.indexOf(keyName)+1,subSection:Math.floor(i/vm.questionMaxSize)+1,total:Math.ceil(arrayList.length/vm.questionMaxSize)}),vm.keyNameToPrint.push(keyName)}}function setIndex(currentIndex,argument,status){if(status){var loop=vm.startRepeat[currentIndex].answer;vm.errorScope=[];for(var i=0;i<loop.length;i++)null===loop[i]&&vm.errorScope.push(i);vm.errorScope.length?vm.showError(vm.errorScope,currentIndex):vm.currentIndex=argument}else vm.currentIndex=argument}function showError(errorArrayIndex,currentvalue){var _this=$(".pulse-question-list");_this.find("li.realState").removeClass("showError");for(var i=0;i<errorArrayIndex.length;i++)_this.find("li.realState:eq("+errorArrayIndex[i]+")").addClass("showError")}function isItChecked(currentIndex,index,row){var checkUncheck=vm.startRepeat[currentIndex].answer[row];return null!=checkUncheck&&checkUncheck===index?!0:!1}function submitRequest(currentIndex){var loop=vm.startRepeat[currentIndex].answer;vm.errorScope=[];for(var i=0;i<loop.length;i++)null===loop[i]&&vm.errorScope.push(i);vm.errorScope.length?vm.showError(vm.errorScope,currentIndex):vm.callSubmit()}function callSubmit(){vm.clubResult=[];for(var i=0;i<vm.startRepeat.length;i++)vm.isItAlreadyInArray(vm.clubResult,vm.startRepeat[i])&&vm.clubResult.push({categoryName:vm.startRepeat[i].name,questionSelectionIndex:vm.startRepeat[i].answer});ajaxService.getAjaxResponse({url:vm.config.callSubmit,data:vm.clubResult,headers:{"Content-Type":"application/json"}}).then(function(response){if("true"===response.Success)$localStorage.set("pulseDone","true"),window.location.href="/sp";else if(null!=response.error){for(var key in response.error)vm.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:vm.errorMessage})}})}function isItAlreadyInArray(clubResult,returnResult){if(clubResult.length){for(var i=0;i<clubResult.length;i++)if(returnResult.name===clubResult[i].categoryName)return vm.clubResult[i].questionSelectionIndex=vm.clubResult[i].questionSelectionIndex.concat(returnResult.answer),!1;return!0}return!0}var vm=this;vm.getQuestion=[],vm.currentIndex=0,vm.questionMaxSize=5,vm.keyNameToPrint=[],vm.clubResult=[],vm.config={startQuestion:"/sp/pulse/getQuestions",callSubmit:"/sp/pulseUser/saveAssessment?pulseRequestId="+sharedProperties.getParam("pulseRequestId")},vm.startQuestion=startQuestion,vm.createQuestionSet=createQuestionSet,vm.getAllQuestionSet=getAllQuestionSet,vm.createSetsToDisplay=createSetsToDisplay,vm.createAnswerSheet=createAnswerSheet,vm.inputStyleCheck=inputStyleCheck,vm.spliceArray=spliceArray,vm.setIndex=setIndex,vm.showError=showError,vm.isItChecked=isItChecked,vm.submitRequest=submitRequest,vm.callSubmit=callSubmit,vm.isItAlreadyInArray=isItAlreadyInArray}angular.module("spApp").controller("pulseController",pulseController),angular.module("spApp").controller("pulseQuestionController",pulseQuestionController),pulseController.$inject=["$scope","ajaxService","ngDialog","sharedProperties","$rootScope","$localStorage","$timeout"],pulseQuestionController.$inject=["$scope","ajaxService","sharedProperties","$localStorage"];
function relationshipManagerController($scope,$element,$attrs,$http,$timeout,ajaxService,$rootScope,$localStorage,ngDialog){$scope.selectedCandidate={},$scope.memberMasterList={},$scope.validMemberList=[],$scope.candidateMasterList={},$scope.validCandidateList=[],$scope.selectedMemberDetails={},$scope.candidateProfileDetails={},$scope.memberProfileDetails={},$scope.candidateAdvise={},$scope.memberAdvise={},$scope.candidateAvoidFormatted=[],$scope.resultTabs={},$scope.personalityFlags=[],$scope.cachedAdvisorData=[],$scope.showMemberListingWidget={},$scope.selectedMember={},$scope.selectedMember.left={},$scope.selectedMember.right={},$scope.showMemberListingWidget.right=!1,$scope.showMemberListingWidget.left=!1,$scope.memberSelected={},$scope.memberSelected.right=!1,$scope.memberSelected.left=!1,$scope.showContent=!1,$scope.resultTabs.leftSelected=0,$scope.resultTabs.rightSelected=0,$scope.serverException=!1,$scope.mobileControls={},$scope.mobileControls.display=!1,$scope.memberCountException=!1,$scope.sResizeFlag=0,$scope.lResizeFlag=0,$scope.viewMode={list:!0,chart:!1},$scope.cachedUSerEmails=null,$scope.matchPercent={},$scope.matchPercent.primary=!0,$scope.switchToUser1=!0,$scope.winWidth=jQuery(window).width(),jQuery(window).resize(function(){$scope.winWidth=jQuery(window).width()}),$scope.getAllMemberDetails=function(){ajaxService.getAjaxResponse({url:"/sp/relationship/getMembers"}).then(function(response){if("true"===response.Success)$scope.serverException=!1,$scope.memberMasterList=response.memberList,$scope.memberMasterList.length>1?($scope.memberCountException=!1,jQuery.each($scope.memberMasterList,function(i,j){var newList=jQuery.extend({},$scope.memberMasterList[i],{selectedMember:!1,selectedSide:{left:!1,right:!1}});$scope.validMemberList.push(newList)})):$scope.memberCountException=!0;else{$scope.compareToolReset(),$scope.serverException=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.showDropdownWidget=function(side){"right"===side?($scope.showMemberListingWidget.right=!$scope.showMemberListingWidget.right,$scope.showMemberListingWidget.left=!1,$timeout(function(){jQuery(window).width()<768&&jQuery("html, body").animate({scrollTop:325})},300)):($scope.showMemberListingWidget.left=!$scope.showMemberListingWidget.left,$scope.showMemberListingWidget.right=!1,$timeout(function(){jQuery(window).width()<768&&jQuery("html, body").animate({scrollTop:325})},300))},$scope.compareToolReset=function(){$scope.viewMode={list:!0,chart:!1},$scope.switchToUser1=!0,$scope.cachedUSerEmails=null,$scope.matchPercent.primary=!0,$scope.resultTabs={},$scope.personalityFlags=[],$scope.cachedAdvisorData=[],$scope.resultTabs.leftSelected=0,$scope.resultTabs.rightSelected=0,$scope.showContent=!1,$scope.showMemberListingWidget.right=!1,$scope.memberSelected.right=!1,$scope.showMemberListingWidget.left=!1,$scope.memberSelected.left=!1,$scope.selectedMember.left.email=null,$scope.selectedMember.right.email=null,$scope.mobileControls.display=!1,jQuery.each($scope.validMemberList,function(j){$scope.validMemberList[j].selectedMember=!1,$scope.validMemberList[j].selectedSide.right=!1,$scope.validMemberList[j].selectedSide.left=!1}),$scope.sResizeFlag=0,$scope.lResizeFlag=0,$scope.winWidth<768?$rootScope.setBoxSizes("#dd-wrap",".dd","full"):jQuery("body").find("#dd-wrap").find(".dd").removeAttr("style")},$scope.updateCompareMember=function(i,side){$scope.cachedUSerEmails=null,$scope.showMemberListingWidget[side]=!1,$scope.personalityFlags=[],$scope.cachedAdvisorData=[],$scope.resultTabs.leftSelected=0,$scope.resultTabs.rightSelected=0,jQuery.each($scope.validMemberList,function(j){$scope.validMemberList[j].selectedSide[side]===!0&&($scope.validMemberList[j].selectedMember=!1,$scope.validMemberList[j].selectedSide[side]=!1)}),jQuery.each($scope.validMemberList,function(j){return $scope.validMemberList[j].email===i?($scope.validMemberList[j].selectedMember=!0,$scope.validMemberList[j].selectedSide[side]=!0,$scope.memberSelected[side]=!0,$scope.selectedMemberDetails[side]=$scope.validMemberList[parseInt(j)],$scope.selectedMember[side].email=$scope.validMemberList[parseInt(j)].email,void($scope.viewMode.list===!0?$scope.compareMembers($scope.selectedMember.left.email,$scope.selectedMember.right.email,{user1PersonalityType:"Primary",user2PersonalityType:"Primary"}):$scope.getCompareCharts($scope.selectedMember.left.email,$scope.selectedMember.right.email))):void 0}),$scope.winWidth<768&&$timeout(function(){$rootScope.setBoxSizes("#dd-wrap",".dd","full")},300)},$scope.compareMembers=function(c,m,pTypes){if($scope.memberSelected.left&&$scope.memberSelected.right){var data=$.extend({},{user1:c,user2:m},pTypes),_o={url:"/sp/relationship/getReport",data:$.param(data).replace(/%40/g,"@")};ajaxService.getAjaxResponse(_o).then(function(response){if("true"===response.Success)$scope.serverException=!1,$scope.cacheResults(data,response),$scope.winWidth>767?($scope.showContent=!0,$scope.mobileControls.display=!1):($scope.showContent=!1,$scope.mobileControls.display=!0,$scope.switchToUser1=!0,setTimeout(function(){$rootScope.setBoxSizes(".mobile-tabs",".mtabs")},200)),setTimeout(function(){$rootScope.setBoxSizes(".results-wrapper",".results-content")},500);else{$scope.compareToolReset(),$scope.serverException=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})}},$scope.chartsException=!1,$scope.getCompareCharts=function(u1,u2){$scope.memberSelected.left&&$scope.memberSelected.right&&($scope.matchPercent.primary=!0,null===$scope.cachedUSerEmails&&($scope.cachedUSerEmails=u1+u2,ajaxService.getAjaxResponse({url:"/sp/relationship/getCompare",data:$.param({user1:u1,user2:u2})}).then(function(response){if("true"===response.Success)$scope.chartsException=!1,$scope.compareProfileData=response,$scope.cacheCompareResponse=response,$scope.candidateProfileDetails=response.Analysis1,$scope.memberProfileDetails=response.Analysis2,$scope.matchPercentageData=response.matchPercent,$scope.winWidth>767?($scope.showContent=!0,$scope.mobileControls.display=!1):($scope.showContent=!1,$scope.mobileControls.display=!0,$scope.switchToUser1=!0,setTimeout(function(){$rootScope.setBoxSizes(".mobile-tabs",".mtabs")},200)),$scope.personalityFormatted={candidate:{primary:$rootScope.pullInterNationalization("profileKeys."+$scope.candidateProfileDetails.personality.Primary.personalityType.trim()),pressure:$rootScope.pullInterNationalization("profileKeys."+$scope.candidateProfileDetails.personality.UnderPressure.personalityType.trim())},member:{primary:$rootScope.pullInterNationalization("profileKeys."+$scope.memberProfileDetails.personality.Primary.personalityType.trim()),pressure:$rootScope.pullInterNationalization("profileKeys."+$scope.memberProfileDetails.personality.UnderPressure.personalityType.trim())}},$timeout(function(){$scope.dataAvailablity=!0},300);else{$scope.chartsException=!0,$scope.compareToolReset();for(var key in response.error)$scope.chartsExceptionMsg=response.error[key]}})))},$scope.cacheResults=function(p,r){var pType=p.user1PersonalityType.charAt(0)+p.user2PersonalityType.charAt(0),existingFlag=$.inArray(pType,$scope.personalityFlags);-1===existingFlag&&($scope.personalityFlags.push(pType),$scope.cachedAdvisorData[pType]=r,$scope.candidateAdvise=$scope.cachedAdvisorData[pType].primary,$scope.memberAdvise=$scope.cachedAdvisorData[pType].secondary)},$scope.formatList=function(list){if("undefined"!=typeof list){var rawList=list.split("</p>"),listHTML="",counter=0;if(jQuery.each(rawList,function(i){"undefined"!=typeof rawList[i].split("<p>")[1]&&(listHTML+="<li>"+rawList[i].split("<p>")[1]+"</li>"),counter++}),counter===rawList.length)return listHTML}},$scope.changeContentTabs=function(s,i){"left"===s?$scope.resultTabs.leftSelected=parseInt(i):$scope.resultTabs.rightSelected=parseInt(i);var u1PType=0===$scope.resultTabs.leftSelected?"Primary":"UnderPressure",u2PType=0===$scope.resultTabs.rightSelected?"Primary":"UnderPressure",pFlag=u1PType.charAt(0)+u2PType.charAt(0),existingFlag=$.inArray(pFlag,$scope.personalityFlags);-1===existingFlag?$timeout(function(){$scope.compareMembers($scope.selectedMember.left.email,$scope.selectedMember.right.email,{user1PersonalityType:u1PType,user2PersonalityType:u2PType})},100):($scope.candidateAdvise=$scope.cachedAdvisorData[pFlag].primary,$scope.memberAdvise=$scope.cachedAdvisorData[pFlag].secondary)},$scope.changeViewMode=function(v){$scope.showMemberListingWidget.right=!1,$scope.showMemberListingWidget.left=!1,"list"===v?($scope.viewMode.list=!0,$scope.viewMode.chart=!1,$scope.compareMembers($scope.selectedMember.left.email,$scope.selectedMember.right.email,{user1PersonalityType:"Primary",user2PersonalityType:"Primary"})):($scope.viewMode.list=!1,$scope.viewMode.chart=!0,$scope.getCompareCharts($scope.selectedMember.left.email,$scope.selectedMember.right.email))},$scope.initCandiateCompare=function(){$scope.getAllMemberDetails()},$scope.getMobileReport=function(v){$scope.winScreenHeight=jQuery(window).height()+"px",v===!0?ngDialog.open({template:"/sp/resources/html/tools/relationship-manager/mobile-report.html",scope:$scope}):ngDialog.open({template:"/sp/resources/html/tools/relationship-manager/mobile-charts.html",scope:$scope})},jQuery(window).resize(function(){$scope.winWidth<768?($scope.memberSelected.left&&$scope.memberSelected.right&&0===$scope.sResizeFlag&&$scope.mobileControls.display===!1&&($scope.showContent=!1,$timeout(function(){$scope.mobileControls.display=!0},500),$scope.sResizeFlag=1,$scope.lResizeFlag=0),$rootScope.setBoxSizes("#dd-wrap",".dd","full")):($scope.memberSelected.left&&$scope.memberSelected.right&&0===$scope.lResizeFlag&&($timeout(function(){$scope.viewMode.list=!0,$scope.viewMode.chart=!1,$scope.cachedUSerEmails=null,$scope.mobileControls.display=!1,$scope.showContent=!0},500),$scope.sResizeFlag=0,$scope.lResizeFlag=1),ngDialog.close("ngdialog1"),jQuery("body").find("#dd-wrap").find(".dd").removeAttr("style"))}),$scope.printPage=function(f){f===!0&&setTimeout(function(){window.print()},500)},$scope.initCandiateCompare()}angular.module("spApp").controller("relationshipManagerController",relationshipManagerController),relationshipManagerController.$inject=["$scope","$element","$attrs","$http","$timeout","ajaxService","$rootScope","$localStorage","ngDialog"];
function renewBusinessController($scope,$element,$attrs,$http,ngDialog,$timeout,ajaxService,$rootScope){$scope.priceFormatter=function(p){if("undefined"!=typeof p&&""!==p&&null!==p){var formattedPrice="$"+p.toFixed(2);return formattedPrice}},$scope.product={},$scope.promoApplied=!1,$scope.finalAmount=0,$scope.promo={},$scope.updatedPromoDetails={},$scope.updateCC={},$scope.activeMembers=0,$scope.renewBusiness={},$scope.account={},$scope.promoFormSubmitted=!1,$scope.promoError={},$scope.promoError.error=!1,$scope.dialogStatus={},$scope.timeout=0,$scope.submitDisabled=!1,$scope.pricing={},$scope.bBox={},$scope.getMemberCount=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/getActiveMemberCount"}).then(function(response){if("true"===response.Success)$scope.activeMembers=response.activeMembers,$scope.account.numAccounts=response.activeMembers;else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.getAcccountInfo=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/businessAccountDetails"}).then(function(response){if("true"===response.Success)$scope.accountDetails=response,$scope.renewalDate=response.account.productInfo.renewalDate;else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.getPlanInfo=function(){ajaxService.getAjaxResponse({url:"/sp/signup/getProducts",data:$.param({productType:"BUSINESS"})}).then(function(response){if("true"===response.Success)$scope.products=response.products,$.each($scope.products,function(i){"YEARLY"===$scope.products[i].validityType&&($scope.annualProduct=$scope.products[i],$scope.pricing.yearlyUnitPrice=$scope.products[i].unitPrice),"MONTHLY"===$scope.products[i].validityType&&($scope.monthlyProduct=$scope.products[i],$scope.pricing.monthlyUnitPrice=$scope.products[i].unitPrice)}),$scope.getProductInfo();else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})},$scope.getProductInfo=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/getCurrentBusinessProductInfo"}).then(function(response){if("true"===response.Success){$scope.productInfoError=!1,$scope.submitDisabled=!1,$scope.product=response.product;var multiplier="YEARLY"===$scope.product.validityType?12:1;$scope.bBox.yearly="YEARLY"===$scope.product.validityType?!0:!1,"undefined"!=typeof response.promotion&&"undefined"!=typeof response.promotion.unitPrice?($scope.product.updatedUnitPrice=parseFloat(response.promotion.unitPrice).toFixed(2),$scope.promoApplied=!0,$scope.finalAmount=parseFloat($scope.product.updatedUnitPrice*$scope.activeMembers*multiplier).toFixed(2)):($scope.product.updatedUnitPrice=parseFloat("YEARLY"===$scope.product.validityType?$scope.pricing.yearlyUnitPrice:$scope.pricing.monthlyUnitPrice).toFixed(2),$scope.promoApplied=!1,$scope.finalAmount=parseFloat($scope.product.updatedUnitPrice*$scope.activeMembers*multiplier).toFixed(2))}else $scope.productInfoError=!0,$scope.submitDisabled=!0,jQuery("html, body").animate({scrollTop:0})})},$scope.paymentCalculator=function(empNo,action,type,event){var currentEmpNo=parseInt(empNo),updatedEmpNo=0,multiplier="YEARLY"===type?12:1;"undefined"==typeof event?currentEmpNo>=20&&"add"===action?(updatedEmpNo=parseInt(currentEmpNo+1),$scope.account.numAccounts=updatedEmpNo,$scope.finalAmount=parseFloat($scope.product.updatedUnitPrice*updatedEmpNo*multiplier).toFixed(2)):currentEmpNo>20&&"remove"===action?(updatedEmpNo=parseInt(currentEmpNo-1),$scope.account.numAccounts=updatedEmpNo,$scope.finalAmount=parseFloat($scope.product.updatedUnitPrice*updatedEmpNo*multiplier).toFixed(2)):($scope.account.numAccounts=parseInt($scope.account.minEmployee),$scope.finalAmount=parseFloat($scope.product.updatedUnitPrice*$scope.account.numAccounts*multiplier).toFixed(2)):/^[0-9\b]+$/g.test(empNo)&&empNo>=20?($scope.account.numAccounts=empNo,$scope.finalAmount=parseFloat($scope.product.updatedUnitPrice*$scope.account.numAccounts*multiplier).toFixed(2),$timeout.cancel($scope.timeout)):($timeout.cancel($scope.timeout),$scope.timeout=$timeout(function(){$scope.account.numAccounts=20,$scope.finalAmount=parseFloat(20*$scope.product.updatedUnitPrice*multiplier).toFixed(2)},1500))},$scope.activatePromo=function(promoCode){if($scope.promoFormSubmitted=!1,$scope.promoError.error=!1,"undefined"!=typeof promoCode){var _params={code:promoCode,productId:$scope.product.id};ajaxService.getAjaxResponse({url:"/sp/signup/promotion",data:$.param(_params)}).then(function(response){"true"===response.Success?($scope.updatedPromoDetails=response.promotion,$scope.pricing.promoUnitPrice=parseFloat(response.promotion.unitPrice).toFixed(2),$scope.product.updatedUnitPrice=parseFloat(response.promotion.unitPrice).toFixed(2),$scope.promoApplied=!0,$scope.bBox.yearly===!0?$scope.finalAmount=parseFloat($scope.pricing.promoUnitPrice*$scope.account.numAccounts*12).toFixed(2):$scope.finalAmount=parseFloat($scope.pricing.promoUnitPrice*$scope.account.numAccounts*1).toFixed(2)):($scope.promoError.error=!0,$scope.promoError.msg=response.error)})}else $scope.promoFormSubmitted=!0},$scope.renewIndividualSubscription=function(fData){var _paramsUpdated,_params={},vCount=0;for(var k in fData)("default"===fData[k]||"default1"===fData[k])&&vCount++;_params=$scope.promoApplied===!1?{productId:$scope.product.id}:{productId:$scope.product.id,promotionId:$scope.updatedPromoDetails.id},$scope.updateCC.$valid&&0===vCount?(_paramsUpdated=$.extend({},_params,fData),ajaxService.getAjaxResponse({url:"/sp/admin/account/renewAccount",data:$.param(_paramsUpdated)}).then(function(response){if("true"===response.Success)$scope.dialogStatus.title="Subscription Renewal",$scope.dialogStatus.content="Subscription renewed successfully.",ngDialog.open({template:"/sp/resources/html/admin/account/success-dialog.html",scope:$scope});else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})):$scope.updateCC.submitted=!0},$scope.deactivatePromo=function(){$scope.pricing.promoUnitPrice=0,$scope.bBox.yearly===!0?$scope.finalAmount=parseFloat($scope.pricing.yearlyUnitPrice*$scope.account.numAccounts*12).toFixed(2):$scope.finalAmount=parseFloat($scope.pricing.monthlyUnitPrice*$scope.account.numAccounts*1).toFixed(2),$scope.promoApplied=!1,$scope.promo.code=null},$scope.cancelRedirect=function(){window.location="/sp/admin/account/business"},$scope.renewBusinessSubscription=function(fData){var _paramsUpdated,_params={};_params=$scope.promoApplied===!1?{numAccounts:$scope.account.numAccounts,productId:$scope.product.id}:{numAccounts:$scope.account.numAccounts,productId:$scope.product.id,promotionId:$scope.updatedPromoDetails.id},$scope.submitDisabled===!1&&($scope.renewBusiness.$valid?(_paramsUpdated=$.extend({},_params,fData),ajaxService.getAjaxResponse({url:"/sp/admin/account/renewAccount",data:$.param(_paramsUpdated)}).then(function(response){if("true"===response.Success)$scope.dialogStatus.title="Subscription Renewal",$scope.dialogStatus.content="Subscription renewed successfully.",ngDialog.open({template:"/sp/resources/html/admin/account/success-dialog.html",scope:$scope});else{$scope.submitException=!0;for(var key in response.error)$scope.submitExceptionMsg=response.error[key];jQuery("html, body").animate({scrollTop:0})}})):$scope.renewBusiness.submitted=!0)},$scope.changePlan=function(type){"YEARLY"===type?($scope.product.updatedUnitPrice=$scope.promoApplied===!0?$scope.pricing.promoUnitPrice:$scope.pricing.yearlyUnitPrice,$scope.finalAmount=parseFloat($scope.product.updatedUnitPrice*$scope.account.numAccounts*12).toFixed(2),$scope.bBox.yearly=!0):($scope.product.updatedUnitPrice=$scope.promoApplied===!0?$scope.pricing.promoUnitPrice:$scope.pricing.monthlyUnitPrice,$scope.finalAmount=parseFloat($scope.product.updatedUnitPrice*$scope.account.numAccounts*1).toFixed(2),$scope.bBox.yearly=!1)},$scope.initRenewBusiness=function(){$scope.getMemberCount(),$scope.getPlanInfo(),$scope.getAcccountInfo()},$scope.initRenewBusiness()}angular.module("spApp").controller("Additional Member Accounts",renewBusinessController),renewBusinessController.$inject=["$scope","$element","$attrs","$http","ngDialog","$timeout","ajaxService","$rootScope"];
function renewIndividualController($scope,$element,$attrs,$http,ngDialog,$timeout,ajaxService){$scope.product={},$scope.promoApplied=!1,$scope.finalAmount=0,$scope.promo={},$scope.updatedPromoDetails={},$scope.updateCC={},$scope.dialogStatus={},$scope.promoError={},$scope.serverError=!1,$scope.getIndividualAccountInfo=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/individualAccountDetails"}).then(function(response){"true"===response.Success&&($scope.accountInfo=response)})},$scope.getProductInfo=function(){ajaxService.getAjaxResponse({url:"/sp/admin/account/getCurrentIndividualProductInfo"}).then(function(response){"true"===response.Success&&($scope.product=response.product,"undefined"!=typeof response.promotion&&"undefined"!=typeof response.promotion.unitPrice?($scope.product.updatedUnitPrice=parseFloat(response.promotion.unitPrice).toFixed(2),$scope.promoApplied=!0,$scope.finalAmount=parseFloat(12*$scope.product.updatedUnitPrice).toFixed(2)):($scope.product.updatedUnitPrice=parseFloat(response.product.unitPrice).toFixed(2),$scope.promoApplied=!1,$scope.finalAmount=parseFloat(12*$scope.product.updatedUnitPrice).toFixed(2)))})},$scope.activatePromo=function(promoCode){if($scope.promoDetails.$valid){var _params={code:promoCode,productId:$scope.product.id};ajaxService.getAjaxResponse({url:"/sp/signup/promotion",data:$.param(_params)}).then(function(response){"true"===response.Success?($scope.updatedPromoDetails=response.promotion,$scope.product.updatedUnitPrice=parseFloat(response.promotion.unitPrice).toFixed(2),$scope.promoApplied=!0,$scope.finalAmount=parseFloat(12*$scope.product.updatedUnitPrice).toFixed(2)):($scope.promoError.error=!0,$scope.promoError.msg=response.error,$scope.promo.code=null,$timeout(function(){$scope.promoError.error=!1},1500))})}else $scope.promoFormSubmitted=!0,$scope.promo.code=null},$scope.renewIndividualSubscription=function(fData){var _paramsUpdated,_params={},vCount=0;for(var k in fData)("default"===fData[k]||"default1"===fData[k])&&vCount++;_params=$scope.promoApplied===!1?{numAccounts:1,productId:$scope.product.id}:{numAccounts:1,productId:$scope.product.id,promotionId:$scope.updatedPromoDetails.id},$scope.updateCC.$valid&&0===vCount?(_paramsUpdated=$.extend({},_params,fData),ajaxService.getAjaxResponse({url:"/sp/admin/account/renewAccount",data:$.param(_paramsUpdated)}).then(function(response){if("true"===response.Success)$scope.dialogStatus.title="Subscription Renewal",$scope.dialogStatus.content="Subscription renewed successfully.",ngDialog.open({template:"/sp/resources/html/admin/account/success-dialog.html",scope:$scope});else{$scope.serverError=!0;for(var key in response.error)$scope.errorMessage=response.error[key]}})):$scope.updateCC.submitted=!0},$scope.deactivatePromo=function(){$scope.product.updatedUnitPrice=parseFloat($scope.product.unitPrice).toFixed(2),$scope.finalAmount=parseFloat(12*$scope.product.updatedUnitPrice).toFixed(2),$scope.promoApplied=!1,$scope.promo.code=null},$scope.cancelRedirect=function(){window.location="/sp/admin/account/individual"},$scope.initRenewIndividual=function(){$scope.getIndividualAccountInfo(),$scope.getProductInfo()},$scope.initRenewIndividual()}angular.module("spApp").controller("Additional Member Accounts",renewIndividualController),renewIndividualController.$inject=["$scope","$element","$attrs","$http","ngDialog","$timeout","ajaxService"];
function resumeController($scope,ajaxService,ngDialog,$filter,sharedProperties,$timeout,ProfileDataService,$rootScope,$localStorage){$scope.createFormError=!1,$scope.itemPositioned=[],$scope.linkedIn=[],$scope.profileContentDisplay=!0,$scope.contactInfo=!1,$scope.coverLetter=!1,$scope.displayCover=!1,$scope.profile={},$scope.manageResumeLength=0;var date=new Date;$scope.fullmonth=date.getMonth(),$scope.fullyear=date.getFullYear(),$scope.getAllResume=function(){ajaxService.getAjaxResponse({url:"/sp/resume/getAllResumes",method:"get"}).then(function(response){if("true"===response.Success)$scope.resultStat=response.resume,$scope.firstView=$scope.resultStat.length?"true":"false",$scope.order("formattedDate",!0);else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.openDialogCreateResume=function(){ngDialog.open({template:"/sp/createResume",scope:$scope})},$scope.order=function(predicate,reverse){$scope.resultStat=$filter("orderBy")($scope.resultStat,predicate,reverse)},$scope.active=function(event){sharedProperties.toggleFilterClick(event,$scope.currentPredicate)},$scope.createResumeDetail=function(form){if($scope.createFormError=!1,form.$valid){$localStorage.remove("firstViewEnable"),$localStorage.set("createResumeContent",{resumeLength:$scope.resultStat.length,createResumeRoleName:form.createResumeRole.$viewValue,createResumeProviderName:form.createResumeName.$viewValue});$localStorage.get("profileDone");window.location.href="/sp/resume/resumeDetailsView"}else $scope.createFormError=!0},$scope.openMessage=function(result){$scope.displayName=result,ngDialog.open({template:"/sp/messageAll",scope:$scope})},$scope.openPreview=function(id){var popupWin=window.open("/sp/resume/getResume/"+id,"_blank","width=700,height=700,scrollbars=no,menubar=no,toolbar=no,location=no,status=no,titlebar=no");"Microsoft Internet Explorer"===navigator.appName?window.print():popupWin.print(),popupWin.window.focus()},$scope.openPreviewNew=function(id){window.open("/sp/resume/getResume/"+id,"_blank")},$scope.displayResume=function(){$scope.openDialogCreateResume()},$scope.createLayout=function(){var $slidesElem=$("ul.ordering-tool-list"),slidesHeight=$slidesElem.find("li").outerHeight();$slidesElem.find("li").outerWidth();return"undefined"!=typeof $scope.pckry&&$slidesElem.packery("destroy"),this.initialize=function(execute){$scope.pckry=$slidesElem.packery({itemSelector:".handleMe",rowHeight:slidesHeight,transitionDuration:0});var itemElems=$scope.pckry.packery("getItemElements");$scope.initialItem=itemElems;for(var i=0,len=itemElems.length;len>i;i++){var draggie=new Draggabilly(itemElems[i],{axis:"y",containment:$slidesElem,grid:[0,35]});$scope.pckry.packery("bindDraggabillyEvents",draggie)}$scope.pckry.packery("on","dragItemPositioned",this.orderItems)},this.orderItems=function(){for(var $itemElems=$scope.pckry.packery("getItemElements"),i=0;i<$itemElems.length;i++){var indexToPut=$($itemElems[i]).attr("tabindex");$scope.itemPositioned[i]=indexToPut,$scope.profileContent[indexToPut].id=i,$($itemElems[i]).attr("data-module-index",i)}$scope.$apply()},this.resetOrder=function(){for(var $itemElems=$scope.pckry.packery("getItemElements"),number=0,i=0;i<$itemElems.length;i++){var _this=$($itemElems[i]);$scope.itemPositioned[i]=_this.attr("tabindex"),_this.attr("data-module-index",i),_this.css("top",number),number+=slidesHeight,$scope.profileContent[i].id=i}},this.destroy=function(destroy){$scope.pckry.packery("reloadItems"),this.resetOrder()},this},$scope.callReorder=function(){$scope.initAside.destroy(),$scope.destroyProfileContent()},$scope.destroyProfileContent=function(){for(var i=0;i<$scope.profileContent.length;i++)$scope.profileContent[i].status=!0},$scope.displatyContent=function(){$scope.initAside=new $scope.createLayout,$scope.initAside.initialize(!0)},$scope.previewPDF=function(section){var printContents=$("."+section).html(),frontPage=$(".htmlFront").html(),coverLetter="",graphs=$(".graphs").html(),messageContent=$(".coverLetterPDF").find(".messageContent").html();if(this.displayCover&&""!==messageContent){var sub=$rootScope.nl2br(messageContent);$(".htmlCover").find(".messageContent").html(sub),coverLetter=$(".htmlCover").html()}var data={content:encodeURIComponent('<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link type="text/css" rel="stylesheet" href="/sp/resources/css/css-min/bootstrap.min.css"><link type="text/css" rel="stylesheet" href="/sp/resources/css/css-min/spResume.css"><script src="//use.typekit.net/ofk8xcu.js"></script><script> try {Typekit.load();} catch (e) {}</script></head><body class="sp-resume sp-resume-print-preview"><div class="container"><article class="resume-content">'+frontPage+coverLetter+"<div>"+printContents+"</div>"+graphs+"</article></div></body></html>"),role:$scope.roleName,providerName:$scope.providerName};ajaxService.getAjaxResponse({url:"/sp/resume/previewResume",data:$.param(data)}).then(function(response){if("true"===response.Success)window.open(response.url,"_blank");else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.createResumeCall=function(section){var printContents=$("."+section).html(),frontPage=$(".htmlFront").html(),coverLetter="",graphs=$(".graphs").html(),messageContent=$(".coverLetterPDF").find(".messageContent").html();if(this.displayCover&&""!==messageContent){var sub=$rootScope.nl2br(messageContent);$(".htmlCover").find(".messageContent").html(sub),coverLetter=$(".htmlCover").html()}var data={content:encodeURIComponent('<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link type="text/css" rel="stylesheet" href="/sp/resources/css/css-min/bootstrap.min.css"><link type="text/css" rel="stylesheet" href="/sp/resources/css/css-min/spResume.css"><script src="//use.typekit.net/ofk8xcu.js"></script><script> try {Typekit.load();} catch (e) {}</script></head><body class="sp-resume sp-resume-print-preview"><div class="container"><article class="resume-content">'+frontPage+coverLetter+"<div>"+printContents+"</div>"+graphs+"</article></div></body></html>"),role:$scope.roleName,providerName:$scope.providerName};ajaxService.getAjaxResponse({url:"/sp/resume/createResume",data:$.param(data)}).then(function(response){if("true"===response.Success)window.location.href="/sp/spResume",$.growl({icon:"glyphicon glyphicon-ok",message:"PDF Created"});else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.goBack=function(){window.location.href="/sp/connect/linkedin"},$scope.getProfileDetails=function(param){var _obj="";"undefined"!=typeof param?_obj={url:"/sp/linkedin/getProfileFull?updateProfile="+!0,method:"get"}:($scope.getUserDetail(),_obj={url:"/sp/linkedin/getProfileFull",method:"get"}),ajaxService.getAjaxResponse(_obj).then(function(response){if("true"===response.Success)$scope.linkedIn=response.linkedProfile,$localStorage.set("profileDone",!0),$scope.mapToResponse(),"undefined"!=typeof response.otherProfileData&&($scope.linkedIn.otherProfileData=response.otherProfileData),$scope.createNewMappingObject($scope.linkedIn);else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.mapToResponse=function(){$scope.searchContent=["summary","projects","positions","testScores","educations","certifications","courses","interests","skills","languages","volunteer","Organizations","Supported Organizations","honorsAwards","patents","publications"]},$scope.createNewMappingObject=function(response){$scope.profileContent=[],$scope.asideContent=[];for(var count=0,i=0;i<$scope.searchContent.length;i++)for(var key in response)if("otherProfileData"===key||"linkedProfile"===key)for(var subKey in response[key])$scope.searchContent[i]===subKey&&null!==response[key][subKey]&&($scope.asideContent.push($scope.searchContent[i]),$scope.profileContent.push({id:count,content:response[key][subKey],status:"true",type:angular.lowercase(subKey)}),count++);$timeout(function(){$scope.displatyContent()},500)},$scope.changeStatusType=function(event,tabIndex){var _this=angular.element(event.currentTarget),dataType=$(_this).closest("li").attr("data-type");$scope.profileContent[tabIndex].status=!$scope.profileContent[tabIndex].status,$(_this).closest("li").attr("data-type",dataType=!dataType)},$scope.getUserDetail=function(){ajaxService.getAjaxResponse({url:"/sp/admin/user"}).then(function(response){if("true"===response.Success){$scope.userProfileDetail=response.profileForm,$scope.userProfileAddress=response.address,$scope.userSummary=response.userSummary;var fullDetail=$localStorage.get("createResumeContent");null!==fullDetail&&($scope.roleName=fullDetail.createResumeRoleName,$scope.providerName=fullDetail.createResumeProviderName,$scope.manageResumeLength=fullDetail.resumeLength)}else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.coverletterfn=function(){this.displayCover?(this.contactInfo=!1,this.profileContentDisplay=!1,this.coverLetter=!0):(this.contactInfo=!1,this.profileContentDisplay=!0,this.coverLetter=!1)},$scope.deleteResumePop=function(id){$scope.deleteResumeId=id,ngDialog.open({template:"/sp/resume/deleteConfirmation",scope:$scope})},$scope.deleteResume=function(){ajaxService.getAjaxResponse({url:"/sp/resume/delete/"+$scope.deleteResumeId,method:"get"}).then(function(response){if("true"===response.Success)sharedProperties.spliceIndex($scope.resultStat,"id",$scope.deleteResumeId),ngDialog.close("ngdialog1"),$scope.firstView=$scope.resultStat.length?"true":"false",$.growl({icon:"glyphicon glyphicon-ok",message:"Delete Successfully"});else if(null!=response.error){ngDialog.close("ngdialog1");for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})},$scope.messageItem=function(param){if($scope.errpat=!1,param.$valid){var data=$(".shareResume").serialize();ajaxService.getAjaxResponse({url:"/sp/resume/share",data:data}).then(function(response){if("true"===response.Success)ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:"Resume Shared"});else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})}else $scope.errpat=!0},$scope.callGraphs=function(){ajaxService.getAjaxResponse({url:"/sp/signedIn/getAnalysisFull"}).then(function(response){if("true"===response.Success)$scope.profile.analysis=response.Analysis,$scope.profileContentGraphs=response,ProfileDataService.save(response);else if(null!=response.error){for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.errorMessage})}})}}angular.module("spApp").controller("resumeController",resumeController),resumeController.$inject=["$scope","ajaxService","ngDialog","$filter","sharedProperties","$timeout","ProfileDataService","$rootScope","$localStorage"];
function signUpController($scope,$http,$element,$attrs,ajaxService,$location,$state,$localStorage){window.scrollTo(0,0),$scope.pwd={min:8,max:32,toggle:!1,err:!1,inputType:"password"},$scope.getExceeded=!1,$scope.overlayClose=!1,$scope.timeout=0,$scope.validCoupoun=!0,$scope.subErrorMessage=!1,$scope.sfailure=!1,$scope.shownoError=!1,$scope.failure=[],$scope.localstorage=[],$scope.ageError=!1,$scope.localStorageEMp=null===$localStorage.get("employeeCount")?20:$localStorage.get("employeeCount"),$scope.showPassword=function($event){$event.preventDefault(),$scope.pwd.toggle===!1?($scope.pwd.toggle=!0,$scope.pwd.inputType="text"):($scope.pwd.toggle=!1,$scope.pwd.inputType="password")},$scope.pullLocalStorage=function(){ajaxService.getAjaxResponse({url:"/sp/incompleteProfile"}).then(function(response){"true"===response.Success&&($scope.localstorage=response,$scope.signup.firstName="firstName"in $scope.localstorage?$scope.localstorage.firstName:"",$scope.signup.lastName="lastName"in $scope.localstorage?$scope.localstorage.lastName:"",$scope.signup.title="title"in $scope.localstorage?$scope.localstorage.title:"",$scope.signup.email="email"in $scope.localstorage?$scope.localstorage.email:"",$scope.signup.address1="address1"in $scope.localstorage?$scope.localstorage.address1:"",$scope.signup.address2="address2"in $scope.localstorage?$scope.localstorage.address2:"",$scope.signup.city="city"in $scope.localstorage?$scope.localstorage.city:"",$scope.signup.state="state"in $scope.localstorage?$scope.localstorage.state:null,$scope.signup.zip="zip"in $scope.localstorage?$scope.localstorage.zip:"",$scope.signup.phone="phone"in $scope.localstorage?$scope.localstorage.phone:"")})},$scope.updateEmpCount=function(e,v,checkboxSelected){var thisClass=$(e.target).attr("class"),empVal=parseInt(v);checkboxSelected=$($element).find("."+checkboxSelected).val(),$scope.alternateBillingMode===!0&&(checkboxSelected=$scope.products[$scope.activeIndex].unitPrice),empVal>$scope.signup.maximum&&"undefined"==typeof $scope.alternateBillingMode?($scope.getExceeded=!0,$scope.overlayClose=!0):$scope.getExceeded===!0&&$scope.overlayClose===!0&&(""===$scope.appliedPromotionId?($scope.getExceeded=!1,$scope.overlayClose=!1):$scope.getExceeded=!1),angular.isNumber(empVal)&&("up"===thisClass&&empVal>=$scope.signup.minimum?$scope.signup.emp=parseInt($scope.signup.emp,10)+parseInt(1,10):"down"===thisClass&&empVal>=parseInt($scope.signup.minimum,10)+parseInt(1,10)&&($scope.signup.emp=parseInt($scope.signup.emp,10)-parseInt(1,10)),$scope.totalCount($scope.signup.emp,checkboxSelected,$scope.products[$scope.activeIndex].validityType)),e&&e.preventDefault()},$scope.keyUpEvent=function(e,v,checkboxSelected){if(""===v)return!1;if(38===e.keyCode?(v=parseInt(v,10)+parseInt(1,10),$scope.signup.emp=parseInt(v)):40===e.keyCode&&(v=parseInt(v,10)-parseInt(1,10),$scope.signup.emp=parseInt(v)),v>=$scope.signup.maximum&&"undefined"==typeof $scope.alternateBillingMode)return $scope.getExceeded=!0,$scope.overlayClose=!0,!1;$scope.getExceeded===!0&&$scope.overlayClose===!0&&(""===$scope.appliedPromotionId?($scope.getExceeded=!1,$scope.overlayClose=!1):$scope.getExceeded=!1);var empVal=($(e.target).attr("class"),parseInt(v));checkboxSelected=$($element).find("."+checkboxSelected).val(),$scope.alternateBillingMode===!0&&(checkboxSelected=$scope.products[$scope.activeIndex].unitPrice),angular.isNumber(empVal)&&(clearTimeout($scope.timeout),$scope.timeout=setTimeout(function(){$scope.signup.emp=empVal<$scope.signup.minimum||isNaN(empVal)?$scope.signup.minimum:parseInt($scope.signup.emp,10),$scope.totalCount($scope.signup.emp,checkboxSelected,$scope.products[$scope.activeIndex].validityType),$scope.$apply()},$attrs.delay||1e3))},$scope.totalCount=function(empVal,unitPrice,validity){"undefined"!=typeof validity&&"yearly"===validity.toLowerCase()?$scope.signup.total=12*(parseFloat(empVal,10)*parseFloat(unitPrice,10)):$scope.signup.total=parseFloat(empVal,10)*parseFloat(unitPrice,10)},$scope.updateSelectedBox=function(event,item,min,max,unitPrice,index,validity){return $scope.overlayClose&&$scope.closeOverlaySuccessMsg(),$scope.signup.minimum=min,$scope.signup.maxEmployee=max,$scope.activateCheck=item,$scope.activeIndex=index,$scope.contractPlan=$scope.products[index].name,$scope.contractTerm=$scope.products[index].validityKey,$scope.lastcheckedItem===$scope.activateCheck?!1:($scope.lastcheckedItem=item,void $scope.totalCount($scope.signup.emp,unitPrice,$scope.products[$scope.activeIndex].validityType))},$scope.processincompleteSignUpIndividual=function(fData){$scope.spSignUpIndividual.submitted=!1,$scope.sfailure=!1;var elem=angular.element($element),obj={firstName:$scope.signup.firstName,lastName:$scope.signup.lastName,title:$scope.signup.title,email:$scope.signup.email,password:$scope.signup.password,phone:$scope.signup.phone,zip:$scope.signup.zip,address1:$scope.signup.address1,address2:$scope.signup.address2,country:$scope.signup.country,city:$scope.signup.city,state:$scope.signup.state,gender:$scope.signup.gender,month:$scope.signup.month,year:$scope.signup.year,day:$scope.signup.day},vCount=0;for(var k in obj)("default"===obj[k]||"default1"===obj[k])&&vCount++;if($scope.spSignUpIndividual.$valid&&$scope.ageLimitCheck($scope.signup.month,$scope.signup.year,$scope.signup.day)&&0===vCount){console.log("success");var ur="/sp/updateProfile",options={url:ur,data:$.param(obj)};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?window.location.reload():null!=response.error&&($scope.failure=response.error,$scope.sfailure=!0)})}else $scope.spSignUpIndividual.submitted=!0,elem=angular.element($element),$scope.ageError||$("html,body").animate({scrollTop:$(elem).find("form .ng-invalid:first").offset().top-20},300)},$scope.addmemberSignUpIndividual=function(fData,alternate){var token=window.location.pathname.substring(window.location.pathname.lastIndexOf("/")+1);$scope.addMemberSignUp.submitted=!1,$scope.sfailure=!1;var elem=angular.element($element),obj={firstName:$scope.signup.firstName,lastName:$scope.signup.lastName,title:$scope.signup.title,email:$scope.signup.email,password:$scope.signup.password,phone:$scope.signup.phone,zip:$scope.signup.zip,address1:$scope.signup.address1,address2:$scope.signup.address2,country:$scope.signup.country,city:$scope.signup.city,state:$scope.signup.state,gender:$scope.signup.gender,month:$scope.signup.month,year:$scope.signup.year,day:$scope.signup.day,token:token};if($scope.addMemberSignUp.$valid&&$scope.ageLimitCheck($scope.signup.month,$scope.signup.year,$scope.signup.day)){var options={url:"undefined"==typeof alternate?"/sp/signup/member":"/sp/signup/individual/member",data:$.param(obj)};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?window.location.href="/sp":null!=response.error&&($scope.failure=response.error,$scope.sfailure=!0)})}else elem=angular.element($element),$scope.ageError||$("html,body").animate({scrollTop:$(elem).find("form .ng-invalid:first").offset().top-20},300),$scope.addMemberSignUp.submitted=!0},$scope.processSignUpIndividual=function(fData){$scope.spSignUpIndividual.submitted=!1,$scope.sfailure=!1;var sourceRefer;sourceRefer="other"===$scope.signup.referSource.toLowerCase()?$scope.signup.referSourceOther:"default2"===$scope.signup.referSource?"":$scope.signup.referSource;var elem=angular.element($element),obj={firstName:$scope.signup.firstName,lastName:$scope.signup.lastName,title:$scope.signup.title,email:$scope.signup.email,password:$scope.signup.password,phone:$scope.signup.phone,zip:$scope.signup.zip,address1:$scope.signup.address1,address2:$scope.signup.address2,country:$scope.signup.country,city:$scope.signup.city,state:$scope.signup.state,gender:$scope.signup.gender,month:$scope.signup.month,year:$scope.signup.year,day:$scope.signup.day,referSource:sourceRefer},vCount=0;for(var k in obj)("default"===obj[k]||"default1"===obj[k])&&vCount++;if($scope.spSignUpIndividual.$valid&&$scope.ageLimitCheck($scope.signup.month,$scope.signup.year,$scope.signup.day)&&0===vCount){console.log("success");var ur="/sp/signup/"+angular.lowercase($location.path().replace("/signup_","")),options={url:ur,data:$.param(obj)};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?$state.go(angular.lowercase($location.path().replace("/signup_",""))):null!=response.error&&($scope.failure=response.error,$scope.sfailure=!0)})}else $scope.spSignUpIndividual.submitted=!0,elem=angular.element($element),$scope.ageError||$("html,body").animate({scrollTop:$(elem).find("form .ng-invalid:first").offset().top-20},300)},$scope.processSignUp=function(fData){$scope.spSignUp.submitted=!1;var sourceRefer,elem=angular.element($element);sourceRefer="other"===$scope.signup.referSource.toLowerCase()?$scope.signup.referSourceOther:"default2"===$scope.signup.referSource?"":$scope.signup.referSource;var obj={firstName:$scope.signup.firstName,lastName:$scope.signup.lastName,title:$scope.signup.title,email:$scope.signup.email,password:$scope.signup.password,company:$scope.signup.company,industry:$scope.signup.industry,numEmp:$scope.signup.noEmp,phone:$scope.signup.phone,zip:$scope.signup.zip,address1:$scope.signup.address1,address2:$scope.signup.address2,country:$scope.signup.country,city:$scope.signup.city,state:$scope.signup.state,referSource:sourceRefer},vCount=0;for(var k in obj)("default"===obj[k]||"default1"===obj[k])&&vCount++;if($scope.spSignUp.$valid&&0===vCount){console.log("if"),$localStorage.set("businessUserCred",obj);var ur="/sp/signup/"+angular.lowercase($location.path().replace("/signup_","")),options={url:ur,data:$.param(obj)};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?$state.go(angular.lowercase($location.path().replace("/signup_",""))):null!=response.error&&($scope.failure=response.error,$scope.sfailure=!0)})}else $scope.spSignUp.submitted=!0,elem=angular.element($element),$scope.ageError||$("html,body").animate({scrollTop:$(elem).find("form .ng-invalid:first").offset().top-20},300)},$scope.processAlternateSignUp=function(fData){$scope.spSignUp.submitted=!1;var obj={firstName:$scope.signup.firstName,lastName:$scope.signup.lastName,title:$scope.signup.title,email:$scope.signup.email,company:$scope.signup.company,industry:$scope.signup.industry,numEmp:$scope.signup.noEmp,phone:$scope.signup.phone,zip:$scope.signup.zip,address1:$scope.signup.address1,address2:$scope.signup.address2,country:$scope.signup.country,city:$scope.signup.city,state:$scope.signup.state},vCount=0;for(var k in obj)("default"===obj[k]||"default1"===obj[k])&&vCount++;if($scope.spSignUp.$valid&&0===vCount){$localStorage.set("alternativeBUserCred",obj);var options={url:"/sp/sysAdmin/alternateBilling/signup/business",data:$.param(obj)};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?window.location.href="/sp/sysAdmin/alternateBilling/businessStep2Form":null!=response.error&&($scope.failure=response.error,$scope.sfailure=!0)})}else{$scope.spSignUp.submitted=!0;var elem=angular.element($element);$scope.ageError||$("html,body").animate({scrollTop:$(elem).find("form .ng-invalid:first").offset().top-20},300)}},$scope.processAlternateIndividualSignUp=function(fData){$scope.spSignUp.submitted=!1,$scope.sfailure=!1;var obj={firstName:$scope.signup.firstName,lastName:$scope.signup.lastName,title:$scope.signup.title,email:$scope.signup.email,password:$scope.signup.password,phone:$scope.signup.phone,zip:$scope.signup.zip,address1:$scope.signup.address1,address2:$scope.signup.address2,country:$scope.signup.country,city:$scope.signup.city,state:$scope.signup.state,gender:$scope.signup.gender,month:$scope.signup.month,year:$scope.signup.year,day:$scope.signup.day},vCount=0;for(var k in obj)("default"===obj[k]||"default1"===obj[k])&&vCount++;if($scope.spSignUp.$valid&&$scope.ageLimitCheck($scope.signup.month,$scope.signup.year,$scope.signup.day)&&0===vCount){var options={url:"/sp/sysAdmin/alternateBilling/signup/individual",data:$.param(obj)};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?window.location.href="/sp/sysAdmin/alternateBilling/individualStep2Form":null!=response.error&&($scope.failure=response.error,$scope.sfailure=!0)})}else{$scope.spSignUp.submitted=!0;var elem=angular.element($element);$scope.ageError||$("html,body").animate({scrollTop:$(elem).find("form .ng-invalid:first").offset().top-20},300)}},$scope.contactUs=function(){var elem=angular.element($element);$(elem.find("form")).serialize()},$scope.processSubscribe=function(fData){var elem=angular.element($element);$(elem.find("form")).serialize();$scope.shownoError=!1;var obj={},options={};if("subscribe"===fData){$scope.spSubscribe.submitted=!1,$scope.subErrorMessage=!1,obj={nameOnCard:$scope.signup.ccname,cardNumber:$scope.signup.ccno,month:$scope.signup.month,year:$scope.signup.year,cvv:$scope.signup.ccv,country:$scope.signup.country,zip:$scope.signup.zip,total:$scope.signup.total,action:"submitsubscribe",numEmp:$scope.signup.emp,productId:$scope.activateCheck.replace("index_","")};var vCount=0;"undefined"!=typeof $scope.appliedPromotionId&&""!==$scope.appliedPromotionId&&(obj.promotionId=$scope.appliedPromotionId);for(var k in obj)("default"===obj[k]||"default1"===obj[k])&&vCount++;$scope.spSubscribe.$valid&&0===vCount?(options={url:"/sp/signup/"+angular.lowercase($location.path().replace("/",""))+"/account",data:$.param(obj)},ajaxService.getAjaxResponse(options).then(function(response){if("undefined"!=typeof response.error){var keyname="";for(var key in response.error)keyname=key;$scope.errorMessage=response.error[keyname],$scope.subErrorMessage=!0}else $localStorage.remove("employeeCount"),window.location.href="/sp"})):($scope.spSubscribe.submitted=!0,elem=angular.element($element),$scope.ageError||$("html,body").animate({scrollTop:$(elem).find("form .ng-invalid:first").offset().top-20},300))}else"cancel"===fData?($scope.shownoError=!0,window.location.replace("/pricing/")):"contactus"===fData&&($scope.contactUsForm.submitted=!0,$scope.contactUsForm.$valid?(obj={name:$scope.signup.vciname,company:$scope.signup.vcicompname,phone:$scope.signup.vcitel,action:"contact",numEmp:$scope.signup.emp},options={url:"/sp/signup/business/assisted/account",data:$.param(obj)},ajaxService.getAjaxResponse(options).then(function(response){$state.go("thankYou")})):(console.log("errors !!!"),elem=angular.element($element),$scope.ageError||$("html,body").animate({scrollTop:$(elem).find("form .ng-invalid:first").offset().top-20},300),$scope.contactUsForm.submitted=!0))},$scope.priorityCode=function(val,productId){var promoCode=$scope.signup.coupon;if(!/^[a-zA-Z0-9]{3,8}$/.test(promoCode))return $scope.validCoupoun=!1,!1;$scope.validCoupoun=!0;var obj={code:promoCode.toUpperCase(),productId:productId.replace("index_","")},options={url:"/sp/signup/promotion",data:$.param(obj)};ajaxService.getAjaxResponse(options).then(function(response){if($scope.getResult="undefined"!=typeof response.Success?response.Success:!1,$scope.getResult){if("Active"!==response.promotion.status)return $scope.getResult=!1,!1;$scope.appliedPromotionId=response.promotion.id,$scope.getContent="undefined"!=typeof response.promotion.message?response.promotion.message:"No Discount Available",$scope.overlayClose=$scope.getResult,$scope.getDiscountedPrice=response.promotion.unitPrice,$scope.discountedActivated=$scope.activateCheck,$scope.withoutDiscountedPrice=$($element).find("."+$scope.discountedActivated).val(),$scope.alternateBillingMode===!0&&($scope.withoutDiscountedPrice=$scope.products[$scope.activeIndex].unitPrice),$scope.originproduct=$scope.products,$scope.discountedItemIndex=$scope.activeIndex,$scope.products[$scope.activeIndex].unitPrice=$scope.getDiscountedPrice,$scope.totalCount($scope.signup.emp,$scope.getDiscountedPrice,$scope.products[$scope.activeIndex].validityType)}else"undefined"!=typeof response.error&&($scope.getResult=!1,$scope.PromotionsValidationException=response.error.Promotion_Not_Found)})},$scope.closeOverlaySuccessMsg=function(event){$scope.overlayClose=!1,$scope.appliedPromotionId="",$scope.products[$scope.discountedItemIndex].unitPrice=$scope.withoutDiscountedPrice,$scope.totalCount($scope.signup.emp,$scope.products[$scope.activeIndex].unitPrice,$scope.products[$scope.activeIndex].validityType),event&&event.preventDefault()},$scope.checkStatus=function(param1,param2){return param1===param2?!0:!1},$scope.highlighter=function(index){return $scope.getResult&&$scope.overlayClose&&$scope.discountedActivated===$scope.activateCheck&&$scope.discountedItemIndex===index?!0:!1},$scope.getAnnualMonthlyEmpData=function(mode){var obj={productType:angular.uppercase($location.path().replace("/",""))},options={url:"/sp/signup/getProducts",data:$.param(obj)};$scope.userMode=mode,ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success){if("undefined"!=typeof response.Product_Not_Found)return console.log("Page not formed"),!1;$scope.products=response.products;var countStore=$localStorage.get("employeeCount"),empyType=$localStorage.get("emplyeeType"),_index=0;if($scope.minEmpCount=response.products[_index].minEmployee,null!=empyType){"m"===empyType?empyType="MONTHLY":"y"===empyType&&(empyType="YEARLY");for(var i=0;i<$scope.products.length;i++)$scope.products[i].validityType===empyType&&(_index=i)}$scope.signup.minimum=response.products[_index].minEmployee,$scope.signup.maximum="undefined"!=typeof response.products[_index].maxEmployee?response.products[_index].maxEmployee:1e3,$scope.signup.contract=[],$scope.signup.emp="undefined"!=typeof countStore&&countStore>$scope.signup.minimum?countStore:response.products[_index].minEmployee,$scope.activateCheck="index_"+response.products[_index].id,$scope.lastcheckedItem="index_"+response.products[_index].id,$scope.contractPlan=response.products[_index].name,$scope.contractTerm=response.products[_index].validityKey,$scope.activeIndex=_index,$scope.totalCount($scope.signup.emp,response.products[_index].unitPrice,response.products[_index].validityType),$scope.annualCheckbox=!0,$scope.master=angular.copy($scope.signup)}else{$scope.updateStatusError=!0;for(var key in response.error)$scope.updateStatusErrorMsg=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.updateStatusErrorMsg})}})},$scope.ageLimitCheck=function(month,year,date){if("undefined"==typeof month||"undefined"==typeof year)return!0;var today=new Date,birthDate=new Date(year+"/"+month+"/"+date),age=today.getFullYear()-birthDate.getFullYear(),m=today.getMonth()-birthDate.getMonth();return(0>m||0===m&&today.getDate()<birthDate.getDate())&&age--,age>=18?($scope.ageError=!1,!0):($scope.ageError=!0,!1)},$scope.pullContactUsDetails=function(){var storage=$localStorage.get("businessUserCred");null!==storage&&($scope.signup.vciname=storage.firstName+" "+storage.lastName,$scope.signup.vcicompname=storage.company,$scope.signup.vcitel=storage.phone);({firstName:$scope.signup.firstName,lastName:$scope.signup.lastName,title:$scope.signup.title,email:$scope.signup.email,password:$scope.signup.password,company:$scope.signup.company,industry:$scope.signup.industry,numEmp:$scope.signup.noEmp,phone:$scope.signup.phone,zip:$scope.signup.zip,address1:$scope.signup.address1,address2:$scope.signup.address2,country:$scope.signup.country,city:$scope.signup.city,state:$scope.signup.state})},$scope.historyGoBack=function(type){switch(type){case"business":window.location.href="/sp/sysAdmin/alternateBilling/business";break;case"individual":window.location.href="/sp/sysAdmin/alternateBilling/individual"}},$scope.getAllProducts=function(type){$scope.alternateBillingMode=!0,ajaxService.getAjaxResponse({url:"/sp/sysAdmin/alternateBilling/signup/getProducts",data:$.param({productType:type})}).then(function(response){if("true"===response.Success)$scope.products=response.products,$scope.signup.emp=0,$scope.signup.minimum=0,$scope.signup.maximum=0,$scope.totalCount(0,0,"MONTHLY");else{for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",message:$scope.errorMessage})}})},$scope.paymentTypeChange=function(_this){if($scope.overlayClose&&$scope.closeOverlaySuccessMsg(),""===_this.signup.paymentType)return $scope.signup.emp=0,$scope.signup.minimum=0,$scope.signup.maximum=0,$scope.totalCount(0,0,"MONTHLY"),!0;var _index=_this.signup.paymentType;$scope.signup.minimum=$scope.products[_index].minEmployee,$scope.signup.maximum="undefined"!=typeof $scope.products[_index].maxEmployee?$scope.products[_index].maxEmployee:1e3,$scope.signup.contract=[],$scope.signup.emp=$scope.products[_index].minEmployee,$scope.activateCheck="index_"+$scope.products[_index].id,$scope.lastcheckedItem="index_"+$scope.products[_index].id,$scope.contractPlan=$scope.products[_index].name,$scope.contractTerm=$scope.products[_index].validityKey,$scope.activeIndex=_index,$scope.totalCount($scope.signup.emp,$scope.products[_index].unitPrice,$scope.products[_index].validityType),$scope.annualCheckbox=!0,$scope.master=angular.copy($scope.signup)},$scope.validateSendResponse=function(signup,individual){$scope.signup.submitted=!1;var response;if(signup.$valid&&$scope.signup.camount>=$scope.signup.total){var obj={productId:$scope.products[$scope.activeIndex].id,numEmp:$scope.signup.emp,chargeAmount:$scope.signup.camount,isTrial:"TRIAL"===$scope.signup.cpt?!0:!1,paymentType:$scope.signup.cpt,creditRef:$scope.signup.cnr,comment:$scope.signup.ccomment,paymentAggrement:$scope.signup.paymentAgreement};"undefined"!=typeof $scope.appliedPromotionId&&""!==$scope.appliedPromotionId&&(obj.promotionId=$scope.appliedPromotionId);var options={url:"undefined"==typeof individual?"/sp/sysAdmin/alternateBilling/signup/business/account":"/sp/sysAdmin/alternateBilling/signup/individual/account",data:$.param(obj)};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?window.location.href="undefined"==typeof individual?"/sp/sysAdmin/alternateBilling/business":"/sp/sysAdmin/alternateBilling/individual":null!=response.error&&($scope.failure=response.error,$scope.sfailure=!0)})}else{$scope.signup.submitted=!0;var elem=angular.element($element);if(!$scope.ageError)if($(elem).find("form .ng-invalid:first").length)$("html,body").animate({scrollTop:$(elem).find("form .ng-invalid:first").offset().top-20},300);else{for(var key in response.error)$scope.errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",message:$scope.errorMessage})}}},$scope.paymentAgreement=function(total,agreement){return total*agreement*("YEARLY"===$scope.products[$scope.activeIndex].validityType?1:12)}}angular.module("spApp").controller("signUpController",signUpController),signUpController.$inject=["$scope","$http","$element","$attrs","ajaxService","$location","$state","$localStorage"];
function siteHeaderController($scope,userDataService,ajaxService,$localStorage){$scope.userProfile={},$scope.navLoaded=!1,$scope.showNav=!1,$scope.navigationTrue=!1,$scope.isSuperAdmin=!1,$scope.logout=function(){deleteCookie("udata"),window.location.href="/sp/logout"},$scope.createNavigation=function(){this.getUserProfile=function(){ajaxService.getAjaxResponse({url:"/sp/signedIn/getProfile"}).then(function(response){if("true"===response.Success){$scope.userProfile=response.member;var userRoles=$scope.userProfile.roles;$scope.isSuperAdmin=-1!==userRoles.indexOf("SuperAdministrator")?!0:!1,$localStorage.set("loggegdInProfile",response),userDataService.save(response);var userCookie={};userCookie.uid=response.member.id,userCookie.cid=response.member.companyId,setCookie("udata",JSON.stringify(userCookie))}})},this.getSiteNavigation=function(){ajaxService.getAjaxResponse({url:"/sp/navigation/get"}).then(function(response){"true"===response.Success&&($scope.headerFn.clubJsonResponse(response),$scope.mainNavLinks=response.navigation.navigationList,$scope.mainNavLinksCached=response.navigation.navigationList,$scope.navLoaded=!0)})},this.clubJsonResponse=function(response){$localStorage.set("globalNav",response)},this.cacheHtml=function(clone){var html=$(clone).html();$localStorage.set("navHtml",html),$scope.headerFn.classToggle(clone)},this.classToggle=function(classs){var $classTake=$(classs),url=window.location.pathname+window.location.hash,parentId="",childrenId="",colorPanel=!1;$classTake.find("section").after(" "),$classTake.closest(".container").removeClass("blueBar"),"/sp/admin/group#/profile"===url&&(url="/sp/admin/group#/group");for(var key in $scope.mainNavLinksCached)if(null!=$scope.mainNavLinksCached[key].children)for(var childKey in $scope.mainNavLinksCached[key].children)if("undefined"!=typeof $scope.mainNavLinksCached[key].children[childKey].activeKeys)for(var i=0;i<$scope.mainNavLinksCached[key].children[childKey].activeKeys.length;i++)if(url.indexOf($scope.mainNavLinksCached[key].children[childKey].activeKeys[i])>-1){childrenId=$scope.mainNavLinksCached[key].children[childKey].id,parentId=$scope.mainNavLinksCached[key].id,colorPanel="undefined"!=typeof $scope.mainNavLinksCached[key].children[childKey].color?$scope.mainNavLinksCached[key].children[childKey].color:!1;break}$classTake.find("section").after(" "),$classTake.closest(".container").removeClass("blueBar"),$classTake.find("h2").removeClass("active"),$classTake.find("ul li").removeClass("active").closest("ul").removeClass("active"),$classTake.find("h2[data-slide='"+parentId+"']").addClass("active"),$classTake.find("ul li[data-slide='"+childrenId+"']").addClass("active").closest("ul").addClass("active"),colorPanel&&$classTake.find("ul.active").closest(".container").addClass(colorPanel),$scope.navigationTrue=!0;var activeTxt=$(".reposition-nav").find("li.active a").html();$(".breadcrumb-title").html(activeTxt),$(".nav-dashboard h2 a").on("click",function(e){var $this=$(this),$html=$this.closest("section"),$hideWrap=$html.find(".hide-wrap"),$subLinks=$html.find("ul"),$subLinkHeight=$subLinks.innerHeight();$(".showPos").length&&(0===$hideWrap.height()?($hideWrap.height($subLinkHeight),$html.closest("div").find(".hide-wrap").not($hideWrap).height(0)):$hideWrap.height(0),e.preventDefault())}).stop()},this.localstorageCheck=function(key){return null===$localStorage.get(key)},this.bodyAil=function(body,$target,container){$(body).on("click",function(e){$(".nice-name-info").is(e.target)||0!==$(".nice-name-info").has(e.target).length||$target.removeClass("show")})},this.activate=function(classs,_target){var $target=$(_target);$(document).on("click",classs,function(event){$target.hasClass("show")?($target.removeClass("show"),event.stopPropagation()):($target.addClass("show"),event.stopPropagation())})},this.bindEvent=function(){$scope.headerFn.bodyAil("body",$(".nav-nice-name-tools"),$(".nice-name-info")),$scope.headerFn.activate(".nice-name-info",".nav-nice-name-tools")},this.init=function(){if(this.localstorageCheck("loggegdInProfile"))this.getUserProfile();else{var storedProfile=$localStorage.get("loggegdInProfile");$scope.userProfile=storedProfile.member,userDataService.save($localStorage.get("loggegdInProfile"));var userRoles=$scope.userProfile.roles;$scope.isSuperAdmin=-1!==userRoles.indexOf("SuperAdministrator")?!0:!1}if(this.localstorageCheck("globalNav"))this.getSiteNavigation();else{var storedGlobalNav;this.localstorageCheck("navHtml")?(storedGlobalNav=$localStorage.get("globalNav"),$scope.mainNavLinks=storedGlobalNav.navigation.navigationList,$scope.mainNavLinksCached=storedGlobalNav.navigation.navigationList):($(".nav-main-app-toc").html($localStorage.get("navHtml")),storedGlobalNav=$localStorage.get("globalNav"),$scope.mainNavLinksCached=storedGlobalNav.navigation.navigationList,this.classToggle(".nav-main-app-toc")),$scope.navLoaded=!0}this.bindEvent()}},function(){$scope.headerFn=new $scope.createNavigation,$scope.headerFn.init()}();var setCookie=function(cookieName,cookieValue){document.cookie=cookieName+"="+cookieValue+";path=/; domain=.surepeople.com"},deleteCookie=function(cookieName){document.cookie=cookieName+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/; domain=.surepeople.com"}}function assessmentHeaderController($scope){$scope.addAssessmentBrdr=function(){var isAssessment=$(".assessment-template-wrapper"),isNonLogged=$(".non-logged-header"),theHeaderAssessment=$("#header");isAssessment.length&&theHeaderAssessment.addClass("addOrangeBrdr"),isNonLogged.length&&theHeaderAssessment.addClass("addOrangeBrdr")},function(){$scope.addAssessmentBrdr()}()}angular.module("spApp").controller("siteHeaderController",siteHeaderController),angular.module("spApp").controller("assessmentHeaderController",assessmentHeaderController),siteHeaderController.$inject=["$scope","userDataService","ajaxService","$localStorage"],assessmentHeaderController.$inject=["$scope"];
function spectrumController($scope,ajaxService,$localStorage,$timeout,$rootScope,ngDialog){function groupsCall(groupName){ajaxService.getAjaxResponse({url:vm.config.getProfileBalance,data:$.param({groupName:"undefined"==typeof groupName?"":groupName})}).then(function(response){"true"===response.Success?(vm.profileChartNoData=null!=response.profileBalance?response.profileBalance.personalityBalanceAllZero:!0,vm.total=vm.completedProfile(vm.allGroups,"undefined"==typeof groupName?"":groupName),vm.profileChartNoData||(vm.groupDetail=response.profileBalance.personalityBalances,vm.genderBalance=response.profileBalance.genderBalance,vm.genderData=Object.keys(vm.genderBalance),vm.ageBalances=response.profileBalance.ageBalances,vm.chartDataReady=!0,vm.userScreen&&$timeout(function(){vm.userDetail=vm.groupDetail[0].usersId,vm.profileBalanceSelect=vm.groupDetail[0].personalityType},0))):null!=response.error&&(vm.groupDetail=[],vm.profileChartNoData=!0,vm.total=vm.completedProfile(vm.allGroups,"undefined"==typeof groupName?"":groupName))})}function completedProfile(scan,groupName){var obj={};if(""===groupName||null===groupName)obj={total:"undefined"!=typeof vm.allMembers?vm.allMembers.totalMember:0,valid:"undefined"!=typeof vm.allMembers?vm.allMembers.validMembers:0};else for(var key in scan)if(key===groupName){obj={total:scan[key].totalMember,valid:scan[key].validMembers};break}return obj}function candidateProfileList(scan,groupName){var obj={};if(""===groupName||null===groupName)obj={total:"undefined"!=typeof vm.candidateAllRoles?vm.candidateAllRoles.totalMembers:0,valid:"undefined"!=typeof vm.candidateAllRoles?vm.candidateAllRoles.validMembers:0};else for(var key in scan)if(key===groupName){obj={total:scan[key].totalMembers,valid:scan[key].validMembers};break}return obj}function allGroups(callback){ajaxService.getAjaxResponse({url:vm.config.allGroups}).then(function(response){"true"===response.Success?(vm.allGroups=response.members,vm.allMembers=response["All Groups"],vm.groupRender=!0,null!==callback&&"function"==typeof callback&&callback()):null!=response.error&&(vm.allGroups=[],vm.groupRender=!0,vm.allMembers={totalMember:0,validMembers:0})})}function profileBalanceChange(select,mode){for(var key in vm.groupDetail)if(vm.groupDetail[key].personalityType===select){vm.userDetail=vm.groupDetail[key].usersId,vm.profileName=$rootScope.pullInterNationalization("spectrum."+vm.groupDetail[key].personalityType),vm.profileNumber=vm.groupDetail[key].number,vm.dimensionType=vm.groupDetail[key].dimensionType,vm.personalityDescription=vm.groupDetail[key].personalityDescription,vm.videoUrl=vm.groupDetail[key].videoUrl;break}}function learnerChart(groupName,callback){ajaxService.getAjaxResponse({url:vm.config.learnerChart,data:$.param({groupName:"undefined"==typeof groupName?"":groupName})}).then(function(response){"true"===response.Success?(vm.learnerChartData=response.learnerStatus.learnerStatusTrackerMap,vm.fullObjectKeys=Object.keys(vm.learnerChartData),vm.modeSelected=Object.keys(vm.learnerChartData)[1],vm.detectData(vm.modeSelected),vm.learnerChartAvailable=!0,vm.totalLearn=vm.completedProfile(vm.allGroups,"undefined"==typeof groupName?"":groupName),null!==callback&&"function"==typeof callback&&callback()):null!=response.error&&(vm.totalLearn=vm.completedProfile(vm.allGroups,"undefined"==typeof groupName?"":groupName))})}function hiringRoles(role,callback){ajaxService.getAjaxResponse({url:vm.config.hiringInsights,data:$.param({role:"undefined"==typeof role?"":role})}).then(function(response){"true"===response.Success?(vm.RadialChartData=response.hringFiterInsights.hiringInsightsMap,vm.RadialfullObjectKeys=Object.keys(vm.RadialChartData),vm.RadialmodeSelected=Object.keys(vm.RadialChartData)[1],vm.RadialChartAvailable=!0,vm.roleChanges=role,vm.totalHiring=vm.candidateProfileList(vm.candidateRoles,"undefined"==typeof role?"":role),null!==callback&&"function"==typeof callback&&callback()):null!=response.error&&(vm.totalHiring=vm.candidateProfileList(vm.candidateRoles,"undefined"==typeof role?"":role))})}function hiringInsights(callback){ajaxService.getAjaxResponse({url:vm.config.hiringRoles}).then(function(response){"true"===response.Success?(vm.hiringRolesName=response.filterInsightsRoles,vm.candidateRoles=response.hrProfileBalanceRoles,vm.candidateAllRoles=response.hrProfileBalanceRolesAllRoles,vm.candidateRender=!0,null!==callback&&"function"==typeof callback&&callback()):null!=response.error&&(vm.candidateRender=!0,vm.hiringRolesName=[],vm.candidateRoles=[],vm.candidateAllRoles={totalMembers:0,validMembers:0})})}function candidateProfileBalance(role,callback){ajaxService.getAjaxResponse({url:vm.config.candidateProfileBalance,data:$.param({role:"undefined"==typeof role?"":role})}).then(function(response){"true"===response.Success?(vm.candidateChartNoData=null!=response.hringFiterProfileBalance?response.hringFiterProfileBalance.personalityBalanceAllZero:!0,vm.candidateDataReady=!0,vm.candidateChartNoData||(vm.groupCandidateDetail=response.hringFiterProfileBalance.personalityBalances,vm.candidateScreen&&vm.groupCandidateDetail.length&&$timeout(function(){vm.candidateDetail=vm.groupCandidateDetail[0].usersId,vm.candidateBalanceSelect=vm.groupCandidateDetail[0].personalityType},0)),vm.totalCan=vm.candidateProfileList(vm.candidateRoles,"undefined"==typeof role?"":role)):null!=response.error&&(vm.groupCandidateDetail=[],vm.candidateChartNoData=!0,vm.candidateDataReady=!0,vm.totalCan=vm.candidateProfileList(vm.candidateRoles,"undefined"==typeof role?"":role))})}function candidateBalanceChange(select,mode){for(var key in this.groupCandidateDetail)if(this.groupCandidateDetail[key].personalityType===select){this.candidateDetail=this.groupCandidateDetail[key].usersId,this.candidateNumber=this.groupCandidateDetail[key].number,this.candidateName=$rootScope.pullInterNationalization("spectrum."+this.groupCandidateDetail[key].personalityType),this.candidatedimensionType=this.groupCandidateDetail[key].dimensionType,this.candidatepersonalityDescription=this.groupCandidateDetail[key].personalityDescription,this.candidatevideoUrl=this.groupCandidateDetail[key].videoUrl;break}}function candidateUpdateFn(callback){$scope.$apply(function(){vm.candidateScreen=!0,vm.candidateDetail=callback.userDetail,vm.candidateName=callback.name,vm.candidateBalanceSelect=callback.className,vm.candidateNumber=callback.number,vm.candidatedimensionType=callback.dimensionType,vm.candidatepersonalityDescription=callback.personalityDescription,vm.candidatevideoUrl=callback.videoUrl})}function profileUpdateFn(callback){$scope.$apply(function(){vm.userScreen=!0,vm.userDetail=callback.userDetail,vm.profileName=callback.name,vm.profileBalanceSelect=callback.className,vm.profileNumber=callback.number,vm.dimensionType=callback.dimensionType,vm.personalityDescription=callback.personalityDescription,vm.videoUrl=callback.videoUrl})}function detectData(mode){this.noLearnerData="undefined"==typeof mode?!1:!!vm.learnerChartData[mode].graphs}function videoPopUp(url){$scope.videoUrl=url,ngDialog.open({template:vm.config.videoPopUpDialog,scope:$scope})}var vm=this;vm.groupDetail=[],vm.chartDataReady=!1,vm.groupRender=!1,vm.userScreen=!1,vm.userDetail=[],vm.profileBalanceSelect="",vm.learnerChartData=[],vm.candidateScreen=!1,vm.config={getProfileBalance:"/sp/spectrum/getProfileBalance",allGroups:"/sp/spectrum/groups/memberCount",learnerChart:"/sp/spectrum/getLearnerStatus",hiringInsights:"/sp/spectrum/getHiringInsights",hiringRoles:"/sp/spectrum/getHiringRoles",candidateProfileBalance:"/sp/spectrum/getHiringProfileBalance",videoPopUpDialog:"/sp/support/videoPopUp"},vm.groupsCall=groupsCall,vm.completedProfile=completedProfile,vm.candidateProfileList=candidateProfileList,vm.allGroups=allGroups,vm.profileBalanceChange=profileBalanceChange,vm.learnerChart=learnerChart,vm.hiringRoles=hiringRoles,vm.hiringInsights=hiringInsights,vm.candidateProfileBalance=candidateProfileBalance,vm.candidateBalanceChange=candidateBalanceChange,vm.candidateUpdateFn=candidateUpdateFn,vm.profileUpdateFn=profileUpdateFn,vm.detectData=detectData,vm.videoPopUp=videoPopUp,$scope.videoCall=function(){$scope.videoSrc=$scope.videoUrl;var videoType;if(/youtube/g.test($scope.videoSrc))videoType="youtube";else if(/vimeo/g.test($scope.videoSrc)){videoType="vimeo";var link=$scope.videoSrc.split("?")[0].split("/");$scope.videoSrc="https://vimeo.com/"+link[parseInt(link.length-1)]}else videoType="html5";setTimeout(function(){videojs(document.getElementById("vid1"),{autoplay:!1,techOrder:[videoType],src:$scope.videoSrc},function(){$scope.videoReady=!0,this.on("ended",function(){var vid=this;vid.trigger("loadstart"),$timeout(function(){vid.posterImage.show()},500)}),this.on("timeupdate",function(){var ct=this.currentTime(),timeLeft=this.remainingTime();ct>0&&this.bigPlayButton.hide(),0===timeLeft&&this.bigPlayButton.show()})})},500)}}angular.module("spApp").controller("spectrumController",spectrumController),spectrumController.$inject=["$scope","ajaxService","$localStorage","$timeout","$rootScope","ngDialog"],angular.module("spApp").directive("barChart",["$rootScope","$window",function($rootScope,$window){function tickValues(dataMax){for(var max=0,i=0;i<dataMax.length;i++)max<dataMax[i].number&&(max=dataMax[i].number);return max}function change(d){d3.select(this).attr("class","bar barBright-"+d.className)}function restore(d){d3.select(this).attr("class","bar bar-"+d.className)}function classes(root){function recurse(name,node){null===name?node.forEach(function(child){recurse(child.personalityType,child)}):classesList.push({name:$rootScope.pullInterNationalization("spectrum."+name),className:name.toLowerCase(),number:node.number,userDetail:node.usersId,percent:node.percent,index:node.percent+name+node.number,dimensionType:node.dimensionType,personalityDescription:node.personalityDescription,videoUrl:node.videoUrl})}var classesList=[];return recurse(null,root),{children:classesList}}var directiveDefinitionObject={restrict:"E",replace:!1,scope:{data:"=chartData",clickOperation:"=clickEvent",updateFn:"&"},link:function(scope,element,attrs){var duration=800,classToBind=$("."+attrs.classBind),legendSpace=150,margin={top:20,right:150,bottom:30,left:150},width=classToBind.width()-margin.left-margin.right,height=classToBind.height()-margin.top-margin.bottom,widthMar=(d3.format(",d"),width+margin.left+margin.right),heightMar=height+margin.top+margin.bottom,ease="cubic-in-out",svg=d3.select(element[0]).append("svg").attr("width","100%").attr("height","100%").attr("viewBox","0 0 "+widthMar+" "+heightMar).attr("preserveAspectRatio","xMinYMin").attr("class","barChart").append("g").attr("transform","translate("+margin.left+","+margin.top+")"),chart=$(".barChart"),barChartCreation=(chart.width()/chart.height(),chart.parent(),function(svgElem,data,scopePass){var x=d3.scale.linear().domain([0,d3.max(data,function(d){return 10*Math.ceil(d.number/10)})]).range([0,width-legendSpace]),y=d3.scale.ordinal().domain(d3.range(data.length)).rangeBands([0,height],.1),tickValue=tickValues(data);tickValue=10*Math.ceil(tickValue/10);for(var tickInterval=tickValue/10,tickList=[],i=tickInterval;tickValue>=i;i+=tickInterval)tickList.push(i);svgElem.selectAll("g.axis").remove(),svgElem.selectAll(".bar").remove();var xAxis=d3.svg.axis().scale(x).orient("bottom").tickSize(1).tickPadding(3).tickValues(tickList).innerTickSize(6),yAxis=d3.svg.axis().scale(y).orient("left").tickSize(1).tickPadding(6).tickFormat(function(d){return data[d].name});svgElem.append("g").attr("class","x axis").transition().duration(duration).ease(ease).attr("transform","translate(0,"+height+")").call(xAxis).selectAll("text").style("text-anchor","end").attr("dx","0em").attr("dy","1em").attr("x","3"),svgElem.append("g").attr("class","y axis").call(yAxis).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em"),svgElem.select(".y").selectAll(".tick").data(data).attr("class",function(d,i){return d.number?"tick click":void 0}).on("click",function(d,i){d.number&&scopePass.updateFn({callback:d})}),svgElem.select(".y").selectAll(".tick line").attr("x2","-4"),svgElem.select(".y").selectAll(".tick text").attr("y","-1"),svgElem.select(".x").selectAll(".tick").each(function(d){0===d&&this.remove()});var bars=svgElem.selectAll(".bar").data(data);bars.enter().append("g").attr("class",function(d){return"bar bar-"+d.className}).on("mouseout",restore).on("mouseover",change).on("click",function(d){return scopePass.clickOperation?void scopePass.updateFn({callback:d}):!0}).attr("transform",function(d,i){return"translate(0,"+y(i)+")"}),bars.append("rect").transition().duration(duration).ease(ease).attr("width",function(d){return d.number&&x(d.number)>15?x(d.number)-10:x(d.number)}).attr("height",20).attr("x",10),bars.append("text").attr("x",function(d){return x(d.number)+(6+7*d.number.toString().length)}).attr("y",10).attr("dy",".35em").attr("text-anchor","end").text(function(d){return d.number?d.number:void 0}),bars.exit().transition().style({opacity:0}).remove()});scope.$watch("data",function(newValue,oldValue){if("undefined"!=typeof scope.data&&scope.data.length){var dataToPass=classes(scope.data);barChartCreation(svg,dataToPass.children,scope)}})}};return directiveDefinitionObject}]),angular.module("spApp").directive("bubbleChart",["$parse","$rootScope","$window",function($parse,$rootScope,$window){function classes(root){function recurse(name,node){null===name?node.forEach(function(child){recurse(child.personalityType,child)}):classesList.push({name:$rootScope.pullInterNationalization("spectrum."+name),className:name.toLowerCase(),number:node.number,userDetail:node.usersId,percent:node.percent,index:node.percent+name+node.number})}var classesList=[];return recurse(null,root),{children:classesList}}function change(d){d3.select(this).attr("class","node bubbleBright-"+d.className)}function restore(d){d3.select(this).attr("class","node bubble-"+d.className)}$window=$(window);var directiveDefinitionObject={restrict:"E",replace:!1,scope:{data:"=chartData",clickOperation:"=clickEvent",updateFn:"&"},link:function(scope,element,attrs){var duration=800,delay=200,pad=240,classToBind=$("."+attrs.classBind),diameterw=classToBind.width(),diameterh=classToBind.height(),bubble=(d3.format(",d"),d3.scale.ordinal().domain(["Sqoop","Pig","Apache","a","b","c","d","e","f","g"]).range(["steelblue","pink","lightgreen","violet","orangered","green","orange","skyblue","gray","aqua"]),d3.layout.pack().sort(null).size([diameterw,diameterh]).value(function(d){return d.percent}).padding(pad)),svg=d3.select(element[0]).append("svg").attr("width",diameterw).attr("height",diameterh).attr("viewBox","0 0 1148 470").attr("perserveAspectRatio","xMinYMid").attr("class","bubble"),chart=$(".bubble"),bubbleChartCreation=(chart.width()/chart.height(),chart.parent(),function(svgElem,scopePass){var extraRadius=scopePass.data.length>4?40:1,node=svgElem.selectAll(".node").data(bubble.nodes(classes(scopePass.data)).filter(function(d){return!d.children}),function(d){return d.index}),nodeEnter=node.enter().append("g").on("mouseout",restore).on("mouseover",change).on("click",function(d){return scopePass.clickOperation?void scopePass.updateFn({callback:d}):!0}).attr("class",function(d){return"node bubble-"+d.className}).attr("transform",function(d){d.x-Math.ceil(Math.random()),d.y;return"translate("+d.x+","+d.y+")"}).style("opacity",1);nodeEnter.append("circle").attr("r",function(d){return 0}).transition().ease("elastic").attr("r",function(d){return parseInt(d.r+extraRadius,10)}),nodeEnter.append("text").attr("dy","0.3em").attr("stroke","#fff").attr("class","bubblePercentage").style("text-anchor","middle").style("font-size",function(d){return d.r>100?"18px":"12px"}).text(function(d){var param="";return d.number&&(param=" ("+d.number+")"),d.name+param}),nodeEnter.append("text").attr("dy","-0.8em").attr("dx","0.1em").attr("stroke","#fff").attr("class","bubbleName").style("font-size",function(d){return d.r>100?"20px":"14px"}).style("text-anchor","middle").text(function(d){return d.percent+"%"}),nodeEnter.append("svg:image").attr("x",function(d){return d.r>100?-11:-9}).attr("y","1em").attr("width",function(d){return d.r>100?20:14}).attr("height",function(d){return d.r>100?20:14}).attr("xlink:href","resources/css/images/graphsPlus.png"),node.select("circle").transition().ease("elastic").duration(duration).attr("r",function(d){return parseInt(d.r+extraRadius,10)}),node.exit().transition().duration(duration+delay).style("opacity",0).remove()});scope.$watch("data",function(newValue,oldValue){scope.data.length&&bubbleChartCreation(svg,scope)})}};return directiveDefinitionObject}]),angular.module("spApp").directive("pieChartsp",["$parse","$rootScope","$window",function($parse,$rootScope,$window){var directiveDefinitionObject={restrict:"E",replace:!1,scope:{data:"=chartData",clickOperation:"=clickEvent"},link:function(scope,element,attrs){var pieChartCreation=function(){for(var formattedData={},formattedDataKeys=[],formattedColor=[],color=["#f59f13","#eb6b10","#cc3300","#660000"],i=0,ii=scope.data.length;ii>i;i++){var currentContentObject=scope.data[i];formattedDataKeys.push($rootScope.pullInterNationalization("spectrum.piechart."+currentContentObject.ageCategory)),formattedData[$rootScope.pullInterNationalization("spectrum.piechart."+currentContentObject.ageCategory)]=currentContentObject.percent,formattedColor.push(color[i])}c3.generate({bindto:"#ageRatioChart",data:{json:[formattedData],keys:{value:formattedDataKeys},type:"pie"},color:{pattern:formattedColor},legend:{item:{onclick:function(id){}}}})};scope.$watch("data",function(newValue,oldValue){"undefined"!=typeof scope.data&&pieChartCreation()})}};return directiveDefinitionObject}]),angular.module("spApp").directive("learnerChart",["$parse","$rootScope","$window","$filter",function($parse,$rootScope,$window,$filter){function dateConvertor(date,mode){switch(mode){case"WEEK":return $filter("date")(new Date(date),"MMM")+" "+new Date(date).getDate();case"YEAR":return $filter("date")(new Date(date),"MMM")+" "+new Date(date).getFullYear();case"DAY":return(parseInt(date,10)+11)%12+1+(date>11?"PM":"AM");case"MONTH":return $filter("date")(new Date(date),"MMM")+" "+new Date(date).getDate()}}var directiveDefinitionObject={restrict:"E",replace:!1,scope:{data:"=chartData",mode:"=selected"},link:function(scope,element,attrs){var otherObject={grouped:!1,position:function(data,width,height,element){var chartOffsetX=document.querySelector("#learnerChart").getBoundingClientRect().left,graphOffsetX=document.querySelector("#learnerChart g.c3-axis-y").getBoundingClientRect().right,tooltipWidth=document.getElementById("tooltip").parentNode.clientWidth,x=parseInt(element.getAttribute("cx"))+graphOffsetX-chartOffsetX-Math.floor(tooltipWidth/2),y=element.getAttribute("cy");return y=y-height-14,{top:y+5,left:x+5}},contents:function(data,defaultTitleFormat,defaultValueFormat,color){var text,i,title,value,$$=this,config=$$.config,titleFormat=config.tooltip_format_title||defaultTitleFormat,valueFormat=(config.tooltip_format_name||function(name){return name},config.tooltip_format_value||defaultValueFormat);for(i=0;i<data.length;i++)data[i]&&(data[i].value||0===data[i].value)&&(text||(title=titleFormat?titleFormat(data[i].x):data[i].x,text="<div id='tooltip' class='d3-tip'>"),value=valueFormat(data[i].value,data[i].ratio,data[i].id,data[i].index),text+="<div class='c3-box-styling'>",text+="<div class='value'>"+value+"</div>",text+="<div class='title'>"+title+"</div>",text+="</div></div>");return text}},ieObject={grouped:!0,contents:function(data,defaultTitleFormat,defaultValueFormat,color){var text,i,title,value,$$=this,config=$$.config,titleFormat=config.tooltip_format_title||defaultTitleFormat,valueFormat=(config.tooltip_format_name||function(name){return name},config.tooltip_format_value||defaultValueFormat);for(i=0;i<data.length;i++)data[i]&&(data[i].value||0===data[i].value)&&(text||(title=titleFormat?titleFormat(data[i].x):data[i].x,text="<div id='tooltip' class='d3-tip'>"),value=valueFormat(data[i].value,data[i].ratio,data[i].id,data[i].index),text+="<div class='c3-box-styling'>",text+="<div class='value'>"+value+"</div>",text+="<div class='title'>"+title+"</div>",text+="</div></div>");return text}},ie=$("html").hasClass("ie")?ieObject:otherObject,learnerChartCreation=function(){var learnerGraphData=scope.data,type=scope.mode,graphs="undefined"!=typeof type?learnerGraphData[type].graphs:null,plot=[],xAxisGraph=[];for(var key in graphs)plot.push({date:dateConvertor(key.replace(".","-").replace(".","-"),type),articlesRead:graphs[key]}),xAxisGraph.push(graphs[key]);c3.generate({bindto:"#learnerChart",data:{json:plot,keys:{value:["articlesRead"]},type:"area"},size:{height:300},axis:{x:{tick:{format:function(x){return plot[x].date},culling:{max:10}},padding:{left:.75,right:.75}},y:{show:!1}},point:{r:3,focus:{expand:{r:4}}},tooltip:ie})};scope.$watch("[mode,data]",function(newValue,oldValue){learnerChartCreation()},!0)}};return directiveDefinitionObject}]),angular.module("spApp").directive("radialGraph",["$rootScope","$window",function($rootScope,$window){var directiveDefinitionObject={restrict:"E",replace:!1,scope:{data:"=actual",expected:"=expected",labelshown:"=labeldisplay",rolechanges:"=rolechanges",selected:"=selected"},link:function(scope,element,attrs){var diameter=100,ringThickness=12,margin={left:0,right:0,top:0,bottom:0},svg=d3.select(element[0]).append("svg").attr("height","100%").attr("width","100%").attr("viewBox","0 0 "+(margin.left+diameter+margin.right)+" "+(margin.top+diameter+margin.bottom)).attr("preserveAspectRatio","xMidYMid meet").attr("class","radialGraph"),radialGraphCreation=function(svgElem,scopePass){function arcTween(transition,newAngle){transition.attrTween("d",function(d){var interpolate=d3.interpolate(d.endAngle,newAngle);return function(t){return d.endAngle=interpolate(t),text.text(scopePass.data*scopePass.expected),arc(d)}})}svgElem.selectAll("g text").remove(),svgElem.selectAll("g .foreground").remove();var vis=svgElem.append("g").attr("transform","translate("+(margin.left+diameter/2)+","+(margin.top+diameter/2)+")"),arc=d3.svg.arc().outerRadius(diameter/2).innerRadius(diameter/2-ringThickness).startAngle(0),area=2*Math.PI,text=vis.append("text").text("0").attr("text-anchor","middle").attr("dx",0).attr("dy",10).attr("class","radial-actual"),foreground=(vis.append("text").text(scopePass.labelshown[0]).attr("text-anchor","middle").attr("dx","0").attr("dy","60").attr("class","progress-text"),vis.append("path").datum({endAngle:area}).style("fill","#acacac").attr("d",arc).attr("class","background"),vis.append("path").datum({endAngle:0}).style("fill","#f06739").attr("d",arc).attr("class","foreground")),newAngle=area*scopePass.data;foreground.transition().delay(200).duration(1500).call(arcTween,newAngle)};scope.$watch("[data,rolechanges,selected]",function(newValue,oldValue){radialGraphCreation(svg,scope)},!0)}};return directiveDefinitionObject}]);
function supportController($scope,$localStorage,ngDialog,sharedProperties){$scope.videoReady=!1,jQuery(function($){if($(".support-body").length){var $toggleFaq=$(".section-faq-header"),$list=$(".nav-support-link-list"),$contentArea=$(".main-support-content"),$iniSectionFaq=$(".section-faq.defaultOpen"),$upTarget=($iniSectionFaq.find(".section-faq-content").outerHeight(),$iniSectionFaq.find(".x-section-faq-content")),$mobileNavSupport=$(".mobileNavigationSupport"),_href=window.location.href,status=sharedProperties.getParam("submit");$iniSectionFaq.addClass("show"),$(".js_hostName").val(_href+"?submit=support"),null!=status&&$.growl({icon:"glyphicon glyphicon-ok",message:"Message sent successfully"}),setTimeout(function(){$toggleFaq.css({WebkitTransition:"all 400ms ease-in-out",MozTransition:"all 400ms ease-in-out",MsTransition:"all 400ms ease-in-out",OTransition:"all 400ms ease-in-out",transition:"all 400ms ease-in-out"})},500),$upTarget.height("100%"),$toggleFaq.on("click",function(){var $this=$(this),$html=$this.closest(".section-faq"),$upTarget=$html.find(".x-section-faq-content"),$upTargetHeight=$upTarget.outerHeight(),$elHeight=$html.find(".section-faq-content").outerHeight();return $this.hasClass("noAction")?!1:($upTargetHeight>1?$upTarget.height(0):$upTarget.height($elHeight),void $html.toggleClass("show"))}),$(".js_helpFormSubmit").on("click",function(event){var messageVal=$(".js_message_type").val(),textLength=$(".js_textarea").val().length,$messageErr=$(".js_select_error"),$textErr=$(".js_narrow_message");"-1"===messageVal?$messageErr.addClass("support_show"):$messageErr.addClass("support_hide"),20>textLength?($(".js_textarea").addClass("extra-spacing"),$textErr.addClass("support_show")):($textErr.addClass("support_hide"),$(".js_textarea").removeClass("extra-spacing")),"-1"!==messageVal&&textLength>19?$(".js_help_form").submit():event.preventDefault()}),$list.find("li a").on("click",function(){var _this=$(this),listId=_this.attr("data-list"),text=_this.text();toggleHideShow(listId,_this),$(".mobileNavigationText").find(".selectedTabText").html(text)}),$mobileNavSupport.length&&$mobileNavSupport.find("li a").on("click",function(){var _this=$(this),listId=_this.attr("data-list"),text=_this.text();toggleHideShow(listId,_this),$mobileNavSupport.hasClass("menuShow")?$mobileNavSupport.removeClass("menuShow").addClass("menuHide"):$mobileNavSupport.removeClass("menuHide").addClass("menuShow"),$list.find("li a").removeClass("active"),$list.find("li a[data-list='"+listId+"']").addClass("active"),$(".mobileNavigationText").find(".selectedTabText").html(text)});var toggleHideShow=function(listId,_this){$list.find("li a").removeClass("active"),_this.addClass("active"),$contentArea.find(".support-customer").removeClass("local-show"),$contentArea.find(".support-customer[data-tab='"+listId+"']").addClass("local-show")},userType=function(){var userRoles=$localStorage.get("loggegdInProfile").member.roles,hiringFlag=-1!==userRoles.indexOf("Hiring")?!0:!1,adminFlag=-1!==userRoles.indexOf("Administrator")?!0:!1,accountAdminFlag=-1!==userRoles.indexOf("AccountAdministrator")?!0:!1,individualUser=-1!==userRoles.indexOf("IndividualAccountAdministrator")?!0:!1;individualUser?($contentArea.find(".support-customer[data-tab='2'] .childAccount:eq(1)").addClass("local-show"),$contentArea.find(".support-customer[data-tab='2'] .childAccount:eq(0)").addClass("local-hide")):($contentArea.find(".support-customer[data-tab='2'] .childAccount:eq(0)").addClass("local-show"),$contentArea.find(".support-customer[data-tab='2'] .childAccount:eq(1)").addClass("local-hide")),adminFlag&&$contentArea.find(".support-customer[data-tab='2'] .childAccount:eq(0) .adminFlag").addClass("local-show"),accountAdminFlag&&$contentArea.find(".support-customer[data-tab='2'] .childAccount:eq(0) .accountAdminFlag").addClass("local-show"),hiringFlag&&$contentArea.find(".support-customer[data-tab='1'] .hiring-section").addClass("local-show")};!function(){userType(),$("textarea").focus(function(){this.placeholder===this.value&&(this.value="")}).blur(function(){""===this.value&&(this.value=this.placeholder)})}()}}),$scope.videoPopUp=function(url){$scope.videoUrl=url,ngDialog.open({template:"/sp/support/videoPopUp",scope:$scope})},$scope.videoCall=function(){$scope.videoSrc=$scope.videoUrl;var videoType;if(/youtube/g.test($scope.videoSrc))videoType="youtube";else if(/vimeo/g.test($scope.videoSrc)){videoType="vimeo";var link=$scope.videoSrc.split("?")[0].split("/");$scope.videoSrc="https://vimeo.com/"+link[parseInt(link.length-1)]}else videoType="html5";setTimeout(function(){videojs(document.getElementById("vid1"),{autoplay:!1,techOrder:[videoType],src:$scope.videoSrc},function(){$scope.videoReady=!0})},500)}}angular.module("spApp").controller("supportController",supportController),supportController.$inject=["$scope","$localStorage","ngDialog","sharedProperties"];
function sysAdminPanel($scope,$element,$attrs,ajaxService,$state,$filter,sharedProperties,$rootScope){$scope.memberList=[],$scope.masterMemberList=[],$scope.pageSize=10,$scope.intialPageSize=10,$scope.lastPredicate="name",$scope.lastReverse=!1,$scope.userEmail={email:[]},$scope.textSearching="",$scope.checkedAll=!1,$scope.getLoggedInUserList=function(){var options={url:"/sp/sysAdmin/hk/getLoggedInUsers",method:"get"};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&($scope.masterMemberList=response.loggedInUsers.length?response.loggedInUsers:[],$scope.memberList=angular.copy($scope.masterMemberList),$scope.returnMemberList($scope.pageSize),$scope.change="email")})},$scope.getUserList=function(){var options={url:"/sp/sysAdmin/hk/getUserList",method:"get"};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&($scope.masterMemberList=response.users.length?response.users:[],$scope.memberList=angular.copy($scope.masterMemberList),$scope.returnMemberList($scope.pageSize),$scope.change="email")})},$scope.getCompanyList=function(){var options={url:"/sp/sysAdmin/hk/getCompanyList",method:"get"};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&($scope.masterMemberList=response.companies.length?response.companies:[],$scope.memberList=angular.copy($scope.masterMemberList),$scope.returnMemberList($scope.pageSize),$scope.change="phoneNumber")})},$scope.order=function(predicate,reverse){$scope.lastPredicate=predicate,$scope.lastReverse=reverse,$scope.memberList=$filter("orderBy")($scope.memberList,predicate,reverse)},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.returnMemberList($scope.pageSize)},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize))},$scope.active=function(event){sharedProperties.toggleFilterClick(event,$scope.currentPredicate)},$scope.infinteScroll=function(arg){$scope.returnMemberList(arg)},$scope.returnMemberList=function(pageSize){return $scope.masterMemberList.length?($scope.memberList=sharedProperties.searchModuleName($scope.textSearching,$scope.masterMemberList,2,$scope.change),$scope.pageSize=pageSize,pageSize>=$scope.masterMemberList.length&&($scope.disabledInfinite=!0,$scope.pageSize=$scope.masterMemberList.length),$scope.order($scope.lastPredicate,$scope.lastReverse),void($scope.memberList=$scope.memberList)):!0},$scope.checkUncheck=function(){$scope.alltoggle=!1,$scope.checkedAll&&($scope.negative=!$scope.negative,$scope.checkedAll=!$scope.checkedAll)},$scope.checkAll=function(){$scope.checkedAll=!$scope.checkedAll,$scope.negative?$scope.userEmail.email=$scope.masterMemberList.map(function(item){return{email:item.email,name:item.name,title:item.title}}):$scope.userEmail.email=[]}}angular.module("spApp").controller("sysAdminPanel",sysAdminPanel),sysAdminPanel.$inject=["$scope","$element","$attrs","ajaxService","$state","$filter","sharedProperties","$rootScope"];
function themeDetailsController($scope,$element,$attrs,ngDialog,$timeout,sharedProperties,ajaxService,$rootScope,$localStorage,$filter){$scope.accountsListException=!1,$scope.updatedAccountListing=[],$scope.selectedAccountsCount=0,$scope.updatedListingIndex=0,$scope.accountList={},$scope.selectedCompanyIdList=[],$scope.allAccountsIdList=[],$scope.accountList.search=null,$scope.filteredAccountListing={},$scope.newTheme={},$scope.newTheme.validationErrors=!1,$scope.newThemeDetails={},$scope.updateThemeException=!1,$scope.themeDetailsEditing={},$scope.themeDetailsEditing.status=!1,$scope.themeId=sharedProperties.getParam("t"),$scope.getThemeDetailsException=!1,$scope.selectedAccountsDisplayList=[],$scope.getAccountList=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/hk/getCompanyList",method:"GET"}).then(function(response){if("true"===response.Success)$scope.accountsListException=!1,$scope.accountListing=response.companies,jQuery.each($scope.accountListing,function(i,j){$scope.updatedAccountListing.push(jQuery.extend({},$scope.accountListing[i],{accountSelectedStatus:!1})),$scope.allAccountsIdList.push($scope.accountListing[i].id)});else{$scope.accountsListException=!0;for(var key in response.error)$scope.accountsListExceptionMsg=response.error[key]}})},$scope.addtoSelectedAccounts=function(id){jQuery.each($scope.updatedAccountListing,function(i){return $scope.updatedAccountListing[i].id===id?($scope.updatedAccountListing[i].accountSelectedStatus=!0,$scope.selectedAccountsCount+=1,$scope.selectedCompanyIdList.push($scope.updatedAccountListing[i].id),$scope.updatedAccountListing[i].updatedListingIndex=$scope.updatedListingIndex++,!1):void 0})},$scope.removeFromSelectedAccounts=function(id){jQuery.each($scope.updatedAccountListing,function(i){return $scope.updatedAccountListing[i].id===id?($scope.updatedAccountListing[i].accountSelectedStatus=!1,$scope.selectedAccountsCount-=1,$scope.selectedCompanyIdList.splice($scope.selectedCompanyIdList.indexOf(id),1),!1):void 0})},$scope.removeAllSelectedAccounts=function(){jQuery.each($scope.updatedAccountListing,function(i){$scope.updatedAccountListing[i].accountSelectedStatus=!1,$scope.updatedAccountListing[i].updatedListingIndex=null}),$scope.selectedAccountsCount=0,$scope.selectedCompanyIdList=[]},$scope.addFilteredAccounts=function(){var selectedList=$filter("filter")($scope.updatedAccountListing,$scope.accountList.search);jQuery.each(selectedList,function(i){jQuery.each($scope.updatedAccountListing,function(j){selectedList[i].id===$scope.updatedAccountListing[j].id&&($scope.updatedAccountListing[j].accountSelectedStatus=!0,$scope.selectedAccountsCount+=1,$scope.selectedCompanyIdList.push($scope.updatedAccountListing[j].id),$scope.updatedAccountListing[j].updatedListingIndex=$scope.updatedListingIndex++)})}),$scope.accountList.search=null},$scope.themeDetailsEdit=function(s){"enable"===s?$scope.themeDetailsEditing.status=!0:($scope.themeDetailsEditing.status=!1,$scope.getThemeDetails()),$scope.accountList.search=null},$scope.updateThemeDetails=function(fData){var _params;$scope.newTheme.validationErrors=!1,$scope.createNewThemeException=!1,"All"===fData.assignAccounts?($scope.accList=$scope.allAccountsIdList,_params={name:fData.name,description:fData.description,status:fData.status,category:fData.category,isMandatory:fData.isMandatory,allAccounts:!0,goalId:$scope.themeId}):($scope.accList=$scope.selectedCompanyIdList,_params={name:fData.name,description:fData.description,status:fData.status,category:fData.category,isMandatory:fData.isMandatory,accounts:$scope.accList.join(),allAccounts:!1,goalId:$scope.themeId}),this.newTheme.$valid&&$scope.accList.length>0?($scope.newTheme.validationErrors=!1,ajaxService.getAjaxResponse({url:"/sp/sysAdmin/goals/updateGoal",data:$.param(_params)}).then(function(response){if("true"===response.Success)$scope.updateThemeException=!1,$scope.themeDetailsEdit(),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Details</strong>",message:" updated successfully."});else{$scope.updateThemeException=!0;for(var key in response.error)$scope.updateThemeExceptionMsg=response.error[key]}})):$scope.newTheme.validationErrors=!0},$scope.getThemeDetails=function(){null!==$scope.themeId&&"undefined"!=typeof $scope.themeId&&ajaxService.getAjaxResponse({url:"/sp/sysAdmin/goals/getGoalDetail",data:$.param({goalId:$scope.themeId})}).then(function(response){if("true"===response.Success)if($scope.getThemeDetailsException=!1,$scope.currentThemeDetails=response.goal,$scope.newThemeDetails.name=$scope.currentThemeDetails.name,$scope.newThemeDetails.description=$scope.currentThemeDetails.description,$scope.newThemeDetails.category=$scope.currentThemeDetails.category,$scope.newThemeDetails.isMandatory=$scope.currentThemeDetails.mandatory.toString(),$scope.newThemeDetails.status=$scope.currentThemeDetails.status,$scope.currentThemeDetails.allAccounts===!0)$scope.newThemeDetails.assignAccounts="All";else{$scope.selectedAccountsDisplayList=[],$scope.selectedCompanyIdList=[],$scope.selectedAccountsCount=0,$scope.newThemeDetails.assignAccounts="Selected";var _c=$scope.currentThemeDetails.companyDTO;jQuery.each(_c,function(i){jQuery.each($scope.updatedAccountListing,function(j){_c[i].id===$scope.updatedAccountListing[j].id&&($scope.updatedAccountListing[j].accountSelectedStatus=!0,$scope.selectedAccountsCount+=1,$scope.selectedCompanyIdList.push($scope.updatedAccountListing[j].id),$scope.updatedAccountListing[j].updatedListingIndex=$scope.updatedListingIndex++,$scope.selectedAccountsDisplayList.push($scope.updatedAccountListing[j]))})})}else $scope.getThemeDetailsException=!0})},function(){$scope.getAccountList(),$timeout(function(){$scope.getThemeDetails()},300)}()}angular.module("spApp").controller("themeDetailsController",themeDetailsController),themeDetailsController.$inject=["$scope","$element","$attrs","ngDialog","$timeout","sharedProperties","ajaxService","$rootScope","$localStorage","$filter"];
function themeListingController($scope,$q,$element,$attrs,ajaxService,$location,$http,$state,$filter,ngDialog,sharedProperties,$timeout,$rootScope,$localStorage){$scope.themesListMaster=[],$scope.getAllError=!1,$scope.searchTag=[],$scope.pageSize=10,$scope.statusInclude=[],$scope.textSearching="",$scope.intialPageSize=10,$scope.load=!0,$scope.formatMonth=function(d){if(null!==d&&"undefined"!=typeof d){var splitDate=d.split(" "),formatMonth=splitDate[0].substr(0,3).toUpperCase(),formattedDate=formatMonth+" "+splitDate[1]+" "+splitDate[2];return formattedDate}},$scope.getFullThemeList=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/goals/getAllGoals"}).then(function(response){if("true"===response.Success)$scope.getAllError=!1,$scope.themesListMaster=response.goals,$scope.returnMemberList($scope.pageSize);else{$scope.getAllError=!0;for(var key in response.error)$scope.getAllErrorMsg=response.error[key]}})},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.returnMemberList($scope.pageSize)},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize))},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.returnMemberList=function(pageSize){if(!$scope.themesListMaster.length)return!0;if($scope.searchTag.length&&!$scope.statusInclude.length&&($scope.themesList=angular.copy($scope.newArr)),$scope.searchTag.length&&$scope.statusInclude.length){$scope.combineArray=[];for(var i=0;i<$scope.newArr.length;i++)for(var j=0;j<$scope.checkBox.length;j++)$scope.newArr[i].email===$scope.checkBox[j].email&&$scope.combineArray.push($scope.newArr[i]);$scope.themesList=angular.copy($scope.combineArray)}!$scope.searchTag.length&&$scope.statusInclude.length&&($scope.themesList=angular.copy($scope.checkBox)),$scope.searchTag.length||$scope.statusInclude.length||($scope.themesList=angular.copy($scope.themesListMaster)),$scope.pageSize=pageSize,pageSize>=$scope.themesListMaster.length&&($scope.disabledInfinite=!0,$scope.pageSize=$scope.themesListMaster.length),$scope.load&&($scope.lastPredicate="name",$scope.lastReverse=!1,$scope.loadBtnCLicked=!1,$scope.load=!1),$scope.loadBtnCLicked&&($scope.loadBtnCLicked=!1),$scope.order($scope.lastPredicate,$scope.lastReverse),$scope.themesList=$scope.themesList},$scope.active=function(event){var currentElem=$(event.currentTarget);currentElem.find("h4").hasClass("on")?currentElem.find("h4").hasClass("reverseon")?currentElem.find("h4").removeClass("reverseon"):currentElem.find("h4").addClass("reverseon"):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"))},$scope.order=function(predicate,reverse){$scope.lastPredicate=predicate,$scope.lastReverse=reverse,$scope.themesList=$filter("orderBy")($scope.themesList,predicate,reverse)},$scope.resetfilter=function(allmembers){$scope.pageSize=$scope.intialPageSize,$scope.newArr=[],$scope.searchTag=[],$scope.tags=[],$scope.filter={},$scope.statusInclude=[],$scope.adminc=!1,$scope.leadC=!1,$scope.textSearching="",$scope.searchText="","undefined"!=typeof this.selectedSearch&&(this.selectedSearch.userStatusFormatted="",this.selectedSearch.hiringRoles=""),$scope.themesList=angular.copy($scope.themesListMaster),"undefined"!=typeof allmembers&&($scope.pageSize=$scope.themesListMaster.length),angular.element($(".tags").find("input")).scope().newTag.text="",$scope.load=!0,$scope.disabledInfinite=!1,$rootScope.$broadcast("$scrollStart"),$scope.returnMemberList($scope.pageSize);var curr=$(".memberHolder");curr.find(".heading h4").removeClass("reverseon").removeClass("on"),curr.find(".heading h4:eq(0)").addClass("on")},$scope.updateStatusError=!1,$scope.updateAffiliateCodeStatus=function(status,pid){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/promotions/updateStatus",data:$.param({promotionId:pid,promotionStatus:status})}).then(function(response){if("true"===response.Success)$scope.updateStatusError=!1,ngDialog.close("ngdialog1"),$scope.getFullThemeList(),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Status</strong>",message:" updated successfully"});else{$scope.updateStatusError=!0;for(var key in response.error)$scope.updateStatusErrorMsg=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.updateStatusErrorMsg})}})},$scope.deactivateThemeException=!1,$scope.deActivateTheme=function(d,n){$scope.currentThemeName=n,$scope.processDeactivate=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/goals/deactivate",data:$.param({goalId:d})}).then(function(response){if("true"===response.Success)$scope.deactivateThemeException=!1,$scope.getFullThemeList(),ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Status</strong>",message:" updated successfully"});else{$scope.deactivateThemeException=!0;for(var key in response.error)$scope.deactivateThemeExceptionMsg=response.error[key];ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.deactivateThemeExceptionMsg})}})},ngDialog.open({template:"/sp/resources/html/sysAdmin/learning-library/deactivateTheme.html",scope:$scope})},$scope.activateThemeException=!1,$scope.activateTheme=function(d){$scope.processActivate=function(){ajaxService.getAjaxResponse({url:"/sp/sysAdmin/goals/activate",data:$.param({goalId:d})}).then(function(response){if("true"===response.Success)$scope.activateThemeException=!1,$scope.getFullThemeList(),ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Status</strong>",message:" updated successfully"});else{$scope.activateThemeException=!0;for(var key in response.error)$scope.deactivateThemeExceptionMsg=response.error[key];ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:$scope.updateStatusErrorMsg})}})},ngDialog.open({template:"/sp/resources/html/sysAdmin/learning-library/activateTheme.html",scope:$scope})},function(){var growlNotification=$localStorage.get("gNotify");null!==growlNotification&&"undefined"!=typeof growlNotification&&("AddTheme"===growlNotification&&$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Theme</strong>",message:" created successfully"}),setTimeout(function(){$localStorage.remove("gNotify")},1e3)),$scope.getFullThemeList()}()}angular.module("spApp").controller("themeListingController",themeListingController),themeListingController.$inject=["$scope","$q","$element","$attrs","ajaxService","$location","$http","$state","$filter","ngDialog","sharedProperties","$timeout","$rootScope","$localStorage"];
function validateImportedListController($scope,$q,$element,$attrs,$http,ajaxService,$location,$state,$filter,ngDialog,sharedProperties,$timeout,$localStorage){$scope.memberList=[],$scope.masterMemberList=[],$scope.showfilter=!1,$scope.pageSize=200,$scope.intialPageSize=20,$scope.searchTag=[],$scope.hiringRoles=[],$scope.alldisplay=!1,$scope.filter={},$scope.tags=[],$scope.userEmail={email:[]},$scope.checkBox=[],$scope.submitDisabled=!1,$scope.allMembersEmailId=[],$scope.statusInclude=[],$scope.setEditMode=!1,$scope.userStatus=[],$scope.groupModule=[],$scope.masterGroupModule=[],$scope.textSearching="",$scope.mainGroupInfoList=[],$scope.checkedAll=!1,$scope.deleteUser=!1,$scope.deleteUserError=!1,$scope.updateGroup=!1,$scope.updateGroupError=!1,$scope.updateError="",$scope.EditGroupEmail="",$scope.archiveDialog={},$scope.archiveDialog.addHiring=!1,$scope.showArchive=!1,$scope.newDate={},$scope.totalRecords=0,$scope.totalConflicts=0,$scope.conflictException=!1,$scope.noEmailsError=!1,$scope.cancelRedirect=function(){window.location="/sp/tools/hiring/"},$scope.newDate.currentDay=new Date,$scope.newDate={year:$scope.newDate.currentDay.getFullYear(),month:$scope.newDate.currentDay.getMonth()+1,day:$scope.newDate.currentDay.getDate()},$scope.formatDate=function(d){if(null!==d&&"undefined"!==d){var splitDate=d.split("-"),monthData={"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"},month=splitDate[1],formattedDate=monthData[month.toString()]+" "+parseInt(splitDate[2])+", "+parseInt(splitDate[0]);return formattedDate}},$scope.today=$scope.formatDate($scope.newDate.year+"-"+($scope.newDate.month<9?"0"+$scope.newDate.month:$scope.newDate.month)+"-"+$scope.newDate.day),$scope.formatName=function(n){if(null!==n||"undefined"!==n){var slpitName=n.split(", "),formatName=slpitName[1]+" "+slpitName[0];return formatName}},$scope.getMembersData=function(){var options={url:"/sp/hiring/multiInviteValidate",data:$.param({filesToProcess:$localStorage.get("files")}).replace(/%2C/g,",").replace(/%40/g,"@")};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&($scope.masterMemberList=response.hiring.length?response.hiring:[],$scope.returnMemberList($scope.pageSize),angular.forEach(response.hiring,function(val,index){$scope.allMembersEmailId.push(val.email)}),$scope.totalRecords=response.hiring.length,$.each($scope.masterMemberList,function(i){("ALREADY_EXISTS"===$scope.masterMemberList[i].userStatus||"ALREADY_EXISTS_ARCHIVED"===$scope.masterMemberList[i].userStatus)&&$scope.totalConflicts++}),$scope.totalRecords>$scope.availableSubscriptions&&($scope.candidateCountException=!0,$scope.removeCandidates=Math.abs($scope.totalRecords-$scope.availableSubscriptions)),$scope.totalConflicts>0||$scope.totalRecords>$scope.availableSubscriptions?$scope.submitDisabled=!0:$scope.submitDisabled=!1)})},$scope.getCandidateAvailability=function(){ajaxService.getAjaxResponse({url:"/sp/hiring/getAvailableSubscriptions"}).then(function(response){"true"===response.Success&&($scope.availableSubscriptions=response.availableHiringSubscripitons,setTimeout(function(){$scope.getMembersData()},200))})},$scope.enableAdvanceSection=function(event){$(event.currentTarget).closest(".complete-profile").find(".editable-section").show()},$scope.autoCompleteType=function(arr){for(var customarray=[],i=0;i<arr.length;i++)customarray.push({text:arr[i]});return customarray},$scope.order=function(predicate,reverse){$scope.memberList=$filter("orderBy")($scope.memberList,predicate,reverse)},$scope.loadTags=function(query){var deferred=$q.defer();return deferred.resolve($scope.getLoadSuggestion(query)),deferred.promise},$scope.getLoadSuggestion=function(query){for(var copyArray=[],i=0;i<$scope.tagListArray.length;i++)angular.lowercase($scope.tagListArray[i].text).indexOf(angular.lowercase(query))>-1&&copyArray.push($scope.tagListArray[i]);return copyArray.slice(0,5)},$scope.tagAdded=function(tag){$scope.searchTag.push(tag.text),$scope.refineSearch($scope.searchTag)},$scope.tagRemoved=function(tag){$scope.searchTag.splice($scope.searchTag.indexOf(tag.text),1),$scope.refineSearch($scope.searchTag)},$scope.refineSearch=function(list){$scope.newArr=[],angular.forEach($scope.masterMemberList,function(val,key){if(null!=val.tagList)for(var i=0;i<list.length;i++){var exists=val.tagList.indexOf(list[i]);exists>=0&&$scope.newArr.push(val)}}),$scope.checkboxFilter()},$scope.includeCheck=function(status){var i=$.inArray(status,$scope.statusInclude);i>-1?$scope.statusInclude.splice(i,1):$scope.statusInclude.push(status),$scope.checkboxFilter()},$scope.checkboxFilter=function(status){$scope.statusInclude.length>0&&($scope.checkBox=[],angular.forEach($scope.masterMemberList,function(val,index){for(var i=0;i<$scope.statusInclude.length;i++)for(var j=0;j<val.roles[i].length;j++)val.roles[j]===$scope.statusInclude[i]&&$scope.checkBox.push(val)})),$scope.returnMemberList($scope.pageSize)},$scope.searchTextFilter=function(search){$scope.textSearching=search,$scope.returnMemberList($scope.pageSize)},$scope.enableCancel=function(search){return"undefined"!=typeof search&&search.length>1?!0:!1},$scope.clearSearch=function(){$scope.textSearching.length&&($scope.textSearching="",$scope.searchText="",$scope.returnMemberList($scope.pageSize))},$scope.active=function(event){var currentElem=$(event.currentTarget);currentElem.find("h4").hasClass("on")?currentElem.find("h4").hasClass("reverseon")?currentElem.find("h4").removeClass("reverseon"):currentElem.find("h4").addClass("reverseon"):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"))},$scope.returnMemberList=function(pageSize){if($scope.searchTag.length&&!$scope.statusInclude.length&&($scope.memberList=angular.copy($scope.newArr)),$scope.searchTag.length&&$scope.statusInclude.length){$scope.combineArray=[];for(var i=0;i<$scope.newArr.length;i++)for(var j=0;j<$scope.checkBox.length;j++)$scope.newArr[i].email===$scope.checkBox[j].email&&$scope.combineArray.push($scope.newArr[i]);$scope.memberList=angular.copy($scope.combineArray)}if(!$scope.searchTag.length&&$scope.statusInclude.length&&($scope.memberList=angular.copy($scope.checkBox)),$scope.searchTag.length||$scope.statusInclude.length||($scope.memberList=angular.copy($scope.masterMemberList)),$scope.textSearching.length>2){for(var copyArray=[],z=0;z<$scope.memberList.length;z++)angular.lowercase($scope.memberList[z].name).indexOf(angular.lowercase($scope.textSearching))>-1&&copyArray.push($scope.memberList[z]);$scope.memberList=angular.copy(copyArray)}pageSize>=$scope.memberList.length?$scope.alldisplay=!0:$scope.alldisplay=!1,$scope.pageSize=pageSize,$scope.memberList=$scope.memberList.slice(0,pageSize)},$scope.checkAll=function(){$scope.checkedAll=!$scope.checkedAll,$scope.negative?$scope.userEmail.email=$scope.masterMemberList.map(function(item){return{email:item.email,name:item.name}}):$scope.userEmail.email=[]},$scope.deleteContact=function(email){var index,counter=0;$.each($scope.masterMemberList,function(i){$scope.masterMemberList[i].email===email&&(index=i,("ALREADY_EXISTS"===$scope.masterMemberList[i].userStatus||"ALREADY_EXISTS_ARCHIVED"===$scope.masterMemberList[i].userStatus)&&$scope.totalConflicts--),counter++}),counter===$scope.masterMemberList.length&&($scope.masterMemberList.splice(index,1),$scope.memberList=angular.copy($scope.masterMemberList),$scope.totalRecords=$scope.memberList.length,0===$scope.totalConflicts&&$scope.totalRecords<=$scope.availableSubscriptions&&($scope.candidateCountException=!1,$scope.submitDisabled=!1))},$scope.resetfilter=function(allmembers){$scope.pageSize=$scope.intialPageSize,$scope.newArr=[],$scope.searchTag=[],$scope.tags=[],$scope.filter={},$scope.userEmail.email=[],$scope.statusInclude=[],$scope.adminc=!1,$scope.leadC=!1,$scope.textSearching="",$scope.searchText="","undefined"!=typeof $scope.selectedSearch&&($scope.selectedSearch.userStatus=""),$scope.memberList=angular.copy($scope.masterMemberList),"undefined"!=typeof allmembers&&($scope.pageSize=$scope.masterMemberList.length),$scope.returnMemberList($scope.pageSize),$scope.order("name",$scope.reverse);var currentElem=$(".memberHolder").find(".heading .m-name");currentElem.find("h4").hasClass("on")?currentElem.find("h4").hasClass("reverseon")?currentElem.find("h4").removeClass("reverseon"):currentElem.find("h4").addClass("reverseon"):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"))},$scope.deleteButton=function(){},$scope.confirmDelete=function(event){var email=$(event.target).closest(".complete-profile").find(".email").html(),eve=angular.element(event.currentTarget),options={url:"/sp/hiring/deleteCandidate",data:$.param({candidateEmail:email})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?(angular.forEach($scope.masterMemberList,function(val,index){val.email===email&&$scope.masterMemberList.splice(index,1)}),angular.forEach($scope.memberList,function(val,index){val.email===email&&$scope.memberList.splice(index,1)}),angular.forEach($scope.checkBox,function(val,index){val.email===email&&$scope.checkBox.splice(index,1)}),$scope.searchTag.length&&angular.forEach($scope.newArr,function(val,index){val.email===email&&$scope.newArr.splice(index,1)}),$scope.returnMemberList($scope.pageSize),eve.scope().moreadvance=!eve.scope().moreadvance,$scope.deleteUser=!0,$timeout(function(){$scope.deleteUser=!1},5e3)):($scope.errorMessaage=response.error.InvalidRequestException,$scope.deleteUserError=!0,$timeout(function(){$scope.deleteUserError=!1},5e3))})},$scope.deleteUsers=function(emails){var emailList=[];jQuery.each(emails,function(i,j){emailList.push(emails[i].email)});var options={url:"/sp/hiring/deleteCandidate",data:$.param({candidateEmail:emailList.toString()})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&$scope.getMembersData()})},$scope.addClassActive=function(){$scope.dropUp=!$scope.dropUp},$scope.notificationEmail=function(emails){emails.length&&(sharedProperties.setEmail(emails),sharedProperties.setObject($scope.memberList),ngDialog.open({template:"return-visitor.html"}))},$scope.profileRoute=function(event){var groupname=$(event.currentTarget).data("routeparam");$localStorage.set("groupname",groupname),window.location.href="/sp/admin/group/#profile"},$scope.showFullList=function(){$scope.resetfilter("full")},$scope.editGroupSection=function(index){$scope.EditGroupEmail=this.memberList.email;var currentEmail=this.memberList.email;index="";for(var i=0;i<$scope.memberList.length;i++)currentEmail===$scope.memberList[i].email&&(index=i);$scope.setEditMode=!0,$scope.indexToChange=index,$scope.groupEditSection=angular.copy($scope.memberList[index]),$scope.groupSelectOption=[];for(var j=0;j<$scope.groupEditSection.groupAssociationList.length;j++)$scope.groupSelectOption.push($scope.groupEditSection.groupAssociationList[j].name);ngDialog.open({template:"/sp/admin/member/editGroup",scope:$scope})},$scope.enableLeadDialog=function(leadValue,index,groupName){for(var i=0;i<$scope.mainGroupInfoList.length;i++)if(groupName===$scope.mainGroupInfoList[i].name){if(null!==$scope.mainGroupInfoList[i].groupLead&&$scope.mainGroupInfoList[i].groupLead.email!==$scope.EditGroupEmail)return!1;$scope.groupEditSection.groupAssociationList[index].groupLead=!leadValue}},$scope.setStyle=function(lead){return $scope.viewMode(),lead===!0?!0:!1},$scope.isItEnabled=function(groupName,id){$scope.classActivate=[];for(var i=0;i<$scope.mainGroupInfoList.length;i++)groupName===$scope.mainGroupInfoList[i].name&&null!==$scope.mainGroupInfoList[i].groupLead&&$scope.mainGroupInfoList[i].groupLead.email!==$scope.EditGroupEmail&&($scope.classActivate.push("#mode_"+id),$scope.classActivate.push("#modeprop_"+id))},$scope.viewMode=function(){if($scope.classActivate.length)for(var i=0;i<$scope.classActivate.length;i++)$($scope.classActivate[i]).addClass("disabled")},$scope.addGroupToModule=function(groupName,lead){return $scope.selectedGroup=groupName,"default"===groupName?!1:(""===$scope.groupEditSection.groupAssociationList[0].name&&$scope.groupEditSection.groupAssociationList.splice(0,1),$scope.groupEditSection.groupAssociationList.push({name:groupName,groupLead:!1}),void $scope.groupSelectOption.push(groupName))},$scope.addGroupMember=function(names){return""===names?!1:!0},$scope.removeGroupDialog=function(event,groupName){for(var _this=event.target,current=($(_this).closest(".blockGroup").remove(),""),i=0;i<$scope.groupEditSection.groupAssociationList.length;i++)$scope.groupEditSection.groupAssociationList[i].name===groupName.name&&($scope.groupEditSection.groupAssociationList.splice(i,1),current=i);$scope.groupSelectOption.splice(current,1)},$scope.saveGroupToModule=function(groupName){for(var newArr="",i=0;i<$scope.groupEditSection.groupAssociationList.length;i++)newArr=newArr.length?newArr+","+$scope.groupEditSection.groupAssociationList[i].name+":"+$scope.groupEditSection.groupAssociationList[i].groupLead:$scope.groupEditSection.groupAssociationList[i].name+":"+$scope.groupEditSection.groupAssociationList[i].groupLead;var options={url:"/sp/admin/group/memberGroupUpdate",data:$.param({groupAssociationList:newArr,memberEmail:$scope.groupEditSection.email})};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success){$scope.groupEditSection.groupAssociationList.length?$scope.memberList[$scope.indexToChange]=$scope.groupEditSection:($scope.groupEditSection.groupAssociationList.push({name:"",groupLead:!1}),$scope.memberList[$scope.indexToChange]=$scope.groupEditSection);for(var i=0;i<$scope.masterMemberList.length;i++)$scope.masterMemberList[i].email===$scope.memberList[$scope.indexToChange].email&&($scope.masterMemberList[i]=$scope.groupEditSection);ngDialog.close("ngdialog1"),ngDialog.open({template:"/sp/admin/member/confirmation"})}else ngDialog.close("ngdialog1"),ngDialog.open({template:"/sp/admin/member/errorGroup"})})},$scope.memberTakeAway=function(email,id){$localStorage.set("candidateEmail",email).set("candidateID",id),window.location.href="/sp/tools/hiring/profile"},$scope.updatedEmaiList=function(emailList){var allEmailList=emailList,updatedEmails={membersToInvite:[],membersToAdd:[]},count=0;return $.each(allEmailList,function(i){$.each($scope.memberList,function(j){$scope.memberList[j].email===allEmailList[i]&&null===$scope.memberList[j].spUserId?updatedEmails.membersToInvite.push(allEmailList[i]):$scope.memberList[j].email===allEmailList[i]&&null!==$scope.memberList[j].spUserId&&null===$scope.memberList[j].existingCandidate&&updatedEmails.membersToAdd.push(allEmailList[i])}),count++}),count===allEmailList.length?(parseInt(updatedEmails.membersToInvite.length+updatedEmails.membersToAdd.length)>$scope.availableSubscriptions?($scope.submitDisabled=!0,$scope.candidateCountException=!0):($scope.submitDisabled=!1,$scope.candidateCountException=!1),updatedEmails):void 0},$scope.processImportList=function(f){console.log(f),$scope.noSelectionError=!1,$scope.importCandidateForm.submitted=!1;var emailist,_params={};if($scope.importCandidateForm.$valid)if("all"===f.options)emailist=$scope.updatedEmaiList($scope.allMembersEmailId),console.log("emailist : ",emailist),_params={membersToInvite:emailist.membersToInvite.toString(),membersToAdd:emailist.membersToAdd.toString(),day:"undefined"!=typeof f.dueDate?f.dueDate.getDate():0,month:"undefined"!=typeof f.dueDate?f.dueDate.getMonth()+1:0,year:"undefined"!=typeof f.dueDate?f.dueDate.getFullYear():0},emailist.membersToInvite.length>0||emailist.membersToAdd.length>0?($scope.noEmailsError=!1,$scope.submitDisabled=!1,$scope.addInviteMultipleCandidates(_params)):($scope.noEmailsError=!0,$scope.importCandidateForm.submitted=!0);else{var emails=[],counter=0;$.each($scope.userEmail.email,function(i){emails.push($scope.userEmail.email[i].email),counter++}),counter===$scope.userEmail.email.length&&(emailist=$scope.updatedEmaiList(emails),_params={membersToInvite:emailist.membersToInvite.toString(),membersToAdd:emailist.membersToAdd.toString(),day:"undefined"!=typeof f.dueDate?f.dueDate.getDate():0,month:"undefined"!=typeof f.dueDate?f.dueDate.getMonth()+1:0,year:"undefined"!=typeof f.dueDate?f.dueDate.getFullYear():0},emailist.membersToInvite.length>0||emailist.membersToAdd.length>0?($scope.noEmailsError=!1,$scope.addInviteMultipleCandidates(_params)):($scope.noEmailsError=!0,$scope.importCandidateForm.submitted=!0))}else $scope.importCandidateForm.submitted=!0},$scope.addInviteMultipleCandidates=function(o){var options={url:"/sp/hiring/multiInvite",data:$.param(o)};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&0===response.error.length&&($localStorage.set("gNotify","import"),console.log("response : ",response),setTimeout(function(){window.location="/sp/tools/hiring/"},100))})},$scope.candidateCompare=function(email,id){$localStorage.set("candidateEmail",email).set("candidateID",id),window.location.href="/sp/tools/hiring/compare"},$scope.candidateAdvisor=function(email,id){$localStorage.set("candidateEmail",email).set("candidateID",id),window.location.href="/sp/tools/hiring/advisor"},$scope.calltoAction=function(select){return""===select?!1:void(window.location.href=select)},$scope.archiveDialog=function(e,n,r){$scope.archiveCandidate={name:n,email:e,roles:r},ngDialog.open({template:"/sp/resources/html/tools/hiring/archive-candidate.html",scope:$scope})},$scope.archiveAllCandidate=function(cEmail,isHired,single){var emailList=[];single!==!0?jQuery.each(cEmail,function(i,j){emailList.push(cEmail[i].email)}):emailList=cEmail;var options={url:"/sp/hiring/archiveCandidate",data:$.param({candidateEmail:emailList.toString(),isHired:isHired})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&(ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",title:"<strong> Candidate</strong>",message:" archived successfully"}),$scope.getMembersData(),$scope.negative=!$scope.negative)})},$scope.archiveAllDialog=function(emails){emails.length>0&&($scope.archiveCandidateAll={emails:emails},ngDialog.open({template:"/sp/resources/html/tools/hiring/archive-candidate-list.html",scope:$scope}))},$scope.sendViewProfileRequest=function(e,n){$scope.profileRequest={email:e,name:n,heading:"Request Access"},ngDialog.open({template:"/sp/resources/html/tools/hiring/send-profile-invite.html",scope:$scope}),$scope.sendRequest=function(e){var options={url:"/sp/notifications/sendNotification",data:$.param({memberEmail:e,type:""}).replace(/%40/g,"@")};ajaxService.getAjaxResponse(options).then(function(response){"true"!==response.Success&&$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:"Not able to send invite"})})}},$scope.getArchiveCandidateList=function(){var options={url:"/sp/hiring/getAllArchivedCandidates"};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success&&(response["hiring-archived"].length>0?$scope.showArchive=!0:$scope.showArchive=!1)})},$scope.sendReminder=function(e,n){$scope.profileRequest={email:e,name:n,heading:"Reminder"},ngDialog.open({template:"/sp/resources/html/tools/hiring/send-profile-invite.html",scope:$scope}),$scope.sendRequest=function(e){var options={url:"/sp/notifications/sendNotification",data:$.param({memberEmail:e,type:""}).replace(/%40/g,"@")};ajaxService.getAjaxResponse(options).then(function(response){"true"!==response.Success&&$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong> ",message:"Not able to send invite"})})}}}function notification($scope,sharedProperties){$scope.name=[];var memberList=sharedProperties.getObject(),emails=sharedProperties.getEmail();$scope.emailId=emails,angular.forEach(memberList,function(val,index){for(var i=0;i<emails.length;i++)emails[i]===val.email&&$scope.name.push(val.name)})}angular.module("spApp").controller("validateImportedListController",validateImportedListController),angular.module("spApp").controller("notification",notification),validateImportedListController.$inject=["$scope","$q","$element","$attrs","$http","ajaxService","$location","$state","$filter","ngDialog","sharedProperties","$timeout","$localStorage"],notification.$inject=["$scope","sharedProperties"];
function verifyEmailController($scope,$element,$attrs,ajaxService,$rootScope,sharedProperties,$localStorage){$scope.verifyEmailForm={},$scope.verifyEmailError=!1,$scope.verifyEmail=function(f){$scope.verifyEmailError=!1,$scope.verifyEmailForm.submitted=!1,$scope.verifyEmailForm.$valid?($scope.verifyEmailForm.submitted=!1,ajaxService.getAjaxResponse({url:"/sp/profileCopy/copyAssessment",data:$.param({copyFromEmail:f.email}).replace(/%40/g,"@")}).then(function(response){"true"===response.Success?($scope.verifyEmailError=!1,$localStorage.set("verifiedEmail",f.email),window.location.href="/sp/profileCopy/verifyEmailInvite"):$scope.verifyEmailError=!0})):$scope.verifyEmailForm.submitted=!0},$scope.getVerifyedEmail=function(){$scope.vEmail=$localStorage.get("verifiedEmail")},$scope.authorizeCopyProfile=function(){ajaxService.getAjaxResponse({url:"/sp/profileCopy/authorizeCopyProfile"}).then(function(response){"true"===response.Success?window.location.href="/sp/profileCopy/verifySuccess":window.location.href="/sp/profileCopy/verifyFailed"})}}angular.module("spApp").controller("verifyEmailController",verifyEmailController),verifyEmailController.$inject=["$scope","$element","$attrs","ajaxService","$rootScope","sharedProperties","$localStorage"];
function fixContainer(){return{restrict:"A",link:function($scope,$element,$attrs){$scope.innerHeightSet=function(){jQuery($element[0]).css({"min-height":window.innerHeight-(jQuery("#header").outerHeight()+jQuery("#footer").outerHeight())}),$(".footer-wrapper").removeClass("visibilitynone")},jQuery(window).resize(function(){$scope.innerHeightSet()}),$scope.innerHeightSet()}}}angular.module("spApp").directive("fixContainer",fixContainer),$(".training-library").closest("#content").addClass("whiteBackground");
function barInfoGraph($rootScope,$timeout){return{restrict:"A",scope:{data:"=barData",barConfig:"@barConfig"},link:function(scope,element,attrs){function generateD3Chart(){graphId="#"+jQuery(element[0]).attr("id"),d3GraphWrap=d3.select(graphId),d3Graph=d3GraphWrap.append("svg").attr({width:"100%",height:"100%",viewBox:"0 0 "+jQuery(element[0]).width()+" "+jQuery(element[0]).height(),perserveAspectRatio:"none"});var _h=jQuery(element[0]).find("svg").height(),_w=jQuery(element[0]).find("svg").width(),_options={fill:scope.data[_config.name]>49?colors[_config.type][0]:colors[_config.type][1],width:"Vertical"===_config.type?"100%":scope.data[_config.name]+"%",height:"Vertical"===_config.type?scope.data[_config.name]+"%":"100%",x:"Vertical"===_config.type?0:"Left"===_config.dir?_w-_w*scope.data[_config.name]/100:0,y:"Vertical"===_config.type&&"Top"===_config.dir?_h-_h*scope.data[_config.name]/100:0};d3Graph.append("rect").attr(_options);for(var i=0;10>i;i++)i>0&&10>i&&d3Graph.append("rect").attr({fill:"#fff",x:"Vertical"===_config.type?0:_w/10*i,y:"Vertical"===_config.type?_h/10*i:0,width:"Vertical"===_config.type?"100%":1,height:"Vertical"===_config.type?1:"100%"})}if(Object.keys(scope.data).length){jQuery(element[0]).find("svg").remove();var graphId,d3GraphWrap,d3Graph,_config=JSON.parse(scope.barConfig.toString()),colors={Vertical:["#69519D","#BBB1E5"],Horizantal:["#26A6C3","#AAE3E8"]},initChart=null;initChart=$timeout(generateD3Chart,0)}}}}angular.module("spApp").directive("barInfoGraph",barInfoGraph),barInfoGraph.$inject=["$rootScope","$timeout"];
function candidateTags($http,ajaxService,$localStorage){return{restrict:"A",link:function($scope,$element,$attrs){function updateTagList(t,c){var textTags,context=c,_t=jQuery(t).find(".tagsinput"),tagCount=0;if(console.log(_t),textTags=[],jQuery.each(jQuery(_t).find("span.tag"),function(i,j){var formatTags=jQuery(this).find("span").html().replace(/&nbsp;/g," ").trim();textTags.push(formatTags),tagCount++}),tagCount===jQuery(_t).find("span.tag").length){var roleOptions={url:"/sp/hiring/updateRole",data:$.param({hiringRoles:textTags.toString(),candidateEmail:$localStorage.get("candidateEmail")}).replace(/%40/g,"@").replace(/%2C/g,",")},tagOptions={url:"/sp/hiring/updateTags",data:$.param({tagList:textTags.toString(),candidateEmail:$localStorage.get("candidateEmail")}).replace(/%40/g,"@").replace(/%2C/g,",")};ajaxService.getAjaxResponse("roles"===context?roleOptions:tagOptions).then(function(response){"true"===response.Success&&console.log("tags updates")})}}jQuery($element[0]).tagsInput({width:"100%",height:"100%",defaultText:jQuery($element[0]).attr("data-ph"),onAddTag:function(tag){var context="";jQuery($element[0]).hasClass("roles")&&(context="roles"),jQuery($element[0]).hasClass("tags")&&(context="tags"),updateTagList(jQuery($element[0]).parent(),context)},onRemoveTag:function(tag){var context="";jQuery($element[0]).hasClass("roles")&&(context="roles"),jQuery($element[0]).hasClass("tags")&&(context="tags"),updateTagList(jQuery($element[0]).parent(),context)}}),setTimeout(function(){jQuery($element[0]).importTags(jQuery($element[0]).attr("data-existing"))},800)}}}angular.module("spApp").directive("candidateTags",candidateTags),candidateTags.$inject=["$http","ajaxService","$localStorage"];
function capitalize(){return function(input,all){return input?input.replace(/([^\W_]+[^\s-]*) */g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()}):""}}angular.module("spApp").filter("capitalize",capitalize);
function clickOut($http){return{restrict:"A",link:function($scope,$element,$attrs){jQuery("body").on("click",function(e){jQuery(e.target).hasClass("clickOut")||($scope.dropUp=!1,$scope.$apply())})}}}angular.module("spApp").directive("clickOut",clickOut),clickOut.$inject=["$http"];
function cnoValidate(){return{restrict:"A",require:"ngModel",$scope:{invalidCCNo:"="},link:function($scope,$element,$attrs,$ctrl){function luhnChk(luhn){if("undefined"!=typeof luhn){for(var len=luhn.length,mul=0,prodArr=[[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]],sum=0;len--;)sum+=prodArr[mul][parseInt(luhn.charAt(len),10)],mul^=1;return sum%10===0&&sum>0}}$scope.$watch(function(){if("undefined"!=typeof $ctrl.$viewValue&&$ctrl.$viewValue.length>0){var valid=luhnChk($ctrl.$viewValue);valid===!0?$ctrl.$setValidity("invalidCCNo",!0):$ctrl.$setValidity("invalidCCNo",!1)}else $ctrl.$setValidity("invalidCCNo",!0)})}}}angular.module("spApp").directive("cnoValidate",cnoValidate);
function companyPicUploader($http,ajaxService,$rootScope,$timeout,ngDialog,$localStorage){return{restrict:"A",link:function($scope,$element,$attrs){jQuery($element[0]).find(".select-image-btn").on("click",function(e){e.preventDefault();var fileInput=jQuery($element[0]).find("form.pic-uploader").find("input:file");if(fileInput.click(),$scope.enableBtns=!0,$scope.$apply(),jQuery("html").hasClass("ie10")&&$scope.prevImage===jQuery($element[0]).find(".image-editor").cropit("imageSrc")&&$scope.resetFlag===!0){jQuery($element[0]).find(".cropit-image-background").removeAttr("src"),jQuery($element[0]).find(".cropit-image-preview").removeClass("cropit-image-loaded");var img=jQuery($element[0]).find(".image-editor").cropit("imageSrc");jQuery($element[0]).find(".cropit-image-background").attr("src",img),jQuery($element[0]).find(".cropit-image-background-container").css({"background-image":'url("'+img+'")'}),jQuery($element[0]).find(".cropit-image-preview").css({"background-image":'url("'+img+'")'}).addClass("cropit-image-loaded"),$scope.prevImage="",$scope.resetFlag=!1}}),setTimeout(function(){jQuery($element[0]).find(".image-editor").cropit({imageBackground:!0,previewSize:{width:200,height:100},exportZoom:1,originalSize:!1})},500),jQuery($element[0]).find(".reset-image").on("click",function(e){if(e.preventDefault(),$scope.enableBtns===!0){$scope.enableBtns=!1,$scope.$apply();var fileInput=jQuery($element[0]).find("form.pic-uploader").find("input:file");fileInput.val(""),jQuery($element[0]).find(".avatar-company-upload div").each(function(){jQuery(this).css("background-image","none")}),$scope.resetFlag=!0,$scope.prevImage=jQuery($element[0]).find(".image-editor").cropit("imageSrc"),jQuery($element[0]).find(".cropit-image-background").attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7")}}),jQuery($element[0]).find(".process-pic").on("click",function(e){e.preventDefault();var hasBGImage="none"!==jQuery($element[0]).find(".cropit-image-preview").css("background-image");if(!hasBGImage)return $scope.enableBtns=!1,!1;if($scope.enableBtns===!0){$scope.enableBtns=!1,$scope.$apply(),$scope.imageData=jQuery($element[0]).find(".image-editor").cropit("export",{type:"image/jpeg",quality:.99,exportZoom:1,originalSize:!1});var options={url:"company"===$scope.imageType?"/sp/admin/company/uploadImage":"/sp/uploadImage",data:$.param({image:$scope.imageData})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?(ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:" Image updated Successfully"}),$timeout(function(){$localStorage.remove("loggegdInProfile"),window.location.reload()},1e3)):$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:"Image upload failed."})})}})}}}angular.module("spApp").directive("companyPicUploader",companyPicUploader),companyPicUploader.$inject=["$http","ajaxService","$rootScope","$timeout","ngDialog","$localStorage"];
function dateSame(){return{require:"ngModel",link:function(scope,elem,attrs,ngModel){function validate(value){var isValid="",firstArg=scope.$eval(attrs.dateSame);return isValid=null!==firstArg&&void 0!==firstArg&&null!==value&&void 0!==value?firstArg.toString()!==value.toString():!0,ngModel.$setValidity("same",isValid),isValid?value:void 0}ngModel.$parsers.unshift(validate),scope.$watch(attrs.dateSame,function(){ngModel.$setViewValue(ngModel.$viewValue)})}}}function sameAs(){return{require:"ngModel",link:function(scope,elem,attrs,ngModel){function validate(value){var isValid=scope.$eval(attrs.sameAs)===value;return ngModel.$setValidity("same-as",isValid),isValid?value:void 0}ngModel.$parsers.unshift(validate),scope.$watch(attrs.sameAs,function(){ngModel.$setViewValue(ngModel.$viewValue)})}}}angular.module("spApp").directive("sameAs",sameAs),angular.module("spApp").directive("dateSame",dateSame),angular.module("spApp").directive("validationCheck",["$parse",function($parse){return{require:"ngModel",link:function(scope,elm,attrs,ngModel){var check=$parse(attrs.validationCheck);scope.$watch(check,function(newValue){ngModel.$setValidity(attrs.name,newValue)})}}}]);
function copyToClipboard($http,ajaxService,$rootScope,$timeout,ngDialog){return{restrict:"A",link:function($scope,$element,$attrs){var client=new ZeroClipboard(jQuery($element[0]));client.on("ready",function(readyEvent){client.on("aftercopy",function(event){$.growl({icon:"glyphicon glyphicon-ok",message:"Link copied"})})})}}}angular.module("spApp").directive("copyToClipboard",copyToClipboard),copyToClipboard.$inject=["$http","ajaxService","$rootScope","$timeout","ngDialog"];
function focusIf($timeout){function link($scope,$element,$attrs){function focusFn(condition){condition&&$timeout(function(){dom.focus()},$scope.$eval($attrs.focusDelay)||0)}var dom=$element[0];$attrs.focusIf?$scope.$watch($attrs.focusIf,focusFn):focusFn(!0)}return{restrict:"A",link:link}}angular.module("spApp").service("debounce",["$timeout",function($timeout){return function(func,wait,immediate){function debounce(){context=this,args=arguments;var later=function(){timeout=null,immediate||(result=func.apply(context,args))},callNow=immediate&&!timeout;return timeout&&$timeout.cancel(timeout),timeout=$timeout(later,wait),callNow&&(result=func.apply(context,args)),result}var timeout,args,context,result;return debounce.cancel=function(){$timeout.cancel(timeout),timeout=null},debounce}}]).directive("debounce",["debounce","$parse",function(debounce,$parse){return{require:"ngModel",priority:999,link:function($scope,$element,$attrs,ngModelController){var debouncedValue,pass,debounceDuration=$parse($attrs.debounce)($scope),immediate=!!$parse($attrs.immediate)($scope),prevRender=ngModelController.$render.bind(ngModelController),commitSoon=debounce(function(viewValue){pass=!0,ngModelController.$setViewValue(viewValue),pass=!1},parseInt(debounceDuration,10),immediate);ngModelController.$render=function(){prevRender(),commitSoon.cancel(),debouncedValue=this.$viewValue},ngModelController.$parsers.unshift(function(value){return pass?(debouncedValue=value,value):(commitSoon(ngModelController.$viewValue),debouncedValue)})}}}]),angular.module("spApp").directive("ngEnter",function(){return function(scope,element,attrs){element.bind("keydown keypress",function(event){13===event.which&&(scope.$apply(function(){scope.$eval(attrs.ngEnter)}),event.preventDefault())})}}),angular.module("spApp").filter("addEllipsis",function(){return function(input,number){return input?input.length>number?input.substring(0,number)+"...":input:void 0}}),angular.module("spApp").filter("unique",function(){return function(arr,field){var i,o={},l=arr.length,r=[];for(i=0;l>i;i+=1)o[arr[i][field]]=arr[i];for(i in o)r.push(o[i]);return r}}),angular.module("spApp").directive("autoFocus",function(){return function(scope,element,attr){element[0].focus()}}),angular.module("spApp").directive("focusIf",focusIf),focusIf.$inject=["$timeout"],angular.module("spApp").filter("removeSpaces",function(){return function(text){var str=text.replace(/\s+/g,"");return str.toLowerCase()}}),angular.module("spApp").filter("secureHtml",["$sce",function($sce){return function(input){return $sce.trustAsHtml(input)}}]),angular.module("spApp").filter("percentage",function(){return function(input){return input+"%"}}),angular.module("spApp").filter("tel",function(){return function(tel){if(!tel)return"";var value=tel.toString().trim().replace(/^\+/,"");if(value.match(/[^0-9]/))return tel;var country,city,number;switch(value.length){case 10:country=1,city=value.slice(0,3),number=value.slice(3);break;case 11:country=value[0],city=value.slice(1,4),number=value.slice(4);break;case 12:country=value.slice(0,3),city=value.slice(3,5),number=value.slice(5);break;default:return tel}return 1===country&&(country=""),number=number.slice(0,3)+"-"+number.slice(3),(country+" ("+city+") "+number).trim()}}),angular.module("spApp").directive("compile",["$compile","$rootScope","$state","$localStorage",function($compile,$rootScope,$state,$localStorage){return function(scope,element,attrs){scope.profileRoute=function(){$localStorage.set("groupname",scope.group.name),$state.go("profile")},scope.$watch(function(scope){return scope.$eval(attrs.compile)},function(value){""===value.name?element.html("<a href='javascript:void(0)' addgroup>"+$rootScope.pullInterNationalization("admin.member.addtogroup")+"</a>"):value.name?value.groupLead?element.html("<a href='javascript:void(0)' data-routeparam ='"+value.name+"' ng-click='profileRoute()'>"+value.name+"<span class='groupLead'>"+$rootScope.pullInterNationalization("admin.member.leadsign")+"</span></a>"):element.html("<a href='javascript:void(0)' data-routeparam ='"+value.name+"' ng-click='profileRoute()'>"+value.name+"</a>"):element.html(value),$compile(element.contents())(scope)})}}]),angular.module("App",[]).filter("search",["$filter",function($filter){return function(items,text){if(!text||0===text.length)return items;var searchTerms=text.split(" ");return searchTerms.forEach(function(term){term&&term.length&&(items=$filter("filter")(items,term))}),items}}]),angular.module("spApp").directive("dynamicName",["$parse",function($parse){return{restrict:"A",priority:1e4,controller:["$scope","$element","$attrs",function($scope,$element,$attrs){var name=$attrs.dynamicName.replace("$index",$scope.$index);delete $attrs.dynamicName,$element.removeAttr("data-dynamic-name"),$element.removeAttr("dynamic-name"),$attrs.$set("name",name)}]}}]),angular.module("spApp").directive("changeName",["$parse",function($parse){return{restrict:"A",priority:1e4,controller:["$scope","$element","$attrs",function($scope,$element,$attrs){var name=$attrs.changeName.replace("$index",$scope.$index).replace("ctrl.currentActionPlan",$scope.ctrl.currentActionPlan).replace("actionList.type",void 0===$scope.actionList?"":$scope.actionList.type).replace("parentIndex",$scope.parentIndex).replace("superIndex",$scope.superIndex);delete $attrs.changeName,$element.removeAttr("data-change-name"),$element.removeAttr("change-name"),$attrs.$set("name",name)}]}}]),angular.module("spApp").directive("createLayout",["$compile","$rootScope","$localStorage",function($compile,$rootScope,$localStorage){return{restrict:"C",scope:{},link:function(scope,element,attrs){scope.profileRoute=function(){$localStorage.set("memEmail",scope.$parent.groupList.groupLead.email),window.location.href="/sp/admin/account/member/details?email="+scope.$parent.groupList.groupLead.email},attrs.$observe("listcomp",function(listcomp){var value=JSON.parse(listcomp);if(value.name)if("undefined"!=typeof value.groupLead&&null===value.groupLead)element.html("<a href='javascript:void(0)' addlead class='agl'>"+$rootScope.pullInterNationalization("admin.group.assigngrouplead")+"</a>");else if("undefined"!=typeof value.groupLead.email&&null!==value.groupLead.email){var mailto="mailto:"+value.groupLead.email;element.html("<div class='name'><a href='javascript:void(0)' ng-click='profileRoute()' class='nameDetail'>"+value.groupLead.name+"</a></div><a href='"+mailto+"' class='email'>"+value.groupLead.email+"</div>")}else element.html("<a href='javascript:void(0)'>"+value.name+"</a>");else element.html(value);$compile(element.contents())(scope)})}}}]),angular.module("spApp").directive("inviteLink",["$compile","$rootScope",function($compile,$rootScope){return{restrict:"AC",scope:{callViewMember:"&",naming:"=namingType"},replace:!0,link:function(scope,element,attrs){attrs.$observe("listcomp",function(listcomp){var value=JSON.parse(listcomp);if("invite"===value.email)element.html("<a href='javascript:void(0)' id='event_button_360_request' class='clearfix' data-invite='true'><span class='symbol'>+</span><span class='naming'>"+scope.naming+"</span></a>");else if("inviteGrowth"===value.email)element.html("<a href='javascript:void(0)' id='event_new-member_add-data_invite' class='clearfix' data-invite='true'><span class='symbol'>+</span><span class='naming'>"+scope.naming+"</span></a>");else{var name="",img="",email="";"undefined"!=typeof value.user?(name=null===value.user.name?"":value.user.name,img=null!==value.user.smallProfileImage?"<img ng-src='"+value.user.smallProfileImage+"' class='img'></img>":"<div class='imgReplacement'>"+value.user.userInitials+"</div>",email=value.user.email):(name=null===value.name?"":value.name,img=null!==value.smallProfileImage?"<img ng-src='"+value.smallProfileImage+"' class='img'></img>":"<div class='imgReplacement'>"+value.userInitials+"</div>",email=value.email),element.html("<a href='javascript:void(0)' class='clearfix memberClass' data-invite='false'><span class='beak'></span><div class='left'>"+img+"</div><div class='right'><div class='name'>"+name+"</div><div class='email'>"+email+"</div></div></a>")}$compile(element.contents())(scope)})}}}]),angular.module("spApp").directive("processRequest",["$compile",function($compile){return{restrict:"AC",scope:{callViewMember:"&"},replace:!0,link:function(scope,element,attrs){attrs.$observe("assessment",function(assessment){var value=JSON.parse(assessment);if("object"==typeof value.requestProgressStatus&&value.requestProgressStatus){for(var htmlAppend="",firstFalse=-1!==value.requestProgressStatus.indexOf(null)?value.requestProgressStatus.indexOf(null):value.requestProgressStatus.length,i=0;i<value.requestProgressStatus.length;i++){var newClass="stField3";"true"===value.requestProgressStatus[i]?newClass="stField":"false"===value.requestProgressStatus[i]&&(newClass="stField2"),htmlAppend+="<div class='"+newClass+"' style='width:"+100/value.requestProgressStatus.length+"%'></div>"}element.html(htmlAppend+"<div class='end'>"+firstFalse+" of "+value.requestProgressStatus.length+"</div>")}else"Active"===value.requestStatus?element.html("<div class='notinitated'>Not Initated</div>"):element.html("<div class='notinitated'>"+value.requestStatus+"</div>");$compile(element.contents())(scope)})}}}]),angular.module("spApp").directive("addgroup",["$compile",function($compile){return{restrict:"A",scope:!1,link:function(scope,element,attrs){element.bind("click",function(){scope.memberController.oneTime&&(scope.memberController.getGroupsData(),scope.memberController.oneTime=!1),$(element).parent().find(".model").length?($(element).closest(".complete-profile").find(".selectModal").addClass("hide"),$(element).closest(".complete-profile").find(".addModal").removeClass("hide")):(scope.memberController.groupModuleSelected="",$(element).closest(".complete-profile").find(".addModal").addClass("hide"),$(element).closest(".complete-profile").find(".selectModal").removeClass("hide"))})}}}]),angular.module("spApp").directive("addlead",["$compile",function($compile){return{restrict:"A",scope:!1,link:function(scope,element,attrs){element.bind("click",function(){scope.$parent.groupController.pageSetting.oneTime&&(scope.$parent.groupController.getAllMembers(),scope.$parent.groupController.pageSetting.oneTime=!1),$(element).parent().find(".groups").length?($(element).closest(".group-profile").find(".selectModal").addClass("hide"),$(element).closest(".group-profile").find(".addModal").removeClass("hide")):($(element).closest(".group-profile").find(".addModal").addClass("hide"),$(element).closest(".group-profile").find(".selectModal").removeClass("hide"),$(element).closest(".group-profile").find(".viewable").addClass("selectModalOpen"))})}}}]),angular.module("spApp").directive("addremove",["ajaxService","$rootScope",function(ajaxService,$rootScope){return{restrict:"A",scope:!1,link:function(scope,element,attrs){element.bind("click",function(){if($(element).data("add")){if("undefined"==typeof scope.memberController.groupModuleSelected||""===scope.memberController.groupModuleSelected)return!1;var id=$(element).closest(".complete-profile").attr("id"),name=scope.memberController.groupModuleSelected,email=scope.memberController.memberList[id].email,options={url:"/sp/admin/group/addMember",data:$.param({name:name,memberEmail:email})};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success){$(element).closest(".complete-profile").find(".selectModal").addClass("hide"),$(element).closest(".complete-profile").find(".addModal").removeClass("hide");for(var i=0;i<scope.memberController.memberList.length;i++)if(scope.memberController.memberList[i].email===email){scope.memberController.memberList[i]=response.member;break}for(var j=0;j<scope.memberController.masterMemberList.length;j++)if(scope.memberController.masterMemberList[j].email===email){scope.memberController.masterMemberList[j]=response.member;break}scope.memberController.updateGroup=!0,$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.group.memberadded")})}else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}else $(element).data("remove")&&(scope.memberController.groupModuleSelected="",$(element).closest(".complete-profile").find(".selectModal").addClass("hide"),$(element).closest(".complete-profile").find(".addModal").removeClass("hide"))})}}}]),angular.module("spApp").directive("armember",["sharedProperties","ajaxService","$rootScope",function(sharedProperties,ajaxService,$rootScope,$scope){return{restrict:"A",scope:!1,link:function(scope,element,attrs){element.bind("click",function(){if($(element).data("add")){if("undefined"==typeof scope.selectedLead)return!1;if("undefined"==typeof scope.selectedLead.originalObject.email)return!1;var email=($(element).closest(".group-profile").attr("id"),scope.selectedLead.originalObject.email),name=scope.groupList.name,options={url:"/sp/admin/group/addMember",data:$.param({name:name,memberEmail:email,isGroupLead:!0})};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success){$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.group.updateMessage")}),$(element).closest(".group-profile").find(".selectModal").addClass("hide"),$(element).closest(".group-profile").find(".addModal").removeClass("hide");for(var i=0;i<scope.groupController.groupList.length;i++)scope.groupController.groupList[i].name===name&&(scope.groupController.groupList[i].groupLead=response.member.user,scope.groupController.groupList[i].numOfMembers=response.numMembers)}else if(null!=response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}else $(element).data("remove")&&($(element).closest(".group-profile").find(".selectModal").addClass("hide"),$(element).closest(".group-profile").find(".addModal").removeClass("hide"),$(element).closest(".group-profile").find(".viewable").removeClass("selectModalOpen"))})}}}]),angular.module("spApp").directive("prmember",["sharedProperties","ajaxService","$rootScope",function(sharedProperties,ajaxService,$rootScope,$scope){return{restrict:"A",scope:!1,link:function(scope,element,attrs){element.bind("click",function(){if($(element).data("add")){if("undefined"==typeof scope.selectedLead)return!1;if("undefined"==typeof scope.selectedLead.originalObject.email)return!1;var email=($(element).closest(".complete-profile").attr("id"),scope.selectedLead.originalObject.email),name=scope.profileController.profileList.name,options={url:"/sp/admin/group/addMember",data:$.param({name:name,memberEmail:email,isGroupLead:!1})};ajaxService.getAjaxResponse(options).then(function(response){if("true"===response.Success)$.growl({icon:"glyphicon glyphicon-ok",message:$rootScope.pullInterNationalization("admin.group.profile.updateAddGroup")}),scope.profileController.profileList.memberSummaryList.push({user:response.member}),null!=scope.profileController.profileList.groupLead&&scope.profileController.profileList.groupLead.email===response.member.email&&(scope.profileController.profileList.groupLead=null),sharedProperties.spilceIndexWithBreak(scope.profileController.allEmails,"email",email),scope.profileController.actionToClear(),scope.profileController.showAddMember=!scope.profileController.showAddMember,scope.profileController.enableAddMember=!scope.profileController.enableAddMember;else if(null!=response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}})}}}]),angular.module("checklist-model",[]).directive("checklistModel",["$parse","$compile",function($parse,$compile){function contains(arr,item){if(angular.isArray(arr))for(var i=0;i<arr.length;i++)if(angular.equals(arr[i],item))return!0;return!1}function add(arr,item){arr=angular.isArray(arr)?arr:[];for(var i=0;i<arr.length;i++)if(angular.equals(arr[i],item))return arr;return arr.push(item),arr}function remove(arr,item){if(angular.isArray(arr))for(var i=0;i<arr.length;i++)if(angular.equals(arr[i],item)){arr.splice(i,1);break}return arr}function postLinkFn(scope,elem,attrs){$compile(elem)(scope);var getter=$parse(attrs.checklistModel),setter=getter.assign,value=$parse(attrs.checklistValue)(scope.$parent);scope.$watch("checked",function(newValue,oldValue){if(newValue!==oldValue){var current=getter(scope.$parent);newValue===!0?setter(scope.$parent,add(current,value)):setter(scope.$parent,remove(current,value))}}),scope.$parent.$watch(attrs.checklistModel,function(newArr,oldArr){scope.checked=contains(newArr,value)},!0)}return{restrict:"A",priority:1e3,terminal:!0,scope:!0,compile:function(tElement,tAttrs){if("INPUT"!==tElement[0].tagName||!tElement.attr("type","checkbox"))throw'checklist-model should be applied to `input[type="checkbox"]`.';if(!tAttrs.checklistValue)throw"You should provide `checklist-value`.";return tElement.removeAttr("checklist-model"),tElement.attr("ng-model","checked"),postLinkFn}}}]),angular.module("spApp").directive("repeatDone",function(){return function(scope,element,attrs){scope.$last&&window.setTimeout(function(){scope.$eval(attrs.repeatDone)},100)}}),angular.module("spApp").directive("progressBar",function(){return{restrict:"EA",scope:{total:"=total",complete:"=complete",barClass:"@barClass"},transclude:!0,link:function(scope,elem,attrs){scope.completedClass="progress-bar-success",scope.$watch("complete",function(){var progress=scope.complete/scope.total;progress>=1?$(elem).find(".progress-bar").addClass(scope.completedClass):1>progress&&$(elem).find(".progress-bar").removeClass(scope.completedClass)})},template:"<div class='progress'><div class='progress-bar {{barClass}}' style='width:{{complete}}%'></div></div>"}}),angular.module("spApp").directive("ddTextCollapse",["$compile",function($compile){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope.collapsed=!1,scope.toggle=function(){scope.collapsed=!scope.collapsed},attrs.$observe("ddTextCollapseText",function(text){var maxLength=scope.$eval(attrs.ddTextCollapseMaxLength);if(text.length>maxLength){var firstPart=String(text).substring(0,maxLength),secondPart=String(text).substring(maxLength,text.length),firstSpan=$compile("<span>"+firstPart+"</span>")(scope),secondSpan=$compile('<span ng-if="collapsed">'+secondPart+"</span>")(scope),moreIndicatorSpan=$compile('<span ng-if="!collapsed">... </span>')(scope),lineBreak=$compile('<br ng-if="collapsed">')(scope),toggleButton=$compile('<span class="collapse-text-toggle" ng-click="toggle()">{{collapsed ? "LESS" : "MORE"}}</span>')(scope);element.empty(),element.append(firstSpan),element.append(secondSpan),element.append(moreIndicatorSpan),element.append(lineBreak),element.append(toggleButton)}else element.empty(),element.append(text)})}}}]),angular.module("spApp").filter("thousandSuffix",function(){return function(input,decimals){var exp,suffixes=["k","M","G","T","P","E"];return window.isNaN(input)?null:1e3>input?input:(exp=Math.floor(Math.log(input)/Math.log(1e3)),(input/Math.pow(1e3,exp)).toFixed(decimals)+suffixes[exp-1])}});
function decisionInfoGraph($rootScope,$timeout){return{restrict:"A",scope:{data:"=dmKeys"},link:function(scope,element,attrs){function generateD3Chart(){graphId="#"+jQuery(element[0]).attr("id"),d3GraphWrap=d3.select(graphId),d3Graph=d3GraphWrap.insert("svg","div.on-graph-labels"),d3Graph=d3GraphWrap.select("svg").attr({width:isPdf?190:jQuery(element[0]).width(),height:isPdf?190:jQuery(element[0]).width(),viewBox:isPdf?"0 0 190 190":"0 0 "+jQuery(element[0]).width()+" "+jQuery(element[0]).width(),perserveAspectRatio:"none"}),isPdf&&jQuery(element[0]).find(".on-graph-labels").css({width:190,height:190});var gWidth=jQuery(element[0]).find("svg").width(),gHeight=jQuery(element[0]).find("svg").width(),xMid=gWidth/2,yMid=gHeight/2;d3Graph.append("rect").attr({fill:"#E8E8E8",x:0,y:0,width:"100%",height:"100%"});var dPointX=gWidth/2/100*scope.data.Rapid,dPointY=gHeight/2/100*scope.data.Inward,dmMax=0,colors=["#57AE52","#E7DF18","#D0362E"],defaultColor=colors[0];for(var key in scope.data)scope.data[key]>dmMax&&(dmMax=scope.data[key]);dmMax>80&&(defaultColor=colors[1]),dmMax>90&&(defaultColor=colors[2]),d3Graph.append("rect").attr({fill:defaultColor,x:dPointX,y:dPointY,width:gWidth/2,height:gHeight/2}),d3Graph.append("line").attr({x1:xMid,y1:0,x2:xMid,y2:gHeight,"stroke-width":1,stroke:"#fff"}),d3Graph.append("line").attr({x1:0,y1:yMid,x2:gWidth,y2:yMid,"stroke-width":1,stroke:"#fff"});for(var gridLines=20,ySpacing=gHeight/gridLines,xSpacing=gWidth/gridLines,i=0;gridLines>i;i++)i>0&&gridLines>i&&10!==i&&(d3Graph.append("rect").attr({fill:"#fff",x:i%5===0?xMid-8:xMid-5,y:ySpacing*i,width:i%5===0?16:10,height:1}),d3Graph.append("rect").attr({fill:"#fff",x:xSpacing*i,y:i%5===0?yMid-8:yMid-5,width:1,height:i%5===0?16:10}))}if(Object.keys(scope.data).length){jQuery(element[0]).find("svg").remove();var graphId,d3GraphWrap,d3Graph,initChart=null,isPdf="undefined"!=typeof jQuery(element[0]).attr("data-pdf")?!0:!1;initChart=$timeout(generateD3Chart,0)}}}}angular.module("spApp").directive("decisionInfoGraph",decisionInfoGraph),decisionInfoGraph.$inject=["$rootScope","$timeout"];
function genericTagInput($http,$rootScope,$timeout){return{restrict:"A",link:function($scope,$element,$attrs){function updateTags(tagContainer){var _t=jQuery(tagContainer).find(".tagsinput"),_tInput=jQuery(tagContainer).find("input.storeTagsHere").attr("ng-model").split("."),textTags=[];$scope[_tInput[0]][_tInput[1]]=null,$scope.$apply(),jQuery.each(jQuery(_t).find("span.tag"),function(i,j){var formatTags=jQuery(this).find("span").html().replace(/&nbsp;/g," ").trim();textTags.push(formatTags)}),$scope[_tInput[0]][_tInput[1]]=textTags.join(),$scope.$apply()}$rootScope.inviteReady===!0&&$timeout(function(){jQuery($element[0]).tagsInput({width:"100%",height:"100%",defaultText:"undefined"!=typeof $rootScope.pullInterNationalization(jQuery($element[0]).attr("data-ph"))||null!==$rootScope.pullInterNationalization(jQuery($element[0]).attr("data-ph"))?$rootScope.pullInterNationalization(jQuery($element[0]).attr("data-ph")):jQuery($element[0]).attr("data-ph"),getTabIndex:"undefined"!=typeof jQuery($element[0]).attr("data-tab")?jQuery($element[0]).attr("data-tab"):"",onAddTag:function(tag){var tags=tag.split(",");return tags.length>1?($(this).removeTag(tag),!1):void updateTags(jQuery($element[0]).parent())},onRemoveTag:function(){updateTags(jQuery($element[0]).parent())}}),setTimeout(function(){"undefined"!=typeof jQuery($element[0]).attr("data-existing")&&(jQuery($element[0]).importTags(jQuery($element[0]).attr("data-existing")),updateTags(jQuery($element[0]).parent()))},500)},1e3)}}}angular.module("spApp").directive("genericTagInput",genericTagInput),genericTagInput.$inject=["$http","$rootScope","$timeout"];
function personalityInfoGraph($rootScope,$timeout){return{restrict:"A",scope:{data:"=personalityScore"},link:function(scope,element,attrs){function convertScoreToCoords(){var _p=scope.data.Primary.segmentScore.toString(),_s=scope.data.UnderPressure.segmentScore.toString(),_w=jQuery(element[0]).find("svg").width(),_h=jQuery(element[0]).find("svg").height(),_c={x:Math.floor(_w/2),y:Math.floor(_h/2)};return{c:_c,p:{powerful:{x:Math.floor(_c.x-_p.substr(0,1)*multplier*(_w/2)),y:Math.floor(_c.y-_p.substr(0,1)*multplier*(_h/2))},versatile:{x:Math.floor(_c.x+_p.substr(1,1)*multplier*(_w/2)),y:Math.floor(_c.y-_p.substr(1,1)*multplier*(_h/2))},adaptable:{x:Math.floor(_c.x+_p.substr(2,1)*multplier*(_w/2)),y:Math.floor(_c.y+_p.substr(2,1)*multplier*(_h/2))},precise:{x:Math.floor(_c.x-_p.substr(3,1)*multplier*(_w/2)),y:Math.floor(_c.y+_p.substr(3,1)*multplier*(_h/2))}},s:{powerful:{x:Math.floor(_c.x-_s.substr(0,1)*multplier*(_w/2)),y:Math.floor(_c.y-_s.substr(0,1)*multplier*(_h/2))},versatile:{x:Math.floor(_c.x+_s.substr(1,1)*multplier*(_w/2)),y:Math.floor(_c.y-_s.substr(1,1)*multplier*(_h/2))},adaptable:{x:Math.floor(_c.x+_s.substr(2,1)*multplier*(_w/2)),y:Math.floor(_c.y+_s.substr(2,1)*multplier*(_h/2))},precise:{x:Math.floor(_c.x-_s.substr(3,1)*multplier*(_w/2)),y:Math.floor(_c.y+_s.substr(3,1)*multplier*(_h/2))}}}}function generateD3Chart(){graphId="#"+jQuery(element[0]).attr("id"),d3GraphWrap=d3.select(graphId),d3Graph=d3GraphWrap.append("svg").attr({width:"100%",height:"100%",viewBox:"0 0 "+jQuery(element[0]).width()+" "+jQuery(element[0]).width(),perserveAspectRatio:"none"});var _w=jQuery(element[0]).find("svg").width(),_h=jQuery(element[0]).find("svg").height(),_s=convertScoreToCoords();d3Graph.append("rect").attr({fill:"#D3D3D3",width:Math.floor(57*_w/100),height:Math.floor(57*_h/100),x:Math.floor((_w-57*_w/100)/2),y:Math.floor((_h-57*_h/100)/2)});for(var o in _s.s)0===_s.s[o].x&&(_s.s[o].x=3),0===_s.s[o].y&&(_s.s[o].y=3);d3Graph.append("path").attr({"fill-opacity":.6,fill:"#E8C80F","stroke-width":0,d:"M "+_s.p.powerful.x+" "+_s.p.powerful.y+" L "+_s.p.versatile.x+" "+_s.p.versatile.y+" L "+_s.p.adaptable.x+" "+_s.p.adaptable.y+" L "+_s.p.precise.x+" "+_s.p.precise.y+" L "+_s.p.powerful.x+" "+_s.p.powerful.y}),d3Graph.append("path").attr({"stroke-width":1,stroke:"#fefdf8",d:"M 0 "+_h+" L "+_w+" 0 M 0 0 L "+_w+" "+_h}),d3Graph.append("path").attr({"stroke-width":4,stroke:"#df4825","stroke-linecap":"round","stroke-linejoin":"round",fill:"transparent",d:"M "+_s.s.powerful.x+" "+_s.s.powerful.y+" L "+_s.s.versatile.x+" "+_s.s.versatile.y+" L "+_s.s.adaptable.x+" "+_s.s.adaptable.y+" L "+_s.s.precise.x+" "+_s.s.precise.y+" L "+_s.s.powerful.x+" "+_s.s.powerful.y})}if(Object.keys(scope.data).length){jQuery(element[0]).find("svg").remove();var graphId,d3GraphWrap,d3Graph,initChart=null,multplier=.1428571;initChart=$timeout(generateD3Chart,0)}}}}angular.module("spApp").directive("personalityInfoGraph",personalityInfoGraph),personalityInfoGraph.$inject=["$rootScope","$timeout"];
function piechartInfoGraph($rootScope,$timeout){return{restrict:"A",scope:{data:"=pieKeys"},link:function(scope,element,attrs){function byLabelsAsc(a,b){return a[0]<b[0]?-1:a[0]>b[0]?1:0}function customLabelOrder(c,p){var customOrder=[];return customOrder.push(c[2]),customOrder.push(c[4]),customOrder.push(c[0]),customOrder.push(c[1]),customOrder.push(c[3]),customOrder}function generatePieLabels(){var html="";return jQuery.each(pieLabelsCollection,function(i){html+="conflictManagement"===pieName&&2===i?'<span class="split-labels"></span><span class="pie-legend-'+i+'"><span class="lColor"></span><span class="lText">'+pieLabelsCollection[i][0]+"</span></span>":"fundamentalNeeds"===pieName&&1===i?'<span class="split-labels"></span><span class="pie-legend-'+i+'"><span class="lColor"></span><span class="lText">'+pieLabelsCollection[i][0]+"</span></span>":'<span class="pie-legend-'+i+'"><span class="lColor"></span><span class="lText">'+pieLabelsCollection[i][0]+"</span></span>"}),'<p class="pieChartLegends '+pieName+'">'+html+"</p>"}function generatePieWithD3(pdfCheck){var d3GraphWrap,d3Chart,labelsHTML,_outerRadius,_arc,_pie,_pieSlices,defaultOptions,responsiveOptions,pdfOptions,_options,_pieColors=d3.scale.ordinal().range(pieColorSets[pieName]);defaultOptions={viewBox:"0 0 "+jQuery(element[0]).width()+" "+(jQuery(element[0]).height()+25),t1:2.2,t2:1.2,r:105,w:"100%",h:isIE?parseInt(jQuery(element[0]).height()+25):"100%"},responsiveOptions={viewBox:"0 0 285 285",t1:1.2,t2:1.2,r:110,w:285,h:285},pdfOptions={viewBox:"0 0 200 200",t1:1,t2:1,r:75,w:200,h:200},jQuery(window).width()<1024?(_options=responsiveOptions,_outerRadius=responsiveOptions.r):(_options=defaultOptions,_outerRadius=defaultOptions.r),pdfCheck&&(_options=pdfOptions,_outerRadius=pdfOptions.r),d3GraphWrap=d3.select(pieId),d3Chart=d3GraphWrap.append("svg:svg").attr({width:_options.w,height:_options.h,viewBox:_options.viewBox,perserveAspectRatio:"none"}).data([pieLabelsCollection]).append("svg:g").attr("transform","translate("+_options.t1*_outerRadius+","+(_options.t2*_outerRadius+25)+")"),_arc=d3.svg.arc().outerRadius(_outerRadius),_pie=d3.layout.pie().value(function(d){return d[1]}).sort(function(d){return null}),_pieSlices=d3Chart.selectAll("g.sp-pie-slice").data(_pie).enter().append("svg:g").attr("class","sp-pie-slice"),_pieSlices.append("svg:path").attr({fill:function(d,i){return _pieColors(i)},d:_arc,"class":function(d,i){return"d3-arc-"+pieLabelsCollection[i][0]}}),_pieSlices.append("svg:text").attr({"class":function(d,i){return 0===pieLabelsCollection[i][1]?"hide":"outside-labels d3-label-"+pieLabelsCollection[i][0]},transform:function(d){return d.outerRadius=_outerRadius+0,d.innerRadius=_outerRadius+45,"translate("+_arc.centroid(d)+")"},"text-anchor":function(d){return(d.endAngle+d.startAngle)/2>Math.PI?"end":"start"}}).text(function(d,i){return pieLabelsCollection[i][0]}).append("tspan").text(function(d,i){return pieLabelsCollection[i][1]+"%"}).attr({x:function(d){var w=-this.parentNode.getBBox().width+23;return(d.endAngle+d.startAngle)/2>Math.PI?w?w:0:"0"},y:15,"text-anchor":"start"}),_pieSlices.filter(function(d){return d.endAngle-d.startAngle>.2}).append("svg:text").attr({transform:function(d){return d.outerRadius=_outerRadius,d.innerRadius=_outerRadius/2,"translate("+_arc.centroid(d)+")"},"text-anchor":"middle","class":"inside-labels"}).text(function(d){return d.data[1]+"%"}),labelsHTML=generatePieLabels(),jQuery(pieId).append(labelsHTML)}if(Object.keys(scope.data).length){var pieName=jQuery(element[0]).attr("data-piename"),isPdf="undefined"!=typeof jQuery(element[0]).attr("data-pdf")?!0:!1,pieId="#"+jQuery(element[0]).attr("id"),pieKeys=scope.data,pieColorSets={conflictManagement:["#eb5a2c","#eb7b21","#f59f13","#ffe299","#ffffd1"],fundamentalNeeds:["#ac3caf","#ce75d3","#eeaaf2"],learningStyle:["#b21b6e","#dd66b3"]},pieLabels=[],initChart=null,pieLabelsCollection=[],isIE=jQuery("html").hasClass("ie")?!0:!1;for(var keys in pieKeys)pieLabels.push($rootScope.pullInterNationalization("profileKeys."+keys),pieKeys[keys]),pieLabelsCollection.push(pieLabels),pieLabels=[];pieLabelsCollection="conflictManagement"===pieName?customLabelOrder(pieLabelsCollection.sort(byLabelsAsc),"conflictManagement"):pieLabelsCollection.sort(byLabelsAsc),isPdf?scope.$watch(function(){return attrs.dataPdf},function(){$timeout(generatePieWithD3(isPdf),100)}):initChart=$timeout(generatePieWithD3,0)}}}}angular.module("spApp").directive("piechartInfoGraph",piechartInfoGraph),piechartInfoGraph.$inject=["$rootScope","$timeout"];
function profilePicUploader($http,ajaxService,$rootScope,$timeout,ngDialog,$localStorage){return{restrict:"A",link:function($scope,$element,$attrs){jQuery($element[0]).find(".select-image-btn").on("click",function(e){e.preventDefault();var fileInput=jQuery($element[0]).find("form.pic-uploader").find("input:file");if(fileInput.click(),$scope.enableBtns=!0,$scope.$apply(),jQuery("html").hasClass("ie10")&&$scope.prevImage===jQuery($element[0]).find(".image-editor").cropit("imageSrc")&&$scope.resetFlag===!0){jQuery($element[0]).find(".cropit-image-background").removeAttr("src"),jQuery($element[0]).find(".cropit-image-preview").removeClass("cropit-image-loaded");var img=jQuery($element[0]).find(".image-editor").cropit("imageSrc");jQuery($element[0]).find(".cropit-image-background").attr("src",img),jQuery($element[0]).find(".cropit-image-background-container").css({"background-image":'url("'+img+'")'}),jQuery($element[0]).find(".cropit-image-preview").css({"background-image":'url("'+img+'")'}).addClass("cropit-image-loaded"),$scope.prevImage="",$scope.resetFlag=!1}}),setTimeout(function(){jQuery($element[0]).find(".image-editor").cropit({imageBackground:!0,previewSize:{width:170,height:170},exportZoom:.51,originalSize:!1})},500),jQuery($element[0]).find(".reset-image").on("click",function(e){if(e.preventDefault(),$scope.enableBtns===!0){$scope.enableBtns=!1,$scope.$apply();var fileInput=jQuery($element[0]).find("form.pic-uploader").find("input:file");fileInput.val(""),jQuery($element[0]).find(".avatar-upload div").each(function(){jQuery(this).css("background-image","none")}),$scope.resetFlag=!0,$scope.prevImage=jQuery($element[0]).find(".image-editor").cropit("imageSrc"),jQuery($element[0]).find(".cropit-image-background").attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7")}}),jQuery($element[0]).find(".process-pic").on("click",function(e){e.preventDefault();var hasBGImage="none"!==jQuery($element[0]).find(".cropit-image-preview").css("background-image");if(!hasBGImage)return $scope.enableBtns=!1,!1;if($scope.enableBtns===!0){$scope.enableBtns=!1,$scope.$apply(),$scope.imageData=jQuery($element[0]).find(".image-editor").cropit("export",{type:"image/jpeg",quality:.99,exportZoom:.5});var options={url:"company"===$scope.imageType?"/sp/admin/company/uploadImage":"/sp/uploadImage",data:$.param({image:$scope.imageData})};ajaxService.getAjaxResponse(options).then(function(response){"true"===response.Success?(ngDialog.close("ngdialog1"),$.growl({icon:"glyphicon glyphicon-ok",message:" Image updated Successfully"}),$timeout(function(){$localStorage.remove("loggegdInProfile"),window.location.reload()},1e3)):$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:"Image upload failed."})})}})}}}angular.module("spApp").directive("profilePicUploader",profilePicUploader),profilePicUploader.$inject=["$http","ajaxService","$rootScope","$timeout","ngDialog","$localStorage"];
function profileTags($http,ajaxService){return{restrict:"A",link:function($scope,$element,$attrs){function addtoTagList(t){var _params={userEmail:$scope.updatedEmail,tagName:t,op:"SET"};ajaxService.getAjaxResponse({url:"/sp/admin/user/tag",data:$.param(_params)}).then(function(response){})}function removeFromTagList(t){var _params={userEmail:$scope.updatedEmail,tagName:t,op:"REMOVE"};ajaxService.getAjaxResponse({url:"/sp/admin/user/tag",data:$.param(_params)}).then(function(response){})}jQuery($element[0]).tagsInput({width:"100%",height:"100%",defaultText:jQuery($element[0]).attr("data-ph"),onAddTag:function(tag){addtoTagList(tag)},onRemoveTag:function(tag){removeFromTagList(tag)}}),setTimeout(function(){jQuery($element[0]).importTags(jQuery($element[0]).attr("data-existing"))},800)}}}angular.module("spApp").directive("profileTags",profileTags),profileTags.$inject=["$http","ajaxService"];
function toggleSection(){return{restrict:"A",link:function($scope,$element,$attrs){jQuery($element[0]).on("click",function(e){e.preventDefault();var activeTab,secInfo=jQuery(this).attr("data-rel"),secCont=jQuery("body").find("div[data-section="+secInfo+"]");$.each(jQuery("body").find(".btn-wrap a.toggle-btn"),function(){jQuery(this).hasClass("on")&&(activeTab=jQuery(this).attr("data-rel"))}),$.each(jQuery("body").find("div[data-section]"),function(){jQuery(this).removeClass("toggleShow").addClass("toggleHide")}),$.each(jQuery("body").find(".btn-wrap a.toggle-btn"),function(){jQuery(this).removeClass("on")}),secInfo!==activeTab?(secCont.removeClass("toggleHide").addClass("toggleShow"),jQuery(this).addClass("on"),jQuery("html,body").animate({scrollTop:jQuery(secCont).offset().top-40},300)):(secCont.removeClass("toggleShow").addClass("toggleHide"),jQuery(this).removeClass("on"))})}}}angular.module("spApp").directive("toggleSection",toggleSection);
function tagTypeInput($http,$rootScope,ajaxService){return{restrict:"A",link:function($scope,$element,$attrs){function validateUpdateEmails(tagContainer){var _t=jQuery(tagContainer).find(".tagsinput"),_tInput=jQuery(tagContainer).find("input.storeTagsHere").attr("ng-model").split("."),emailPattern=/^[a-z0-9._-]+@[a-z0-9._-]+\.[a-z]{2,4}$/i;jQuery(tagContainer).hasClass("emailTags")?(emailInputs=[],$scope.emailPatternError=!1,$scope.addMemberEmailCount=0,$scope.emailCountError=!1,$scope.addMemberStatus.existingEmailError=!1,$scope.addMemberStatus.requiredError=!1,$scope.addMemberStatus.inValidEmailError=!1,$scope.$apply(),jQuery.each(jQuery(_t).find("span.tag"),function(i,j){var formattedEmail=jQuery(this).find("span").html().replace(/&nbsp;/g," ").trim();jQuery(this).find("span").attr("data-email",formattedEmail),emailPattern.test(formattedEmail)?(ajaxService.getAjaxResponse({url:"/sp/signup/validateEmails",data:$.param({memberList:formattedEmail}).replace(/%2C/g,",").replace(/%40/g,"@")}).then(function(response){"true"===response.Success&&response.failureList.length>0&&($scope.addMemberStatus.existingEmailError=!0,jQuery(j).addClass("error-email"))}),emailInputs.push(formattedEmail)):($scope.emailPatternError=!0,jQuery(j).addClass("error-email"),$scope.addMemberStatus.inValidEmailError=!0)}),$scope.addMemberEmailCount=emailInputs.length,$scope[_tInput[0]][_tInput[1]]=emailInputs.join(),$scope.$apply()):(textTags=[],$scope[_tInput[0]][_tInput[1]]=null,$scope.$apply(),jQuery.each(jQuery(_t).find("span.tag"),function(i,j){var formatTags=jQuery(this).find("span").html().replace(/&nbsp;/g," ").trim();textTags.push(formatTags)}),$scope[_tInput[0]][_tInput[1]]=textTags.join(),$scope.$apply())}var emailInputs=[],textTags=[];$rootScope.inviteReady===!0&&jQuery($element[0]).tagsInput({width:"100%",height:"100%",getTabIndex:"undefined"!=typeof jQuery($element[0]).attr("data-tab")?jQuery($element[0]).attr("data-tab"):"",defaultText:$rootScope.pullInterNationalization(jQuery($element[0]).attr("data-ph")),onAddTag:function(tag){var tags=tag.split(",");return tags.length>1?($(this).removeTag(tag),!1):void validateUpdateEmails(jQuery($element[0]).parent())},onRemoveTag:function(){validateUpdateEmails(jQuery($element[0]).parent())}})}}}angular.module("spApp").directive("tagTypeInput",tagTypeInput),tagTypeInput.$inject=["$http","$rootScope","ajaxService"];
function wolLinks($http,ajaxService,$rootScope,$timeout,ngDialog){return{restrict:"A",link:function($scope,$element,$attrs){$scope.redirectToPage=function(l){window.open(l),$timeout(function(){ngDialog.close("ngdialog1")},200)},jQuery($element[0]).on("click","a",function(e){e.preventDefault(),$scope.link=jQuery(this).attr("href"),ngDialog.open({template:"/sp/resources/html/curriculum/wol.html",scope:$scope})})}}}angular.module("spApp").directive("wolLinks",wolLinks),wolLinks.$inject=["$http","ajaxService","$rootScope","$timeout","ngDialog"];
function routerConfig($stateProvider){$stateProvider.state("practice",{url:"/practice",templateUrl:"/sp/resources/html/goals/practice.html",controllerAs:"vm"}).state("addNote",{url:"/addnote",templateUrl:"/sp/resources/html/goals/addNote.html",controllerAs:"vm"}).state("requestFeedback",{url:"/requestFeedback",templateUrl:"/sp/resources/html/goals/requestFeedback.html",controllerAs:"vm"}).state("completedArticle",{url:"/completedArticle",templateUrl:"/sp/resources/html/goals/completedArticle.html",controllerAs:"vm"}).state("notesAndFeedback",{url:"/notesAndFeedback",templateUrl:"/sp/resources/html/goals/notesFeedbackOverlay.html",controllerAs:"vm"}).state("manageArticle",{url:"/manageArticle",templateUrl:"/sp/resources/html/goals/manageStratagies.html",controllerAs:"vm"}).state("selectActionPlan",{url:"/selectActionPlan",templateUrl:"/sp/resources/html/goals/orgLanding.html",controllerAs:"vm"}).state("organization",{url:"/organization",templateUrl:"/sp/resources/html/goals/organization.html",controllerAs:"vm"})}angular.module("spApp").config(routerConfig),routerConfig.$inject=["$stateProvider"];
function ajaxService($http,$q,$rootScope,$filter,$localStorage){function startRequest(delay,maximum){requestCount||(startTimeout=setTimeout(function(){$rootScope.$broadcast("httpLoaderStart"),endTimeout=setTimeout(function(){requestCount&&(requestCount=0,$rootScope.$broadcast("httpLoaderEnd"))},maximum)},delay)),requestCount++}function endRequest(){requestCount&&(requestCount--,requestCount||(clearTimeout(startTimeout),clearTimeout(endTimeout),$rootScope.$broadcast("httpLoaderEnd")))}function getAjaxResponse(options){if("undefined"==typeof options)return void console.log("Please Provide Options to Perform Ajax Request");var delay="undefined"!=typeof options.delay?options.delay:500,maximum="undefined"!=typeof options.maximum?options.maximum:5e3;startRequest(delay,maximum);var request=$http({method:"undefined"!=typeof options.method?options.method:"post",url:"undefined"!=typeof options.url?options.url:"#",data:"undefined"!=typeof options.data?options.data:"",param:"undefined"!=typeof options.param?options.param:"",headers:"undefined"!=typeof options.headers?options.headers:{"Content-Type":"application/x-www-form-urlencoded"}});return request.then(handleSuccess,handleError)}function handleError(response){return endRequest(),angular.isObject(response.success)&&response.success?$q.reject(response.data.error):$q.reject("An unknown error occurred.")}function handleSuccess(response){if(endRequest(),null!==response.data&&void 0!==response.data){if(null!==response.data.success&&void 0!==response.data.success)return void 0!==response.data.success.Actions&&updateLocalStorage(response.data.success.Actions),response.data.success;if(null!==response.data.error&&void 0!==response.data.error)return void 0!==response.data.error.Actions&&updateLocalStorage(response.data.error.Actions),response.data}return response.data}function updateLocalStorage(Action){void 0!==Action.UpdateNavigation&&($localStorage.set("globalNav",Action.UpdateNavigation),$localStorage.remove("navHtml")),void 0!==Action.UpdatePermission&&$localStorage.set("loggegdInProfile",Action.UpdatePermission),void 0!==Action.UpdateParams&&Action.UpdateParams.doLogout&&(window.location.href="/sp/logout")}var requestCount=0,startTimeout=0,endTimeout=0;return{getAjaxResponse:getAjaxResponse,startRequest:startRequest,endRequest:endRequest}}function sharedProperties($rootScope,ngDialog,ajaxService,$localStorage){var email=[],objectValue={},resetEmail="",getArray=[];return{getEmail:function(){return email},setEmail:function(value){email=value},setObject:function(obj){objectValue=angular.copy(obj)},getObject:function(){return objectValue},setResetEmail:function(val){resetEmail=val},getResetEmail:function(){return resetEmail},getArrayResult:function(parent,keytosearch,full){getArray=[];for(var key=keytosearch,i=0;i<parent.length;i++)key in parent[i]&&null!==parent[i][key]&&(full?getArray.push(parent[i]):getArray.push(parent[i][key]));return getArray},getStringValue:function(parent,key,search,toreturn){angular.forEach(parent,function(val,index){return key in val&&val[key]===search?toreturn?val.toreturn:val:void 0})},spliceIndex:function(parent,searchkey,parentkey){return angular.forEach(parent,function(value,index){value[searchkey]===parentkey&&parent.splice(index,1)}),parent},spilceIndexWithBreak:function(parent,searchkey,parentkey){for(var i=0;i<parent.length;i++)if(parent[i][searchkey]===parentkey){parent.splice(i,1);break}return parent},toggleFilterClick:function(event,currentPredicate){var currentElem=$(event.currentTarget);currentPredicate=currentElem.data("predicate"),currentElem.find("h4").hasClass("on")?currentElem.find("h4").hasClass("reverseon")?currentElem.find("h4").removeClass("reverseon"):currentElem.find("h4").addClass("reverseon"):(currentElem.parent().find(".tog h4").removeClass("on"),currentElem.find("h4").addClass("on"))},searchModule:function(textVar,parent,num,key){if(textVar.length>=num){for(var copyArray=[],i=0;i<parent.length;i++)"undefined"==typeof key?""===angular.lowercase(parent[i].name)||null===angular.lowercase(parent[i].name)?angular.lowercase(parent[i].email).indexOf(angular.lowercase(textVar))>-1&&copyArray.push(parent[i]):(angular.lowercase(parent[i].email).indexOf(angular.lowercase(textVar))>-1||angular.lowercase(parent[i].name).indexOf(angular.lowercase(textVar))>-1)&&copyArray.push(parent[i]):""===angular.lowercase(parent[i][key].name)||null===angular.lowercase(parent[i][key].name)?angular.lowercase(parent[i][key].email).indexOf(angular.lowercase(textVar))>-1&&copyArray.push(parent[i]):(angular.lowercase(parent[i][key].email).indexOf(angular.lowercase(textVar))>-1||angular.lowercase(parent[i][key].name).indexOf(angular.lowercase(textVar))>-1)&&copyArray.push(parent[i]);return copyArray}return parent},singleElementSearch:function(textVar,parent,num){if(!(textVar.length>=num))return parent;if("undefined"==typeof key)if(""===angular.lowercase(parent.name)||null===angular.lowercase(parent.name)){if(angular.lowercase(parent.email).indexOf(angular.lowercase(textVar))>-1)return parent}else if(angular.lowercase(parent.email).indexOf(angular.lowercase(textVar))>-1||angular.lowercase(parent.name).indexOf(angular.lowercase(textVar))>-1)return parent},searchModuleName:function(textVar,parent,num,change,key){var type="undefined"==typeof change?"email":change;if(textVar.length>=num){for(var copyArray=[],i=0;i<parent.length;i++)"undefined"==typeof key?""===angular.lowercase(parent[i].name)||null===angular.lowercase(parent[i].name)?angular.lowercase(parent[i][type]).indexOf(angular.lowercase(textVar))>-1&&copyArray.push(parent[i]):(angular.lowercase(parent[i][type]).indexOf(angular.lowercase(textVar))>-1||angular.lowercase(parent[i].name).indexOf(angular.lowercase(textVar))>-1)&&copyArray.push(parent[i]):""===angular.lowercase(parent[i][key].name)||null===angular.lowercase(parent[i][key].name)?angular.lowercase(parent[i][key][type]).indexOf(angular.lowercase(textVar))>-1&&copyArray.push(parent[i]):(angular.lowercase(parent[i][key][type]).indexOf(angular.lowercase(textVar))>-1||angular.lowercase(parent[i][key].name).indexOf(angular.lowercase(textVar))>-1)&&copyArray.push(parent[i]);return copyArray}return parent},getParam:function(param){var url=location.href,regexS="[\\?&]"+param+"=([^&#]*)",regex=new RegExp(regexS),results=regex.exec(url);return null==results?null:results[1]},setSwitch:function(param){$rootScope.switchType=param},notification:function(args,userTypeName,disabledName,extra){if($rootScope.notificationList=args,$rootScope.extra=null,"undefined"==typeof userTypeName?$rootScope.userTypeName="GenericMessage":$rootScope.userTypeName=userTypeName,"undefined"==typeof disabledName)$rootScope.disabledName=null,$rootScope.selectedNotification="default";else{$rootScope.disabledName=disabledName,$rootScope.selectedNotification=disabledName;var comment=$.parseHTML($rootScope.pullInterNationalization("admin.group."+disabledName+".notification.text"))[0],subBlock=$.parseHTML($rootScope.pullInterNationalization("admin.group."+disabledName+".notification.nosubject"))[0];$rootScope.commentNotification=$(comment).text(),$rootScope.subBlockNotification=$(subBlock).text()}$rootScope.notify=["Profile","Goals","Prism"],angular.isObject(extra)&&($rootScope.extra=extra),ngDialog.open({template:"/sp/notification/email"})},printPdfProfile:function(options){var $getCont=$(options.holder),cssToApply="undefined"==typeof options.cssName?"global.min.css":options.cssName,parObj=options.obj;if(!$getCont.length)return!0;var printContents=$getCont.html(),data={content:encodeURIComponent('<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><script src="//use.typekit.net/ofk8xcu.js"></script><script> try {Typekit.load();} catch (e) {}</script><link type="text/css" rel="stylesheet" href="/sp/resources/css/css-min/bootstrap.min.css"><link type="text/css" rel="stylesheet" href="/sp/resources/css/css-min/'+cssToApply+'"></head><body>'+printContents+"</body></html>")};data.pdfName=options.extraParam,ajaxService.getAjaxResponse({url:options.url,data:$.param(data)}).then(function(response){if("true"===response.Success)$rootScope.$broadcast("pdfGenerated",{obj:parObj,url:response.url});else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage}),$rootScope.$broadcast("pdfGenerated",parObj),ngDialog.close("ngdialog1")}})},openMediaModal:function(){$rootScope.mediaView="select";var sourceSelect=ngDialog.open({template:"/sp/resources/html/sysAdmin/media/select-modal.html"});sourceSelect.closePromise.then(function(data){$rootScope.$broadcast("mediaData",$localStorage.get("mediaData")),$localStorage.remove("mediaData")})}}}function $localStorage($window){var localStorageOn=!1,$privateMode={};if("localStorage"in window)try{$window.localStorage.setItem("_tmptest","tmpval"),localStorageOn=!0,$window.localStorage.removeItem("_tmptest")}catch(error){localStorageOn=!1}return{isAvailable:function(){return localStorageOn},executeMethod:function(fnSuccess,fnFail){return localStorageOn?fnSuccess&&fnSuccess():fnFail&&fnFail()},remove:function(){if(localStorageOn)for(var j=0;j<arguments.length;j++)$window.localStorage.removeItem(arguments[j]);else for(var i=0;i<arguments.length;i++)arguments[i]in $privateMode&&($privateMode.arguments[i]=null)},flush:function(){localStorageOn?$window.localStorage.clear():$privateMode={}},get:function(key){return localStorageOn?$privateMode=JSON.parse($window.localStorage[key]||null):$privateMode[key]||null},set:function(key,value,callback){if(localStorageOn){if(void 0===value)return $localStorage.remove(key);$window.localStorage[key]=JSON.stringify(value)}else $privateMode[key]=value;return"function"==typeof callback&&callback&&callback(),this}}}angular.module("spApp").config(["$httpProvider",function($httpProvider){$httpProvider.interceptors.push(["$location","$injector",function($location,$injector){return{request:function(config){return config.headers["X-Requested-With"]="XMLHttpRequest",config},requestError:function(rejection){return rejection},response:function(response){return response},responseError:function(rejection){return 408===rejection.status||null===rejection.data&&0===rejection.status?(window.location.reload(),!1):rejection}}}])}]),angular.module("spApp").service("ajaxService",ajaxService),ajaxService.$inject=["$http","$q","$rootScope","$filter","$localStorage"],angular.module("spApp").service("sharedProperties",sharedProperties),sharedProperties.$inject=["$rootScope","ngDialog","ajaxService","$localStorage"],angular.module("spApp").service("$localStorage",$localStorage),$localStorage.$inject=["$window"];
function ProfileDataService(){function savaData(data){serviceData=data}function savaMemberData(data){memberData=data}function savaCandidateData(data){candidateData=data}function retriveData(){return serviceData}function retriveCandidateData(){return candidateData}function retriveMemberData(){return memberData}function clearData(){return serviceData=null}var serviceData,memberData,candidateData;return{save:savaData,saveMember:savaMemberData,saveCandidate:savaCandidateData,retrive:retriveData,retriveMember:retriveMemberData,retriveCandidate:retriveCandidateData,reset:clearData}}angular.module("spApp").factory("ProfileDataService",ProfileDataService);
function userDataService($rootScope){function savaData(data){serviceData=data,$rootScope.profileReady=!0}function retriveData(){return serviceData}var serviceData;return{save:savaData,retrive:retriveData}}angular.module("spApp").factory("userDataService",userDataService),userDataService.$inject=["$rootScope"];
function userIntroSettingsService(ngDialog,ajaxService,$localStorage){function getUserIntroSettings(key,maxCount){var showModal=!1;if(null!==userProfile){var introSettings=userProfile.member.introSettingsMap;(null===introSettings||void 0===introSettings[key]||null===introSettings[key]||null!==introSettings[key]&&void 0!==introSettings[key]&&introSettings[key].count<=maxCount)&&(showModal=!0)}return showModal}function updateUserIntroSettings(flagName,flagValue){ajaxService.getAjaxResponse({url:"/sp/updateIntroSettings",data:$.param({flagName:flagName,flagValue:flagValue})}).then(function(response){if("true"===response.Success)userProfile.member.introSettingsMap=response.introSettingsMap,$localStorage.set("loggegdInProfile",userProfile),ngDialog.close();else if(null!==response.error){var errorMessage="";for(var key in response.error)errorMessage=response.error[key];$.growl({icon:"glyphicon glyphicon-ban-circle",title:"<strong> Alert </strong>",message:errorMessage})}})}var userProfile=$localStorage.get("loggegdInProfile");return{getUserIntroSettings:getUserIntroSettings,updateUserIntroSettings:updateUserIntroSettings}}angular.module("spApp").service("userIntroSettingsService",userIntroSettingsService),userIntroSettingsService.$inject=["ngDialog","ajaxService","$localStorage"];